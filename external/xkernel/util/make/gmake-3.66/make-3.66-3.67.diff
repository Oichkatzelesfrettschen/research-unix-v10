This file contains diffs from version 3.66 of GNU Make to version 3.67.
Changes in files that are generated by etags and TeX have been omitted.


diff -ruN make-3.66/ChangeLog make-3.67/ChangeLog
--- make-3.66/ChangeLog	Fri May 21 16:09:35 1993
+++ make-3.67/ChangeLog	Sat May 22 21:00:00 1993
@@ -1,3 +1,18 @@
+Sat May 22 16:15:18 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)
+
+	* Version 3.67.
+
+	* file.c (remove_intermediates): Don't write extra space after `rm'.
+
+	* main.c (struct command_switch.type): Remove `usage_and_exit'.
+	(print_usage_flag): New variable.
+	(switches: --help): Make type `flag', to set print_usage_flag.
+	(init_switches): Remove `usage_and_exit' case.
+	(decode_switches): Likewise.
+	(decode_switches): Print usage if print_usage_flag is set.
+	When printing usage, die with status of BAD.
+	(main): Die with 0 if print_version_flag.
+
 Fri May 21 16:09:28 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)
 
 	* Version 3.66.
diff -ruN make-3.66/Makefile.in make-3.67/Makefile.in
--- make-3.66/Makefile.in	Fri May 21 15:51:28 1993
+++ make-3.67/Makefile.in	Sat May 22 21:02:06 1993
@@ -1,3 +1,6 @@
+# NOTE: If you have no `make' program at all to process this makefile, run
+# `build.sh' instead.
+#
 # Copyright (C) 1988, 1989, 1991, 1992, 1993 Free Software Foundation, Inc.
 # This file is part of GNU Make.
 # 
diff -ruN make-3.66/README make-3.67/README
--- make-3.66/README	Fri May 21 15:50:47 1993
+++ make-3.67/README	Sat May 22 21:01:24 1993
@@ -1,4 +1,4 @@
-This directory contains the 3.66 test release of GNU Make.
+This directory contains the 3.67 test release of GNU Make.
 All bugs reported for previous test releases have been fixed.
 Some bugs surely remain.
 
diff -ruN make-3.66/alloca.c make-3.67/alloca.c
--- make-3.66/alloca.c	Tue May 11 19:23:34 1993
+++ make-3.67/alloca.c	Fri May 21 19:39:17 1993
@@ -42,10 +42,6 @@
 #endif /* static */
 #endif /* emacs */
 
-#ifdef emacs
-#define free xfree
-#endif
-
 /* If your stack is a linked list of frames, you have to
    provide an "address metric" ADDRESS_FUNCTION macro.  */
 
@@ -64,8 +60,6 @@
 
 #define	NULL	0
 
-extern pointer xmalloc ();
-
 /* Define STACK_DIRECTION if you know the direction of stack
    growth for your system; otherwise it will be automatically
    deduced at run-time.
@@ -181,7 +175,7 @@
   /* Allocate combined header + user data storage.  */
 
   {
-    register pointer new = xmalloc (sizeof (header) + size);
+    register pointer new = malloc (sizeof (header) + size);
     /* Address of header.  */
 
     ((header *) new)->h.next = last_alloca_header;
diff -ruN make-3.66/file.c make-3.67/file.c
--- make-3.66/file.c	Wed Mar 10 15:24:57 1993
+++ make-3.67/file.c	Sat May 22 16:24:37 1993
@@ -336,12 +336,13 @@
 		error ("*** Deleting file `%s'", f->name);
 	      else if (!silent_flag)
 		{
-		  if (!doneany)
+		  if (! doneany)
 		    {
 		      fputs ("rm ", stdout);
 		      doneany = 1;
 		    }
-		  putchar (' ');
+		  else
+		    putchar (' ');
 		  fputs (f->name, stdout);
 		  fflush (stdout);
 		}
diff -ruN make-3.66/main.c make-3.67/main.c
--- make-3.66/main.c	Fri May 14 17:50:11 1993
+++ make-3.67/main.c	Sat May 22 16:20:16 1993
@@ -91,8 +91,7 @@
 	string,			/* One string per switch.  */
 	positive_int,		/* A positive integer.  */
 	floating,		/* A floating-point number (double).  */
-	ignore,			/* Ignored.  */
-	usage_and_exit		/* Ignored; exit after processing switches.  */
+	ignore			/* Ignored.  */
       } type;
 
     char *value_ptr;	/* Pointer to the value-holding variable.  */
@@ -219,6 +218,10 @@
 /* List of files given with -W switches.  */
 
 static struct stringlist *new_files = 0;
+
+/* If nonzero, we should just print usage and exit.  */
+
+static int print_usage_flag = 0;
 
 /* The table of command switches.  */
 
@@ -239,7 +242,7 @@
     { 'f', string, (char *) &makefiles, 0, 0, 0, 0, 0,
 	"file", "FILE",
 	"Read FILE as a makefile" },
-    { 'h', usage_and_exit, 0, 0, 0, 0, 0, 0,
+    { 'h', flag, (char *) &print_usage_flag, 0, 0, 0, 0, 0,
 	"help", 0,
 	"Print this message and exit" },
     { 'i', flag, (char *) &ignore_errors_flag, 1, 1, 0, 0, 0,
@@ -500,7 +503,7 @@
 
   /* `make --version' is supposed to just print the version and exit.  */
   if (print_version_flag)
-    die (1);
+    die (0);
 
   /* Search for command line arguments that define variables,
      and do the definitions.  Also save up the text of these
@@ -1085,7 +1088,6 @@
 	case flag:
 	case flag_off:
 	case ignore:
-	case usage_and_exit:
 	  long_options[i].has_arg = no_argument;
 	  break;
 
@@ -1173,10 +1175,6 @@
 		case ignore:
 		  break;
 
-		case usage_and_exit:
-		  bad = 1;
-		  break;
-
 		case flag:
 		case flag_off:
 		  if (doit)
@@ -1269,7 +1267,7 @@
       other_args->list[other_args->idx] = 0;
     }
 
-  if (bad && !env)
+  if (!env && (bad || print_usage_flag))
     {
       /* Print a nice usage message.  */
 
@@ -1355,7 +1353,7 @@
 		   buf, cs->description);
 	}
 
-      die (1);
+      die (bad);
     }
 }
 
diff -ruN make-3.66/mkinstalldirs make-3.67/mkinstalldirs
--- make-3.66/mkinstalldirs	Sun May 16 14:03:08 1993
+++ make-3.67/mkinstalldirs	Sat May 22 20:14:19 1993
@@ -8,13 +8,14 @@
 IFS="${IFS-${defaultIFS}}"
 
 for file in ${1+"$@"} ; do 
-   oIFS="${IFS}"; IFS='/'; set - ${file}; IFS="${oIFS}"
+   oIFS="${IFS}"
+   # Some sh's can't handle IFS=/ for some reason.
+   IFS='%'
+   set - `echo ${file} | sed -e 's@/@%@g' -e 's@^%@/@'`
+   IFS="${oIFS}"
    test ".${1}" = "." && shift
 
-   case "${file}" in 
-    /* ) pathcomp='/' ;;
-    * )  pathcomp=''  ;;
-   esac
+   pathcomp=''
 
    while test $# -ne 0 ; do
      pathcomp="${pathcomp}${1}"
diff -ruN make-3.66/version.c make-3.67/version.c
--- make-3.66/version.c	Fri May 21 15:47:59 1993
+++ make-3.67/version.c	Sat May 22 20:59:55 1993
@@ -1,4 +1,4 @@
-char *version_string = "3.66";
+char *version_string = "3.67";
 
 /*
   Local variables:
