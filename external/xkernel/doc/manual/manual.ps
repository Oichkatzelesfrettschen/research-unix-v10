%!PS-Adobe-2.0
%%Creator: dvips 5.485 Copyright 1986-92 Radical Eye Software
%%Title: manual.dvi
%%Pages: 157 1
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Italic Times-Roman Times-Bold Helvetica Palatino-Roman
%%+ Courier
%%EndComments
%DVIPSCommandLine: dvips -o manual.ps manual.dvi
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo setfont}2 array copy cvx N load 0 nn
put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0
0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data
dup length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128
ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127
sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp 0 N
/cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2 index get
S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff ch-yoff ch-height
sub ch-xoff ch-width add ch-yoff setcachedevice ch-width ch-height true[1 0 0
-1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}imagemask restore}B /D{/cc X dup
type /stringtype ne{]}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1
ne{dup dup length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}
B /I{cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto pop}N /eop{SI restore showpage userdict /eop-hook known{eop-hook}
if}N /@start{userdict /start-hook known{start-hook}if /VResolution X
/Resolution X 1000 div /DVImag X /IE 256 array N 0 1 255{IE S 1 string dup 0 3
index put cvn put}for 65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N
/RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X
/rulex X V}B /V statusdict begin /product where{pop product dup length 7 ge{0
7 getinterval(Display)eq}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1
TR 1 1 scale rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1
-.1 TR rulex ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /a{
moveto}B /delta 0 N /tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{
S p tail}B /c{-4 M}B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B
/j{3 M}B /k{4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w
}B /q{p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2 index
/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll exec 0 exch 5
-1 roll VResolution Resolution div mul neg 0 0]/Metrics exch def dict begin
Encoding{exch dup type /integertype ne{pop pop 1 sub dup 0 le{pop}{[}ifelse}{
FontMatrix 0 get div Metrics 0 get div def}ifelse}forall Metrics /Metrics
currentdict end def[2 index currentdict end definefont 3 -1 roll makefont
/setfont load]cvx def}def /ObliqueSlant{dup sin S cos div neg}B /SlantFont{4
index mul add}def /ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding
exch def}def end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 @start /Fa 135[22
3[14 1[19 16[25 97[{}4 50.000000 /Times-Italic rf /Fb 88 126
df<70F8F8F8F8F8F8F8F8F8F8F8F8F8F8F8F870000000000070F8F8F870051C779B18>33
D<4010E038F078E038E038E038E038E038E038E038E038E038E03860300D0E7B9C18>I<030600
078F00078F00078F00078F00078F00078F007FFFC0FFFFE0FFFFE07FFFC00F1E000F1E000F1E00
0F1E000F1E000F1E007FFFC0FFFFE0FFFFE07FFFC01E3C001E3C001E3C001E3C001E3C001E3C00
0C1800131C7E9B18>I<00C00001C00001C00001C00003F0000FFC003FFE007DCF0071C700E1C3
80E1C780E1C780E1C780F1C00079C0003FC0001FE0000FF80001FC0001DE0001CF0001C70061C3
80F1C380F1C380E1C380E1C70071C70079DE003FFE001FF80007E00001C00001C00001C00000C0
0011247D9F18>I<01C00007E0000FF0000E70001C38001C38001C38001C38001C73F81CF3F81C
E3F80FC1C00FC3800F83800F03801F07003F87007B8E0071CE00E1FC00E0FC00E07C00E07870E0
787070FE707FFFE03FC7E00F03C0151C7F9B18>38 D<387C7C7E3E0E0E0E1C1C38F8F0C0070E78
9B18>I<007000F001E003C007800F001E001C00380038007000700070007000E000E000E000E0
00E000E000E000E0007000700070007000380038001C001E000F00078003C001F000F000700C24
799F18>I<6000F00078003C001E000F000780038001C001C000E000E000E000E0007000700070
0070007000700070007000E000E000E000E001C001C0038007800F001E003C007800F00060000C
247C9F18>I<01C00001C00001C00001C00041C100F1C780FDDF807FFF001FFC0007F00007F000
1FFC007FFF00FDDF80F1C78041C10001C00001C00001C00001C00011147D9718>I<00600000F0
0000F00000F00000F00000F00000F00000F0007FFFC0FFFFE0FFFFE07FFFC000F00000F00000F0
0000F00000F00000F00000F00000600013147E9718>I<1C3E7E7F3F1F070E1E7CF860080C7885
18>I<7FFFC0FFFFE0FFFFE07FFFC013047E8F18>I<3078FCFC78300606778518>I<0003000007
80000780000F80000F00001F00001E00001E00003E00003C00007C0000780000780000F80000F0
0001F00001E00003E00003C00003C00007C0000780000F80000F00000F00001F00001E00003E00
003C00003C00007C0000780000F80000F00000F0000060000011247D9F18>I<01F00007FC000F
FE001F1F001C07003803807803C07001C07001C0E000E0E000E0E000E0E000E0E000E0E000E0E0
00E0E000E0E000E0F001E07001C07001C07803C03803801C07001F1F000FFE0007FC0001F00013
1C7E9B18>I<01800380038007800F803F80FF80FB804380038003800380038003800380038003
80038003800380038003800380038003807FFCFFFE7FFC0F1C7B9B18>I<03F0000FFE003FFF00
7C0F807003C0E001C0F000E0F000E06000E00000E00000E00001C00001C00003C0000780000F00
001E00003C0000780000F00001E00007C0000F80001E00E03C00E07FFFE0FFFFE07FFFE0131C7E
9B18>I<07F8001FFE003FFF007807807803C07801C03001C00001C0000380000380000F0003FF
0003FE0003FF000007800003C00001C00000E00000E00000E0F000E0F000E0F001C0F003C07C07
803FFF001FFE0003F800131C7E9B18>I<001F00003F0000770000770000E70001E70001C70003
87000787000707000E07001E07003C0700380700780700F00700FFFFF8FFFFF8FFFFF800070000
0700000700000700000700000700007FF0007FF0007FF0151C7F9B18>I<3FFF803FFF803FFF80
3800003800003800003800003800003800003800003800003BF8003FFE003FFF003C07803003C0
0001C00000E00000E06000E0F000E0F000E0E001C07003C07C0F803FFF001FFC0003F000131C7E
9B18>I<007E0001FF0007FF800F83C01E03C01C03C0380180380000700000700000E1F800E7FE
00FFFF00FE0780F803C0F001C0F000E0E000E0F000E07000E07000E07000E03801C03C03C01E07
800FFF0007FE0001F800131C7E9B18>I<E00000FFFFE0FFFFE0FFFFC0E00380E00700000F0000
1E00001C0000380000380000700000F00000E00000E00001C00001C00001C00003800003800003
8000038000070000070000070000070000070000070000070000131D7E9C18>I<03F8000FFE00
1FFF003E0F803803807001C07001C07001C07001C03803803C07801FFF0007FC000FFE001F1F00
3C07807001C0F001E0E000E0E000E0E000E0E000E07001C07803C03E0F801FFF000FFE0003F800
131C7E9B18>I<03F0000FFC001FFE003C0F00780780700380E001C0E001C0E001C0E001E0E001
E07001E07803E03C0FE01FFFE00FFEE003F0E00000E00001C00001C00001C0300380780780780F
00783E003FFC001FF00007C000131C7E9B18>I<3078FCFC783000000000000000003078FCFC78
300614779318>I<183C7E7E3C180000000000000000183C7E7E3E1E0E1C3C78F060071A789318>
I<0000C00003E00007E0001FC0003F8000FE0001FC0007F0000FE0003F80007F0000FC0000FC00
007F00003F80000FE00007F00001FC0000FE00003F80001FC00007E00003E00000C013187E9918
>I<7FFFC0FFFFE0FFFFE0FFFFE0000000000000000000000000FFFFE0FFFFE0FFFFE07FFFC013
0C7E9318>I<600000F80000FC00007F00003F80000FE00007F00001FC0000FE00003F80001FC0
0007E00007E0001FC0003F8000FE0001FC0007F0000FE0003F80007F0000FC0000F80000600000
13187E9918>I<007C0001FE0007FF000F87801E03C03C1DC0387FC070FFE071E3E071C1E0E1C1
E0E380E0E380E0E380E0E380E0E380E0E380E0E1C1C071C1C071E3C070FF80387F003C1C001E00
E00F83E007FFC001FF80007E00131C7E9B18>64 D<00700000F80000F80000D80000D80001DC00
01DC0001DC00018C00038E00038E00038E00038E000707000707000707000707000707000FFF80
0FFF800FFF800E03801C01C01C01C01C01C07F07F0FF07F87F07F0151C7F9B18>I<7FFC00FFFF
007FFF801C03C01C01C01C00E01C00E01C00E01C00E01C01E01C01C01C07C01FFF801FFF001FFF
C01C03C01C00E01C00F01C00701C00701C00701C00701C00F01C00E01C03E07FFFC0FFFF807FFE
00141C7F9B18>I<00F8E003FEE007FFE00F07E01E03E03C01E03800E07000E07000E0700000E0
0000E00000E00000E00000E00000E00000E00000E000007000007000E07000E03800E03C00E01E
01C00F07C007FF8003FE0000F800131C7E9B18>I<7FF800FFFE007FFF001C0F801C03C01C03C0
1C01E01C00E01C00E01C00F01C00701C00701C00701C00701C00701C00701C00701C00701C00F0
1C00E01C00E01C01E01C01C01C03C01C0F807FFF00FFFE007FF800141C7F9B18>I<FFFFF0FFFF
F0FFFFF01C00701C00701C00701C00701C00001C00001C0E001C0E001C0E001FFE001FFE001FFE
001C0E001C0E001C0E001C00001C00001C00381C00381C00381C00381C0038FFFFF8FFFFF8FFFF
F8151C7F9B18>I<FFFFF8FFFFF8FFFFF81C00381C00381C00381C00381C00001C00001C07001C
07001C07001FFF001FFF001FFF001C07001C07001C07001C00001C00001C00001C00001C00001C
00001C0000FFC000FFC000FFC000151C7F9B18>I<01F1C003FDC00FFFC01F0FC01C03C03803C0
3801C07001C07001C0700000E00000E00000E00000E00000E00000E00FF0E01FF0E00FF07001C0
7001C07003C03803C03803C01C07C01F0FC00FFFC003FDC001F1C0141C7E9B18>I<7F07F0FF8F
F87F07F01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01FFFC01FFFC01FFF
C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C07F07F0FF8FF87F07
F0151C7F9B18>I<7FFF00FFFF807FFF0001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C0007FFF00FFFF807FFF00111C7D9B18>I<01FFC001FFC001FFC0000E00000E00000E00
000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00
000E00000E00000E00F00E00F00E00F03C007FFC003FF0000FC000121C7D9B18>I<7F07F0FF87
F87F07F01C03C01C07801C07001C0E001C1E001C3C001C38001C70001CF0001DF0001DF0001FB8
001FB8001F1C001E1C001C0E001C0E001C07001C07001C03801C03801C01C07F03F0FF87F87F03
F0151C7F9B18>I<FFC000FFC000FFC0001C00001C00001C00001C00001C00001C00001C00001C
00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00E01C00E01C00E01C
00E01C00E0FFFFE0FFFFE0FFFFE0131C7E9B18>I<FC01F8FE03F8FE03F83B06E03B06E03B06E0
3B06E03B8EE03B8EE0398CE0398CE039DCE039DCE039DCE038D8E038D8E038F8E03870E03870E0
3800E03800E03800E03800E03800E03800E0FE03F8FE03F8FE03F8151C7F9B18>I<7E07F0FF0F
F87F07F01D81C01D81C01D81C01DC1C01CC1C01CC1C01CE1C01CE1C01CE1C01C61C01C71C01C71
C01C31C01C39C01C39C01C39C01C19C01C19C01C1DC01C0DC01C0DC01C0DC07F07C0FF87C07F03
C0151C7F9B18>I<0FFE003FFF807FFFC07803C07001C0F001E0E000E0E000E0E000E0E000E0E0
00E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0F001E070
01C07C07C07FFFC03FFF800FFE00131C7E9B18>I<FFFE00FFFF80FFFFC01C03C01C01E01C00E0
1C00701C00701C00701C00701C00701C00E01C01E01C03C01FFFC01FFF801FFE001C00001C0000
1C00001C00001C00001C00001C00001C0000FF8000FF8000FF8000141C7F9B18>I<0FFE003FFF
807FFFC07803C07001C0F001E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000
E0E000E0E000E0E000E0E000E0E000E0E070E0E070E0F079E07039C0783FC07FFFC03FFF800FFE
00000F000007800007800003C00001C00001C013227E9B18>I<7FF800FFFE007FFF001C0F801C
03801C03C01C01C01C01C01C01C01C03C01C03801C0F801FFF001FFE001FFE001C0F001C07001C
03801C03801C03801C03801C03801C039C1C039C1C039C7F01F8FF81F87F00F0161C7F9B18>I<
03F1C01FFFC03FFFC07C0FC07003C0E001C0E001C0E001C0E000007000007800003F00001FF000
07FE0000FF00000F800003C00001C00000E00000E06000E0E000E0E001E0F001C0F80780FFFF80
FFFE00E7F800131C7E9B18>I<7FFFF8FFFFF8FFFFF8E07038E07038E07038E070380070000070
000070000070000070000070000070000070000070000070000070000070000070000070000070
0000700000700000700007FF0007FF0007FF00151C7F9B18>I<FF83FEFF83FEFF83FE1C00701C
00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C
00701C00701C00701C00701C00700E00E00F01E00783C003FF8001FF00007C00171C809B18>I<
FE03F8FF07F8FE03F83C01E01C01C01C01C01C01C01E03C00E03800E03800E03800E0380070700
070700070700070700038E00038E00038E00038E00018C0001DC0001DC0001DC0000D80000F800
00F800007000151C7F9B18>I<FE03F8FE03F8FE03F87000707000707000703800E03800E03800
E03800E03800E038F8E039FCE039DCE039DCE019DCC019DCC019DCC0198CC0198CC01D8DC01D8D
C01D8DC01D05C00D05800F07800F07800E0380151C7F9B18>I<7F0FE07F9FE07F0FE00E07000F
0700070E00078E00039C0003DC0001F80001F80000F80000F00000700000F00000F80001FC0001
DC00039E00038E00070F000707000E07800E03801E03C07F07F0FF07F87F07F0151C7F9B18>I<
FE03F8FF07F8FE03F81C01C01E03C00E03800F0780070700070700038E00038E0001DC0001DC00
01DC0000F80000F80000700000700000700000700000700000700000700000700000700001FC00
03FE0001FC00151C7F9B18>I<3FFFE07FFFE07FFFE07001C07003C0700780700700000F00001E
00001C00003C0000780000700000F00001E00001C00003C0000780000700000F00001E00E01C00
E03C00E07800E07000E0FFFFE0FFFFE0FFFFE0131C7E9B18>I<FFF8FFF8FFF8E000E000E000E0
00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000FFF8FFF8FFF80D24779F18>I<600000F00000F00000F80000
7800007C00003C00003C00003E00001E00001F00000F00000F00000F800007800007C00003C000
03C00003E00001E00001F00000F00000F800007800007800007C00003C00003E00001E00001E00
001F00000F00000F8000078000078000030011247D9F18>I<FFF8FFF8FFF80038003800380038
003800380038003800380038003800380038003800380038003800380038003800380038003800
38003800380038003800380038FFF8FFF8FFF80D247F9F18>I<7FFFC0FFFFE0FFFFE07FFFC013
047E7F18>95 D<0FF0001FFC003FFE003C0F0018070000038000038000FF8007FF801FFF807F03
80780380E00380E00380E00380F00780780F803FFFF81FFDF807F0F815147E9318>97
D<7E0000FE00007E00000E00000E00000E00000E00000E00000E3E000EFF800FFFC00FC1E00F80
E00F00700E00700E00380E00380E00380E00380E00380E00380F00700F00700F80E00FC1E00FFF
C00EFF80063E00151C809B18>I<01FE0007FF001FFF803E0780380300700000700000E00000E0
0000E00000E00000E00000E000007000007001C03801C03E03C01FFF8007FF0001FC0012147D93
18>I<001F80003F80001F8000038000038000038000038000038003E3800FFB801FFF803C1F80
380F80700780700380E00380E00380E00380E00380E00380E00380700780700780380F803C1F80
1FFFF00FFBF803E3F0151C7E9B18>I<01F00007FC001FFE003E0F00380780700380700380E001
C0E001C0FFFFC0FFFFC0FFFFC0E000007000007001C03801C03E07C01FFF8007FF0001F8001214
7D9318>I<001F80007FC000FFE000E1E001C0C001C00001C00001C0007FFFC0FFFFC0FFFFC001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C0007FFF007FFF007FFF00131C7F9B18>I<01E1F007FFF80FFFF81E1E301C0E00380700380700
3807003807003807001C0E001E1E001FFC001FF80039E0003800001C00001FFE001FFFC03FFFE0
7801F0700070E00038E00038E00038E000387800F07E03F01FFFC00FFF8001FC00151F7F9318>
I<7E0000FE00007E00000E00000E00000E00000E00000E00000E3E000EFF800FFFC00FC1C00F80
E00F00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E07FC7
FCFFE7FE7FC7FC171C809B18>I<038007C007C007C0038000000000000000007FC0FFC07FC001
C001C001C001C001C001C001C001C001C001C001C001C001C001C0FFFFFFFFFFFF101D7C9C18>
I<0038007C007C007C003800000000000000000FFC0FFC0FFC001C001C001C001C001C001C001C
001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C6038F078FFF07FE03F
800E277E9C18>I<7E0000FE00007E00000E00000E00000E00000E00000E00000E3FF00E3FF00E
3FF00E07800E0F000E1E000E3C000E78000EF0000FF8000FFC000F9C000F0E000E0F000E07000E
03800E03C07FC7F8FFC7F87FC7F8151C7F9B18>I<FFC000FFC000FFC00001C00001C00001C000
01C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C000
01C00001C00001C00001C00001C00001C000FFFF80FFFF80FFFF80111C7D9B18>I<F9C1C0FFF7
F0FFFFF03E3E383C3C383C3C383838383838383838383838383838383838383838383838383838
38383838383838FE3E3EFE7E7EFE3E3E1714809318>I<7E3E00FEFF807FFFC00FC1C00F80E00F
00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E07FC7FCFF
E7FE7FC7FC1714809318>I<01F0000FFE001FFF003E0F803803807001C07001C0E000E0E000E0
E000E0E000E0E000E0F001E07001C07803C03C07803E0F801FFF000FFE0001F00013147E9318>
I<7E3E00FEFF807FFFC00FC1E00F80E00F00700E00700E00380E00380E00380E00380E00380E00
380F00700F00700F80E00FC1E00FFFC00EFF800E3E000E00000E00000E00000E00000E00000E00
000E00007FC000FFE0007FC000151E809318>I<01F38007FB801FFF803E1F80380F8070078070
0780E00380E00380E00380E00380E00380E00380700780700780380F803C1F801FFF800FFB8003
E380000380000380000380000380000380000380000380001FF0003FF8001FF0151E7E9318>I<
FF0FC0FF3FE0FF7FF007F0F007E06007C000078000078000070000070000070000070000070000
070000070000070000070000FFFC00FFFE00FFFC0014147E9318>I<07F7003FFF007FFF00780F
00E00700E00700E007007C00007FE0001FFC0003FE00001F00600780E00380E00380F00380F80F
00FFFF00FFFC00E7F00011147D9318>I<0180000380000380000380000380007FFFC0FFFFC0FF
FFC00380000380000380000380000380000380000380000380000380000380400380E00380E003
80E001C1C001FFC000FF80003E0013197F9818>I<7E07E0FE0FE07E07E00E00E00E00E00E00E0
0E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E01E00F03E007FFFC03FFFE
01FCFC1714809318>I<7F8FF0FF8FF87F8FF01C01C00E03800E03800E03800707000707000707
00078F00038E00038E00038E0001DC0001DC0001DC0000F80000F80000700015147F9318>I<FF
07F8FF8FF8FF07F83800E03800E03800E03800E01C01C01C71C01CF9C01CF9C01CD9C01DDDC00D
DD800DDD800DDD800D8D800F8F800F8F8007070015147F9318>I<7F8FF07F9FF07F8FF00F0700
078E00039E0001DC0001F80000F80000700000F00000F80001DC00039E00038E000707000E0780
7F8FF0FF8FF87F8FF015147F9318>I<7F8FF0FF8FF87F8FF00E01C00E03800E03800703800707
00070700038700038700038E0001CE0001CE0001CC0000CC0000DC000078000078000078000070
0000700000700000F00000E00079E0007BC0007F80003F00001E0000151E7F9318>I<3FFFF07F
FFF07FFFF07001E07003C0700780000F00001E00003C0000F80001F00003C0000780000F00701E
00703C0070780070FFFFF0FFFFF0FFFFF014147F9318>I<0007E0001FE0007FE000780000E000
00E00000E00000E00000E00000E00000E00000E00000E00000E00000E00001E0007FC000FF8000
FF80007FC00001E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E000
00E000007800007FE0001FE00007E013247E9F18>I<7C0000FF0000FFC00003C00000E00000E0
0000E00000E00000E00000E00000E00000E00000E00000E00000E00000F000007FC0003FE0003F
E0007FC000F00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0
0003C000FFC000FF00007C000013247E9F18>125 D E /Fc 130[22 1[22
1[22 22 1[22 22 22 22 22 1[22 22 22 22 22 22 1[22 22 22 22
22 22 22 22 22 1[22 5[22 2[22 1[22 22 22 1[22 22 22 22 2[22
2[22 1[22 22 22 1[22 22 1[22 22 1[22 10[22 22 22 22 22 2[22
22 4[22 35[{}52 37.500000 /Courier rf /Fd 134[23 4[13 1[15
1[23 23 23 35 13 6[20 3[20 97[{.167 SlantFont}10 45.624989
/Times-Roman rf /Fe 130[27 1[27 27 27 27 27 27 27 27 27 27
1[27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 1[27 1[27
1[27 1[27 27 1[27 27 27 27 27 1[27 27 27 27 27 27 1[27 27 27
27 27 27 27 27 27 1[27 27 27 27 27 27 27 1[27 27 2[27 27 27
27 27 27 27 27 27 27 27 27 27 27 27 1[27 27 27 33[{}79 45.624989
/Courier rf /Ff 81[30 51[25 28 26 42 28 30 16 21 20 1[30 27
29 44 14 28 12 14 29 28 17 24 30 22 28 25 10[36 1[31 26 33
2[39 41 47 30 5[28 30 2[30 15[25 25 2[12 1[12 44[{}41 50.000000
/Palatino-Roman rf /Fg 81[23 51[23 23 23 33 23 25 13 23 15
1[25 25 25 38 10 23 1[10 25 25 13 25 25 23 25 25 6[28 30 30
43 1[33 28 30 33 1[30 35 33 38 25 2[13 33 35 28 30 33 33 30
30 46 4[13 13 4[25 1[25 1[25 25 13 13 15 13 27 18 15 15 3[25
36[{}63 45.624989 /Helvetica rf /Fh 39 124 df<007E0001C1800301800703C00E03C00E
01800E00000E00000E00000E00000E0000FFFFC00E01C00E01C00E01C00E01C00E01C00E01C00E
01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C07F87F8151D809C17>12
D<6060F0F0F8F86868080808080808101010102020404080800D0C7F9C15>34
D<0300030003000300C30CE31C73381FE0078007801FE07338E31CC30C03000300030003000E12
7D9E15>42 D<60F0F0701010101020204080040C7C830C>44 D<60F0F06004047C830C>46
D<00010003000600060006000C000C000C0018001800180030003000300060006000C000C000C0
018001800180030003000300060006000C000C000C001800180018003000300030006000600060
00C000C00010297E9E15>I<03C00C301818300C300C700E60066006E007E007E007E007E007E0
07E007E007E007E007E007E007E00760066006700E300C300C18180C3007E0101D7E9B15>I<00
0600000006000000060000000F0000000F0000000F000000178000001780000037C0000023C000
0023C0000043E0000041E0000041E0000080F0000080F0000080F000010078000100780001FFF8
0002003C0002003C0002003C0004001E0004001E000C001F000C000F001E001F00FF00FFF01C1D
7F9C1F>65 D<FFFFC0000F0078000F003C000F001E000F000E000F000F000F000F000F000F000F
000F000F000E000F001E000F003C000F00F8000FFFF0000F003C000F001E000F000F000F000700
0F0007800F0007800F0007800F0007800F0007800F000F000F000F000F001E000F007800FFFFE0
00191C7F9B1D>I<FFFFFC0F003C0F000C0F00040F00040F00060F00020F00020F01020F01000F
01000F01000F03000FFF000F03000F01000F01000F01000F01010F00010F00020F00020F00020F
00060F00060F000C0F003CFFFFFC181C7E9B1C>69 D<FFF0FFF00F000F000F000F000F000F000F
000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000FFFFF00
0F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F
000F000F000F000F000F000F00FFF0FFF01C1C7F9B1F>72 D<FFF00F000F000F000F000F000F00
0F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F
00FFF00C1C7F9B0F>I<FF8000FF800F8000F8000F8000F8000BC00178000BC00178000BC00178
0009E002780009E002780008F004780008F004780008F004780008780878000878087800087808
7800083C107800083C107800083C107800081E207800081E207800081E207800080F407800080F
40780008078078000807807800080780780008030078001C03007800FF8307FF80211C7E9B26>
77 D<003F800000E0E0000380380007001C000E000E001C0007003C00078038000380780003C0
780003C0700001C0F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0F00001
E0700001C0780003C0780003C0380003803C0007801C0007000E000E0007001C000380380000E0
E000003F80001B1E7E9C20>79 D<FFFF00000F01E0000F0078000F003C000F001C000F001E000F
001E000F001E000F001E000F001C000F003C000F0078000F01E0000FFF00000F01E0000F007000
0F0078000F003C000F003C000F003C000F003C000F003C000F003C000F003C100F003C100F001C
100F001C10FFF00E20000003C01C1D7E9B1F>82 D<07E0801C1980300580300380600180E00180
E00080E00080E00080F00000F800007C00007FC0003FF8001FFE0007FF0000FF80000F800007C0
0003C00001C08001C08001C08001C0C00180C00180E00300D00200CC0C0083F800121E7E9C17>
I<08081010202040404040808080808080B0B0F8F8787830300D0C7A9C15>92
D<1FC000307000783800781C00301C00001C00001C0001FC000F1C00381C00701C00601C00E01C
40E01C40E01C40603C40304E801F870012127E9115>97 D<FC00001C00001C00001C00001C0000
1C00001C00001C00001C00001C00001C00001C7C001D87001E01801C00C01C00E01C00601C0070
1C00701C00701C00701C00701C00701C00601C00E01C00C01E018019070010FC00141D7F9C17>
I<03F80C0C181E301E700C6000E000E000E000E000E000E00060007002300218040C1803E00F12
7F9112>I<001F8000038000038000038000038000038000038000038000038000038000038003
F3800E0B80180780300380700380600380E00380E00380E00380E00380E00380E0038060038070
03803003801807800E1B8003E3F0141D7F9C17>I<07E00C301818300C700E6006E006FFFEE000
E000E000E00060007002300218040C1803E00F127F9112>I<00F8018C071E061E0E0C0E000E00
0E000E000E000E00FFE00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E007FE00F1D809C0D>I<00038007C4C01C78C0383880301800701C00701C00701C00701C00
3018003838001C700027C0002000002000003000003FF8001FFF001FFF802003806001C0C000C0
C000C0C000C06001803003001C0E0007F800121C7F9215>I<FC00001C00001C00001C00001C00
001C00001C00001C00001C00001C00001C00001C7C001C87001D03001E03801C03801C03801C03
801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380FF9FF0141D7F9C17
>I<18003C003C0018000000000000000000000000000000FC001C001C001C001C001C001C001C
001C001C001C001C001C001C001C001C001C00FF80091D7F9C0C>I<FC001C001C001C001C001C
001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C00FF80091D7F9C0C>108 D<FC7E07E0001C838838001D019018001E01E01C001C01
C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C
01C01C001C01C01C001C01C01C001C01C01C001C01C01C00FF8FF8FF8021127F9124>I<FC7C00
1C87001D03001E03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1C03801C03801C0380FF9FF014127F9117>I<03F0000E1C00180600300300700380600180E001
C0E001C0E001C0E001C0E001C0E001C06001807003803003001806000E1C0003F00012127F9115
>I<FC7C001D87001E01801C01C01C00E01C00E01C00701C00701C00701C00701C00701C00701C
00E01C00E01C01C01E01801D07001CFC001C00001C00001C00001C00001C00001C00001C0000FF
8000141A7F9117>I<FCE01D381E781E781C301C001C001C001C001C001C001C001C001C001C00
1C001C00FFC00D127F9110>114 D<1F9020704030C010C010E010F8007F803FE00FF000F88038
8018C018C018E010D0608FC00D127F9110>I<04000400040004000C000C001C003C00FFE01C00
1C001C001C001C001C001C001C001C001C101C101C101C101C100C100E2003C00C1A7F9910>I<
FC1F801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1C03801C07800C07800E1B8003E3F014127F9117>I<FF07E03C03801C01001C01000E02000E02
000F060007040007040003880003880003C80001D00001D00000E00000E00000E0000040001312
7F9116>I<FF3FC7E03C0703C01C0701801C0701001C0B01000E0B82000E0B82000E1182000711
C4000711C4000720C40003A0E80003A0E80003C0680001C0700001C0700001803000008020001B
127F911E>I<FF07E03C03801C01001C01000E02000E02000F0600070400070400038800038800
03C80001D00001D00000E00000E00000E000004000004000008000008000F08000F10000F30000
660000380000131A7F9116>121 D<FFFFF01401808B15>123 D E /Fi 3
104 df<03F0000FFC001FFE003FFF007FFF807FFF80FFFFC0FFFFC0FFFFC0FFFFC0FFFFC0FFFF
C07FFF807FFF803FFF001FFE000FFC0003F00012127E9317>15 D<000F0038006000E001C001C0
01C001C001C001C001C001C001C001C001C001C001C001C001C0038007001E00F8001E00070003
8001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C000E000600038000F
102D7DA117>102 D<F8001E000700038001C001C001C001C001C001C001C001C001C001C001C0
01C001C001C001C000E000600038000F0038006000E001C001C001C001C001C001C001C001C001
C001C001C001C001C001C001C0038007001E00F800102D7DA117>I E /Fj
51 123 df<000FF83F00007FFDFFC001F81FE3E003E03F87E007C03F87E00F803F07E00F803F03
C00F801F00000F801F00000F801F00000F801F00000F801F00000F801F0000FFFFFFFC00FFFFFF
FC000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F80
1F00000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F
801F00000F801F00000F801F00007FF0FFF0007FF0FFF00023237FA221>11
D<000FF000007FFC0001F80E0003E01F0007C03F000F803F000F803F000F801E000F800C000F80
00000F8000000F8000000F800000FFFFFF00FFFFFF000F801F000F801F000F801F000F801F000F
801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F00
0F801F000F801F000F801F000F801F007FF0FFE07FF0FFE01B237FA21F>I<00700000F8000070
00007000207020707070FC71F87E73F03F27E007AF0000F80000F80007AF003F27E07E73F0FC71
F870707020702000700000700000F80000700015167DA41C>42 D<03FC000FFF003C1FC07007E0
7C07F0FE03F0FE03F8FE03F8FE01F87C01F83803F80003F80003F00003F00007E00007C0000F80
001F00003E0000380000700000E01801C0180380180700180E00380FFFF01FFFF03FFFF07FFFF0
FFFFF0FFFFF015207D9F1C>50 D<000070000000007000000000F800000000F800000000F80000
0001FC00000001FC00000003FE00000003FE00000003FE000000067F000000067F0000000C7F80
00000C3F8000000C3F800000181FC00000181FC00000301FE00000300FE00000700FF000006007
F000006007F00000C007F80000FFFFF80001FFFFFC00018001FC00018001FC00030001FE000300
00FE00070000FF000600007F000600007F00FFE007FFF8FFE007FFF825227EA12A>65
D<FFFFFF8000FFFFFFF00007F001F80007F000FC0007F0007E0007F0007E0007F0007F0007F000
7F0007F0007F0007F0007F0007F0007F0007F0007E0007F000FE0007F000FC0007F003F80007FF
FFF00007FFFFF00007F001FC0007F0007E0007F0003F0007F0003F8007F0001F8007F0001FC007
F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0003F8007F0003F8007F0007F00
07F001FE00FFFFFFF800FFFFFFC00022227EA128>I<0003FE0080001FFF818000FF01E38001F8
003F8003E0001F8007C0000F800F800007801F800007803F000003803F000003807F000001807E
000001807E00000180FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000
FE00000000FE000000007E000000007E000001807F000001803F000001803F000003801F800003
000F8000030007C000060003F0000C0001F800380000FF00F000001FFFC0000003FE000021227D
A128>I<FFFFFF8000FFFFFFF00007F003FC0007F0007E0007F0003F0007F0001F8007F0000FC0
07F00007E007F00007E007F00007F007F00003F007F00003F007F00003F007F00003F807F00003
F807F00003F807F00003F807F00003F807F00003F807F00003F807F00003F807F00003F807F000
03F007F00003F007F00003F007F00007E007F00007E007F0000FC007F0001F8007F0003F0007F0
007E0007F003FC00FFFFFFF000FFFFFF800025227EA12B>I<FFFFFFFCFFFFFFFC07F000FC07F0
003C07F0001C07F0000C07F0000E07F0000E07F0000607F00C0607F00C0607F00C0607F00C0007
F01C0007F03C0007FFFC0007FFFC0007F03C0007F01C0007F00C0007F00C0007F00C0307F00C03
07F0000307F0000607F0000607F0000607F0000E07F0000E07F0001E07F0003E07F001FCFFFFFF
FCFFFFFFFC20227EA125>I<FFFFFFF8FFFFFFF807F001F807F0007807F0003807F0001807F000
1C07F0001C07F0000C07F0000C07F0180C07F0180C07F0180007F0180007F0380007F0780007FF
F80007FFF80007F0780007F0380007F0180007F0180007F0180007F0180007F0000007F0000007
F0000007F0000007F0000007F0000007F0000007F00000FFFFC000FFFFC0001E227EA123>I<00
03FE0040001FFFC0C0007F00F1C001F8003FC003F0000FC007C00007C00FC00003C01F800003C0
3F000001C03F000001C07F000000C07E000000C07E000000C0FE00000000FE00000000FE000000
00FE00000000FE00000000FE00000000FE00000000FE000FFFFC7E000FFFFC7F00001FC07F0000
1FC03F00001FC03F00001FC01F80001FC00FC0001FC007E0001FC003F0001FC001FC003FC0007F
80E7C0001FFFC3C00003FF00C026227DA12C>I<FFFF83FFFEFFFF83FFFE07F0001FC007F0001F
C007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F000
1FC007F0001FC007F0001FC007F0001FC007FFFFFFC007FFFFFFC007F0001FC007F0001FC007F0
001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007
F0001FC007F0001FC007F0001FC007F0001FC007F0001FC0FFFF83FFFEFFFF83FFFE27227EA12C
>I<FFFF80FFFF8007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F000FFFF80FFFF8011227EA115>I<01FFFF8001FF
FF800003F8000003F8000003F8000003F8000003F8000003F8000003F8000003F8000003F80000
03F8000003F8000003F8000003F8000003F8000003F8000003F8000003F8000003F8000003F800
0003F8000003F8000003F8001803F8007E03F800FF03F800FF03F800FF03F800FF03F0007E07E0
007C0FC0001FFF800007FC0000192280A11D>I<FFFFC000FFFFC00007F0000007F0000007F000
0007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0
000007F0000007F0000007F0000007F0000007F0000007F0000007F0001807F0001807F0001807
F0001807F0003807F0003807F0007007F0007007F000F007F001F007F007F0FFFFFFF0FFFFFFF0
1D227EA122>76 D<FFF000000FFFFFF800001FFF07F800001FE006FC000037E006FC000037E006
FC000037E0067E000067E0067E000067E0063F0000C7E0063F0000C7E0061F800187E0061F8001
87E0060FC00307E0060FC00307E0060FC00307E00607E00607E00607E00607E00603F00C07E006
03F00C07E00601F81807E00601F81807E00601F81807E00600FC3007E00600FC3007E006007E60
07E006007E6007E006003FC007E006003FC007E006001F8007E006001F8007E006001F8007E006
000F0007E0FFF00F00FFFFFFF00600FFFF30227EA135>I<FFF8001FFEFFFC001FFE07FC0000C0
07FE0000C006FF0000C0067F8000C0063FC000C0061FE000C0060FE000C0060FF000C00607F800
C00603FC00C00601FE00C00600FE00C00600FF00C006007F80C006003FC0C006001FE0C006000F
F0C0060007F0C0060007F8C0060003FCC0060001FEC0060000FFC00600007FC00600007FC00600
003FC00600001FC00600000FC006000007C006000003C006000003C0FFF00001C0FFF00000C027
227EA12C>I<0007FC0000003FFF800000FC07E00003F001F80007E000FC000FC0007E001F8000
3F001F80003F003F00001F803F00001F807F00001FC07E00000FC07E00000FC0FE00000FE0FE00
000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE07E
00000FC07F00001FC07F00001FC03F00001F803F80003F801F80003F000FC0007E0007E000FC00
03F001F80000FC07E000003FFF80000007FC000023227DA12A>I<FFFFFF00FFFFFFE007F007F0
07F001FC07F000FC07F0007E07F0007E07F0007F07F0007F07F0007F07F0007F07F0007F07F000
7E07F0007E07F000FC07F001FC07F007F007FFFFE007FFFF0007F0000007F0000007F0000007F0
000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F00000FF
FF8000FFFF800020227EA126>I<FFFFFE0000FFFFFFC00007F007F00007F001F80007F000FC00
07F0007E0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007E
0007F000FC0007F001F80007F007F00007FFFFC00007FFFF800007F00FE00007F007F00007F003
F80007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F0
01FC0007F001FC0607F000FE0607F000FF0CFFFF803FF8FFFF800FF027227EA12A>82
D<01FE0207FF861F01FE3C007E7C001E78000E78000EF80006F80006FC0006FC0000FF0000FFE0
007FFF007FFFC03FFFF01FFFF80FFFFC03FFFE003FFE0003FE00007F00003F00003FC0001FC000
1FC0001FE0001EE0001EF0003CFC003CFF00F8C7FFE080FF8018227DA11F>I<7FFFFFFF807FFF
FFFF807E03F80F807803F807807003F803806003F80180E003F801C0E003F801C0C003F800C0C0
03F800C0C003F800C0C003F800C00003F800000003F800000003F800000003F800000003F80000
0003F800000003F800000003F800000003F800000003F800000003F800000003F800000003F800
000003F800000003F800000003F800000003F800000003F800000003F800000003F8000001FFFF
F00001FFFFF00022227EA127>I<FFFF803FFCFFFF803FFC07F000018007F000018007F0000180
07F000018007F000018007F000018007F000018007F000018007F000018007F000018007F00001
8007F000018007F000018007F000018007F000018007F000018007F000018007F000018007F000
018007F000018007F000018007F000018007F000018007F000018003F000030003F800030001F8
00060000FC000E00007E001C00003F80F800000FFFE0000001FF000026227EA12B>I<FFFF000F
FEFFFF000FFE07F00000C007F00000C003F800018003F800018003FC00038001FC00030001FE00
030000FE00060000FF000600007F000C00007F000C00007F801C00003F801800003FC03800001F
C03000001FE03000000FE06000000FE060000007F0C0000007F0C0000007F9C0000003F9800000
03FD80000001FF00000001FF00000000FE00000000FE00000000FE000000007C000000007C0000
0000380000000038000027227FA12A>I<FFFF0FFFF00FFEFFFF0FFFF00FFE0FF000FF0000E007
F0007F0000C007F0007F0000C003F8003F80018003F8003F80018003FC003FC0018001FC003FC0
030001FC003FC0030001FE007FE0070000FE006FE0060000FE006FE00600007F00C7F00C00007F
00C7F00C00007F81C7F80C00003F8183F81800003F8183F81800003FC301FC3800001FC301FC30
00001FC301FE3000000FE600FE6000000FE600FE6000000FFE00FFE0000007FC007FC0000007FC
007FC0000003F8003F80000003F8003F80000003F8003F80000001F0001F00000001F0001F0000
0001F0001F00000000E0000E00000000E0000E000037227FA13A>I<7FFFC1FFF87FFFC1FFF803
FC000C0001FE00180001FE00380000FF003000007F806000007F80E000003FC1C000001FE18000
001FE30000000FF700000007FE00000003FC00000003FC00000001FE00000000FE00000000FF00
000000FF80000001FFC0000001BFC00000031FE00000070FF000000E0FF000000C07F800001803
FC00003803FC00007001FE00006000FF0000C000FF0001C0007F800180003FC0FFFC03FFFEFFFC
03FFFE27227FA12A>I<0FFC003FFF807E07C07E03E07E01E07E01F03C01F00001F00001F0003F
F003FDF01FC1F03F01F07E01F0FC01F0FC01F0FC01F0FC01F07E02F07E0CF81FF87F07E03F1816
7E951B>97 D<FF000000FF0000001F0000001F0000001F0000001F0000001F0000001F0000001F
0000001F0000001F0000001F0000001F0000001F0FE0001F3FF8001FE07C001F803E001F001F00
1F000F801F000F801F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000F
C01F000F801F001F801F801F001FC03E001EE07C001C3FF800180FC0001A237EA21F>I<00FF80
07FFE00F83F01F03F03E03F07E03F07C01E07C0000FC0000FC0000FC0000FC0000FC0000FC0000
7C00007E00007E00003E00181F00300FC06007FFC000FF0015167E9519>I<0001FE000001FE00
00003E0000003E0000003E0000003E0000003E0000003E0000003E0000003E0000003E0000003E
0000003E0001FC3E0007FFBE000F81FE001F007E003E003E007E003E007C003E00FC003E00FC00
3E00FC003E00FC003E00FC003E00FC003E00FC003E00FC003E007C003E007C003E003E007E001F
00FE000F83BE0007FF3FC001FC3FC01A237EA21F>I<00FE0007FF800F87C01E01E03E01F07C00
F07C00F8FC00F8FC00F8FFFFF8FFFFF8FC0000FC0000FC00007C00007C00007E00003E00181F00
300FC07003FFC000FF0015167E951A>I<001FC0007FE000F1F001E3F003E3F007C3F007C1E007
C00007C00007C00007C00007C00007C000FFFE00FFFE0007C00007C00007C00007C00007C00007
C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C0003F
FC003FFC00142380A211>I<01FE0F0007FFBF800F87C7801F03E7801E01E0003E01F0003E01F0
003E01F0003E01F0003E01F0001E01E0001F03E0000F87C0000FFF800009FE0000180000001800
00001C0000001FFFE0000FFFF80007FFFE001FFFFF003C003F0078000F80F0000780F0000780F0
000780F000078078000F003C001E001F007C000FFFF80001FFC00019217F951C>I<FF000000FF
0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F000000
1F0000001F0000001F07E0001F1FF8001F307C001F403C001F803E001F803E001F003E001F003E
001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F00
3E001F003E001F003E00FFE1FFC0FFE1FFC01A237EA21F>I<1C003E007F007F007F003E001C00
0000000000000000000000000000FF00FF001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F00FFE0FFE00B247EA310>I<0038007C00FE00FE00FE007C00
38000000000000000000000000000003FE03FE003E003E003E003E003E003E003E003E003E003E
003E003E003E003E003E003E003E003E003E003E003E003E003E783EFC3EFC3CFC7C78F87FE01F
800F2E83A311>I<FF000000FF0000001F0000001F0000001F0000001F0000001F0000001F0000
001F0000001F0000001F0000001F0000001F0000001F00FF801F00FF801F0038001F0060001F01
C0001F0380001F0700001F0E00001F1C00001F7E00001FFF00001FCF00001F0F80001F07C0001F
03E0001F01E0001F01F0001F00F8001F007C001F003C00FFE0FFC0FFE0FFC01A237EA21E>I<FF
00FF001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F00FFE0FFE00B237EA210>I<FF07
F007F000FF1FFC1FFC001F303E303E001F403E403E001F801F801F001F801F801F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
00FFE0FFE0FFE0FFE0FFE0FFE02B167E9530>I<FF07E000FF1FF8001F307C001F403C001F803E
001F803E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F00
3E001F003E001F003E001F003E001F003E001F003E00FFE1FFC0FFE1FFC01A167E951F>I<00FE
0007FFC00F83E01E00F03E00F87C007C7C007C7C007CFC007EFC007EFC007EFC007EFC007EFC00
7EFC007E7C007C7C007C3E00F81F01F00F83E007FFC000FE0017167E951C>I<FF0FE000FF3FF8
001FE07C001F803E001F001F001F001F801F001F801F000FC01F000FC01F000FC01F000FC01F00
0FC01F000FC01F000FC01F000FC01F001F801F001F801F803F001FC03E001FE0FC001F3FF8001F
0FC0001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F000000FFE00000
FFE000001A207E951F>I<FE1F00FE3FC01E67E01EC7E01E87E01E87E01F83C01F00001F00001F
00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F0000FFF000FFF00013
167E9517>114 D<0FF3003FFF00781F00600700E00300E00300F00300FC00007FE0007FF8003F
FE000FFF0001FF00000F80C00780C00380E00380E00380F00700FC0E00EFFC00C7F00011167E95
16>I<0180000180000180000180000380000380000780000780000F80003F8000FFFF00FFFF00
0F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F81800F8180
0F81800F81800F81800F830007C30003FE0000F80011207F9F16>I<FF01FE00FF01FE001F003E
001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F00
3E001F003E001F003E001F003E001F003E001F007E001F00FE000F81BE0007FF3FC001FC3FC01A
167E951F>I<FFE01FE0FFE01FE01F8007000F8006000FC00E0007C00C0007E00C0003E0180003
E0180001F0300001F0300000F8600000F86000007CC000007CC000007FC000003F8000003F8000
001F0000001F0000000E0000000E00001B167F951E>I<FFE3FF07F8FFE3FF07F81F007800C01F
807C01C00F807C01800F807C018007C07E030007C0DE030007C0DE070003E1DF060003E18F0600
01F18F8C0001F3078C0001F3078C0000FF07D80000FE03D80000FE03F800007C01F000007C01F0
00003C01E000003800E000003800E00025167F9528>I<FFE07FC0FFE07FC00F801C0007C03800
03E0700003F0600001F8C00000F98000007F8000003F0000001F0000001F8000003FC0000037C0
000063E00000C1F00001C0F8000380FC0007007E000E003E00FF80FFE0FF80FFE01B167F951E>
I<FFE01FE0FFE01FE01F8007000F8006000FC00E0007C00C0007E00C0003E0180003E0180001F0
300001F0300000F8600000F86000007CC000007CC000007FC000003F8000003F8000001F000000
1F0000000E0000000E0000000C0000000C00000018000078180000FC380000FC300000FC600000
69C000007F8000001F0000001B207F951E>I<7FFFF07FFFF07C03E07007C0600FC0E01F80C01F
00C03E00C07E0000FC0000F80001F00003F03007E03007C0300F80701F80703F00603E00E07C03
E0FFFFE0FFFFE014167E9519>I E /Fk 44 122 df<0007E0001C1000703800E07801C07801C0
3001C00001C0000380000380000380003FFFF00380F00380700700E00700E00700E00700E00700
E00700E00E01C00E01C00E01C00E01C00E01C00E01C01C03801C03C0FF8FF0151D7F9C17>12
D<00C000C000C000806083708F399C0FF003C003C00D603938E31CC30C03000200060006001012
7A9E15>42 D<0000200000003000000070000000F0000000F0000001F0000001F8000002780000
02780000047800000478000008780000083C0000103C0000103C0000203C0000203C0000403E00
00401E0000FFFE0000801E0001001E0001001F0002000F0002000F0004000F000C000F001E000F
80FF807FF01C1D7F9C1F>65 D<07FFFE0000F8078000F001C000F001E000F000E000F000F000F0
00F001E000E001E001E001E001C001E003C001E0078001E01E0003FFFC0003C00F0003C0078003
C003C003C003C003C003C0078003C0078003C0078003C0078003C00780078007800F000F001E00
0F003C00FFFFE0001C1C7F9B1D>I<0007F010001C0C300070026000C001E0038000E0070000E0
0E0000600E0000601C0000403C00004038000040780000007800000078000000F0000000F00000
00F0000000F0000000F0000000F0000080F0000100700001007000010038000200380004001C00
04000C001800060020000380C000007F00001C1E7C9C1E>I<0FFFFC0000F8078000F001C000F0
00E000F0007000F0007000F0007801E0003801E0003801E0003801E0003801E0003C01E0003803
C0003803C0007803C0007803C0007803C0007003C000F0078000E0078000E0078001C007800380
0780078007800E000F001C000F007000FFFFC0001E1C7E9B20>I<07FFFFE000F801E000F000E0
00F0004000F0004000F0004000F0004001E0004001E0204001E0200001E0200001E0600001E0E0
0003FFC00003C0C00003C0400003C0400003C0400003C040800780008007800080078001000780
010007800300078006000F000E000F003E00FFFFFC001B1C7E9B1C>I<07FFFFC000F803C000F0
01C000F0008000F0008000F0008000F0008001E0008001E0208001E0200001E0200001E0600001
E0E00003FFC00003C0C00003C0400003C0400003C0400003C04000078000000780000007800000
0780000007800000078000000F0000000F800000FFF800001A1C7E9B1B>I<07FF87FF8000F800
F80000F000F00000F000F00000F000F00000F000F00000F000F00001E001E00001E001E00001E0
01E00001E001E00001E001E00001E001E00003FFFFC00003C003C00003C003C00003C003C00003
C003C00003C003C000078007800007800780000780078000078007800007800780000780078000
0F000F00000F800F8000FFF0FFF000211C7F9B1F>72 D<07FF00F800F000F000F000F000F001E0
01E001E001E001E001E003C003C003C003C003C003C00780078007800780078007800F000F80FF
F0101C7F9B0F>I<07FFC000F80000F00000F00000F00000F00000F00001E00001E00001E00001
E00001E00001E00003C00003C00003C00003C00003C00003C00407800407800407800407800807
80080780180F00380F00F0FFFFF0161C7E9B1A>76 D<07F80007FC00F8000FC000BC000F8000BC
00178000BC00178000BC00278000BC002780011E004F00011E004F00011E008F00011E008F0001
1E010F00010F010F00020F021E00020F021E00020F041E00020F041E000207881E000207901E00
0407903C000407A03C000407A03C000407C03C000403C03C000403803C000C038078001E03007C
00FF8307FF80261C7E9B26>I<07F800FF8000F8003C0000BC00180000BC001000009E00100000
9F001000008F001000010F80200001078020000107C020000103C020000103E020000101E02000
0200F040000200F040000200784000020078400002003C400002003C400004001E800004001F80
0004000F800004000F8000040007800004000780000C000300001E00010000FF80010000211C7F
9B1F>I<0007F00000381C0000E00E0001C0030003800380070001C00E0001C01E0001E01C0000
E03C0000E0380000E0780000F0780000F0780000F0F00001E0F00001E0F00001E0F00001E0F000
03C0F00003C0F00003C0700007807000070078000F0038001E003C001C001C0038000E00E00003
83800000FE00001C1E7C9C20>I<07FFFC0000F80F0000F0038000F003C000F001C000F001C000
F001C001E003C001E003C001E003C001E0038001E0070001E00E0003C03C0003FFE00003C00000
03C0000003C0000003C000000780000007800000078000000780000007800000078000000F0000
000F800000FFF000001A1C7E9B1C>I<0FFFF80000F80E0000F0078000F003C000F001C000F001
E000F001E001E003C001E003C001E0038001E0070001E00E0001E03C0003FFE00003C0780003C0
1C0003C01E0003C00E0003C00F0007801E0007801E0007801E0007801E0007801E0007801E080F
001E100F801E10FFF00E20000003C01D1D7E9B1F>82 D<003F0400C0CC0180380300380600180E
00180E00180E00181E00101E00001F00000F80000FF80007FF0003FF8001FFC0003FE00003E000
01E00000E00000E04000E04000E04000E04000C06001C0E00180F00300CC0E0083F800161E7E9C
17>I<1FFFFFF03C07C0F03007803020078020600780204007802040078020400F0020800F0020
000F0000000F0000000F0000000F0000001E0000001E0000001E0000001E0000001E0000001E00
00003C0000003C0000003C0000003C0000003C0000003C000000780000007C00001FFFE0001C1C
7C9B1E>I<FFE1FFC0FF801F003E003E000F001E0018000F001E0018000F001E0010000F001E00
30000F001E0020000F003E0060000F802F00400007804F00C00007804F00800007808F01800007
808F01000007810F01000007C10782000003C20782000003C20784000003C60784000003C40788
000003CC0788000003C807D0000001F803D0000001F003E0000001F003E0000001E003C0000001
E003C0000001C00380000000C001800000008001000000291D7B9B2B>87
D<07FF03FE00FC01F0007800C0007C0080003C0100003E0200001E0400001F0C00000F0800000F
90000007A0000007C0000003C0000003E0000001E0000003F0000004F0000008F0000010F80000
30780000607C0000403C0000803E0001001E0002001F0006000F001F001F80FF807FF01F1C7F9B
1F>I<07F0001C18001E0C001C0E00180E00000E00000E0001FE000F0E001C1C00301C00701C00
E01C40E01C40E03C40E05C80709D803F0E0012127D9115>97 D<3F00000F00000E00000E00000E
00000E00000E00000E00001C00001C00001C00001C7C001D87001E01803C01803801C03800C038
00E03800E03800E07001C07001C07001C0700380700300700600F00C00CC380083E000131D7C9C
17>I<00FE000307000E07801C0700380600380000700000700000700000E00000E00000E00000
6000007002007004003008001C300007C00011127E9112>I<0001F80000780000700000700000
700000700000700000700000E00000E00000E000F8E00386E00601E00C01C01801C03801C07001
C07001C07001C0E00380E00380E00380600380700380300780300F001C378007C7E0151D7E9C17
>I<01F8070C0C0618073803300370037FFF7000E000E000E00060006002700430081C3007C010
127E9112>I<000F800039C00061C000E3C001C18001C00001C00001C000038000038000038000
3FF8000380000380000700000700000700000700000700000700000E00000E00000E00000E0000
0E00000E00001C00001E0000FFC000121D7F9C0D>I<000038007CCC01871C0303080703800E03
800E03800E03800E03800E0700060600070C0009F0000800001800001800001FFE000FFF800FFF
C03001C06000C06000E0C000C0C000C0600180200300180E0007F000161C809215>I<07E00001
E00001C00001C00001C00001C00001C00001C000038000038000038000038F8003B0C003C0E007
80E00780E00700E00700E00700E00700E00E01C00E01C00E01C00E01C00E01C00E01C01C03801E
03C0FF9FF0141D7F9C17>I<00C001C001C0018000000000000000000000000000001F80078003
800700070007000700070007000E000E000E000E000E000E001C001E00FF800A1D7F9C0C>I<00
030007000700060000000000000000000000000000007E001E000E001C001C001C001C001C001C
00380038003800380038003800700070007000700070007060E0F0E0F1C063803E001025849C0D
>I<07E00001E00001C00001C00001C00001C00001C00001C0000380000380000380000381FC03
80E00380C007010007020007080007100007300007F8000F38000E3C000E1C000E1E000E0E000E
0F001C07001C0F80FF9FE0161D7F9C16>I<07E001E001C001C001C001C001C001C00380038003
800380038003800700070007000700070007000E000E000E000E000E000E001C001E00FF800B1D
7F9C0C>I<1F8FC0FC00079061060003E076070007807807000780780700070070070007007007
00070070070007007007000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E0
0E001C01C01C001E01E01E00FF8FF8FF8021127F9124>I<1F8F8007B0C003C0E00780E00780E0
0700E00700E00700E00700E00E01C00E01C00E01C00E01C00E01C00E01C01C03801E03C0FF9FF0
14127F9117>I<00FC000307000E01801C01C03800C03000C07000E07000E07000E0E001C0E001
C0E001C0600180600380700700380E001C180007E00013127E9115>I<0FC7C003D87001E03803
C01803801C03800C03800E03800E03800E07001C07001C07001C0700380700300700600F00C00E
C3800E3E000E00000E00000E00001C00001C00001C00001C0000FF8000171A809117>I<1F9C07
EE03CF078E078C07000700070007000E000E000E000E000E000E001C001E00FFC010127F9110>
114 D<03F20C0E18061004300438043E001FE00FF007F8003C401C400C400C6018E010D0608FC0
0F127F9110>I<020002000200060006000C001C003C00FFE01C001C0038003800380038003800
3800700070407040704070407080708031001E000B1A7C9910>I<FC1F803C07801C0380380700
380700380700380700380700380700700E00700E00700E00700E00701E00701E00703C00305E00
1F9F8011127C9117>I<FF07E03C03803C03001C02001C02001C04001C08000E08000E10000E10
000E20000F200007400007C00007800007000003000002000013127C9116>I<FF3FC7E03C0F03
80380E0100380E03003C1F02001C1706001C3704001C270C001C6308001C4318001EC390000E83
B0000F83A0000F03E0000F01C0000E01C0000E018000040180001B127C911E>I<1FE1FC0781E0
03808003C10001C20000E60000EC00007800007000003800007C00009C00011E00020E00040700
0C07003C0780FE1FF016127F9116>I<0FF07E03C03803C03001C02001C02001C04001C08000E0
8000E10000E10000E20000F200007400007C000078000070000030000020000020000040000040
00708000F10000F30000E60000780000171A809116>I E /Fl 81[28 51[22
25 25 36 25 28 17 19 22 1[28 25 28 41 14 28 1[14 28 25 17 22
28 22 28 25 7[36 36 1[36 36 33 28 36 1[30 39 36 47 33 39 1[19
39 39 30 33 36 36 33 36 6[17 25 25 25 25 25 25 25 25 25 25
14 12 17 12 44[{}62 50.000000 /Times-Bold rf /Fm 78[23 2[25
51[20 23 23 33 23 25 15 18 20 1[25 23 25 38 13 25 15 13 25
23 15 20 25 20 25 23 8[33 45 33 33 30 25 33 1[28 35 33 43 30
35 23 18 35 35 28 30 33 33 30 33 7[23 23 23 23 23 23 23 23
23 23 1[11 15 11 44[{}63 45.624989 /Times-Bold rf /Fn 81[33
52[30 30 43 30 33 20 23 27 1[33 30 33 50 17 33 20 17 33 30
20 27 33 27 33 30 8[43 2[43 40 33 43 1[37 47 43 56 40 47 1[23
3[40 43 43 40 43 7[30 30 30 30 30 30 30 30 30 30 2[20 45[{}53
59.999973 /Times-Bold rf /Fo 134[19 1[27 19 19 10 15 12 1[19
19 19 29 10 19 1[10 19 2[17 19 17 19 17 11[27 23 21 25 1[21
1[27 33 3[12 27 27 21 1[27 25 25 27 7[19 19 19 19 19 19 19
19 19 19 1[9 12 9 44[{}48 37.500000 /Times-Roman rf /Fp 1 4
df<0C000C00CCC0EDC07F800C007F80EDC0CCC00C000C000A0B7D8B10>3
D E /Fq 81[23 51[18 20 20 30 20 23 13 18 18 1[23 23 23 33 13
20 13 13 23 23 13 20 23 20 23 23 8[28 38 28 33 25 23 28 1[28
33 30 38 25 30 20 15 33 33 28 28 33 30 28 28 42 23 4[15 6[23
23 23 23 13 11 15 11 1[23 15 15 1[35 38[{}64 45.624989 /Times-Italic
rf /Fr 47[45 21[20 8[23 1[25 25 3[20 47[20 23 23 33 23 23 13
18 15 23 23 23 23 35 13 23 13 13 23 23 15 20 23 20 23 20 15
2[15 1[15 28 33 33 43 33 33 28 25 30 1[25 33 33 40 28 33 18
15 33 33 25 28 33 30 30 33 42 1[26 26 1[13 13 23 23 23 23 23
23 23 23 23 23 13 11 15 11 26 23 15 15 15 35 38 1[23 19 15
33[{}89 45.624989 /Times-Roman rf /Fs 139[17 23 20 14[27 30
27 31[43 65[{}7 59.999973 /Times-Roman rf /Ft 1 4 df<020002000200C218F2783AE0
0F800F803AE0F278C2180200020002000D0E7E8E12>3 D E /Fu 133[22
2[36 4[17 3[25 39 14 2[14 3[22 25 22 25 22 17[36 1[44 1[36
1[17 36 1[28 30 36 10[25 5[25 1[25 2[12 1[12 44[{}25 50.000000
/Times-Roman rf /Fv 138[36 1[28 24 2[36 36 56 20 2[20 1[36
1[32 3[32 10[52 5[40 2[64 1[52 23[36 36 3[18 24 3[24 24 24
39[{}22 72.000000 /Times-Roman rf /Fw 135[32 120[{}1 72.000000
/Times-Italic rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300
TeXDict begin

%%EndSetup
%%Page: 1 1
0 bop 517 306 a Fw(x)p Fv(-Kernel)18 b(Programmer)s(')l(s)e(Manual)788
398 y(\(V)-8 b(ersion)17 b(3.2\))781 582 y Fu(Edwin)12 b(F)l(.)h(Menze)g(III)
794 640 y(Hilarie)f(K.)g(Orman)1156 622 y Ft(\003)792 741 y
Fu(December)g(1,)h(1993)874 965 y Fs(Abstract)114 1072 y Fr(This)18
b(report)h(describes)g(how)g(to)g(implement)g(protocols)f(in)h(the)g
Fq(x)p Fr(-kernel.)42 b(It)19 b(gives)g(the)g Fq(x)p Fr(-kernel')m(s)114
1128 y(programming)9 b(interface,)h(describes)f(how)g(to)g(con\256gure)g(an)g
Fq(x)p Fr(-kernel)h(that)f(contains)f(a)i(certain)f(collection)114
1184 y(of)16 b(protocols,)g(and)f(demonstrates)g(how)h(to)f(run)h(and)g
(debug)f(an)h Fq(x)p Fr(-kernel.)31 b(The)16 b Fq(x)p Fr(-kernel)g(can)h(be)f
(run)114 1241 y(in)d(one)h(of)g(two)g(environments:)20 b(as)14
b(a)h(user)f(program)g(on)g(a)g(Sun)g(SparcStation)g(running)e(SunOS4.1,)j
(or)114 1297 y(as)g(a)h(task)f(on)h(a)g(Mach3.0)g(system)f(\(some)h
(platforms\).)29 b(Protocols)14 b(can)i(be)g(moved)g(between)f(the)g(two)114
1354 y(environments)10 b(without)g(modi\256cation.)17 b(This)11
b(document)h(assumes)f(that)g(the)h(reader)g(is)g(already)f(familiar)114
1410 y(with)f(the)h Fq(x)p Fr(-kernel')m(s)h(object-oriented)d
(infrastructure)h(for)i(implementing)e(protocols.)p 0 2494
780 2 v 49 2521 a Fp(\003)67 2537 y Fo(This)j(work)f(supported)g(in)h(part)g
(by)f(National)h(Science)e(Foundation)g(Grants)h(CCR-8811423,)h(IRI-9015407,)
g(and)f(CCR-9102040,)g(Sun)0 2583 y(Microsystems)h(Inc.,)k(Hewlett-Packard)c
(Company)n(,)h(DARP)m(A)g(Contract)h(DABT63-91-C-0030,)f(and)g(NCSC)g
(University)g(Research)f(Grant)0 2628 y(MDA904-92-C-515)964
2753 y Fr(1)p eop
%%Page: 2 2
1 bop 0 124 a Fn(Contents)0 228 y Fm(1)45 b(Intr)o(oduction)1613
b(9)68 284 y Fr(1.1)48 b(Acknowledgements)21 b Fq(.)i(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)64 b Fr(9)68
340 y(1.2)48 b(Our)11 b(Address)k Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)64
b Fr(9)68 397 y(1.3)48 b(Copyright)9 b(Notice)33 b Fq(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(10)0 499 y Fm(2)j(Uniform)11 b(Pr)o(otocol)g(Interface)1308
b(11)68 555 y Fr(2.1)48 b(T)m(ype)10 b(De\256nitions)h Fq(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(11)173 612 y(2.1.1)54 b(XObj)35 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(11)173 668 y(2.1.2)54 b(Enable)11 b(Objects)29 b Fq(.)23
b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(12)173 725 y(2.1.3)54 b(Return)11 b(V)-5 b(alues)16 b
Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(12)173 781 y(2.1.4)54 b(Function)10 b(T)m(ypes)25
b Fq(.)e(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(12)68 838 y(2.2)48 b(Protocol-Protocol)9 b(Operations)19
b Fq(.)k(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(12)173 894 y(2.2.1)54 b(xOpen)15 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(13)173 950 y(2.2.2)54 b(xOpenEnable)24 b Fq(.)f(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(13)173
1007 y(2.2.3)54 b(xOpenDisable)11 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(13)173 1063
y(2.2.4)54 b(xOpenDisableAll)20 b Fq(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(13)173 1120 y(2.2.5)54 b(xOpenDone)18
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(14)173 1176 y(2.2.6)54 b(xPush)25 b Fq(.)e(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(14)173 1233 y(2.2.7)54 b(xCall)38 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(14)173 1289 y(2.2.8)54 b(xPop)43 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(14)173 1346 y(2.2.9)54 b(xCallPop)35 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(15)173 1402 y(2.2.10)31 b(xCloseDone)13 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(15)173
1459 y(2.2.11)31 b(xClose)44 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(15)173
1515 y(2.2.12)31 b(xControl)42 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(15)173 1571
y(2.2.13)31 b(xDemux)14 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(16)173 1628
y(2.2.14)31 b(xCallDemux)40 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(16)173 1684 y(2.2.15)31
b(xDuplicate)38 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(16)173 1741 y(2.2.16)31
b(xShutDown)20 b Fq(.)j(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(16)68 1797 y(2.3)48 b(Graph)11
b(Manipulation)e(Operations)40 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(16)173 1854 y(2.3.1)54 b(xCreateSessn)28
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(17)173 1910 y(2.3.2)54 b(xCreateProtl)43 b Fq(.)23
b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(17)173 1967 y(2.3.3)54 b(xDestroy)37 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(17)173 2023 y(2.3.4)54 b(xGetProtlByName)36 b Fq(.)23 b(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(17)173 2080
y(2.3.5)54 b(xSetDown)12 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(18)173 2136
y(2.3.6)54 b(xGetDown)38 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(18)173 2192 y(2.3.7)54
b(xSetUp)34 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(18)173 2249 y(2.3.8)54
b(xGetUp)26 b Fq(.)d(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(18)173 2305 y(2.3.9)54 b(xHlpT)m(ype)22
b Fq(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(18)68 2362 y(2.4)59 b(Utility)9 b(Operations)42
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(18)173 2418 y(2.4.1)54 b(xIsProtocol)28
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(18)173 2475 y(2.4.2)54 b(xIsSession)43 b
Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(18)173 2531 y(2.4.3)54 b(xIsXObj)13 b Fq(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(18)173 2588 y(2.4.4)54 b(xIsV)-5 b(alidXObj)18
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(19)964 2753 y(2)p eop
%%Page: 3 3
2 bop 173 124 a Fr(2.4.5)54 b(xPrintXObj)25 b Fq(.)e(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(19)68
181 y(2.5)48 b(Usage)11 b(Rules)18 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(19)173 237 y(2.5.1)54 b(Initializing)9 b(a)j(Protocol)f
Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(19)173 294 y(2.5.2)54 b(hlpRcv)11 b(and)g(hlpT)m(ype)39
b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(20)173 350 y(2.5.3)54 b(Protocol)11 b(Realms)39 b Fq(.)23
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(20)318 407 y(Asynchronous)9 b(Protocols)30 b Fq(.)24 b(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(20)318 463 y(Synchronous)10
b(Protocols)21 b Fq(.)i(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(20)318 519 y(Control)10 b(Protocols)18 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(20)173 576
y(2.5.4)54 b(Anchor)11 b(Protocols)20 b Fq(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(21)173 632 y(2.5.5)54
b(V)m(irtual)11 b(Protocols)30 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(21)68 689 y(2.6)48 b(Default)10
b(Operations)36 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(21)173 745 y(2.6.1)54 b(defaultOpenEnable)
22 b Fq(.)h(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(21)173 802 y(2.6.2)54 b(defaultOpenDisable)9 b Fq(.)23
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(21)173 858 y(2.6.3)54 b(defaultOpenDisableAll)18 b Fq(.)23
b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(22)173
915 y(2.6.4)54 b(defaultV)m(irtualOpenEnable)32 b Fq(.)23 b(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(22)173 971 y(2.6.5)54 b(defaultV)m
(irtualOpenDisable)19 b Fq(.)k(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(22)173 1028 y(2.6.6)54 b(Usage)23 b Fq(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(22)0 1129 y Fm(3)j(Participant)11 b(Library)1452 b(24)68
1186 y Fr(3.1)48 b(T)m(ype)10 b(De\256nitions)h Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(24)68 1242 y(3.2)48 b(Participant)10 b(List)g(Operations)29
b Fq(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(24)173 1299 y(3.2.1)54 b(partInit)36 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(24)173 1355 y(3.2.2)54 b(partPush)45 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(25)173 1412 y(3.2.3)54 b(partPop)29 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(25)173 1468 y(3.2.4)54 b(partStackT)m(opByteLen)43 b Fq(.)23
b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(25)173
1525 y(3.2.5)54 b(partLen)29 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(25)173
1581 y(3.2.6)54 b(partExternalize)28 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(25)173 1638
y(3.2.7)54 b(partInternalize)41 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(25)173 1694 y(3.2.8)54
b(partExtLen)33 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(25)68 1750 y(3.3)48 b(Relative)11
b(Protocol)f(Numbers)25 b Fq(.)e(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fr(26)68 1807 y(3.4)48 b(Usage)11 b(Rules)18
b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(26)0 1909 y Fm(4)j(Message)11
b(Library)1507 b(28)68 1965 y Fr(4.1)48 b(T)m(ype)10 b(De\256nitions)h
Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fr(28)68 2022 y(4.2)48 b(Constructor/Destructor)8
b(Operations)26 b Fq(.)d(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(28)173 2078 y(4.2.1)54 b(msgConstructEmpty)33 b Fq(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(28)173 2135 y(4.2.2)54 b(msgConstructBuf)o(fer)38 b Fq(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(29)173 2191 y(4.2.3)54 b(msgConstructAllocate)34 b Fq(.)23
b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(29)173
2248 y(4.2.4)54 b(msgConstructCopy)22 b Fq(.)h(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(29)173 2304 y(4.2.5)54 b(msgAssign)35
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(29)173 2360 y(4.2.6)54 b(msgConstructInplace)21
b Fq(.)i(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(29)173 2417 y(4.2.7)54 b(msgConstructAppend)10 b Fq(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(29)173 2473 y(4.2.8)54 b(msgDestroy)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(30)68
2530 y(4.3)48 b(Manipulation)9 b(Operations)29 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(30)173 2586
y(4.3.1)54 b(msgLen)24 b Fq(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(30)964 2753
y(3)p eop
%%Page: 4 4
3 bop 173 124 a Fr(4.3.2)54 b(msgT)n(runcate)37 b Fq(.)23 b(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(30)173 181 y(4.3.3)54 b(msgChopOf)o(f)36 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(30)173
237 y(4.3.4)54 b(msgJoin)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(30)173
294 y(4.3.5)54 b(msgPush)40 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(31)173 350
y(4.3.6)54 b(msgPop)24 b Fq(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(31)173 407 y(4.3.7)54
b(msgPopDiscard)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fr(31)173 463 y(4.3.8)54 b(msgAppend)18
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(31)173 519 y(4.3.9)54 b(msgSetAttr)31 b
Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(32)173 576 y(4.3.10)31 b(msgGetAttr)23 b Fq(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(32)173 632 y(4.3.11)31 b(msgForEach)43 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(32)68
689 y(4.4)48 b(Usage)11 b(Rules)18 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(32)0 791 y Fm(5)j(Event)12 b(Library)1558 b(33)68 847
y Fr(5.1)48 b(T)m(ype)10 b(De\256nitions)h Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(33)68 904 y(5.2)48 b(Operations)12 b Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(33)173 960 y(5.2.1)54 b(evSchedule)29 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(33)173
1017 y(5.2.2)54 b(evDetach)33 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(33)173 1073
y(5.2.3)54 b(evCancel)36 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(33)173 1129
y(5.2.4)54 b(evIsCancelled)15 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(34)173 1186 y(5.2.5)54
b(evDump)14 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(34)68 1242 y(5.3)48
b(Usage)11 b(Rules)18 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(34)173
1299 y(5.3.1)54 b(Repeating)11 b(Events)20 b Fq(.)j(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(34)173 1355
y(5.3.2)54 b(Cancellable)11 b(Events)24 b Fq(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(34)173 1412 y(5.3.3)54
b(Event)11 b(Granularity)h Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(35)0 1514 y Fm(6)j(Map)11 b(Library)1581
b(36)68 1570 y Fr(6.1)48 b(T)m(ype)10 b(De\256nitions)h Fq(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(36)68 1627 y(6.2)48 b(Operations)12 b Fq(.)23
b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fr(36)173 1683 y(6.2.1)54 b(mapCreate)43
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(36)173 1739 y(6.2.2)54 b(mapResolve)14 b
Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(36)173 1796 y(6.2.3)54 b(mapV)-5 b(arResolve)19
b Fq(.)k(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(37)173 1852 y(6.2.4)54 b(mapBind)38 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(37)173 1909 y(6.2.5)54 b(mapV)-5 b(arBind)43 b Fq(.)23 b(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(37)173 1965 y(6.2.6)54 b(mapRemoveBinding)32 b Fq(.)23 b(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(37)173 2022
y(6.2.7)54 b(mapUnbind)23 b Fq(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(37)173 2078 y(6.2.8)54
b(mapClose)23 b Fq(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(38)173 2135 y(6.2.9)54 b(mapForEach)41
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(38)68 2191 y(6.3)48 b(Usage)11 b(Rules)18 b
Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(38)173 2248 y(6.3.1)54 b(External)11
b(Keys)i Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fr(38)173 2304 y(6.3.2)54 b(Active)11 b(and)g(Passive)f(Maps)
19 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(38)0 2406 y Fm(7)j(Thr)o(ead)13 b(Library)1528 b(41)68
2462 y Fr(7.1)48 b(T)m(ype)10 b(De\256nitions)h Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(41)68 2519 y(7.2)48 b(Synchronization)9 b(Operations)h
Fq(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(41)173 2575 y(7.2.1)54 b(semInit)34 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(41)964 2753 y(4)p eop
%%Page: 5 5
4 bop 173 124 a Fr(7.2.2)54 b(semW)l(ait)13 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(41)173 181 y(7.2.3)54 b(semSignal)15 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(41)68 237 y(7.3)48 b(Delay)36 b Fq(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(41)68 294 y(7.4)48 b(Locking)10 b(Operations)20 b Fq(.)j(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(42)173 350 y(7.4.1)54 b(rwLockInit)33 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(42)173
407 y(7.4.2)54 b(rwLockDestroy)20 b Fq(.)j(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(42)173 463 y(7.4.3)54
b(readerLock)32 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(42)173 519 y(7.4.4)54 b(readerUnlock)25
b Fq(.)e(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(42)173 576 y(7.4.5)54 b(writerLock)36 b Fq(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(42)173 632 y(7.4.6)54 b(writerUnlock)29 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(43)68
689 y(7.5)48 b(Usage)11 b(Rules)18 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(43)173 745 y(7.5.1)54 b(Scheduling)10 b(and)h(Preemption)43
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(43)173
802 y(7.5.2)54 b(Blocking)37 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(43)173 858
y(7.5.3)54 b(External)11 b(Threads)28 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(43)173 915 y(7.5.4)54
b(Thread)11 b(T)n(urnaround)21 b Fq(.)i(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(44)173 971 y(7.5.5)54 b(Multiprocessor)10
b(Support)h Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(44)0 1073 y Fm(8)j(T)m(race)12 b(Library)1561 b(45)68
1129 y Fr(8.1)48 b(T)m(ype)10 b(De\256nitions)h Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(45)68 1186 y(8.2)48 b(Operations)12 b Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(45)173 1242 y(8.2.1)54 b(xT)n(race)13 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(45)173 1299 y(8.2.2)54 b(xT)n(raceP)22 b Fq(.)h(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(46)173 1355 y(8.2.3)54 b(xIfT)n(race,)13 b(xIfT)n(raceP)18
b Fq(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(46)173 1412 y(8.2.4)54 b(xAssert)31 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(46)173 1468 y(8.2.5)54 b(xError)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(46)68 1525 y(8.3)48 b(Usage)11 b(Rules)18 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(46)0 1627 y Fm(9)j(Utility)10 b(Routines)1530 b(48)68
1683 y Fr(9.1)48 b(Storage:)16 b(xMalloc)10 b(and)h(xFree)44
b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(48)68 1739 y(9.2)48 b(T)n(ime)17 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(48)173 1796 y(9.2.1)54 b(xGetT)n(ime)22 b Fq(.)h(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(48)173 1852 y(9.2.2)54 b(xAddT)n(ime)43 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(48)173 1909 y(9.2.3)54 b(xSubT)n(ime)17 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(48)68 1965 y(9.3)48 b(Byte)11 b(Order:)16 b(ntohs,)10 b(ntohl,)g(htons,)h
(and)g(htonl)30 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(48)68 2022 y(9.4)48 b(Checksum)21 b Fq(.)i(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(49)173 2078 y(9.4.1)54 b(inCkSum)33 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(49)173 2135 y(9.4.2)54 b(ocsum)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(49)68 2191 y(9.5)48 b(Strings)10 b(to)h(Hosts)24 b Fq(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(49)173 2248 y(9.5.1)54 b(ipHostStr)29 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(49)173 2304 y(9.5.2)54 b(str2ipHost)13 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(49)173 2360 y(9.5.3)54 b(ethHostStr)43 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(49)173
2417 y(9.5.4)54 b(str2ethHost)27 b Fq(.)c(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(49)68 2473 y(9.6)48
b(Host)10 b(Name)i(Service)31 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(50)173 2530
y(9.6.1)54 b(xk)p 367 2530 14 2 v 16 w(gethostbyname)36 b Fq(.)23
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(50)68 2586 y(9.7)48 b(ROM)12 b(\256le)f(parsing)f(utilities)18
b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(50)964 2753 y(5)p eop
%%Page: 6 6
5 bop 0 124 a Fm(10)34 b(Contr)o(ol)11 b(Operations)1446 b(53)68
181 y Fr(10.1)36 b(Standard)11 b(Control)f(Operations)53 b
Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(53)173 237 y(10.1.1)h(Protocol)10 b(and)h(Session)f(Operations)43
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(53)173 294 y(10.1.2)h(Session)
10 b(Operations)46 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fr(54)68 350 y(10.2)36 b(Protocol-Speci\256c)11
b(Control)f(Operations)36 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(54)68 407 y(10.3)36 b(Forwarding)11 b(Control)f(Operations)36
b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(55)0 508 y Fm(11)22 b(Refer)o(ence)13 b(Counting)e(XObjs)1313
b(56)68 565 y Fr(11.1)25 b(References)12 b Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(56)68 621 y(11.2)25 b(Reference)12 b(counts)35 b Fq(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(56)173 678 y(11.2.1)h(Counting)9 b(External)h(References)56
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(57)173 734
y(11.2.2)h(Counting)9 b(xPops)37 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(57)68 791 y(11.3)25
b(Internal)10 b(vs.)17 b(External)10 b(Reference)j(Counts)g
Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(58)68 847
y(11.4)25 b(Session)10 b(Caching)h(Strategies)27 b Fq(.)c(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(58)68 904 y(11.5)25
b(Modifying)10 b(v3.1)g(protocols)19 b Fq(.)k(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(60)0 1006 y Fm(12)22
b(Con\256guring)11 b(a)h(Kernel)1423 b(62)68 1062 y Fr(12.1)25
b(Specifying)10 b(a)i(Protocol)e(Graph)35 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(62)68 1118 y(12.2)25
b(Build)10 b(Procedure)20 b Fq(.)j(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(63)68 1175 y(12.3)25
b(Debug)10 b(versus)h(Optimized)f(Mode)19 b Fq(.)k(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(64)68 1231 y(12.4)25 b(Useful)10
b(Make)i(T)m(ar)o(gets)38 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(65)68 1288 y(12.5)25
b(Modifying)10 b(Code)h(in)g(System)g(Areas)g Fq(.)24 b(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(66)0 1390 y Fm(13)22 b(Running)12
b(a)f(Kernel)1489 b(67)68 1446 y Fr(13.1)25 b(Protocol)10 b(T)m(ables)32
b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fr(67)173 1503 y(13.1.1)31 b(ROM)12
b(options)22 b Fq(.)h(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fr(69)68 1559 y(13.2)25 b(ROM)12 b(\256les)22
b Fq(.)h(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(69)173 1616 y(13.2.1)31
b(ROM)12 b(File)f(Generators)h Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fr(70)173 1672 y(13.2.2)31 b(CA)-6
b(VEA)h(TS)40 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(71)68 1728 y(13.3)25 b(SunOS4)i
Fq(.)c(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(72)173 1785 y(13.3.1)31
b(ROM)12 b(options)22 b Fq(.)h(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(73)173 1841 y(13.3.2)h(Problems)11
b(with)f(gcc)h(version)f(2)17 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(73)68 1898 y(13.4)25 b(Mach)12 b(3)41 b Fq(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(73)173 1954 y(13.4.1)31 b(ROM)12
b(options)22 b Fq(.)h(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fr(74)68 2011 y(13.5)25 b(Mach)12 b(3)f
Fq(x)p Fr(-kernel)g(in)g(the)g(Mach)h(kernel)39 b Fq(.)23 b(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(74)68 2067 y(13.6)25 b(Running)10
b(T)m(est)g(Suites)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(74)68 2124 y(13.7)25
b(T)n(roubleshooting)14 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(75)0 2226
y Fm(14)22 b(Releasing)10 b(a)h(Pr)o(otocol)1441 b(76)0 2327
y(15)22 b(System)11 b(Installation)1463 b(77)68 2384 y Fr(15.1)25
b(Unpacking)10 b(the)g Fq(tar)h Fr(\256le)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(77)68
2440 y(15.2)25 b(About)10 b(Compilers)35 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(77)68 2497 y(15.3)25 b(Building)9 b(the)i(Utility)e(programs)15
b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(77)68 2553 y(15.4)25 b(Building)9 b(and)i(testing)f(the)h(system)j
Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(78)964 2753 y(6)p eop
%%Page: 7 7
6 bop 0 124 a Fm(16)22 b(Installing)10 b(MachNetIPC)h(-)g(A)g(Network)h
(Extension)f(of)h(Mach3)f(IPC)644 b(79)68 181 y Fr(16.1)25
b(Building)9 b(MachNetIPC)43 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(79)68 237 y(16.2)25
b(Running)10 b(MachNetIPC)45 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(79)68 294 y(16.3)25
b(Using)10 b(MachNetIPC)25 b Fq(.)e(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(80)68 350 y(16.4)25
b(Protocol)10 b(T)m(ables)32 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fr(80)68
407 y(16.5)25 b(Lar)o(ge)11 b(Messages)23 b Fq(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fr(80)68 463 y(16.6)25 b(Access)11 b(Control)f(and)h(Privacy)j
Fq(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(81)68 519 y(16.7)25 b(Reporting)10 b(Problems)19 b Fq(.)k(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(81)0 621 y Fm(17)22 b(Installing)10 b(within)h(a)g(Mach3)g(Kernel)1194
b(82)0 723 y(A)35 b(Pr)o(otocol)11 b(Speci\256cations)1397
b(84)68 780 y Fr(ARP)26 b Fq(.)d(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(86)68 836 y(BID)36 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(88)68 893 y(BIDCTL)18 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(89)68 949 y(BIND)37 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fr(91)68 1006 y(BLAST)c Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(93)68 1062 y(CHAN)19 b Fq(.)k(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(95)68 1118 y(CR)m(YPT)d Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fr(97)68 1175 y(ETH)25 b Fq(.)e(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(100)68 1231 y(ICMP)38 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(102)68 1288 y(IP)40 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)c Fr(103)68 1344 y(JOIN)c Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)c Fr(105)68 1401 y(KM)41 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)c Fr(107)68 1457 y(MachNetIPC)45 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(111)68 1514 y(NNS)k Fq(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(112)68 1570 y(RA)-5 b(T)28 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)c Fr(113)68 1627 y(RRX)i Fq(.)i(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)c Fr(115)68 1683 y(SELECT)c Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(116)68 1739 y(SIMSIMETH)35 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(117)68 1796 y(SRX)26 b Fq(.)d(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(121)68 1852 y(SSR)34 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)c Fr(122)68 1909 y(SUNRPC)40 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(123)68 1965 y(SUN)11 b(Portmapper)38 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(126)68 2022 y(TCP)31 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)c Fr(127)68 2078 y(TCR)m(YPT)45 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(130)68 2135 y(TEST)39 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(131)68 2191 y(UDP)k Fq(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(133)68 2248 y(VCACHE)29 b Fq(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(135)68 2304 y(VCHAN)h Fq(.)j(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(136)68 2360 y(VDISORDER)24 b Fq(.)f(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(138)68 2417 y(VDROP)28 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(140)68 2473 y(VMUX)43 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(141)68 2530 y(VNET)26 b Fq(.)d(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(142)68 2586 y(VSECSEL)g Fq(.)k(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(144)964 2753 y(7)p eop
%%Page: 8 8
7 bop 68 124 a Fr(VSIZE)19 b Fq(.)k(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(146)68 181 y(VT)l(AP)33 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(147)68 237 y(XKSOCKET)41 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(149)0 339 y Fm(B)38 b(Device)11 b(Drivers)1527 b(150)68
396 y Fr(B.1)41 b(SunOS)16 b Fq(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(150)173 452 y(SIMETH)44 b Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c Fr(150)68
508 y(B.2)41 b(Mach)12 b(3)41 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(152)173 565 y(ETHDR)l(V)32 b Fq(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(152)173 621 y(NS8390)29 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(154)173 678 y(XKLANCE)29 b Fq(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c Fr(155)0
780 y Fm(C)35 b(Application)11 b(Pr)o(ogrammer)g(Interfaces)1118
b(156)68 836 y Fr(C.1)52 b(Mach)12 b(3)30 b Fq(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fr(156)173 893 y(C.1.1)47 b(Sockets)29 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c Fr(156)173
949 y(C.1.2)47 b(MachNetIPC)34 b Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c Fr(156)173 1006 y(C.1.3)47
b(Building)d Fq(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)c Fr(157)964 2753 y(8)p eop
%%Page: 9 9
8 bop 0 124 a Fn(1)60 b(Intr)o(oduction)0 228 y Fr(The)13 b
Fq(x)p Fr(-kernel)h(is)e(an)i(object-oriented)d(multi-threaded)h
(architecture)h(for)g(protocol)f(implementation.)21 b(Each)14
b(protocol)0 284 y(is)e(represented)g(as)h(an)g(object)e(instance;)i
(sessions)d(are)k(specialized)d(instances)h(of)g(protocol)g(objects;)f(each)i
(thread)g(is)f(a)0 340 y(calling)h(sequence)i(of)f(object)g(invocations.)24
b(Generally)14 b(speaking,)h(each)g(message)f(in)g(an)h Fq(x)p
Fr(-kernel)g(is)f(processed)g(by)0 397 y(a)g(thread)g(of)g(protocol/session)c
(layers.)25 b(The)14 b Fq(x)p Fr(-kernel)g(provides)e(the)i(interface)g
(functions)e(that)i(allow)f(one)g(object)h(to)0 453 y(invoke)f(another)h(and)
g(subsystems)e(for)i(manipulating)f(messages,)i(associative)e(memory)h
(tables,)h(events,)f(addresses,)0 510 y(and)d(debugging.)71
566 y(V)-5 b(ersion)11 b(3.2)h(is)f(a)i Fq(pr)n(otocol)d(implementation)f
(envir)n(onment)i Fr(that)g(can)h(be)h(embedded)f(in)f(any)h(platform,)g
(including)0 623 y(both)j(hardware)h(and)g(software)g(platforms.)30
b(By)16 b(de\256ning)g(all)f(the)h(interfaces)g(between)f(the)h(protocol)f
(and)h(the)f(host)0 679 y(environment,)i(the)g Fq(x)p Fr(-kernel)g
(completely)f(isolates)f(the)i(protocol)e(from)j(the)e(underlying)f
(operating)h(system.)32 b(As)17 b(a)0 736 y(result,)11 b(protocol)f(source)h
(code)g(can)g(be)g(moved)h(from)f(one)g(platform)g(to)g(another)g(without)e
(modi\256cation.)71 792 y(This)f(manual)h(covers)g(the)g Fq(x)p
Fr(-kernel)h(functionality)m(,)e(the)h(protocol)f(library)m(,)h(and)g(the)g
(tools)f(for)h(building)e(and)j(running)0 849 y Fq(x)p Fr(-kernels)h(on)h
(various)e(platforms.)17 b(Sections)11 b(2\2619)f(de\256ne)i(the)f(uniform)g
(protocol)g(interface)g(and)g(the)h(various)e(libraries)0 905
y(that)f(make)i(up)f(the)g Fq(x)p Fr(-kernel.)16 b(Sections)10
b(10)g(and)f(11)h(give)g(additional)e(guidelines)g(about)h(using)g(these)h
(routines.)15 b(Finally)m(,)0 961 y(Sections)10 b(12\26117)g(describe)h
(procedures)g(for)g(maintaining,)f(con\256guring,)h(running,)f(and)h
(installing)d(the)j Fq(x)p Fr(-kernel.)0 1086 y Fl(1.1)50 b(Acknowledgements)
0 1173 y Fr(The)15 b Fq(x)p Fr(-kernel)g(was)g(originally)e(the)h(concept)h
(of)g(Norman)g(C.)h(Hutchinson)c(at)j(the)g(University)e(of)i(British)f
(Columbia)0 1229 y(and)j(Larry)h(L.)f(Peterson)h(of)f(the)g(University)f(of)h
(Arizona.)35 b(Several)18 b(people)f(at)g(the)g(University)f(of)h(Arizona)g
(have)0 1286 y(made)g(contributions)c(to)i(the)h(current)g(release,)i
(including)c(Peter)i(Druschel,)h(Hasnain)e(Karampurwala,)j(Ed)e(Menze,)0
1342 y(David)10 b(Mosber)o(ger)o(-T)m(ang,)h(Sean)h(W)l(.)f(O'Malley)m(,)g
(and)g(Hilarie)f(Orman.)17 b(Many)11 b(people)f(have)h(contributed)e
(protocols)h(to)0 1399 y(the)h Fq(x)p Fr(-kernel)g(as)h(noted)e(in)h
(appendix)f(A.)0 1523 y Fl(1.2)50 b(Our)12 b(Addr)o(ess)0 1610
y Fr(Please)g(let)f(us)f(know)h(of)g(any)g(problems)g(you)g(encounter)f(so)h
(that)g(we)g(can)h(continue)e(to)h(improve)g(the)g(distribution)o(.)j(Our)0
1666 y(mail)d(address)g(is:)114 1773 y(The)g Fq(x)p Fr(-Kernel)g(Project)114
1829 y(Department)g(of)g(Computer)g(Science)114 1886 y(University)e(of)i
(Arizona)114 1942 y(T)n(ucson,)g(AZ)g(85721)0 2048 y(W)l(e)h(can)f(be)h
(reached)f(by)g(electronic)g(mail)g(at:)114 2154 y
(xkernel-bugs@cs.arizona.edu)114 2211 y(uunet!arizona!xkernel-bugs)0
2317 y(Because)h(of)f(limited)f(resources)h(we)h(can')o(t)f(promise)g(to)g
(\256x)g(every)g(problem,)g(but)g(we)g(appreciate)g(all)g(comments.)71
2374 y(Also,)k(we)f(typically)f(post)h(messages)h(about)e(the)i
Fq(x)p Fr(-kernel)g(\(including)e(notices)g(of)i(future)f(releases\))h(to)g
(xkernel-)0 2430 y(interest@cs.arizona.edu.)f(Send)9 b(mail)f(to)g
(xkernel-interest-request@cs.arizona.edu)e(to)i(be)g(added)g(to)g(to)g(this)f
(mailing)0 2487 y(list.)964 2753 y(9)p eop
%%Page: 10 10
9 bop 0 124 a Fl(1.3)50 b(Copyright)11 b(Notice)0 211 y Fq(x)p
Fr(-kernel)0 280 y(Copyright)f(\(c\))i(1993,1991,1990)c(Arizona)j(Board)h(of)
f(Regents)0 349 y(Permission)g(to)h(use,)h(copy)m(,)f(modify)m(,)g
(distribute,)f(and)h(sell)f(this)g(software)h(and)g(its)g(documentation)e
(for)i(any)g(purpose)g(is)0 406 y(hereby)c(granted)g(without)e(fee,)k
(provided)c(that)i(the)g(above)g(copyright)e(appear)j(in)e(all)h(copies,)g
(and)g(that)g(both)f(the)h(copyright)0 462 y(and)17 b(this)f(permission)g
(notice)h(appear)h(in)f(supporting)e(documentation,)i(and)g(that)g(the)g
(name)h(of)g(the)f(University)e(of)0 518 y(Arizona)10 b(or)g(the)h(Arizona)f
(Board)g(of)h(Regents)f(not)f(be)i(used)f(in)g(advertising)e(or)j(publicity)d
(pertaining)h(to)h(distribution)d(of)0 575 y(the)j(software)f(without)f
(speci\256c,)j(written)e(prior)g(permission.)15 b(The)10 b(University)e(of)i
(Arizona)f(makes)h(no)g(representations)0 631 y(about)16 b(the)g(suitability)
e(of)i(this)g(software)g(for)h(any)f(purpose.)32 b(It)17 b(is)f(provided)f
("as)h(is")g(without)e(express)i(or)h(implied)0 688 y(warranty)m(.)0
757 y(The)9 b(University)f(of)h(Arizona)h(requests)e(users)h(of)h(this)e
(software)h(to)g(return)h(any)f(improvements)g(or)g(extensions)f(that)h(they)
0 813 y(make,)j(and)f(to)g(grant)g(the)g(University)e(of)i(Arizona)g(the)g
(rights)f(to)g(redistribute)g(these)h(changes.)952 2753 y(10)p
eop
%%Page: 11 11
10 bop 0 124 a Fn(2)60 b(Uniform)14 b(Pr)o(otocol)e(Interface)0
228 y Fr(Each)7 b Fq(x)p Fr(-kernel)g(protocol)g(is)g(encapsulated)g(in)g(a)g
(uniform)g(prot)o(ocol)g(in)o(terface)g(\(UPI\).)g(The)g(suite)g(of)g
(protocols)f(con\256gured)0 284 y(into)11 b(the)g(system)g(form)h(a)g
Fq(pr)n(otocol)e(graph)h Fr(and)g(the)h(collection)e(of)i(currently)e(opened)
i(sessions)d(\(connections\))i(form)h(a)0 340 y Fq(session)e(graph)p
Fr(.)0 465 y Fl(2.1)50 b(T)l(ype)13 b(De\256nitions)0 552 y
Fm(2.1.1)45 b(XObj)0 639 y Fr(An)12 b Fq(XObj)g Fr(is)g(the)h(fundamental)f
(identi\256er)g(in)g(the)h(system.)20 b(It)13 b(can)g(represent)g(either)f(a)
h(protocol)e(or)i(a)g(session.)20 b(Fields)0 695 y(which)10
b(can)i(be)f(read)h(or)f(written)f(by)h(the)g(programmer)h(are)g(so)f
(indicated.)102 801 y Fk(t)o(yp)q(edef)k(struct)e Fj(xob)s(j)e
Fi(f)205 858 y Fk(X)o(Ob)r(jT)o(yp)q(e)68 b Fr(type;)205 914
y Fk(c)o(har)184 b Fr(*fullName;)53 b Fh(/*)14 b(the)g(name)f(giv)o(en)g(in)h
(graph.comp,)d(e.g.,)i(\\ethdrv/SE0")h(*/)205 971 y Fk(c)o(har)184
b Fr(*name;)127 b Fh(/*)14 b(the)g(proto)q(col)g(name,)e(e.g.,)h(\\ethdrv")h
(*/)205 1027 y Fk(c)o(har)184 b Fr(*instName;)50 b Fh(/*)14
b(the)g(instance)h(name,)d(e.g.,)h(\\SE0")g(*/)205 1084 y Fk(c)o(har)184
b Fr(*state;)141 b Fh(/*)14 b(Readable/writable)f({)g(Owned)i(b)o(y)e(the)i
(session/proto)q(col)f(*/)205 1140 y Fk(Bind)174 b Fr(binding;)107
b Fh(/*)14 b(Readable/writable)f(*/)205 1197 y Fk(in)o(t)211
b Fr(rcnt;)177 b Fh(/*)14 b(readable)g(*/)205 1253 y Fk(in)o(t)211
b Fr(id;)h Fh(/*)14 b(readable)g(*/)205 1310 y(/*)f(In)o(terface)i(functions)
f(*/)205 1366 y Fk(Pfo)199 b Fr(open;)159 b Fh(/*)14 b(proto)q(cols)g(only)f
(*/)205 1422 y Fk(Pfk)198 b Fr(closedone;)65 b Fh(/*)14 b(proto)q(cols)g
(only)f(*/)205 1479 y Fk(Pfk)198 b Fr(openenable;)40 b Fh(/*)14
b(proto)q(cols)g(only)f(*/)205 1535 y Fk(Pfk)198 b Fr(opendisable;)29
b Fh(/*)14 b(proto)q(cols)g(only)f(*/)205 1592 y Fk(Pfk)198
b Fr(opendone;)70 b Fh(/*)14 b(proto)q(cols)g(only)f(*/)205
1648 y Fk(Pfk)198 b Fr(demux;)124 b Fh(/*)14 b(proto)q(cols)g(only)f(*/)205
1705 y Fk(Pfk)198 b Fr(calldemux;)58 b Fh(/*)14 b(proto)q(cols)g(only)f(*/)
205 1761 y Fk(Pfk)198 b Fr(shutdown;)69 b Fh(/*)14 b(proto)q(cols)g(only)f
(*/)205 1818 y Fk(Pfk)198 b Fr(pop;)179 b Fh(/*)14 b(sessions)h(only)e(*/)205
1874 y Fk(Pfk)198 b Fr(callpop;)113 b Fh(/*)14 b(sessions)h(only)e(*/)205
1931 y Fk(Pfh)197 b Fr(push;)161 b Fh(/*)14 b(sessions)h(only)e(*/)205
1987 y Fk(Pfk)198 b Fr(call;)182 b Fh(/*)14 b(sessions)h(only)e(*/)205
2043 y Fk(Pfk)198 b Fr(close;)154 b Fh(/*)14 b(sessions)h(or)f(proto)q(cols)g
(*/)205 2100 y Fk(P\014)210 b Fr(control;)118 b Fh(/*)14 b(sessions)h(or)f
(proto)q(cols)g(*/)205 2156 y Fk(Pfk)198 b Fr(duplicate;)80
b Fh(/*)14 b(sessions)h(only)e(*/)205 2213 y Fk(in)o(t)211
b Fr(numdown;)65 b Fh(/*)14 b(readable)g(*/)466 2269 y(/*)f(do)o(wn)h(info)f
(is)g(o)o(wned)h(b)o(y)g(the)h(proto)q(col)e(for)h(its)g(sessions)h(*/)205
2326 y Fk(in)o(t)211 b Fr(downlistsz;)205 2382 y Fk(unsigned)14
b(in)o(t)38 b Fr(idle;)205 2439 y Fk(struct)15 b(xob)r(j)60
b Fr(*down[8];)205 2495 y Fk(struct)15 b(xob)r(j)60 b Fr(**downlist;)205
2552 y Fk(struct)15 b(xob)r(j)60 b Fr(*myprotl;)80 b Fh(/*)14
b(readable)g({)f(a)h(session)h(is)e(an)h(instance)h(of)e(this)h(proto)q(col)g
(*/)205 2608 y Fk(struct)h(xob)r(j)60 b Fr(*up;)179 b Fh(/*)14
b(for)f(sessions)i(only)e(*/)952 2753 y Fr(11)p eop
%%Page: 12 12
11 bop 205 124 a Fk(struct)15 b(xob)r(j)60 b Fr(*hlpT)m(ype;)102
181 y Fi(g)11 b Fr(*)p Fj(X)n(Ob)s(j)p Fr(;)71 284 y(If)k(you)g(think)f(of)h
(the)g Fq(x)p Fr(-kernel)g(as)h(implementing)e(protocol)f(and)i(session)f
(graphs,)i(then)f(each)g Fq(XObj)g Fr(represents)0 341 y(a)h(node)e(in)h(one)
g(of)h(the)f(graphs.)28 b(Furthermore,)17 b(an)e(object')m(s)g
Fq(down)g Fr(vector)g(represents)g(graph)g(edges;)h(they)f(contain)0
397 y(pointers)10 b(to)i(the)f Fq(XObjs)g Fr(that)g(are)h(below)f(the)h
(object)f(in)g(the)h(protocol)e(or)i(session)e(graphs.)18 b(The)12
b(\256elds)f Fq(mypr)n(otl)g Fr(and)h Fq(up)0 454 y Fr(link)e(a)i(session)d
(to)i(the)g(protocols)e(that)i(own)g(and)g(created)g(the)g(session,)f
(respectively)m(.)0 576 y Fm(2.1.2)45 b(Enable)12 b(Objects)0
663 y Fr(The)k Fq(Enable)f Fr(object)h(is)f(provided)g(for)i(use)f(by)g(the)f
(programmer)j(in)d(maintaining)g(maps)h(that)g(associate)f(identi\256ers)0
719 y(and)d(protocols)f(or)h(sessions.)19 b(A)12 b(pointer)g(to)g(an)g
Fq(Enable)g Fr(object)f(is)h(often)g(used)g(as)h(the)f(internal)f
(identi\256er)h(in)g Fq(mapBind)0 776 y Fr(calls.)17 b(An)12
b Fq(Enable)e Fr(object)h(has)h(a)g(\256eld)f(for)h(reference)h(counting.)j
(Protocol)11 b(writers)g(will)g(\256nd)g(this)g(useful)g(in)g(handling)0
832 y Fq(xOpenEnable)e Fr(calls)g(with)g(identical)g(participants\320the)f
(calls)i(are)g(redundant)f(with)g(respect)h(to)g(session)e(creation\320but)0
889 y(they)j(must)f(be)i(reference)g(counted)e(in)h(order)g(to)g(properly)f
(handle)h Fq(xOpenDisable)e Fr(calls.)102 992 y Fk(t)o(yp)q(edef)15
b(struct)e Fj(xenable)d Fi(f)205 1049 y Fk(X)o(Ob)r(j)161 b
Fr(hlpRcv;)94 b Fh(/*)13 b(upp)q(er)i(proto)q(col)e(*/)205
1105 y Fk(X)o(Ob)r(j)161 b Fr(hlpT)m(ype;)76 b Fh(/*)13 b(upp)q(er)i(proto)q
(col)e(*/)205 1162 y Fk(Bind)174 b Fr(binding;)85 b Fh(/*)13
b(from)f(mapBind)g(*/)205 1218 y Fk(in)o(t)211 b Fr(rcnt;)155
b Fh(/*)13 b(A)h(use)h(coun)o(t)f(*/)102 1275 y Fi(g)d Fj(Enable)p
Fr(;)0 1397 y Fm(2.1.3)45 b(Return)13 b(V)l(alues)0 1484 y
Fr(Most)h(routines)e(have)j(a)f(return)g(value)f(type)h(of)g
Fq(xkern)p 887 1484 14 2 v 16 w(r)n(eturn)p 1016 1484 V 16
w(t)p Fr(,)h(which)e(is)h(either)f Fq(XK)p 1416 1484 V 17 w(SUCCESS)h
Fr(or)g Fq(XK)p 1747 1484 V 16 w(F)-6 b(AILURE)p Fr(.)0 1540
y(Routines)14 b(that)h(return)g(type)g Fq(XObj)f Fr(have)i(a)f(failure)h
(value)f(of)g Fq(ERR)p 1116 1540 V 16 w(XOBJ)p Fr(.)g(Some)h(message)g
(handling)d(routines)h(use)0 1597 y(type)e Fq(xmsg)p 188 1597
V 16 w(handle)p Fr(;)h(see)g(section)f(2.2.6.)22 b(Severe)14
b(error)g(conditions)c(will)i(result)g(in)h(console)f(error)i(messages)f(and)
f(the)0 1653 y(termination)e(of)h(the)g Fq(x)p Fr(-kernel.)0
1775 y Fm(2.1.4)45 b(Function)12 b(T)m(ypes)0 1862 y Fr(The)f(following)e
(typedefs)i(are)g(used)g(in)g(the)g Fq(XObj)f Fr(structure)g(and)h
(throughout)e(this)h(document:)114 1966 y Fk(t)o(yp)q(edef)k(xk)o(ern)p
363 1966 13 2 v 16 w(return)p 491 1966 V 16 w(t)25 b Fr(\()12
b(*)f(Pfk)g(\)\(\);)114 2022 y Fk(t)o(yp)q(edef)j(v)o(oid)25
b Fr(\()11 b(*)g(Pfv)h(\)\(\);)114 2079 y Fk(t)o(yp)q(edef)i(struct)h(xob)r
(j)25 b Fr(\()12 b(*)f(Pfo)h(\)\(\);)114 2135 y Fk(t)o(yp)q(edef)i(xmsg)p
358 2135 V 14 w(handle)p 492 2135 V 15 w(t)25 b Fr(\()12 b(*)f(Pfh)g(\)\(\);)
114 2192 y Fk(t)o(yp)q(edef)j(in)o(t)25 b Fr(\()12 b(*)f(P\256)h(\)\(\);)0
2316 y Fl(2.2)50 b(Pr)o(otocol-Pr)o(otocol)12 b(Operations)0
2403 y Fr(This)g(section)h(de\256nes)g(the)g(operations)f(that)g(protocols)g
(\(and)h(sessions\))f(invoke)g(on)h(each)h(other)m(.)23 b(In)13
b(general,)h(each)g(of)0 2459 y(the)e(operations)f(invokes)g(a)i
(corresponding)d(operation)i(in)f(the)i(tar)o(get)f(protocol)f(or)h(session.)
19 b(For)13 b(example,)g(an)f Fq(xOpen)0 2516 y Fr(call)g(will)f(result)g(in)
g(the)h(invocation)e(of)i(a)h(protocol)d(speci\256c)i(open)g(routine,)f(e.g.)
20 b Fq(udp)p 1400 2516 14 2 v 15 w(open)p Fr(.)f(For)12 b(each)h(operation,)
e(we)0 2572 y(give)j(the)h(interface)g(to)g(both)f(the)h(generic)g
Fq(x)p Fr(-kernel)g(operation)f(and)h(an)g(example)g(protocol-speci\256c)f
(procedure)h(that)0 2629 y(implements)g(the)g(generic)h(operation.)29
b(Although)13 b(nearly)j(the)f(same,)j(the)d(speci\256cation)g(for)g(the)h
(generic)f(operation)952 2753 y(12)p eop
%%Page: 13 13
12 bop 0 124 a Fr(and)14 b(the)f(speci\256cation)g(for)h(the)g
(protocol-speci\256c)e(routine)h(typically)f(dif)o(fer)j(in)e(that)g(a)h
Fq(self)g Fr(pointer)e(is)i(passed)f(to)g(the)0 181 y(protocol-speci\256c)d
(routine.)0 301 y Fm(2.2.1)45 b(xOpen)0 388 y Fr(The)13 b Fq(xOpen)h
Fr(function)e(is)h(used)g(by)g(high-level)f(protocol)g Fq(hlpRcv)h
Fr(to)g(actively)f(open)h(a)h(session)e(associated)g(with)h(low-)0
444 y(level)e(protocol)f Fq(llp)h Fr(on)g(behalf)g(of)g(high-level)f
(protocol)g Fq(hlpT)m(ype)p Fr(.)17 b(T)m(ypically)m(,)10 b
Fq(hlpRcv)g Fr(and)i Fq(hlpT)m(ype)e Fr(refer)j(to)d(the)i(same)0
500 y(protocol)j(\(see)i(section)e(2.5.2.\))32 b(The)16 b Fq(participants)d
Fr(ar)o(gument)j(is)g(a)h(list)e(of)h(addresses)g(for)g(each)h(participant)e
(in)g(the)0 557 y(communication.)21 b(For)13 b(this,)f(and)h(all)f(calls)h
(returning)e(type)h Fq(XObj)p Fr(,)h(a)g(return)g(value)f(of)h
Fq(ERR)p 1511 557 14 2 v 16 w(XOBJ)f Fr(indicates)g(failure,)0
613 y(and)f(this)f(must)h(be)g(checked)g(by)g(all)g(callers)g(before)g(using)
f(the)h(return)g(value.)71 670 y(Caveat:)k(the)9 b(high-level)g(protocol)f
(will)g(use)i(its)f Fq(self)g Fr(object)f(as)i(the)g(\256rst)f(ar)o(gument)h
(in)f Fq(xOpen)p Fr(,)h(and)g(the)f(lower)o(-level)0 726 y(protocol)h(object)
h(as)g(the)g(third)g(ar)o(gument.)17 b(The)11 b(lower)o(-level')m(s)g(open)g
(routine)f(will)h(see)g(its)g(own)f Fq(self)h Fr(object)g(as)g(the)g(\256rst)
0 783 y(ar)o(gument,)i(and)f(the)g(high-level)e(protocols)h(as)h(the)g
(second)g(and)g(third)f(ar)o(guments.)19 b(This)11 b(reversal)i(of)f(ar)o
(gument)g(order)0 839 y(preserves)f(the)g(convention)e(that)i(the)g(current)g
(protocol')m(s)f(self)h(object)f(is)h(the)g(\256rst)g(ar)o(gument)g(in)g(the)
g(list.)71 915 y Fg(Generic:)34 b Fk(X)o(Ob)r(j)12 b Fj(xOp)r(en)p
Fr(\()p Fk(X)o(Ob)r(j)f Ff(hlpRcv)p Fr(,)i Fk(X)o(Ob)r(j)e
Ff(hlpT)l(ype)p Fr(,)g Fk(X)o(Ob)r(j)h Ff(llp)p Fr(,)g Fk(P)o(art)g
Fr(*)p Ff(participants)p Fr(\))71 990 y Fg(Speci\256c:)33 b
Fk(X)o(Ob)r(j)12 b Fj(udp)p 484 990 17 2 v 21 w(op)r(en)p Fr(\()p
Fk(X)o(Ob)r(j)f Ff(self)p Fr(,)h Fk(X)o(Ob)r(j)f Ff(hlpRcv)p
Fr(,)i Fk(X)o(Ob)r(j)f Ff(hlpT)l(ype)p Fr(,)e Fk(P)o(art)i
Fr(*)p Ff(participants)p Fr(\))0 1110 y Fm(2.2.2)45 b(xOpenEnable)0
1197 y Fr(Used)14 b(by)g(high-level)f(protocol)g Fq(hlpRcv)h
Fr(to)g(passively)f(open)h(a)h(session)e(associated)h(with)f(low-level)h
(protocol)f Fq(llp)h Fr(on)0 1254 y(behalf)8 b(of)h(high-level)e(protocol)g
Fq(hlpT)m(ype)p Fr(.)15 b(As)9 b(with)e Fq(xOpen)p Fr(,)j Fq(hlpRcv)e
Fr(and)g Fq(hlpT)m(ype)g Fr(usually)f(refer)i(to)g(the)f(same)h(protocol.)0
1310 y(A)k(passive)e(open)h(indicates)g(a)g(willingness)e(to)i(accept)h
(connections)e(initiated)g(by)h(remote)h(participants.)19 b(A)13
b(session)e(is)0 1366 y(not)g(actually)h(returned,)g(but)f(the)h(low-level)f
(protocol,)g(by)h(convention,)f(\252remembers\272)i(this)e(enabling,)h(and)g
(later)g(calls)0 1423 y(the)f(high-level)e(protocol')m(s)h
Fq(xOpenDone)g Fr(operation)g(to)h(complete)f(the)h(passive)f(open.)16
b Fq(participants)8 b Fr(is)i(an)h(ordered)g(list)0 1479 y(of)h(addresses)f
(for)h(each)g(participant)e(for)i(which)f(the)g(communication)g(has)g(been)h
(enabled.)17 b(In)12 b(most)f(cases,)h(it)g(contains)0 1536
y(only)e(a)g(single)g(element:)15 b(the)c(address)f(of)g(the)g(local)h
(participant.)k(A)10 b(return)g(value)g(of)h Fq(XK)p 1445 1536
14 2 v 17 w(F)-6 b(AILURE)10 b Fr(indicates)f(failure.)71 1592
y(The)g(lower)o(-level)g(protocol)g(generally)g(\252remembers\272)j(an)e
(invocation)d(of)j(its)f Fq(xOpenEnable)g Fr(operation)g(by)g(binding)0
1649 y(an)i Fq(Enable)f Fr(object)h(to)g(the)f(participant)g(information)g
(using)g Fq(mapBind)p Fr(.)71 1724 y Fg(Generic:)17 b Fk(xk)o(ern)p
361 1724 13 2 v 15 w(return)p 488 1724 V 16 w(t)12 b Fj(xOp)r(enEnable)e
Fr(\()h Fk(X)o(Ob)r(j)h Ff(hlpRcv)p Fr(,)h Fk(X)o(Ob)r(j)e
Ff(hlpT)l(ype)p Fr(,)g Fk(X)o(Ob)r(j)h Ff(llp)p Fr(,)g Fk(P)o(art)g
Fr(*)p Ff(p)f Fr(\))71 1800 y Fg(Speci\256c:)16 b Fk(xk)o(ern)p
361 1800 V 15 w(return)p 488 1800 V 16 w(t)c Fj(udp)p 626 1800
17 2 v 20 w(op)r(enenable)e Fr(\()i Fk(X)o(Ob)r(j)g Ff(self)p
Fr(,)f Fk(X)o(Ob)r(j)h Ff(hlpRcv)p Fr(,)h Fk(X)o(Ob)r(j)e Ff(hlpT)l(ype)p
Fr(,)g Fk(P)o(art)h Fr(*)p Ff(p)p Fr(\))0 1920 y Fm(2.2.3)45
b(xOpenDisable)0 2007 y Fr(Used)8 b(by)f(high-level)g(protocol)g
Fq(hlpRcv)g Fr(to)h(undo)f(the)h(ef)o(fects)g(of)h(an)f(earlier)g(invocation)
e(of)i Fq(xOpenEnable)p Fr(.)15 b(The)7 b(contents)0 2063 y(of)k(the)g
Fq(participant)e Fr(ar)o(gument,)22 b Fq(hlpRcv)g Fr(and)h
Fq(hlpT)m(ype)f Fr(must)10 b(be)i(the)f(same)g(as)h(the)e(ones)h(given)g(to)f
Fq(xOpenEnable)p Fr(.)71 2139 y Fg(Generic:)17 b Fk(xk)o(ern)p
361 2139 13 2 v 15 w(return)p 488 2139 V 16 w(t)12 b Fj(xOp)r(enDisable)p
Fr(\()e Fk(X)o(Ob)r(j)h Ff(hlpRcv)p Fr(,)i Fk(X)o(Ob)r(j)f
Ff(hlpT)l(ype)p Fr(,)e Fk(X)o(Ob)r(j)i Ff(llp)p Fr(,)h Fk(P)o(art)p
Fr(*)p Ff(p)p Fr(\))71 2214 y Fg(Speci\256c:)j Fk(xk)o(ern)p
361 2214 V 15 w(return)p 488 2214 V 16 w(t)c Fj(udp)p 626 2214
17 2 v 20 w(op)r(endisable)p Fr(\()f Fk(X)o(Ob)r(j)g Ff(self)p
Fr(,)h Fk(X)o(Ob)r(j)g Ff(hlpRcv)p Fr(,)g Fk(X)o(Ob)r(j)g Ff(hlpT)l(ype)p
Fr(,)f Fk(P)o(art)p Fr(*)p Ff(p)p Fr(\))0 2334 y Fm(2.2.4)45
b(xOpenDisableAll)0 2421 y Fr(Used)11 b(by)g(high-level)f(protocol)g
Fq(hlpRcv)g Fr(to)h(inform)g(low-level)g(protocol)f Fq(llp)g
Fr(that)h(all)g(previous)f(openEnables)g(made)i(by)0 2477 y
Fq(hlpRcv)f Fr(should)e(be)i(removed.)71 2553 y Fg(Generic:)17
b Fk(xk)o(ern)p 361 2553 13 2 v 15 w(return)p 488 2553 V 16
w(t)12 b Fj(xOp)r(enDisableAll)d Fr(\()i Fk(X)o(Ob)r(j)h Ff(hlpRcv)p
Fr(,)h Fk(X)o(Ob)r(j)e Ff(llp)i Fr(\))71 2629 y Fg(Speci\256c:)j
Fk(xk)o(ern)p 361 2629 V 15 w(return)p 488 2629 V 16 w(t)c
Fj(udp)p 626 2629 17 2 v 20 w(op)r(endisableall)e Fr(\()h Fk(X)o(Ob)r(j)h
Ff(self)p Fr(,)g Fk(X)o(Ob)r(j)g Ff(hlpRcv)g Fr(\))952 2753
y(13)p eop
%%Page: 14 14
13 bop 0 124 a Fm(2.2.5)45 b(xOpenDone)0 211 y Fr(Used)8 b(by)g(low-level)f
(protocol)h(to)g(inform)g(high-level)f(protocol)g(that)h(session)f(\()p
Fq(s)p Fr(\))h(has)h(now)f(been)g(created)h(corresponding)0
268 y(to)i(an)g(earlier)g Fq(xOpenEnable)f Fr(on)h(behalf)g(of)g
Fq(hlpT)m(ype)p Fr(.)114 362 y Fq(3.1)e(compatibility)d(note:)15
b Fr(This)8 b(is)h(like)f(3.1')m(s)i(x)p 868 362 14 2 v 16
w(callopendone)d(without)h(participants)f(or)i(hlp;)g(the)g(original)114
419 y(x)p 140 419 V 16 w(opendone)h(no)h(longer)f(exists.)71
535 y Fg(Generic:)17 b Fk(xk)o(ern)p 361 535 13 2 v 15 w(return)p
488 535 V 16 w(t)12 b Fj(xOp)r(enDone)e Fr(\()h Fk(X)o(Ob)r(j)h
Ff(hlpRcv)p Fr(,)h Fk(X)o(Ob)r(j)e Ff(s)p Fr(,)h Fk(X)o(Ob)r(j)g
Ff(llp)g Fr(\))71 613 y Fg(Speci\256c:)k Fk(xk)o(ern)p 361
613 V 15 w(return)p 488 613 V 16 w(t)c Fj(udp)p 626 613 17
2 v 20 w(op)r(endone)f Fr(\()p Fk(X)o(Ob)r(j)h Ff(self)p Fr(,)g
Fk(X)o(Ob)r(j)f Ff(lls)p Fr(,)i Fk(X)o(Ob)r(j)f Ff(llp)p Fr(,)g
Fk(X)o(Ob)r(j)g Ff(hlpT)l(ype)f Fr(\))0 734 y Fm(2.2.6)45 b(xPush)0
821 y Fr(Used)15 b(by)f(a)h(high-level)f(protocol)f(that)i(opened)f(session)g
Fq(s)g Fr(to)h(pass)f(the)h(message)g Fq(msg)f Fr(down)g(through)g(that)g
(session.)0 878 y(The)g(return)g(value)g(is)g(an)g(opaque)g(handle)f(on)h
(the)g(message)g(that)g(was)g(sent.)25 b(This)14 b(handle)f(may)i(be)f(used)g
(to)g(identify)0 934 y(this)c(message)i(in)f(subsequent)e Fq(xContr)n(ol)i
Fr(operations.)16 b(The)11 b(message)g(handle)g(may)h(also)f(take)g(one)g(of)
h(two)f(special)f(val-)0 990 y(ues:)17 b(a)12 b(return)g(value)f(of)h
Fq(XMSG)p 529 990 14 2 v 16 w(ERR)p 629 990 V 15 w(HANDLE)g
Fr(indicates)f(general)g(failure,)i(while)e Fq(XMSG)p 1530
990 V 15 w(ERR)p 1629 990 V 16 w(WOULDBLOCK)0 1047 y Fr(indicates)f(that)g(a)
i(session)e(in)g(non-blocking)f(mode)j(would)e(normally)g(have)h(blocked)g
(the)f(push.)114 1142 y Fq(3.1)k(compatibility)e(note:)23 b
Fr(The)15 b(reply)f(message)h(ar)o(g)g(from)h(3.1)f(has)f(been)h(eliminated.)
26 b(Use)15 b(xCall)f(if)h(a)114 1198 y(reply)10 b(message)i(is)e(expected.)
71 1314 y Fg(Generic:)17 b Fk(xmsg)p 356 1314 13 2 v 13 w(handle)p
489 1314 V 15 w(t)12 b Fj(xPush)f Fr(\()p Fk(X)o(Ob)r(j)h Ff(s)p
Fr(,)g Fk(Msg)g Fr(*)p Ff(msg)p Fr(\))71 1392 y Fg(Speci\256c:)k
Fk(xmsg)p 356 1392 V 13 w(handle)p 489 1392 V 15 w(t)c Fj(udp)p
626 1392 17 2 v 20 w(push)g Fr(\()p Fk(X)o(Ob)r(j)g Ff(self)p
Fr(,)g Fk(Msg)f Fr(*)p Ff(msg)p Fr(\))0 1513 y Fm(2.2.7)45
b(xCall)0 1600 y Fr(Similar)16 b(to)f Fq(xPush)f Fr(except)i(that)e(a)i
(\252reply\272)g(message)f(may)h(be)g(returned)f(through)f(the)h(ar)o(gument)
h Fq(r)n(eply)p 1730 1600 14 2 v 16 w(msg)p Fr(.)29 b(Used)0
1657 y(with)9 b(synchronous)f(\(RPC-like\))j(protocols.)j(Because)d(the)f
(lower)f(protocol)g(typically)f(retains)i(no)f(state)h(for)g(the)g(request)0
1713 y(message)i(after)h Fq(xCall)e Fr(returns,)h(a)g(message)h(handle)e(is)g
(not)h(returned.)18 b(The)12 b(message)g(structure)f(for)h(the)g(reply)g
(must)f(be)0 1770 y(initialized;)e(see)i Fq(msgConstructEmpty)p
Fr(.)71 1848 y Fg(Generic:)17 b Fk(xk)o(ern)p 361 1848 13 2
v 15 w(return)p 488 1848 V 16 w(t)12 b Fj(xCall)f Fr(\()p Fk(X)o(Ob)r(j)g
Ff(s)p Fr(,)h Fk(Msg)g Fr(*)p Ff(msg)p Fr(,)f Fk(Msg)h Fr(*)p
Ff(r)o(eply)p 1293 1848 15 2 v 17 w(msg)p Fr(\))71 1926 y Fg(Speci\256c:)k
Fk(xk)o(ern)p 361 1926 13 2 v 15 w(return)p 488 1926 V 16 w(t)c
Fj(udp)p 626 1926 17 2 v 20 w(call)f Fr(\()p Fk(X)o(Ob)r(j)h
Ff(s)p Fr(,)g Fk(Msg)f Fr(*)p Ff(msg)p Fr(,)g Fk(Msg)h Fr(*)p
Ff(r)o(eply)p 1361 1926 15 2 v 17 w(msg)p Fr(\))0 2047 y Fm(2.2.8)45
b(xPop)0 2134 y Fr(Used)15 b(by)g(a)g(protocol)f(to)h(pass)g(an)g(incoming)g
(message)g Fq(msg)g Fr(up)g(to)f(session)g Fq(s)h Fr(for)h(processing,)f(and)
g(to)g(indicate)f(the)0 2190 y(lower)o(-level)e(session)g(from)i(which)e(the)
h(message)g(was)g(received)h(\()p Fq(lls)p Fr(\).)21 b(This)13
b(calls)f(the)h(pop)g(routine)f(of)h(the)g(session)e Fq(s)0
2247 y Fr(and)g(increments)g(the)g(session)f(reference)i(count)e(\(see)i
(section)e(11\).)17 b(This)10 b(call)h(is)g(invoked)f(by)g(a)i(protocol)e(on)
h(one)g(of)g(its)0 2303 y(own)g(sessions.)71 2360 y(The)16
b Fq(hdr)g Fr(ar)o(gument)g(is)g(passed)g(through)f(the)h(infrastructure)f
(directly)h(to)g(the)g(protocol-speci\256c)f(routine.)31 b(It)17
b(is)0 2416 y(typically)c(used)i(to)g(pass)f(the)h(header)h(\(which)e(the)h
Fq(demux)g Fr(routine)f(used)h(to)g(\256nd)g(the)f(session\))g(to)h(the)g
(session')m(s)f Fq(pop)0 2473 y Fr(routine.)71 2551 y Fg(Generic:)j
Fk(xk)o(ern)p 361 2551 13 2 v 15 w(return)p 488 2551 V 16 w(t)12
b Fj(xP)n(op)g Fr(\()p Fk(X)o(Ob)r(j)f Ff(s)p Fr(,)h Fk(X)o(Ob)r(j)g
Ff(lls)p Fr(,)h Fk(Msg)e Fr(*)p Ff(msg)p Fr(,)h Fk(v)o(oid)h(*)e
Ff(hdr)p Fr(\))71 2629 y Fg(Speci\256c:)17 b Fk(xk)o(ern)p
362 2629 V 15 w(return)p 489 2629 V 17 w(t)11 b Fj(udp)p 627
2629 17 2 v 21 w(p)r(op)g Fr(\()p Fk(X)o(Ob)r(j)h Ff(self)p
Fr(,)f Fk(X)o(Ob)r(j)h Ff(lls)p Fr(,)h Fk(Msg)f Fr(*)p Ff(msg)p
Fr(,)f Fk(v)o(oid)i(*)e Ff(hdr)p Fr(\))952 2753 y(14)p eop
%%Page: 15 15
14 bop 0 124 a Fm(2.2.9)45 b(xCallPop)0 211 y Fr(When)7 b(a)h(synchronous)d
(\(RPC-like\))k(protocol)d(will)g(be)i(demuxing)e(a)i(message)g(to)f(an)g
(asynchronous)f(protocol,)h Fq(xCallPop)0 268 y Fr(can)j(be)f(used)g(to)g
(allow)g(the)g(upper)g(protocol)f(to)h(return)h(a)f(message.)17
b(This)8 b(reply)h(message)h(may)g(be)f(the)g(same)i(one)e(passed)0
324 y(to)i(the)g(synchronous)e(protocol)h(via)h Fq(xCallDemux)p
Fr(.)71 406 y Fg(Generic:)17 b Fk(xk)o(ern)p 361 406 13 2 v
15 w(return)p 488 406 V 16 w(t)12 b Fj(xCallP)n(op)f Fr(\()p
Fk(X)o(Ob)r(j)h Ff(s)p Fr(,)g Fk(X)o(Ob)r(j)g Ff(lls)p Fr(,)h
Fk(Msg)e Fr(*)p Ff(msg)p Fr(,)g Fk(v)o(oid)i(*)f Ff(hdr)p Fr(,)f
Fk(Msg)h Fr(*)p Ff(rmsg)p Fr(\))71 487 y Fg(Speci\256c:)k Fk(xk)o(ern)p
361 487 V 15 w(return)p 488 487 V 16 w(t)c Fj(udp)p 626 487
17 2 v 20 w(callp)r(op)f Fr(\()p Fk(X)o(Ob)r(j)h Ff(self)p
Fr(,)f Fk(X)o(Ob)r(j)h Ff(lls)p Fr(,)h Fk(Msg)f Fr(*)p Ff(msg)p
Fr(,)f Fk(v)o(oid)i(*)e Ff(hdr)p Fr(,)h Fk(Msg)f Fr(*)p Ff(rmsg)p
Fr(\))0 610 y Fm(2.2.10)45 b(xCloseDone)0 697 y Fr(Used)16
b(by)g(a)h(low-level)f(protocol)f(to)h(inform)h(the)f(high-level)f(protocol)g
(that)h(originally)f(opened)h(session)f Fq(s)i Fr(that)e(the)0
753 y(session)10 b(has)h(been)g(closed)f(by)h(a)h(peer)f(participant.)71
834 y Fg(Generic:)p Fk(xk)o(ern)p 344 834 13 2 v 16 w(return)p
472 834 V 16 w(t)g Fj(xCloseDone)g Fr(\()p Fk(X)o(Ob)r(j)h
Ff(s)p Fr(\))71 916 y Fg(Speci\256c:)k Fk(xk)o(ern)p 361 916
V 15 w(return)p 488 916 V 16 w(t)c Fj(udp)p 626 916 17 2 v
20 w(closedone)f Fr(\()p Fk(X)o(Ob)r(j)h Ff(s)p Fr(\))0 1038
y Fm(2.2.11)45 b(xClose)0 1125 y Fr(Decrements)18 b(the)f(reference)i(count)e
(of)g(an)h Fq(XObj)e Fr(\(see)i(section)f(11\),)i(calling)e(the)g(object')m
(s)g(close)g(function)f Fq(only)h Fr(if)0 1182 y(the)d(reference)h(count)f
(is)f(zero.)26 b(This)13 b(call)h(applies)g(to)f Fq(XObj)p
Fr(s)g(that)h(represent)g(both)f(protocols)g(and)h(sessions,)f(but)g(the)0
1238 y(implications)c(of)i(invoking)e Fq(xClose)i Fr(on)g(a)h(protocol)e(are)
i(not)e(fully)g(determined)h(at)g(this)f(time.)114 1345 y Fq(3.1)i
(compatibility)e(note:)19 b Fr(Replaces)13 b(xCloseProtl)f(and)g
(xCloseSession.)20 b(Note)12 b(that)g(in)g(3.1,)i(the)e Fq(XObj)p
Fr(')m(s)114 1401 y(close)e(function)g(was)h(called)g(every)h(time)f
(xCloseProtl)f(or)h(xCloseSession)f(was)h(called.)71 1532 y
Fg(Generic:)17 b Fk(xk)o(ern)p 361 1532 13 2 v 15 w(return)p
488 1532 V 16 w(t)12 b Fj(xClose)e Fr(\()p Fk(X)o(Ob)r(j)i
Ff(object)p Fr(\))71 1614 y Fg(Speci\256c:)k Fk(xk)o(ern)p
361 1614 V 15 w(return)p 488 1614 V 16 w(t)c Fj(udp)p 626 1614
17 2 v 20 w(close)f Fr(\()p Fk(X)o(Ob)r(j)h Ff(object)p Fr(\))0
1736 y Fm(2.2.12)45 b(xContr)o(ol)0 1823 y Fr(Used)10 b(by)h(one)g
Fq(XObj)f Fr(to)g(act)h(upon)f(another)g Fq(XObj)g Fr(for)h(retrieving)f
(information)g(or)h(for)g(setting)e(processing)g(parameters.)0
1880 y(The)g(operation)e(code)i Fq(opcode)g Fr(identi\256es)e(the)i(action;)f
Fq(buf)g Fr(is)h(a)g(character)h(buf)o(fer)f(from)g(which)f(an)h(ar)o(gument)
g(is)f(retrieved)0 1936 y(and/or)h(into)f(which)h(a)h(result)e(is)h(placed;)h
(and)f Fq(len)g Fr(is)g(the)h(length)e(of)h(the)h(buf)o(fer)m(.)17
b(There)9 b(are)h(two)f(\252classes\272)g(of)h(operations:)0
1993 y(standard)16 b(ones)h(that)g(may)g(be)g(implemented)g(by)g(more)h(than)
e(one)h(protocol,)h(and)f(protocol-speci\256c)f(ones.)34 b(A)17
b(full)0 2049 y(discussion)9 b(of)i(control)f(operation)g(codes)h(is)g(in)f
(section)h(10.)114 2155 y Fq(3.1)g(compatibility)d(note:)16
b Fr(The)11 b(routines)f(controlprotl)f(and)i(controlsessn)e(no)i(longer)f
(exist.)71 2286 y Fg(Generic:)17 b Fk(in)o(t)11 b Fj(xCon)n(trol)g
Fr(\()p Fk(X)o(Ob)r(j)h Ff(object)p Fr(,)f Fk(in)o(t)g Ff(opcode)p
Fr(,)i Fk(c)o(har)e Fr(*)p Ff(buf)p Fr(,)g Fk(in)o(t)g Ff(len)p
Fr(\))71 2368 y Fg(Speci\256c:)16 b Fk(in)o(t)11 b Fj(udp)p
416 2368 V 20 w(con)n(trol)g Fr(\()p Fk(X)o(Ob)r(j)h Ff(self)p
Fr(,)g Fk(in)o(t)f Ff(opcode)p Fr(,)h Fk(c)o(har)g Fr(*)p Ff(buf)p
Fr(,)f Fk(in)o(t)g Ff(len)p Fr(\))952 2753 y(15)p eop
%%Page: 16 16
15 bop 0 124 a Fm(2.2.13)45 b(xDemux)0 211 y Fr(Used)11 b(by)f(low-level)g
(session)g Fq(s)h Fr(to)g(pass)f(message)i Fq(msg)e Fr(to)h(the)g(high-level)
e(protocol)h(that)h(created)g(it.)16 b(The)11 b(higher)o(-level)0
268 y(protocol)j(is)g(determined)h(from)g(the)g(session)f(object.)27
b(The)15 b(higher)o(-level)f(protocol)f(demux)i(routine)f(should)g(\256nd)g
(the)0 324 y(appropriate)e(session,)g(creating)h(it)f(if)h(necessary)m(,)g
(and)g Fq(xPop)f Fr(the)h(message)g(to)f(the)h(session.)20
b(See)13 b(2.3.1)g(for)g(guidelines)0 381 y(on)e(when)g(session)e(creation)i
(is)g(appropriate.)71 437 y(The)f(called)g(routine)f(is)h(presented)g(with)f
(its)h(protocol)f(object,)h(the)g(session)f(object)g(from)i(the)f(lower)o
(-level)g(protocol,)0 494 y(and)h(the)g(message.)71 575 y Fg(Generic:)17
b Fk(xk)o(ern)p 361 575 13 2 v 15 w(return)p 488 575 V 16 w(t)12
b Fj(xDem)n(ux)d Fr(\()p Fk(X)o(Ob)r(j)j Ff(s)p Fr(,)g Fk(Msg)f
Fr(*)p Ff(msg)p Fr(\))71 656 y Fg(Speci\256c:)16 b Fk(xk)o(ern)p
361 656 V 15 w(return)p 488 656 V 16 w(t)c Fj(udp)p 626 656
17 2 v 20 w(dem)n(ux)e Fr(\()p Fk(X)o(Ob)r(j)i Ff(self)p Fr(,)g
Fk(X)o(Ob)r(j)g Ff(lls)p Fr(,)g Fk(Msg)g Fr(*)p Ff(msg)p Fr(\))0
779 y Fm(2.2.14)45 b(xCallDemux)0 866 y Fr(This)16 b(call)i(is)e(like)h
Fq(xDemux)h Fr(but)e(allows)h(an)g(ar)o(gument)g(to)g(contain)g(a)g(return)h
(message.)35 b(Used)17 b(with)f(synchronous)0 922 y(\(RPC-like\))c
(protocols.)71 1004 y Fg(Generic:)17 b Fk(xk)o(ern)p 361 1004
13 2 v 15 w(return)p 488 1004 V 16 w(t)12 b Fj(xCallDem)n(ux)d
Fr(\()p Fk(X)o(Ob)r(j)j Ff(s)p Fr(,)g Fk(Msg)f Fr(*)p Ff(msg)p
Fr(,)g Fk(Msg)h Fr(*)p Ff(rmsg)p Fr(\))71 1085 y Fg(Speci\256c:)k
Fk(xk)o(ern)p 361 1085 V 15 w(return)p 488 1085 V 16 w(t)c
Fj(udp)p 626 1085 17 2 v 20 w(calldem)n(ux)e Fr(\()p Fk(X)o(Ob)r(j)h
Ff(self)p Fr(,)h Fk(X)o(Ob)r(j)g Ff(lls)p Fr(,)h Fk(Msg)e Fr(*)p
Ff(msg)p Fr(,)h Fk(Msg)f Fr(*)p Ff(rmsg)p Fr(\))0 1208 y Fm(2.2.15)45
b(xDuplicate)0 1295 y Fr(Increments)10 b(the)f(reference)i(count)e(of)g
(session)f Fq(s)p Fr(.)16 b(This)9 b(can)h(be)f(used)g(to)h(create)g(a)g
(permanent)f(handle)g(on)h(the)f Fq(XObj)g Fr(from)0 1351 y(a)k(temporary)g
(handle,)g(or)f(to)h(create)g(a)g(new)g(equivalent)e(handle)h(from)h(an)g
(existing)e(handle.)21 b(For)13 b(a)g(full)f(discussion)e(of)0
1408 y(session)g(reference)i(counts,)e(see)i(section)e(11.)71
1489 y Fg(Generic:)17 b Fk(xk)o(ern)p 361 1489 13 2 v 15 w(return)p
488 1489 V 16 w(t)12 b Fj(xDuplicate)e Fr(\()p Fk(X)o(Ob)r(j)h
Ff(s)p Fr(\))71 1570 y Fg(Speci\256c:)16 b Fk(xk)o(ern)p 361
1570 V 15 w(return)p 488 1570 V 16 w(t)c Fj(udp)p 626 1570
17 2 v 20 w(duplicate)f Fr(\()p Fk(X)o(Ob)r(j)h Ff(self)p Fr(\))0
1693 y Fm(2.2.16)45 b(xShutDown)0 1780 y Fr(Called)12 b(once)g(for)g(each)h
(protocol)e(object)g(to)h(indicate)f(imminent)h(death)g(of)g(the)g
Fq(x)p Fr(-kernel.)20 b(A)12 b(protocol)e(may)j(choose)f(to)0
1836 y(take)f(actions)g(to)g(shut)f(down)g(in)h(a)h(graceful)g(manner)m(.)18
b(In)11 b(particular)n(,)h(boundary)e(protocols)g(may)h(choose)g(to)g(sever)h
(their)0 1893 y(connections)d(to)i(the)g(outside)f(world)g(in)h(an)g(orderly)
g(manner)h(on)e(receipt)h(of)h(this)e(call.)71 1949 y(Protocols)g(should)f
(generally)i(not)f(invoke)h(this)f(operation)g(on)h(other)f(protocols)g(or)h
(on)g(themselves.)16 b(It)11 b(is)g(typically)0 2006 y(invoked)f(by)h(the)g
Fq(x)p Fr(-kernel)g(infrastructure)f(itself.)71 2087 y Fg(Generic:)17
b Fk(xk)o(ern)p 361 2087 13 2 v 15 w(return)p 488 2087 V 16
w(t)12 b Fj(xSh)n(utDo)n(wn)g Fr(\()p Fk(X)o(Ob)r(j)g Ff(pr)o(otl)g
Fr(\))71 2169 y Fg(Speci\256c:)k Fk(xk)o(ern)p 361 2169 V 15
w(return)p 488 2169 V 16 w(t)c Fj(udp)p 626 2169 17 2 v 20
w(sh)n(utdo)n(wn)i Fr(\()p Fk(X)o(Ob)r(j)d Ff(self)p Fr(\))0
2293 y Fl(2.3)50 b(Graph)12 b(Manipulation)e(Operations)0 2380
y Fr(Unlike)15 b(the)i(previous)e(set)h(of)h(operations\320which)e(protocols)
g(invoke)g(on)h(each)h(other)g(to)f(open/close)f(connections)0
2436 y(and)e(to)g(send/receive)g(messages\320the)g(operations)g(de\256ned)g
(in)g(this)f(section)h(actually)f(manipulate)h(the)g(protocol)f(and)0
2493 y(session)c(graphs;)g(i.e,)j(create)f(nodes)e(and)h(edges.)16
b(These)8 b(operations)g(are)i(either)f(called)g(by)f(the)h
Fq(x)p Fr(-kernel)h(at)f(start-up)f(time)0 2549 y(to)14 b(create)g(and)g
(link)f(together)g(protocol)g(objects,)h(or)g(by)g(protocols)e(at)i(runtime)g
(to)f(create)i(and)f(link)f(together)g(session)0 2606 y(objects.)952
2753 y(16)p eop
%%Page: 17 17
16 bop 0 124 a Fm(2.3.1)45 b(xCr)o(eateSessn)0 211 y Fr(Called)11
b(by)f(protocol)g Fq(llp)g Fr(to)g(create)i(a)f(session)f(that)g(will)g
(handle)g(data)h(associated)f(with)g(a)h(common)g(source/destination)0
268 y(pair)m(.)22 b(Usually)12 b(called)h(in)f(response)h(to)f(an)h
Fq(xOpen)g Fr(call,)h(or)f(because)g(data)g(has)f(arrived)h(with)f
(participants)g(that)g(match)0 324 y(a)19 b(previous)f Fq(xOpenEnable)f
Fr(call.)40 b(By)19 b(convention,)g(a)h(protocol)d(will)h(only)g(create)i
(one)e(session)g(at)h(a)g(time)g(for)g(a)0 381 y(source/destination)8
b(pair)n(,)k(even)f(if)g(there)g(have)g(been)h(multiple)e Fq(xOpenEnable)p
Fr(')m(s)g(that)g(would)g(match)i(incoming)e(data.)71 437 y(The)d(session)g
(is)g(initialized)f(using)g(information)h(found)g(in)g(protocols)f
Fq(hlpRcv)p Fr(,)j Fq(hlpT)m(ype)e Fr(and)g Fq(llp)p Fr(.)15
b(The)8 b(new)f(session')m(s)0 494 y(up)14 b(pointer)f(is)g(set)h(to)f
Fq(hlpRcv)h Fr(\(this)f(is)g(where)h(upward-bound)f(messages)g(through)g
(this)g(session)f(will)h(be)h(delivered.\))0 550 y(The)d(count)f
Fq(downc)i Fr(indicates)e(how)g(many)i(lower)f(level)f(sessions)g(this)g
(session)g(will)g(use.)16 b(An)11 b(array)h(of)f(lower)g(sessions)0
606 y(themselves)i(is)g(passed)h(as)g Fq(downv)p Fr(.)24 b(Sessions)13
b(which)g(use)h(no)f(lower)h(sessions)e(may)i(pass)f(zero)i(for)f(both)f
Fq(downc)g Fr(and)0 663 y Fq(downv)m(.)20 b Fr(The)12 b(initialization)e
(function)h(pointer)g Fq(f)h Fr(may)h(be)g(null;)e(otherwise)h(this)f
(function)g(should)g(\256ll)h(in)g(the)g(interface)0 719 y(function)f
(pointers)g(in)h(the)g Fq(XObj)f Fr(structure.)19 b(These)12
b(pointers)f(are)i(initialized)d(to)i(default)g(\(usually)f(null\))g
(functions)g(by)0 776 y(the)g(system)g(initialization)d(code.)71
851 y Fk(X)o(Ob)r(j)h Fj(xCreateSessn)p Fr(\()p Fk(Pfv)f Ff(f)p
Fr(,)h Fk(X)o(Ob)r(j)h Ff(hlpRcv)p Fr(,)h Fk(X)o(Ob)r(j)e Ff(hlpT)l(ype)p
Fr(,)g Fk(X)o(Ob)r(j)g Ff(llp)p Fr(,)i Fk(in)o(t)d Ff(downc)p
Fr(,)j Fk(X)o(Ob)r(j)e Fr(*)p Ff(downv)p Fr(\))71 983 y Fg(Example)k(Init)f
(Function:)17 b Fk(v)o(oid)10 b Fj(udp)p 720 983 17 2 v 21
w(sessn)p 864 983 V 20 w(init)g Fr(\()p Fk(X)o(Ob)r(j)i Ff(self)p
Fr(\))0 1121 y Fm(2.3.2)45 b(xCr)o(eatePr)o(otl)0 1208 y Fr(Called)11
b(during)g(system)f(start-up)h(for)g(each)h(protocol)e(in)h(the)h(graph.)k
(The)c(function)e Fq(f)h Fr(is)g(called)g(to)g(initialize)f(a)i(protocol)0
1265 y(object.)k(It)10 b(must)g(have)h(a)g(well-known)e(name)i(derived)f
(from)i(the)e(concatenation)f(of)i(the)f(protocol)f(name)j(and)e(the)g
(string)0 1321 y(\252)p 23 1321 14 2 v 17 w Fq(init)p Fr(\272)15
b(\(e.g.,)k Fq(tcp)p 303 1321 V 16 w(init)p Fr(\).)32 b(The)16
b(initialization)e(generally)h(allocates)h(and)g(initializes)f(protocol)g
(state)h(and)g(\256lls)g(in)g(the)0 1378 y(interface)10 b(function)f
(pointers.)15 b(Because)c(function)d(pointers)h(are)i(initialized)d(to)i
(null)f(functions)f(before)i Fq(f)g Fr(is)g(called,)g(only)0
1434 y(those)g(functions)g(actually)g(used)h(by)g(the)g(protocol)e(need)j(be)
f(de\256ned.)71 1490 y(Use)e(of)i Fq(xCr)n(eatePr)n(otl)e Fr(outside)f(of)j
(initialization)o(,)d(e.g.,)k(to)d(dynamically)g(load)h(new)g(protocols,)f
(is)g(not)h(supported)e(at)0 1547 y(this)i(time.)114 1632 y
Fq(3.1)18 b(compatibility)e(note:)31 b Fr(Replaces)19 b(x)p
782 1632 V 16 w(instantiateprotl)d(and)i(x)p 1197 1632 V 16
w(createprotl)h(\(the)f(user)h(routine\))f(and)114 1688 y(eliminates)10
b(the)h(need)g(for)g(x)p 566 1688 V 16 w(getproc.)80 1773 y
Fk(X)o(Ob)r(j)g Fj(xCreateProtl)f Fr(\()i Fk(Pfv)f Ff(f)p Fr(,)g
Fk(c)o(har)h Fr(*)p Ff(name)p Fr(,)f Fk(c)o(har)h Fr(*)p Ff(instName)p
Fr(,)g Fk(in)o(t)f Fr(*)p Ff(traceV)-5 b(ar)p Fr(,)568 1830
y Fk(in)o(t)11 b Ff(downc)p Fr(,)h Fk(X)o(Ob)r(j)g Fr(*)p Ff(downv)f
Fr(\))71 1933 y Fg(Example)i(Init)f(Function:)17 b Fk(v)o(oid)10
b Fj(udp)p 720 1933 17 2 v 21 w(init)g Fr(\()p Fk(X)o(Ob)r(j)i
Ff(self)p Fr(\))0 2053 y Fm(2.3.3)45 b(xDestr)o(oy)0 2140 y
Fr(Destroys)12 b(protocol)f(and)i(session)f(objects.)21 b(It)13
b(is)f(the)h(inverse)g(of)g Fq(xCr)n(eateSessn)f Fr(and)h Fq(xCr)n(eatePr)n
(otl)p Fr(.)21 b(Storage)13 b(for)g(the)0 2196 y Fq(XObj)d
Fr(is)h(freed,)h(and)f(if)g(the)g(state)g(pointer)f(of)h(the)g
Fq(XObj)f Fr(is)h(non-null,)f(it)g(is)h(also)g(freed.)71 2271
y Fk(xk)o(ern)p 173 2271 13 2 v 15 w(return)p 300 2271 V 16
w(t)h Fj(xDestro)n(y)p Fr(\()p Fk(X)o(Ob)r(j)e Ff(object)p
Fr(\))0 2410 y Fm(2.3.4)45 b(xGetPr)o(otlByName)0 2497 y Fr(Returns)12
b(a)h(capability)e(for)i(a)g(protocol)e(object)h(given)g(its)g(mnemonic)h
(name.)21 b(\(See)14 b(the)e(discussion)e(of)j(graph.comp)g(in)0
2553 y(section)d(12.\))71 2629 y Fk(X)o(Ob)r(j)h Fj(xGetProtlByName)d
Fr(\()p Fk(c)o(har)k Fr(*)p Ff(name)f Fr(\))952 2753 y(17)p
eop
%%Page: 18 18
17 bop 0 124 a Fm(2.3.5)45 b(xSetDown)0 211 y Fr(Sets)10 b(the)h
Fq(index)p Fr(th)e(member)j(of)f Fq(self)p Fr(')m(s)f(down)f(vector)i(to)f
(be)g Fq(object)p Fr(.)16 b(It)11 b(sets)e(or)i(increments)f(the)g
Fq(XObj)g Fr(\256eld)h Fq(numdown)e Fr(as)0 268 y(a)j(side)e(ef)o(fect.)71
348 y Fk(xk)o(ern)p 173 348 13 2 v 15 w(return)p 300 348 V
16 w(t)i Fj(xSetDo)n(wn)f Fr(\()p Fk(X)o(Ob)r(j)h Ff(self)p
Fr(,)g Fk(in)o(t)f Ff(index)p Fr(,)h Fk(X)o(Ob)r(j)g Ff(object)p
Fr(\))0 470 y Fm(2.3.6)45 b(xGetDown)0 557 y Fr(Returns)11
b(the)h Fq(index)p Fr(th)f(member)i(of)f Fq(self)p Fr(')m(s)f(down)g(vector)m
(.)19 b(Returns)12 b Fq(ERR)p 1178 557 14 2 v 15 w(XOBJ)g Fr(if)g(the)f
(index)g(is)h(lar)o(ger)g(than)f(the)h(down)0 613 y(vector)m(.)71
693 y Fk(X)o(Ob)r(j)f Fj(xGetDo)n(wn)h Fr(\()p Fk(X)o(Ob)r(j)f
Ff(self)p Fr(,)h Fk(in)o(t)f Ff(index)p Fr(\))0 815 y Fm(2.3.7)45
b(xSetUp)0 902 y Fr(Resets)9 b(the)h(up)f(pointer)g(of)g(session)f
Fq(s)i Fr(to)f Fq(hlp)p Fr(.)15 b(The)10 b(up)f(pointer)f(of)i(a)g(session)e
(is)h(initialized)f(in)h Fq(xCr)n(eateSessn)p Fr(,)h(so)f Fq(xSetUp)0
959 y Fr(is)i(only)f(used)h(for)g(extraordinary)f(manipulation)f(of)j(the)f
(session)e(graph.)71 1039 y Fk(v)o(oid)h Fj(xSetUp)h Fr(\()p
Fk(X)o(Ob)r(j)g Ff(s)p Fr(,)h Fk(X)o(Ob)r(j)g Ff(hlp)p Fr(\))0
1161 y Fm(2.3.8)45 b(xGetUp)0 1248 y Fr(Returns)11 b(the)g(up)f(pointer)h(of)
g(session)f Fq(s)p Fr(.)71 1328 y Fk(X)o(Ob)r(j)h Fj(xGetUp)g
Fr(\()p Fk(X)o(Ob)r(j)h Ff(s)p Fr(\))0 1450 y Fm(2.3.9)45 b(xHlpT)m(ype)0
1537 y Fr(Returns)11 b(the)g Fq(hlpT)m(ype)f Fr(ar)o(gument)h(that)g(was)g
(used)g(to)f(create)i(session)e Fq(s.)71 1617 y Fk(X)o(Ob)r(j)h
Fj(xHlpT)n(yp)r(e)f Fr(\()p Fk(X)o(Ob)r(j)i Ff(s)p Fr(\))0
1740 y Fl(2.4)63 b(Utility)11 b(Operations)0 1827 y Fm(2.4.1)45
b(xIsPr)o(otocol)0 1914 y Fr(Returns)11 b(true)g(if)g(the)g
Fq(XObj)f Fr(is)h(a)g(protocol.)71 1994 y Fk(b)q(o)q(ol)f Fj(xIsProto)r(col)g
Fr(\()i Fk(X)o(Ob)r(j)f Fr(\))0 2116 y Fm(2.4.2)45 b(xIsSession)0
2203 y Fr(Returns)11 b(true)g(if)g(the)g Fq(XObj)f Fr(is)h(a)g(session.)71
2283 y Fk(b)q(o)q(ol)f Fj(xIsSession)h Fr(\()g Fk(X)o(Ob)r(j)h
Fr(\))0 2405 y Fm(2.4.3)45 b(xIsXObj)0 2492 y Fr(Returns)11
b(true)h(if)g(the)f Fq(XObj)g Fr(is)g(either)g(a)h(session)f(or)g(a)h
(protocol)f(\(i.e.,)i(if)e(this)g(returns)g(false)h(the)f Fq(XObj)g
Fr(was)h(either)f(never)0 2549 y(initialized)e(or)i(has)g(been)h(badly)e
(clobbered.\))71 2629 y Fk(b)q(o)q(ol)g Fj(xIsX)n(Ob)s(j)i
Fr(\()g Fk(X)o(Ob)r(j)g Fr(\))952 2753 y(18)p eop
%%Page: 19 19
18 bop 0 124 a Fm(2.4.4)45 b(xIsV)l(alidXObj)0 211 y Fr(XObjects)9
b(created)i(with)f(xCreateSessn)g(or)h(xCreateProtl)f(are)h(kept)f(in)g(a)h
(system)f(map)h(and)f(removed)h(when)f(the)g(object)0 268 y(is)i(destroyed.)
20 b Fq(xIsV)-5 b(alidXObj)10 b Fr(can)j(be)g(used)f(to)h(determine)f
(whether)h(a)g(random)f(XObject)g(handle)g(is)g(in)h(this)e(map)i(and)0
324 y(can)e(thus)g(be)g(used)g(safely)m(.)71 406 y Fk(b)q(o)q(ol)f
Fj(xIsV)-5 b(alidX)n(Ob)s(j)13 b Fr(\()e Fk(X)o(Ob)r(j)h Fr(\))0
528 y Fm(2.4.5)45 b(xPrintXObj)0 615 y Fr(Displays)9 b(some)j(information)e
(about)g(the)h(state)g(of)g(the)g Fk(X)o(Ob)r(j)p Fr(.)71 697
y Fk(b)q(o)q(ol)f Fj(xPrin)n(tX)n(Ob)s(j)j Fr(\()e Fk(X)o(Ob)r(j)h
Fr(\))0 821 y Fl(2.5)50 b(Usage)13 b(Rules)0 908 y Fr(This)f(section)h(has)g
(some)g(protocol)f(design)g(rules)h(that)g(protocol)f(writers)g(should)g
(follow)g(in)h(order)g(to)g(develop)f(\252well-)0 964 y(behaved\272)f
(protocols)f(that)g(interact)h(properly)f(with)g(other)h(protocols)f(with)g
(which)g(they)h(might)f(be)i(composed.)0 1087 y Fm(2.5.1)45
b(Initializing)10 b(a)h(Pr)o(otocol)0 1174 y Fr(At)j(system)h(boot)f(time,)i
(the)e Fq(x)p Fr(-kernel)i(calls)e(xCreateProtocol)g(for)i(each)f(protocol)e
(con\256gured)i(into)f(the)g(kernel)h(\(see)0 1230 y(section)9
b(12\).)16 b(xCreateProtocol,)10 b(in)g(turn,)g(calls)g(the)g(protocol')m(s)f
(init)g(routine,)g(where)i(for)f(a)g(protocol)f(named)i(`yap',)f(this)0
1287 y(initialization)e(routine)i(must)h(be)g(named)h(`yap)p
752 1287 14 2 v 16 w(init'.)k(Generally)m(,)11 b(this)f(routine)g(does)g(the)
h(following)e(work.)0 1393 y Fe(void)0 1450 y(yap_init\(self)q(\))109
1506 y(XObj)28 b(self;)0 1562 y({)109 1619 y(/*)g(fill)g(in)g(protocol-spec)q
(ific)j(operations)f(*/)109 1675 y(self->open)g(=)e(yap_open;)109
1732 y(self->demux)i(=)e(yap_demux;)109 1788 y(.)g(.)f(.)109
1901 y(/*)h(create)h(and)f(initialize)i(protocol-speci)q(fic)h(state,)e
(including)g(maps)g(*/)109 1958 y(self->state)h(=)e(xMalloc\()h
(sizeof\(struc)q(t)h(yap_state\))g(\);)109 2014 y(.)e(.)f(.)109
2127 y(/*)h(get)g(handle)h(for,)f(and)g(register)i(with,)e(lower-level)j
(protocol)e(*/)109 2183 y(llp)f(=)g(xGetDown\(self,)j(0\)\);)109
2240 y(partInit\(&par)q(t,)f(1\);)109 2296 y(partPush\(part)q(,)g(ANY_HOST,)g
(0\);)109 2353 y(xOpenEnable\(s)q(elf,)h(self,)e(llp,)f(&part\);)0
2409 y(})952 2753 y Fr(19)p eop
%%Page: 20 20
19 bop 0 124 a Fm(2.5.2)45 b(hlpRcv)12 b(and)f(hlpT)m(ype)0
211 y Fr(The)f(operations)e Fq(xOpen)p Fr(,)i Fq(xOpenEnable)p
Fr(,)f(and)h Fq(xOpenDisable)e Fr(take)i(two)f(high-level)f(protocols,)h
Fq(hlpRcv)g Fr(and)h Fq(hlpT)m(ype)p Fr(.)0 268 y Fq(hlpRcv)g
Fr(is)g(the)h(protocol)e(to)h(which)g(the)g(new)h(lower)f(session)f(should)h
(route)g(incoming)f(messages.)17 b(The)10 b(lower)g(protocol)0
324 y(uses)15 b Fq(hlpRcv)h Fr(as)g(the)g(hlp)f(ar)o(gument)h(to)g
Fq(xCr)n(eateSessn)p Fr(.)30 b(The)16 b(lower)g(protocol)f(uses)g
Fq(hlpT)m(ype)g Fr(to)h(determine)g(which)0 381 y(messages)g(the)f(new)h
(session)f(should)f(handle.)30 b(For)16 b(example,)i(when)d
Fq(ethOpen)h Fr(is)f(called)h(with)e(IP)j(as)f(the)g Fq(hlpT)m(ype)p
Fr(,)0 437 y(ETH)c(knows)g(that)f(the)i(new)f(session)f(will)h(deal)g(with)g
(packets)g(that)g(have)g(the)g(IP)i(ethernet)e(type.)20 b(The)12
b(lower)h(protocol)0 494 y(typically)c(determines)i(the)f(number)h(that)g
(corresponds)f(to)g Fq(hlpT)m(ype)g Fr(by)h(using)e(it)i(in)f(a)i(call)e(to)h
Fq(r)n(elPr)n(otNum)f Fr(\(see)h(section)0 550 y(13.1.\))71
606 y(Most)e(protocols)f(use)i(their)f Fq(self)g Fr(pointer)g(as)h(both)e
Fq(hlpRcv)h Fr(and)h Fq(hlpT)m(ype)f Fr(when)h(making)f(these)g(calls,)h
(though)e(virtual)0 663 y(protocols)i(\(see)h(below\))g(are)h(the)e
(exception.)0 786 y Fm(2.5.3)45 b(Pr)o(otocol)11 b(Realms)0
873 y Fr(Although)h(the)i Fq(x)p Fr(-kernel)g(de\256nes)g(a)g(single)f
(interface)h(for)g(all)g(protocols,)f(not)h(all)f(protocols)g(are)h(created)h
(equal.)24 b(Our)0 929 y(experience)13 b(is)f(that)h(protocols)e(can)i(be)g
(classi\256ed)f(into)g(dif)o(ferent)h(categories,)g(which)f(we)h(call)g
(realms.)22 b(Chances)13 b(are,)0 985 y(any)d(protocol)f(you)g(write)h(falls)
f(into)g(one)h(of)g(the)g(following)e(realms.)16 b(In)10 b(some)h(cases,)f
(the)g(realm)h(into)e(which)g(a)i(protocol)0 1042 y(falls)i(de\256nes)g(both)
f(a)i(restricted)e(subset)h(of)g(the)g(interface)g(that)g(the)g(protocol)f
(implements,)h(and)h(the)f(set)f(of)i(protocols)0 1098 y(with)c(which)h(it)f
(may)i(be)f(composed.)0 1221 y Fm(Asynchr)o(onous)g(Pr)o(otocols)0
1290 y Fr(Most)20 b(protocols\320e.g.,)i(protocols)c(like)i(IP)-5
b(,)21 b(TCP)-5 b(,)21 b(and)f(UDP\320fall)g(in)g(this)e(category)m(.)44
b(The)19 b Fq(x)p Fr(-kernel)i(supports)0 1346 y(asynchronous)12
b(protocols)f(through)h(the)h(use)g(of)h Fq(xPush)p Fr(,)f
Fq(xPop)g Fr(and)h Fq(xDemux)f Fr(operations.)22 b(Asynchronous)11
b(protocols)0 1403 y(are)21 b(typically)d(symmetric)i(in)f(the)h(sense)f
(that)h(the)f(protocols')g(sessions)f(process)h(both)g(incoming)g(and)g
(outgoing)0 1459 y(messages.)d(While)9 b(it)h(seems)g(possible)e(for)i
(asynchronous)f(protocols)f(to)i(have)g(asymmetric)g(sessions)e(\(a)i(given)g
(session)0 1516 y(can)j(handle)f(only)f(incoming)g(or)i(outgoing)d(messages,)
j(but)f(not)g(both\),)g(we)g(have)h(thus)e(far)i(been)g(able)f(to)g(make)h
(all)f(our)0 1572 y(asynchronous)f(protocols)h(symmetric,)h(and)g(we)g
(strongly)f(encourage)h(such)f(designs.)21 b(Knowing)11 b(that)h(any)h
(low-level)0 1629 y(protocols)c(one)h(may)h(use)f(are)i(symmetric)e(enhances)
h(one')m(s)f(ability)f(to)h(compose)g(protocols)f(and)i(makes)f(implementing)
0 1685 y(a)i(given)e(protocol)g(much)h(easier)m(.)0 1808 y
Fm(Synchr)o(onous)h(Pr)o(otocols)0 1877 y Fr(These)17 b(are)h(RPC)h
(protocols.)34 b(They)17 b(are)h(typically)e(asymmetric)h(in)g(the)h(sense)f
(that)g(client-side)f(sessions)f(and)i(the)0 1933 y(server)o(-side)c
(sessions)e(are)i(quite)f(dif)o(ferent.)22 b(The)13 b Fq(x)p
Fr(-kernel)g(explicitly)e(supports)g(synchronous/asymmetric)g(sessions)0
1990 y(through)f(the)g(use)h(of)g Fq(xCall)p Fr(,)g Fq(xCallPop)f
Fr(and)h Fq(xCallDemux)p Fr(.)k(Since)d(synchronous)c(protocols)i(are)h
(asymmetric,)h Fq(xCall)f Fr(is)0 2046 y(used)g(on)f(the)h(client)g(side)f
(and)h Fq(xCallPop)f Fr(and)h Fq(xCallDeumx)g Fr(are)h(used)f(on)f(the)h
(server)h(side.)71 2102 y(Note)g(that)g(some)h(protocols)f(lie)g(on)h(the)f
(boundary)g(between)h(the)f(synchronous)f(and)i(asynchronous)e(realms.)22
b(For)0 2159 y(example,)10 b(a)g(protocol)f(that)f(implements)h(RPC)i(\(as)f
(opposed)e(to)h(one)g(that)g(uses)g(it\))g(probably)g(looks)f(asynchronous)g
(from)0 2215 y(the)k(bottom)f(\(i.e.,)i(lower)e(level)h(protocols)e(call)i
(its)f Fq(xPop)g Fr(routine\),)h(but)f(synchronous)f(from)i(above)g(\(i.e.,)h
(higher)f(level)0 2272 y(protocols)e(call)h(its)f Fq(xCall)h
Fr(routine\).)0 2394 y Fm(Contr)o(ol)g(Pr)o(otocols)0 2463
y Fr(These)18 b(protocols)g(support)f(neither)h(a)h Fq(xPush/xPop)e
Fr(nor)i(a)g Fq(xCall/xCallPop)e Fr(interface.)39 b(T)m(ypically)m(,)19
b(only)f(control)0 2520 y(operations)10 b(may)h(be)h(performed)f(on)g(these)g
(protocols.)k(ARP)d(and)f(ICMP)h(fall)f(into)f(this)g(category)m(.)952
2753 y(20)p eop
%%Page: 21 21
20 bop 0 124 a Fm(2.5.4)45 b(Anchor)12 b(Pr)o(otocols)0 211
y Fr(Anchor)f(protocols)e(sit)h(either)h(at)g(the)g(top)f(or)h(the)g(bottom)f
(of)h(a)g(protocol)f(stack)h(and)f(provide)g(an)i(interface)f(between)f(the)0
268 y Fq(x)p Fr(-kernel)g(and)g(the)f(system)h(in)f(which)g(the)h
Fq(x)p Fr(-kernel)g(is)f(embedded.)16 b(T)m(op-level)9 b(anchor)h(protocols)e
(look)h(like)g(an)h Fq(x)p Fr(-kernel)0 324 y(protocol)i(from)i(the)f
(bottom,)h(but)e(provide)h(an)g(Application)f(Programmer)i(Interface)h(to)e
(the)g Fq(x)p Fr(-kernel)h(\(see)f(appendix)0 381 y(C.\))31
b(Bottom-level)15 b(anchor)h(protocols)e(\(e.g.,)k(device)e(drivers\))f(look)
g(like)g(a)i(protocol)d(from)j(the)e(top,)i(but)e(typically)0
437 y(interface)c(with)g(the)f(lower)h(levels)g(of)g(the)g(surrounding)e
(system)i(or)g(with)f(network)g(hardware.)71 494 y(W)n(riting)f(anchor)i
(protocols)f(involves)f(careful)i(synchronization)e(of)i(external)f(threads)h
(with)f Fq(x)p Fr(-kernel)h(threads)f(and)0 550 y(objects.)16
b(See)c(section)e(7.5.3.)0 673 y Fm(2.5.5)45 b(V)n(irtual)11
b(Pr)o(otocols)0 760 y Fr(V)m(irtual)e(protocols)f(occupy)h(places)h(in)f
(the)g(protocol)g(\(and)g(sometimes)h(the)f(session\))g(graphs,)g(but)g(they)
g(neither)h(produce)0 816 y(nor)f(interpret)g(network)g(headers.)16
b(They)9 b(typically)f(make)i(decisions)e(about)h(how)g(messages)h(should)e
(be)i(routed)f(through)0 873 y(the)i(session)f(graph)g(based)h(on)g
(participants)f(in)g Fq(xOpen)h Fr(or)h(on)e(properties)g(of)i(messages,)f
(such)g(as)g(size.)71 929 y(The)g Fq(xOpen)p Fr(,)h Fq(xOpenEnable)p
Fr(,)f(and)g Fq(xOpenDisable)f Fr(routines)g(of)i(virtual)e(protocols)g(dif)o
(fer)i(from)g(those)f(of)h(conven-)0 985 y(tional)g(protocols.)21
b(A)14 b(virtual)e(protocol')m(s)g(implementation)g(of)h Fq(xOpen)p
Fr(,)h(for)g(example,)g(will)e(usually)g(make)i(an)f Fq(xOpen)0
1042 y Fr(call)c(to)g(its)f(lower)h(protocols)e(using)h(the)h
Fq(hlpT)m(ype)f Fr(that)h(was)g(passed)f(into)g(the)h(virtual)f(protocol,)g
(but)h(using)f(its)g Fq(self)g Fr(pointer)0 1098 y(as)14 b
Fq(hlpRcv)p Fr(.)23 b(This)13 b(allows)f(arbitrary)i(chains)f(of)h(virtual)e
(protocols)g(to)h(insert)g(their)g(sessions)f(between)i(the)f(upper)g(and)0
1155 y(lower)j(conventional)e(sessions)h(while)g(still)g(passing)g(\252type)h
(information\272)f(from)i(the)f(upper)g(protocol)f(to)g(the)i(lower)0
1211 y(protocol.)71 1268 y(Note)7 b(that)h(virtual)f(protocols)f(can)j(be)f
(either)g(synchronous)e(\(support)h(the)h Fq(xCall)p Fr(/)p
Fq(xCallPop)p Fr(/)p Fq(xCallDemu)o(x)e Fr(interface\))0 1324
y(or)11 b(asynchronous)f(\(support)f(the)i Fq(xPush)p Fr(/)p
Fq(xPop)p Fr(/)p Fq(xDemux)e Fr(interface\).)0 1448 y Fl(2.6)50
b(Default)11 b(Operations)0 1535 y Fr(Since)e(many)g(protocols')e(UPI)i
(operations)e(look)h(very)h(similar)n(,)g(the)f Fq(x)p Fr(-kernel)h(provides)
f(some)h(library)f(operations)f(which)0 1592 y(do)12 b(much)h(of)f(the)g
(standard)g(work)g(of)g(some)h(of)f(the)h(operations.)18 b(Many)13
b(protocols)e(can)i(call)f(these)g(default)g(operations)0 1648
y(and)f(greatly)g(simplify)e(their)i(own)g(implementations)e(of)i(these)g
(routines.)0 1771 y Fm(2.6.1)45 b(defaultOpenEnable)0 1858
y Fr(Binds)12 b Fq(key)i Fr(to)e(an)h(enable)g(object)f(with)g
Fq(hlpRcv)h Fr(and)f Fq(hlpT)m(ype)p Fr(.)22 b(If)13 b(a)g(previous)f
(binding)f(exists)h(for)h(the)f(given)h(key)f(and)0 1914 y
Fq(hlp)p Fr(s,)g(the)h(reference)h(count)e(of)h(that)f(enable)g(object)g
(will)g(be)h(increased.)21 b Fq(defaultOpenEnabl)o(e)10 b Fr(will)i(fail)h
(if)f(a)h(previous)0 1971 y(binding)c(exists)h(for)i(this)e(key)h(that)f
(does)h(not)f(match)i(the)f Fq(hlp)p Fr(s.)71 2052 y Fk(xk)o(ern)p
173 2052 13 2 v 15 w(return)p 300 2052 V 16 w(t)h Fj(defaultOp)r(enEnable)d
Fr(\()j Fk(Map)f Ff(m)p Fr(,)h Fk(X)o(Ob)r(j)g Ff(hlpRcv)p
Fr(,)g Fk(X)o(Ob)r(j)g Ff(hlpT)l(ype)p Fr(,)f Fk(v)o(oid)f
Fr(*)p Ff(key)g Fr(\))0 2175 y Fm(2.6.2)45 b(defaultOpenDisable)0
2262 y Fr(Undoes)12 b(the)i(ef)o(fect)g(of)f(a)h(previous)e
Fq(defaultOpenEnable.)20 b Fr(Returns)13 b(failure)g(if)h(no)f(appropriate)g
(enable)g(object)f(exists)0 2318 y(\(e.g.,)g(if)g(nothing)d(exists)h(for)h
(the)g(given)f(key)h(or)h(if)f(the)g Fq(hlp)p Fr(s)f(don')o(t)g(match)i(the)f
(saved)g(values)f(in)h(the)g(enable)g(object.\))71 2400 y Fk(xk)o(ern)p
173 2400 V 15 w(return)p 300 2400 V 16 w(t)h Fj(defaultOp)r(enDisable)d
Fr(\()j Fk(Map)f Ff(m)p Fr(,)h Fk(X)o(Ob)r(j)f Ff(hlpRcv)p
Fr(,)i Fk(X)o(Ob)r(j)f Ff(hlpT)l(ype)p Fr(,)e Fk(v)o(oid)h
Fr(*)p Ff(key)f Fr(\))952 2753 y(21)p eop
%%Page: 22 22
21 bop 0 124 a Fm(2.6.3)45 b(defaultOpenDisableAll)0 211 y
Fr(Removes)12 b(all)f(enable)h(objects)e(bound)h(in)g Fq(map)g
Fr(with)f Fq(hlpRcv)p Fr(.)18 b(If)12 b Fq(f)f Fr(is)g(non-zero,)h(it)f(is)g
(called)h(with)e(the)i(\()p Fq(key)p Fr(,)h Fq(Enable)d Fr(*\))0
268 y(pair)h(for)g(each)h Fq(Enable)e Fr(object)h(in)f(the)h(map)h(before)f
(it)g(is)g(removed.)71 349 y Fk(xk)o(ern)p 173 349 13 2 v 15
w(return)p 300 349 V 16 w(t)h Fj(defaultOp)r(enDisableAll)d
Fr(\()i Fk(Map)g Ff(m)p Fr(,)h Fk(X)o(Ob)r(j)g Ff(hlpRcv)p
Fr(,)g Fk(DisableAllF)m(unc)f Ff(f)g Fr(\))71 430 y Fk(t)o(yp)q(edef)j(v)o
(oid)d Fr(\()p Fj(*DisableAllF)-5 b(unc)10 b Fr(\))i(\()f Fk(v)o(oid)g
Fr(*)p Ff(key)p Fr(,)g Fk(Enable)g Fr(*)p Ff(e)g Fr(\))0 553
y Fm(2.6.4)45 b(defaultV)n(irtualOpenEnable)0 640 y Fr(Designed)16
b(to)g(be)h(used)g(by)f(virtual)g(protocols.)32 b(In)17 b(addition)e(to)i
(the)f(binding)f(performed)j(by)e Fq(defaultOpenEnabl)o(e)p
Fr(,)0 697 y(an)f Fq(xOpenEnable)f Fr(is)h(performed)h(on)f(each)h(lower)f
(protocol)f(in)h(the)g(null-terminated)f(array)i Fq(llp)f Fr(\(using)f
(participants)0 753 y Fq(p)p Fr(,)j(causing)d(the)h(lower)g(protocols)e(to)i
(deliver)g(packets)g(for)g Fq(hlpT)m(ype)g Fr(to)f(the)h(virtual)f(protocol)g
Fq(self)p Fr(.)29 b(If)15 b(any)g(of)h(these)0 809 y Fq(xOpenEnable)p
Fr(s)9 b(fail,)j Fq(defaultV)m(irt)o(ual)o(OpenEn)o(able)c
Fr(backs)j(out)f(of)i(the)f(entire)f(operation.)71 866 y(Assumes)g(that)h
(the)g(passive)f(map)h(is)g(keyed)g(on)g Fq(hlpT)m(ype)p Fr(.)71
997 y Fk(xk)o(ern)p 173 997 V 15 w(return)p 300 997 V 16 w(t)h
Fj(defaultVirtualOp)r(enEnable)d Fr(\()i Fk(X)o(Ob)r(j)h Ff(self)p
Fr(,)g Fk(Map)f Ff(m)p Fr(,)h Fk(X)o(Ob)r(j)g Ff(hlpRcv)p Fr(,)g
Fk(X)o(Ob)r(j)g Ff(hlpT)l(ype)p Fr(,)1024 1054 y Fk(X)o(Ob)r(j)g
Fr(*)p Ff(llp)p Fr(,)h Fk(P)o(art)e Fr(*)p Ff(p)g Fr(\))0 1176
y Fm(2.6.5)45 b(defaultV)n(irtualOpenDisable)0 1263 y Fr(Undoes)10
b(the)h(ef)o(fect)h(of)f(a)h(previous)e Fq(defaultV)m(irt)o(ualO)o(penEn)o
(able)p Fr(.)71 1394 y Fk(xk)o(ern)p 173 1394 V 15 w(return)p
300 1394 V 16 w(t)i Fj(defaultVirtualOp)r(enDisable)d Fr(\()i
Fk(X)o(Ob)r(j)h Ff(self)p Fr(,)g Fk(Map)f Ff(m)p Fr(,)h Fk(X)o(Ob)r(j)f
Ff(hlpRcv)p Fr(,)1037 1451 y Fk(X)o(Ob)r(j)h Ff(hlpT)l(ype)p
Fr(,)f Fk(X)o(Ob)r(j)g Fr(*)p Ff(llp)p Fr(,)i Fk(P)o(art)e
Fr(*)p Ff(p)g Fr(\))0 1573 y Fm(2.6.6)45 b(Usage)0 1660 y Fr(Here)12
b(is)e(an)i(example)f(of)g(how)g(a)g(protocol)f(might)h(simplify)f(its)g
Fq(enable)p Fr(/)p Fq(disable)e Fr(routines)i(using)g(these)h(operations:)0
1823 y Fe(static)29 b(xkern_return_t)0 1880 y(yapOpenEnable)q(\()h(XObj)e
(self,)h(XObj)f(hlpRcv,)i(XObj)e(hlpType,)h(Part)g(*p)f(\))0
1936 y({)109 1993 y(long)110 b(key;)109 2049 y(PState)56 b(*ps)28
b(=)g(self->state;)109 2162 y(key)g(=)g(getRelProtNum\()q(hlpT)q(ype,)j
(self\)\);)109 2218 y(return)e(defaultOpenEn)q(able)q(\(ps-)q(>pa)q(ssiv)q
(e_ma)q(p,)i(hlpRcv,)e(hlpType,)g(&key\);)0 2275 y(})0 2388
y(static)g(xkern_return_t)0 2444 y(yapOpenDisabl)q(e\()h(XObj)f(self,)f(XObj)
h(hlpRcv,)g(XObj)f(hlpType,)i(Part)e(*p)g(\))0 2501 y({)109
2557 y(long)110 b(key;)109 2614 y(PState)56 b(*ps)28 b(=)g(self->state;)952
2753 y Fr(22)p eop
%%Page: 23 23
22 bop 109 181 a Fe(key)28 b(=)g(getRelProtNum\()q(hlpT)q(ype,)j(self\)\);)
109 237 y(return)e(defaultOpenDi)q(sabl)q(e\(ps)q(->p)q(assi)q(ve_m)q(ap,)i
(hlpRcv,)e(hlpType,)g(&key\);)0 294 y(})0 407 y(static)g(xkern_return_t)0
463 y(yapOpenDisabl)q(eAll)q(\()h(XObj)f(self,)f(XObj)h(hlpRcv)f(\))0
519 y({)109 576 y(PState)56 b(*ps)28 b(=)g(self->state;)109
689 y(return)h(defaultOpenDi)q(sabl)q(eAll)q(\(ps)q(->pa)q(ssiv)q(e_m)q(ap,)i
(hlpRcv,)e(0\);)0 745 y(})952 2753 y Fr(23)p eop
%%Page: 24 24
23 bop 0 124 a Fn(3)60 b(Participant)13 b(Library)0 228 y Fr(Participant)k
(lists)f(identify)g(members)i(of)g(a)g(session)e(and)i(are)g(used)f(for)h
(opening)e(connections.)34 b(Upper)18 b(protocols)0 284 y(interested)11
b(in)g(establishing)e(a)k(connection)d(will)h(construct)g(the)g(participant)g
(list)g(and)g(pass)h(it)f(to)g(the)h(lower)g(protocol)e(as)0
340 y(a)j(parameter)h(of)f(an)h(open)e(routine.)21 b(The)13
b(lower)g(protocol)f(will)g(then)g(extract)h(information)f(from)i(the)e
(participant)g(list,)0 397 y(possibly)d(passing)h(the)h(participant)e(list)h
(on)h(to)g(its)f(own)h(lower)g(protocol.)71 453 y(Each)h(participant)g(in)g
(the)g(list)g(contains)f(a)i(participant)f(address)g(stack,)h(designed)f(to)g
(facilitate)g(a)h(general)g(method)0 510 y(of)f(communicating)f(encapsulated)
g(address)g(information)g(between)g(protocol)g(layers.)18 b(By)12
b(using)f(pointers)f(to)i(address)0 566 y(information,)h(one)h(layer)f(can)h
(pass)f(address)g(information)g(through)f(a)i(lower)f(layer)g(without)f
(having)h(the)g(lower)g(layer)0 623 y(manipulate)c(the)g(address)g
(information)f(at)i(all,)g(not)f(even)g(by)g(copying.)15 b(The)9
b(address)h(information)e(for)i(each)g(participant)0 679 y(is)18
b(kept)g(as)g(a)h(stack)f(of)h Fq(void)f(*)g Fr(pointers)f(to)h(address)g
(components)g(and)g(the)g(lengths)f(of)i(each)g(component.)37
b(The)0 736 y(component)10 b(pointers)g(are)i(pushed)e(or)h(popped)g(onto)f
(the)h(stack)f(by)h(utility)e(functions.)0 860 y Fl(3.1)50
b(T)l(ype)13 b(De\256nitions)0 947 y Fr(The)7 b(participant)g(data)g
(structure)g(is)g(used)g(to)g(collect)g(addressing)f(information)g(for)i
(opening)e(connections.)14 b(A)8 b(participant)0 1003 y(list)k(is)h
(de\256ned)g(to)g(be)h(an)f(array)h(of)f(type)g Fq(Part)p Fr(,)h(and)f(a)g
Fq(PartStack)f Fr(is)h(the)g(main)h(\256eld)f(in)g(a)h(single)e
Fq(Part)p Fr(.)22 b(The)13 b(\256elds)g(of)0 1060 y(these)e(structures)f
(should)f(not)i(be)g(directly)f(accessed)i(by)f(the)f(protocol)g(developer)m
(.)102 1166 y(#de\256ne)196 b(P)l(AR)m(T)p 544 1166 14 2 v
16 w(MAX)p 666 1166 V 17 w(ST)l(ACK)73 b(20)102 1223 y Fk(t)o(yp)q(edef)15
b(struct)e Fi(f)205 1279 y Fr(struct)d Fi(f)284 1335 y Fk(v)o(oid)j(*)37
b Fr(ptr;)284 1392 y Fk(in)o(t)98 b Fr(len;)205 1448 y Fi(g)11
b Ff(arr)p Fr([P)l(AR)m(T)p 431 1448 V 16 w(MAX)p 553 1448
V 16 w(ST)l(ACK];)205 1505 y Fk(in)o(t)177 b Ff(top)p Fr(;)102
1561 y Fi(g)11 b Fj(P)n(artStac)n(k)p Fr(;)102 1674 y Fk(t)o(yp)q(edef)k
(struct)e Fi(f)205 1731 y Fk(in)o(t)177 b Ff(len)p Fr(;)205
1787 y Fk(P)o(artStac)o(k)48 b Ff(stack)p Fr(;)102 1844 y Fi(g)11
b Fj(P)n(art)p Fr(;)0 1968 y Fl(3.2)50 b(Participant)11 b(List)i(Operations)0
2055 y Fr(The)f(following)f(operations)g(provide)h(a)h(convenient)e
(interface)i(that)f(hides)g(the)g Fq(PartStack)f Fr(data)i(structure.)20
b(However)n(,)0 2111 y(the)11 b(fact)g(that)g(a)g(participant)f(list)g(is)h
(really)g(an)g(array)h(of)f(type)g Fq(Part)f Fr(is)g(visible)g(to)h(the)g
(programmer)m(.)0 2234 y Fm(3.2.1)45 b(partInit)0 2321 y Fr(Initialize)10
b(participant)g(list)g Fq(p)h Fr(of)g Fq(N)h Fr(participants.)71
2402 y Fk(v)o(oid)e Fj(partInit)p Fr(\()p Fk(P)o(art)k(*)p
Ff(p)p Fr(,)d Fk(in)o(t)g Ff(N)h Fr(\);)952 2753 y(24)p eop
%%Page: 25 25
24 bop 0 124 a Fm(3.2.2)45 b(partPush)0 211 y Fr(Pushes)18
b(address)g Fq(addr)p Fr(,)h(pointing)d(to)i Fq(len)g Fr(bytes,)i(onto)d(the)
h(stack)g(of)g(participant)f Fq(p)p Fr(.)38 b(A)18 b(length)f(of)i(0)f
(indicates)f(a)0 268 y(\252special-value\272)11 b(pointer)h(\(e.g.,)h(ANY)p
640 268 14 2 v 16 w(HOST\))f(whose)g(value)f(as)i(a)f(pointer)f(should)g(be)h
(preserved)g(across)g(protection)0 324 y(boundaries)e(\(and)h(not)f
(dereferenced.\))18 b(See)12 b(section)e(3.4)h(below)m(.)71
399 y Fk(v)o(oid)f Fj(partPush)i Fr(\()g Fk(P)o(art)25 b Ff(p)p
Fr(,)12 b Fk(v)o(oid)h(*)e Ff(addr)p Fr(,)h Fk(in)o(t)f Ff(len)p
Fr(\))0 538 y Fm(3.2.3)45 b(partPop)0 625 y Fr(Pops)11 b(an)g(address)g(of)o
(f)g(the)g(stack)g(of)g(participant)f Fq(p)p Fr(.)16 b(Returns)11
b(NULL)g(if)g(there)g(are)h(no)f(more)h(elements)f(on)f(the)h(stack.)71
700 y Fk(v)o(oid)i(*)e Fj(partP)n(op)p Fr(\()p Fk(P)o(art)k
Ff(p)c Fr(\))0 839 y Fm(3.2.4)45 b(partStackT)l(opByteLen)0
926 y Fr(Returns)14 b(the)g(number)h(of)f(bytes)g(pointed)f(to)h(by)g(the)g
(top)g(element)h(of)f(the)g(stack)h(of)f(participant)f Fq(p)p
Fr(.)27 b(Returns)14 b(0)g(if)g(the)0 982 y(stack)d(element)g(was)h(pushed)e
(with)g(a)i(length)e(\256eld)i(of)f(zero)h(\(i.e.,)g(a)g
(\252special-value\272)f(pointer)m(.\))16 b(Returns)11 b(-1)h(if)f(there)h
(are)0 1039 y(no)f(elements)g(on)g(the)f(stack.)71 1114 y Fk(in)o(t)h
Fj(partStac)n(kT)-5 b(opByteLen)p Fr(\()p Fk(P)o(art)13 b Ff(p)e
Fr(\))0 1253 y Fm(3.2.5)45 b(partLen)0 1340 y Fr(Reports)11
b(the)g(number)g(of)g(participants)f(in)g(participant)g(list)g
Fq(p)p Fr(.)71 1415 y Fk(in)o(t)h Fj(partLen)p Fr(\()f Fk(P)o(art)15
b(*)c Ff(p)g Fr(\))0 1554 y Fm(3.2.6)45 b(partExternalize)0
1641 y Fr(T)m(akes)8 b(a)i(participant)d(list)h Fq(p)h Fr(and)f(externalizes)
g(it)h(into)f Fq(buf)g Fr(in)g(a)h(form)h(appropriate)e(for)h(transmission)e
(across)h(a)i(protection)0 1697 y(boundary)m(,)i(essentially)f(dereferencing)
i(all)f(the)g(pointers)g(except)g(special-value)g(pointers)f(pushed)h(with)f
(length)h(==)g(0.)0 1754 y(The)g Fq(int)g Fr(pointed)f(to)h(by)g
Fq(len)h Fr(holds)e(the)h(size)g(of)h(the)f(buf)o(fer)h(going)e(in)h(and)h
(holds)e(the)h(number)h(of)f(bytes)g(written)f(to)h(the)0 1810
y(buf)o(fer)g(on)e(return.)17 b(If)11 b(the)g(buf)o(fer)h(is)f(not)f(lar)o
(ge)h(enough,)g Fq(partExternalize)d Fr(will)i(fail.)71 1885
y Fk(xk)o(ern)p 173 1885 13 2 v 15 w(return)p 300 1885 V 16
w(t)i Fj(partExternalize)d Fr(\()i Fk(P)o(art)j(*)d Ff(pList)p
Fr(,)i Fk(v)o(oid)g(*)e Ff(buf)p Fr(,)g Fk(in)o(t)j(*)d Ff(len)h
Fr(\))0 2024 y Fm(3.2.7)45 b(partInternalize)0 2111 y Fr(T)m(akes)11
b(an)h(externalized)g(participant)e(buf)o(fer)i Fq(buf)f Fr(resulting)f(from)
j Fq(partExternalize)c Fr(and)i(recreates)i(the)f(participants)e(in)0
2167 y(the)h(uninitialized)e(participant)g(list)h Fq(p)p Fr(.)71
2243 y Fk(v)o(oid)g Fj(partIn)n(ternalize)g Fr(\()i Fk(P)o(art)i(*)d
Ff(p)p Fr(,)h Fk(v)o(oid)g(*)g Ff(buf)e Fr(\))0 2381 y Fm(3.2.8)45
b(partExtLen)0 2468 y Fr(Reports)12 b(the)f(number)i(of)f(participants)e(in)i
(an)g(externalized)f(participant)g(buf)o(fer)h Fq(buf)g Fr(resulting)e(from)j
Fq(partExternaliz)o(e)p Fr(.)0 2525 y(This)d(can)i(be)f(useful)f(for)i
(allocating)d(the)i(appropriate)g(sized)f(participant)g(list)g(to)h(pass)f
(to)h Fq(partInternalize)p Fr(.)71 2600 y Fk(in)o(t)g Fj(partExtLen)p
Fr(\()f Fk(v)o(oid)j(*)e Ff(buf)f Fr(\))952 2753 y(25)p eop
%%Page: 26 26
25 bop 0 124 a Fl(3.3)50 b(Relative)12 b(Pr)o(otocol)g(Numbers)0
211 y Fr(Participant)h(lists)f(are)j(used)e(for)h(passing)e(addressing)g
(information)h(between)g(protocols.)23 b(An)13 b(additional)f(problem)i(is)0
268 y(how)g(a)g(high-level)f(protocol)f(identi\256es)h Fq(itself)g
Fr(to)h(a)g(low-level)f(protocol.)24 b(In)14 b(most)g(conventional)e
(protocols,)h(a)i(low-)0 324 y(level)10 b(protocol)f(uses)h(a)g
Fq(r)n(elative)g(pr)n(otocol)f(number)g Fr(to)h(identify)f(the)h(protocols)f
(above)h(it;)g(e.g.,)i(IP)f(identi\256es)e(UDP)h(with)0 381
y(protocol)g(number)h(17)g(and)g(TCP)g(as)g(protocol)f(number)h(6.)17
b(However)n(,)11 b(protocols)f(that)g(have)h(been)g(especially)f(designed)0
437 y(to)h(use)g(the)g Fq(x)p Fr(-kernel)g(use)g(an)g Fq(absolute)f
Fr(addressing)g(scheme.)71 494 y(V)-5 b(ersion)11 b(3.2)i(of)g(the)f
Fq(x)p Fr(-kernel)i(reconciles)e(these)g(two)g(approaches)h(by)f(maintaining)
f(a)i(table)f(of)h(relative)g(protocol)0 550 y(numbers.)j(\(See)9
b(Section)g(13.1)f(for)h(the)g(format)g(of)g(this)e(table.\))16
b(Rather)9 b(than)f(embed)i(protocol)d(numbers)i(in)f(the)h(protocol)0
606 y(source)i(code,)i(protocols)d(learn)h(the)h(protocol)e(numbers)h(of)h
(protocols)e(above)h(them)h(by)f(querying)g(this)f(table)h(using)f(the)0
663 y(following)f(operation:)71 744 y Fk(long)h Fj(relProtNum)p
Fr(\()f Fk(X)o(Ob)r(j)j Ff(hlp)p Fr(,)g Fk(X)o(Ob)r(j)g Ff(llp)g
Fr(\))0 826 y(This)g(operation)g(returns)g(the)h(protocol)e(number)i(of)g
(the)g(high-level)e(protocol)h(relative)g(to)g(the)h(low-level)f(protocol,)g
(or)0 882 y(-1)h(if)f(no)h(such)f(binding)e(has)j(been)g(con\256gured)f(in)g
(the)g(protocol)g(tables.)20 b(This)12 b(number)g(will)g(have)g(to)h(be)f
(cast)h(into)e(the)0 939 y(appropriate)f(type;)h(e.g.,)h(an)f(unsigned)f
(short)g(by)h(the)g(ETH)f(protocol)g(and)h(an)h(unsigned)d(char)j(by)f(IP)-5
b(.)0 1063 y Fl(3.4)50 b(Usage)13 b(Rules)0 1150 y Fr(By)d(convention,)f
(active)h(participant)f(lists)g(\(those)g(used)h(in)g Fq(xOpen)p
Fr(\))g(have)g(the)g(remote)h(participant\(s\))d(\256rst)j(followed)e(by)0
1206 y(an)j(optional)e(local)i(participant.)18 b(The)12 b(local)f
(participant)g(can)h(often)g(be)g(omitted,)g(in)g(which)f(case)i(the)e
(protocol)g(tries)h(to)0 1263 y(use)g(a)h(reasonable)f(default.)20
b(For)13 b(example,)h(a)e(UDP)h(participant)e(contains)g(a)i(UDP)g(port)f
(and)g(an)h(IP)g(host.)19 b(If)13 b(the)g(local)0 1319 y(participant)d(is)g
(missing)g(from)i(an)f(active)g(participant)f(list,)g(UDP)i(selects)e(an)h
(available)g(port)f(for)i(the)f(local)f(participant.)71 1376
y(In)15 b(some)h(cases,)h(it)e(is)g(necessary)h(to)f(specify)g(part)g(of)h
(the)f(information)g(in)g(a)h(participant,)g(but)e(it)h(is)h(convenient)0
1432 y(to)e(allow)f(the)h(lower)g(protocol)f(to)g(\252\256ll)h(in\272)g(the)g
(rest.)26 b(T)m(o)13 b(allow)h(this)f(\257exibility)m(,)g(one)h(can)h(use)e
(the)h(constant)f(pointer)0 1489 y(ANY)p 102 1489 14 2 v 16
w(HOST)d(to)h(specify)f(\252wildcard\272)g(hosts.)15 b(For)c(example,)g(if)g
(one)g(wants)e(to)i(open)f(UDP)h(with)e(a)i(speci\256c)g(local)f(port,)0
1545 y(but)i(does)f(not)h(care)h(which)e(local)h(host)g(number)g(is)g(used,)g
(one)g(could)g(construct)f(a)h(local)g(participant)f(with)g(the)h(speci\256c)
0 1601 y(local)e(port)g(but)f(with)h(the)g(pointer)f(ANY)p
650 1601 V 16 w(HOST)h(pushed)f(on)h(the)g(stack.)16 b(The)11
b(protocol)e(that)g(interprets)h(the)g(host)f(part)h(of)0 1658
y(the)h(participant)e(stack)i(could)f(then)h(choose)f(a)h(reasonable)g
(default.)16 b(Similarly)m(,)11 b(a)g(wildcard)f(value)h(ANY)p
1709 1658 V 16 w(POR)m(T)g(exists)0 1714 y(for)j(protocols)f(that)h(use)g
(ports)f(on)h(their)g(stacks.)25 b(Protocols)13 b(that)g(support)g(wildcards)
g(indicate)h(this)f(in)g(their)h(manual)0 1771 y(page.)71 1827
y(The)d(following)e(example)j(illustrates)d(how)i(a)h(protocol)e(that)h(is)f
(about)h(to)g(invoke)f Fq(xOpen)h Fr(on)g(a)h(low-level)f(protocol)0
1884 y(initializes)18 b(the)i(participant)f(list,)i(and)f(then)g(how)g(the)g
(low-level)f(protocol)f(extracts)i(that)g(information)f(from)h(the)0
1940 y(participant)10 b(list.)0 2046 y Fe({)109 2103 y(...)109
2159 y(/*)28 b(set)g(participant)i(addresses)g(before)f(calling)g(low-level)h
(protocol's)g(open)e(*/)109 2216 y(partInit\(p,)i(2\);)109
2272 y(partPush\(p[0])q(,)g(&ServerHostAd)q(dr,)h(sizeof\(IPhost\))q(\);)58
b(/*)28 b(remote)g(*/)109 2329 y(partPush\(p[0])q(,)i(&ServerPort,)h
(sizeof\(long\)\);)222 b(/*)28 b(remote)g(*/)109 2385 y(partPush\(p[1])q(,)i
(ANY_HOST,)g(0\);)601 b(/*)28 b(local)55 b(*/)109 2442 y(partPush\(p[1])q(,)
30 b(&ClientPort,)h(sizeof\(long\)\);)222 b(/*)28 b(local)55
b(*/)109 2498 y(xOpen\(self,)30 b(self,)f(llp,)f(p\);)109 2555
y(...)0 2611 y(})952 2753 y Fr(26)p eop
%%Page: 27 27
26 bop 0 237 a Fe(llpOpen\()29 b(XObj)g(self,)f(XObj)h(hlpRcv,)g(XObj)f
(hlpType,)i(Part)e(*p)g(\))0 294 y({)109 350 y(/*)g(get)g(participant)i
(addresses)g(within)f(low-level)h(protocol's)g(open)e(*/)109
407 y(remoteport)i(=)e(\(long)g(*\))g(partPop\(p[0]\))q(;)109
463 y(localport)i(=)d(\(long)i(*\))f(partPop\(p[1]\);)109 519
y(...)0 576 y(})71 682 y Fr(Notice)9 b(in)i(this)e(example)i(how)f(the)g
(high-level)f(protocol)g(pushes)h(two)g(items)g(\(a)h(host)f(address)g(and)g
(a)h(port)f(number\))0 739 y(onto)k(each)h(participant')m(s)f(address)g
(stack,)h(but)f(the)h(low-level)e(protocol)h(pops)g(only)f(one)i(item)g(of)o
(f.)27 b(This)14 b(is)g(because)0 795 y(the)e(low-level)e(protocol)h(does)g
(not)h(interpret)f(the)g(\256rst)h(item)g(\(the)g(host)f(address\);)g(it)h
(just)f(passes)g(it)g(on)h(to)f Fq(its)g Fr(low-level)0 852
y(protocol.)18 b(Also)11 b(note)g(that)h(when)g(using)e(participants)h(that)g
(have)h(been)g(passed)g(from)g(other)g(protocols,)f(the)h(user)g(must)0
908 y(keep)e(in)f(mind)h(that)f(the)h(address)f(pointers)f(may)j(be)f(valid)f
(only)f(for)i(the)g(duration)f(of)g(the)h(current)g(subroutine.)k(Data)c
(that)0 964 y(is)e(needed)h(beyond)f(this)g(time)h(should)e(be)i(explicitly)e
(copied)h(into)g(static)g(storage.)15 b(In)9 b(addition,)f(because)h(the)g
(participant)0 1021 y(structure)k(is)g(passed)g(by)g(reference)i(in)e(the)g
Fq(xOpen)h Fr(call,)g(the)f(caller)h(should)e(consider)h(the)g(contents)f
(invalid)g(after)i(the)0 1077 y(return.)71 1134 y(In)d(general,)g(passive)f
(participant)g(lists)f(\(those)i(used)f(in)h Fq(xOpenEnable)p
Fr(\))f(contain)g(only)g(the)h(local)f(participant,)g(with)0
1190 y(no)h(remote)i(participant)d(speci\256ed.)18 b(This)11
b(indicates)g(that)g(an)h(upper)f(protocol)g(is)g(willing)f(to)h(accept)h
(connections)f(from)0 1247 y(any)k(remote)h(participant,)f(as)h(long)e(as)i
(the)f(connection)f(is)h(addressed)g(to)g(the)g(correct)g(local)g
(participant.)28 b(Protocols)0 1303 y(which)17 b(provide)g(dif)o(ferent)g
(semantics)g(for)h(their)f(openEnable)f(participants)g(will)h(indicate)g
(this)f(explicitly)g(in)h(their)0 1360 y(manual)11 b(page)g(in)g(appendix)f
(A.)952 2753 y(27)p eop
%%Page: 28 28
27 bop 0 124 a Fn(4)60 b(Message)14 b(Library)0 228 y Fr(The)k(message)g
(library)g(provides)f(a)h(set)g(of)g(ef)o(\256cient,)j(high-level)c
(operations)f(for)j(manipulating)d(messages.)37 b(The)0 284
y(underlying)16 b(data)i(structure)f(that)h(implements)f(messages)h(is)f
(optimized)g(for)i(fragmentation/reassembly)m(,)f(and)g(for)0
340 y(adding/strippin)o(g)d(headers.)38 b(Protocol)18 b(programmers)h(should)
d(manipulate)i(messages)g(only)f(with)h(the)g(operations)0
397 y(documented)11 b(here.)71 453 y(Future)f(releases)g(of)h(the)f(message)g
(library)g(will)f(accommodate)i(the)f(use)g(of)h(buf)o(fers)f(that)g(are)h
(owned)f(and)g(managed)0 510 y(by)e(dif)o(ferent)h(buf)o(fer)g(pools,)g
(including)e(device)h(memory)m(,)j(user)d(buf)o(fers,)i(simple)f(kernel)f
(buf)o(fers,)i(and)f(structured)e(kernel)0 566 y(buf)o(fers)k(such)g(as)g
(BSD)h Fq(mbufs)e Fr(and)h(System)g(V)g Fq(mblocks)p Fr(.)0
691 y Fl(4.1)50 b(T)l(ype)13 b(De\256nitions)0 778 y Fr(Loosely)i(speaking,)j
(V)-5 b(ersion)15 b(3.2)i(messages)g(include)e(two)h(main)h(components:)26
b(a)17 b Fq(stack)f Fr(that)g(holds)g(the)g(message)0 834 y(header)n(,)c(and)
f(pointer)f(\()p Fq(tr)n(ee)p Fr(\))i(to)f(a)g(tree)h(structure)e(of)h(buf)o
(fers)g(that)g(hold)f(the)h(data.)102 940 y Fk(t)o(yp)q(edef)k(struct)e
Fi(f)295 997 y Fk(c)o(har)185 b Fr(*headPtr;)295 1053 y Fk(c)o(har)g
Fr(*tailPtr;)295 1110 y Fk(c)o(har)g Fr(*stackHeadPtr;)295
1166 y Fk(c)o(har)g Fr(*stackT)m(ailPtr;)295 1223 y Fk(struct)13
b Fi(f)557 1279 y Fk(unsigned)h(short)19 b Fr(numNodes;)557
1335 y Fk(unsigned)14 b(in)o(t)61 b Fr(myStack;)295 1392 y
Fi(g)12 b Fr(state;)295 1448 y Fk(MNo)q(deLeaf)p Fr(*)29 b(stack;)295
1505 y Fk(MNo)q(de)p Fr(*)107 b(tree;)295 1561 y Fk(v)o(oid)p
Fr(*)162 b(attr;)295 1618 y Fk(in)o(t)212 b Fr(attrLen;)295
1674 y Fk(MNo)q(deLeaf)p Fr(*)29 b(lastStack;)295 1731 y Fk(c)o(har)185
b Fr(*lastStackT)m(ailPtr;)295 1787 y Fk(struct)13 b Fi(f)557
1844 y Fk(unsigned)h(in)o(t)61 b Fr(myLastStack;)295 1900 y
Fi(g)12 b Fr(tailstate;)102 1956 y Fi(g)f Fj(Msg)h Fr(;)0 2081
y Fl(4.2)50 b(Constructor/Destructor)11 b(Operations)0 2168
y Fr(These)h(operations)f(are)i(used)f(to)f(create)i(and)f(destroy)g
(messages.)19 b(Many)13 b(of)f(them)h(are,)g(for)g(example,)g(used)e(by)h
(device)0 2224 y(drivers)f(and)g(application)e(interface)i(code)g(that)g(has)
g(to)g(incorporate)f(a)i(data)f(buf)o(fer)g(into)f(an)i Fq(x)p
Fr(-kernel)f(message.)71 2281 y(Messages)i(that)g(are)i(newly)e(created)h
(\252own\272)g(the)g(stack)f(space)h(and)g(can)g(write)f(into)g(that)g(space)
h(ef)o(\256ciently)f(using)0 2337 y(\252msgPush\272.)j(See)c(the)f(section)f
(on)h(Usage)g(\(4.4\))h(for)f(more)h(information)e(about)g(stacks.)0
2460 y Fm(4.2.1)45 b(msgConstructEmpty)0 2547 y Fr(Initializes)15
b(a)i(message)h(structure)e(with)f(a)j(data)e(length)g(set)h(to)f(zero.)34
b(The)17 b(user)f(must)h(provide)f(a)h(pointer)f(to)g(valid)0
2603 y(memory)m(.)952 2753 y(28)p eop
%%Page: 29 29
28 bop 71 124 a Fk(v)o(oid)10 b Fj(msgConstructEmpt)n(y)f Fr(\()p
Fk(Msg*)i Ff(this)p Fr(\);)0 246 y Fm(4.2.2)45 b(msgConstructBuffer)0
333 y Fr(Copies)8 b(data)g(from)h(a)g(user)f(buf)o(fer)h(into)e(an)h
(uninitialized)e(message)j(structure.)15 b(The)8 b(message)g(data)h(area)g
(is)f(allocated)f(and)0 389 y(a)i(copy)g(is)f(performed.)16
b(This)8 b(constructor)f(is)i(used)f(when)h(the)f(data)h(buf)o(fer)g(already)
g(exists.)14 b(Use)9 b Fq(msgConstructAllo)o(cate)0 446 y Fr(when)i(you)f
(have)i(the)e(opportunity)f(to)i(\256ll)g(the)f(buf)o(fer)i(after)g(it)e(has)
h(been)g(created.)71 525 y Fk(v)o(oid)f Fj(msgConstructBu\013er)g
Fr(\()p Fk(Msg*)h Ff(this)p Fr(,)i Fk(c)o(har)e Fr(*)p Ff(buf)p
Fr(,)g Fk(long)f Ff(len)p Fr(\);)0 646 y Fm(4.2.3)45 b(msgConstructAllocate)0
733 y Fr(Allocates)14 b(a)i(data)f(area)h(of)g(size)f Fq(len)g
Fr(and)g(associates)g(the)g(area)h(with)e(the)h(uninitialized)e(message)j
(structure)e Fq(this)p Fr(.)28 b(A)0 790 y(pointer)13 b(to)h(the)h(data)f
(area)h(is)f(returned)g(in)g Fq(buf)p Fr(.)26 b(A)14 b(device)h(driver)f
(might)g(use)g(this)f(constructor)n(,)i(handing)e Fq(buf)g
Fr(to)h(the)0 846 y(device)d(as)g(a)h(place)f(to)g(put)f(down)h(an)g
(incoming)f(packet.)71 925 y Fk(v)o(oid)g Fj(msgConstructAllo)r(cate)f
Fr(\()p Fk(Msg*)i Ff(this)p Fr(,)i Fk(long)d Ff(len)p Fr(,)j
Fk(c)o(har)e Fr(**)p Ff(buf)p Fr(\);)0 1069 y Fm(4.2.4)45 b(msgConstructCopy)
0 1156 y Fr(The)13 b(uninitialized)d(message)k Fq(this)e Fr(will)g(refer)i
(to)e(the)h(same)h(data)f(as)g(the)f(message)i Fq(another)p
Fr(.)20 b(No)13 b(data)g(is)g(copied.)21 b(See)0 1213 y(also)11
b Fq(msgAssign)p Fr(.)71 1292 y Fk(v)o(oid)f Fj(msgConstructCop)n(y)h
Fr(\()p Fk(Msg*)h Ff(this)p Fr(,)g Fk(Msg)g Fr(*)p Ff(another)p
Fr(\);)0 1413 y Fm(4.2.5)45 b(msgAssign)0 1500 y Fr(The)12
b(assignment)g(of)g(one)g(message)h Fq(m)g Fr(to)f(message)g
Fq(this)g Fr(means)g(that)g(message)h Fq(this)e Fr(will)h(refer)h(to)f(the)g
(same)h(data)g(that)0 1557 y(as)d(message)h Fq(m)f Fr(currently)g(does.)16
b(No)10 b(data)g(copying)f(is)h(involved.)k(This)c(is)g(equivalent)e(to)i
(doing)f(a)i Fq(msgDestr)n(oy)e Fr(to)h Fq(this)p Fr(,)0 1613
y(followed)j(by)i(a)g Fq(msgConstructCopy)p Fr(.)24 b(Therefore,)17
b(this)c(function)g(should)h(be)g(used)g(only)g(when)g(both)g(messages)g(are)
0 1670 y(valid.)i(Copying)10 b(to)g(an)i(uninitialized)c(structure)j(should)e
(be)j(done)e(with)g(msgConstructCopy)m(.)71 1749 y Fk(v)o(oid)g
Fj(msgAssign)g Fr(\()p Fk(Msg*)i Ff(this)p Fr(,)g Fk(Msg*)g
Ff(m)p Fr(\);)0 1893 y Fm(4.2.6)45 b(msgConstructInplace)0
1980 y Fr(The)16 b(uninitialized)e(message)i Fq(this)f Fr(is)h(constructed)f
(with)g(a)h(direct)g(reference)i(to)d(the)h(buf)o(fer)h(speci\256ed.)31
b(A)16 b(function)0 2036 y(appropriate)7 b(for)h(freeing)f(the)g(buf)o(fer)i
(when)e(the)g(message)h(is)f(destroyed)g(must)g(be)g(provided.)15
b(The)7 b Fq(msgConstructInplace)0 2093 y Fr(function)k(is)g(recommended)i
(only)e(for)h(limited)f(use)h(\(e.g.)20 b(within)10 b(device)i(drivers\);)g
(it)f(might)h(not)f(be)h(compatible)f(with)0 2149 y(later)g(implementations)f
(of)h(the)g(message)g(library)g(that)f(will)g(provide)g(highly)g(ef)o
(\256cient)h(buf)o(fer)h(management.)71 2228 y Fk(v)o(oid)e
Fj(msgConstructInplace)g Fr(\()p Fk(Msg*)h Ff(this)p Fr(,)i
Fk(c)o(har)f Fr(*)p Ff(buf)o(fer)p Fr(,)d Fk(long)i Ff(length)p
Fr(,)h Fk(Pfv)f Ff(fr)o(eefunc)p Fr(\);)0 2350 y Fm(4.2.7)45
b(msgConstructAppend)0 2437 y Fr(The)13 b(uninitialized)e(message)j
Fq(this)e Fr(is)h(initialized)f(to)h(prepare)h(for)g(appending)e(data)h(with)
g Fq(msgAppend)p Fr(.)22 b(The)13 b(message)0 2493 y(can)e(be)f(used)g(in)g
(any)g(message)g(operation,)g(but)g Fq(msgPush)f Fr(will)g(cause)h
(additional)f(space)h(to)g(be)g(allocated.)16 b(A)10 b(pointer)g(to)0
2550 y(the)h(beginning)e(of)i(the)g(new)g(message)h(buf)o(fer)f(is)g
(returned)g(in)f(the)h Fq(buffer)f Fr(parameter)m(.)71 2629
y Fk(v)o(oid)g Fj(msgConstructApp)r(end)g Fr(\()p Fk(Msg*)i
Ff(this)p Fr(,)g Fk(long)f Ff(length)p Fr(,)h Fk(c)o(har)g
Fr(**)p Ff(buf)o(fer)p Fr(\))952 2753 y(29)p eop
%%Page: 30 30
29 bop 0 124 a Fm(4.2.8)45 b(msgDestr)o(oy)0 211 y Fr(Logically)10
b(frees)i(message)g Fq(this)p Fr(.)k(Data)11 b(portions)f(of)i(the)f(message)
h(deallocated)e(are)i(freed)h(as)e(a)h(result)f(of)g(this)g(function)0
268 y(should)f(there)h(be)g(no)g(other)g(outstanding)d(references)k(to)f
(them.)71 349 y Fk(v)o(oid)f Fj(msgDestro)n(y)g Fr(\()p Fk(Msg*)h
Ff(this)p Fr(\);)0 473 y Fl(4.3)50 b(Manipulation)10 b(Operations)0
560 y Fr(Protocols)i(manipulate)h(messages\320e.g.,)j(add)d(and)g(strip)g
(headers,)i(fragment)e(and)h(reassemble)f(packets\320using)f(the)0
617 y(following)d(set)i(of)g(operations.)0 739 y Fm(4.3.1)45
b(msgLen)0 826 y Fr(Returns)11 b(the)g(number)g(of)g(bytes)f(of)i(data)f(in)f
(message)i Fq(this)p Fr(.)71 908 y Fk(long)e Fj(msgLen)g Fr(\()p
Fk(Msg)h Fr(*)p Ff(this)p Fr(\);)0 1055 y Fm(4.3.2)45 b(msgT)m(runcate)0
1142 y Fr(T)n(runcates)11 b(the)f(data)h(in)f(the)h(message)g
Fq(this)f Fr(to)g(the)h(given)f(length.)15 b(Attempts)10 b(to)g(to)g(reduce)i
(the)e(length)g(to)g(less)g(than)h(zero)0 1199 y(will)f(result)h(in)g(no)g
(change)g(to)g(the)g(message.)18 b(No)11 b(storage)g(is)g(freed)h(as)f(a)h
(result)f(of)g(truncation.)16 b(This)10 b(operation)h(is)g(used)0
1255 y(to)g(strip)f(trailers)g(from)i(a)g(message.)71 1337
y Fk(v)o(oid)e Fj(msgT)-5 b(runcate)10 b Fr(\()p Fk(Msg*)i
Ff(this)p Fr(,)g Fk(long)f Ff(newLength)p Fr(\);)0 1484 y Fm(4.3.3)45
b(msgChopOff)0 1571 y Fr(Removes)11 b(data)g(from)g(the)g(message)g
Fq(this)e Fr(and)i(assign)e(it)i(to)f(the)g(message)h Fq(head)p
Fr(.)16 b(No)11 b(copying)e(is)i(done.)16 b(This)9 b(operation)0
1628 y(is)i(used)f(to)h(fragment)h(a)f(message)g(into)g(smaller)g(pieces.)16
b(Both)11 b(messages)g(must)g(be)g(valid)f(at)h(the)g(time)g(of)h(the)f
(call.)71 1709 y Fq(3.1)g(Compatibility)d(notes)p Fr(:)15 b(The)c(3.1)g
(version)g(of)g(this)f(was)h Fq(msg)p 1106 1709 14 2 v 15 w(br)n(eak)p
Fr(,)h(but)e(the)h(ar)o(guments)g(were)h(reversed.)71 1790
y Fk(v)o(oid)e Fj(msgChopO\013)h Fr(\()p Fk(Msg*)g Ff(this)p
Fr(,)i Fk(Msg*)e Ff(head)p Fr(,)h Fk(long)e Ff(len)p Fr(\);)0
1938 y Fm(4.3.4)45 b(msgJoin)0 2025 y Fr(Assigns)10 b(\(in)h(the)h(same)g
(sense)g(as)g Fq(msgAssign)p Fr(\))d(to)i Fq(this)g Fr(message)h(the)g
(concatenation)e(of)i(messages)f Fq(m1)h Fr(to)f(the)h(front)f(of)0
2081 y Fq(m2)p Fr(.)26 b(This)14 b(operation)f(is)h(used)g(to)g(reassemble)h
(fragments)f(into)g(a)g(lar)o(ger)h(message.)27 b(The)14 b(\256rst)h(ar)o
(gument)f(must)g(be)h(a)0 2138 y(valid)10 b(message.)17 b(The)11
b(ar)o(guments)g(need)g(not)g(refer)h(to)e(distinct)g(messages.)71
2219 y Fk(v)o(oid)g Fj(msgJoin)g Fr(\()p Fk(Msg*)h Ff(this)p
Fr(,)i Fk(Msg*)e Ff(m1)p Fr(,)h Fk(Msg*)f Ff(m2)p Fr(\);)71
2301 y(Example)g(of)g(using)f(non-unique)f(ar)o(guments:)16
b Fj(msgJoin)9 b Fr(\()p Ff(this)p Fr(,)k Ff(this)p Fr(,)g
Ff(MessageT)-5 b(ail)p Fr(\);)952 2753 y(30)p eop
%%Page: 31 31
30 bop 0 124 a Fm(4.3.5)45 b(msgPush)0 211 y Fr(Prepends)10
b(data)h(pointed)e(to)h(by)h Fq(hdr)f Fr(to)g(the)g(front)g(of)h(message)g
Fq(this)p Fr(.)k(The)10 b(supplied)f(function)h Fq(stor)n(e)g
Fr(will)f(be)i(called)f(with)0 268 y(the)j Fq(hdr)g Fr(pointer)n(,)h(a)f
(pointer)g(to)g(the)g(message)h(data)f(area)h(where)g(the)f(header)h(data)f
(can)h(be)g(copied,)f(the)h Fq(hdrLen)f Fr(value)0 324 y(indicating)e(the)h
(length)g(of)h(the)f(data,)i(and)f(the)f Fq(ar)n(g)h Fr(pointer)m(.)21
b(The)12 b(last)h(ar)o(gument)f(is)h(not)f(interpreted)g(by)g(the)h
Fq(msgPush)0 381 y Fr(function;)c(its)i(semantics)f(are)i(determined)f
(entirely)f(by)h(the)g(user)g(store)g(function.)71 462 y Fk(v)o(oid)f
Fj(msgPush)h Fr(\()p Fk(Msg*)g Ff(this)p Fr(,)i Fk(MStoreF)m(un)f
Ff(stor)o(e)p Fr(,)g Fk(v)o(oid)e Fr(*)p Ff(hdr)p Fr(,)i Fk(long)e
Ff(hdrLen)p Fr(,)i Fk(v)o(oid)f Fr(*)p Ff(ar)o(g)p Fr(\);)71
543 y(Function)d Fq(stor)n(e)h Fr(typically)e(converts)i(the)g(header)h(to)f
(network)g(byte)f(order)i(and)f(stores)g(it)g(in)g(a)h(potentially)d
(unaligned)0 600 y(buf)o(fer;)j Fq(len)g Fr(is)f(the)g(number)h(of)f(bytes)g
(to)g(be)h(read)g(and)f Fq(ar)n(g)h Fr(is)f(an)g(arbitrary)h(ar)o(gument)f
(passed)g(through)f(from)j Fq(msgPush)p Fr(.)71 681 y Fk(t)o(yp)q(edef)j(v)o
(oid)d Fr(\()p Fj(*MStoreF)-5 b(un)12 b Fr(\)\()p Fk(v)o(oid)e
Fr(*)p Ff(hdr)p Fr(,)i Fk(c)o(har)g Fr(*)p Ff(des)p Fr(,)f
Fk(long)g Ff(len)p Fr(,)h Fk(v)o(oid)e Fr(*)p Ff(ar)o(g)p Fr(\);)71
763 y Fg(Example)j(Declaration:)18 b Fk(v)o(oid)11 b Fj(cop)n(ypush)p
Fr(\()p Fk(v)o(oid)g Fr(*)p Ff(sr)o(c)p Fr(,)g Fk(c)o(har)h
Fr(*)p Ff(dst)p Fr(,)g Fk(long)f Ff(count)p Fr(,)h Fk(v)o(oid)f
Fr(*)p Ff(type)p Fr(\)\))0 885 y Fm(4.3.6)45 b(msgPop)0 972
y Fr(Removes)10 b(data)g(from)h(the)f(front)f(of)i(message)f
Fq(this)p Fr(.)15 b(After)10 b(making)g(the)f(requested)h(data)g(contiguous,)
e Fq(msgPop)h Fr(calls)g(the)0 1029 y(function)f Fq(load)g
Fr(with)g(the)g Fq(hdr)g Fr(ar)o(gument,)i(a)g(pointer)e(to)g(the)h(start)f
(of)h(the)g(contiguous)d(data,)k Fq(hdrLen)p Fr(,)f(and)g(the)g
Fq(ar)n(g)f Fr(pointer)m(.)0 1085 y(Function)i Fq(load)g Fr(should)f(return)h
(an)h(integer)g(representing)f(the)g(amount)h(data)f(that)h(should)e(be)i
(popped)f(of)o(f)h(the)g(message.)0 1142 y(In)k(optimized)g(code,)h(no)f
(validity)f(check)h(is)g(done)g(on)g(this)f(number)m(.)29 b(This)15
b(function)f(returns)g(TRUE)i(if)f(successful,)0 1198 y(F)m(ALSE)c(if)g(the)g
(message)g(is)g(shorter)g(than)f Fq(hdrLen)h Fr(bytes.)71 1279
y Fk(b)q(o)q(ol)f Fj(msgP)n(op)h Fr(\()p Fk(Msg*)h Ff(this)p
Fr(,)g Fk(MLoadF)m(un)f Ff(load)p Fr(,)i Fk(v)o(oid)d Fr(*)p
Ff(hdr)p Fr(,)i Fk(long)e Ff(hdrLen)p Fr(,)i Fk(v)o(oid)f Fr(*)p
Ff(ar)o(g)p Fr(\);)71 1361 y(Function)d Fq(load)g Fr(loads)h(the)g(header)h
(from)g(a)g(potentially)d(unaligned)h(buf)o(fer)i(and)f(converts)g(it)g(to)g
(machine)g(byte)g(order)m(.)0 1417 y(The)i Fq(len)f Fr(is)h(the)f(number)h
(of)g(bytes)f(guaranteed)h(contiguous)d(and)j Fq(ar)n(g)f Fr(is)h(an)g
(arbitrary)f(ar)o(gument)h(passed)f(through)g(from)0 1474 y
Fq(msgPop)p Fr(.)25 b(This)13 b(function)g(should)g(return)h(the)g(number)h
(of)f(bytes)g(to)g(be)g(actually)f(popped)h(from)h(the)f(message.)26
b(This)0 1530 y(information)10 b(is)h(used)f(by)h Fq(msgPop)f
Fr(to)h(update)f(the)h(internal)f(message)i(structure.)71 1611
y Fk(t)o(yp)q(edef)i(long)d Fr(\()p Fj(*MLoadF)-5 b(un)12 b
Fr(\)\()p Fk(v)o(oid)f Fr(*)p Ff(hdr)p Fr(,)g Fk(c)o(har)h
Fr(*)p Ff(sr)o(c)p Fr(,)g Fk(long)e Ff(len)p Fr(,)i Fk(v)o(oid)f
Fr(*)p Ff(ar)o(g)p Fr(\);)71 1693 y Fg(Example)i(declaration:)19
b Fk(long)10 b Fj(cop)n(yp)r(op)p Fr(\()i Fk(v)o(oid)e Fr(*)p
Ff(dst)p Fr(,)i Fk(c)o(har)g Fr(*)p Ff(sr)o(c)p Fr(,)f Fk(long)g
Ff(count)p Fr(,)h Fk(v)o(oid)f Fr(*)p Ff(type)p Fr(\)\))0 1815
y Fm(4.3.7)45 b(msgPopDiscard)0 1902 y Fr(Discards)10 b Fq(len)h
Fr(bytes)g(from)g(the)g(front)g(of)g(message)h Fq(this)p Fr(.)j(Returns)c
Fq(TRUE)g Fr(if)g(successful.)71 1984 y Fk(b)q(o)q(ol)f Fj(msgP)n(opDiscard)h
Fr(\()p Fk(Msg)h Fr(*)p Ff(this)p Fr(,)g Fk(long)f Ff(len)p
Fr(\))0 2131 y Fm(4.3.8)45 b(msgAppend)0 2218 y Fr(Appends)11
b(data)h(pointed)f(to)g(by)h Fq(tail)f Fr(to)h(the)g(end)g(of)g(message)g
Fq(this)p Fr(.)18 b(The)12 b(supplied)f(function)g Fq(stor)n(e)g
Fr(will)g(be)h(called)g(with)0 2275 y(the)e Fq(tail)g Fr(pointer)n(,)g(a)h
(pointer)e(to)i(the)f(message)h(data)f(area)i(where)e(the)h(data)f(can)h(be)g
(copied,)f(the)g Fq(tailLen)g Fr(value)g(indicating)0 2331
y(the)f(length)f(in)g(bytes)g(fo)h(the)g(data,)h(and)e(the)h
Fq(ar)n(g)g Fr(pointer)m(.)15 b(If)10 b(it)e(is)h(necessary)f(to)h(allocate)f
(new)h(space)g(to)g(hold)f(the)h(data,)g(the)0 2388 y Fq(newlength)f
Fr(parameter)i(designates)e(the)g(minimum)h(amount)g(of)g(space)g(for)g(the)g
(allocation.)14 b(See)c Fq(msgConstructAppend)p Fr(,)0 2444
y(also.)71 2526 y Fk(v)o(oid)23 b Fj(msgApp)r(end)g Fr(\()p
Fk(Msg*)i Ff(this)p Fr(,)k Fk(MStoreF)m(un)c Ff(stor)o(e)p
Fr(,)j Fk(v)o(oid)23 b Fr(*)p Ff(tail)p Fr(,)29 b Fk(long)24
b Ff(tailLen)p Fr(,)29 b Fk(v)o(oid)24 b Fr(*)p Ff(ar)o(g)p
Fr(,)j Fk(long)0 2582 y Ff(newlength)p Fr(\);)952 2753 y(31)p
eop
%%Page: 32 32
31 bop 0 124 a Fm(4.3.9)45 b(msgSetAttr)0 211 y Fr(Associates)9
b(an)i Fq(attribute)e Fr(of)i Fq(len)f Fr(bytes)g(with)g Fq(name)g
Fr(and)h(attaches)f(it)g(to)h(message)f Fq(this)p Fr(.)16 b(Setting)10
b(an)g(attribute)g(overrides)0 268 y(any)g(previous)f(attribute)f(with)h(the)
h(same)h(name.)16 b(Message)11 b(attributes)d(are)j(used)e(to)h(communicate)g
(ancillary)f(properties)0 324 y(of)i(messages)g(from)h(a)g(protocol)d(to)i(a)
h(session,)e(or)h(between)g(protocols.)71 381 y(The)h(only)f(name)i
(supported)e(at)h(this)f(time)h(is)g Fq(0)p Fr(.)20 b(Attempting)11
b(to)g(set)h(an)h(attribute)e(with)g(another)h(name)h(will)e(result)0
437 y(in)g(an)g Fq(XK)p 162 437 14 2 v 16 w(F)-6 b(AILURE)11
b Fr(return)g(value.)71 518 y Fk(xk)o(ern)p 173 518 13 2 v
15 w(return)p 300 518 V 16 w(t)h Fj(msgSetA)n(ttr)e Fr(\()p
Fk(Msg)h Fr(*)p Ff(this)p Fr(,)i Fk(in)o(t)d Ff(name)p Fr(,)i
Fk(v)o(oid)e Fr(*)p Ff(attribute)p Fr(,)i Fk(in)o(t)f Ff(len)p
Fr(\);)0 666 y Fm(4.3.10)45 b(msgGetAttr)0 753 y Fr(Retrieves)15
b(an)f(attribute)g(previously)e(attached)j(to)f(message)h Fq(this)e
Fr(with)h Fq(name)p Fr(.)26 b(If)16 b(no)e(attribute)f(has)i(been)f
(associated)0 809 y(with)c Fq(name)p Fr(,)h Fq(0)g Fr(will)g(be)g(returned.)
71 891 y Fk(v)o(oid)i(*)e Fj(msgGetA)n(ttr)e Fr(\()p Fk(Msg)j
Fr(*)p Ff(this)p Fr(,)g Fk(in)o(t)f Ff(name)g Fr(\);)0 1013
y Fm(4.3.11)45 b(msgForEach)0 1100 y Fr(For)13 b(each)h(contiguous)d(data)i
(area)h(in)e(the)h(message,)h(invokes)e(the)h(function)e Fq(f)i
Fr(with)f(three)h(ar)o(guments:)20 b(the)13 b(address)f(of)0
1157 y(the)e(data,)h(the)g(length)e(of)i(the)f(data,)h(and)g(a)g(user)f
(supplied)f(ar)o(gument)i Fq(ar)n(g)p Fr(.)16 b(The)10 b(iteration)f(stops)h
(when)g Fq(f)g Fr(does)h(not)e(return)0 1213 y Fq(TRUE)p Fr(.)71
1295 y Fk(v)o(oid)h Fj(msgF)-5 b(orEac)n(h)11 b Fr(\()p Fk(Msg)h
Fr(*)p Ff(this)p Fr(,)g Fk(X)o(CharF)m(un)f Ff(f)p Fr(,)h Fk(v)o(oid)e
Fr(*)p Ff(ar)o(g)p Fr(\);)71 1376 y Fk(t)o(yp)q(edef)i(b)q(o)q(ol)e
Fr(\()p Fj(*X)n(CharF)-5 b(un)14 b Fr(\)\()p Fk(c)o(har)e Fr(*)p
Ff(ptr)p Fr(,)g Fk(long)e Ff(len)p Fr(,)i Fk(v)o(oid)f Fr(*)p
Ff(ar)o(g)p Fr(\);)0 1557 y Fl(4.4)50 b(Usage)13 b(Rules)0
1644 y Fr(The)c Fq(x)p Fr(-kernel)h(coding)e(conventions)f(dictate)i(that)f
(messages)i(should)d(be)j(destroyed)e(by)h(the)g(same)h(entity)e(that)g
(originally)0 1700 y(constructed)19 b(them.)43 b(Thus,)21 b(the)f(ethernet)f
(driver)h(is)f(responsible)g(for)h(destroying)e(messages)h(after)i
(successfully)0 1757 y(delivering)8 b(them)i(upward,)g(and)g(the)g(top-level)
e(protocols)g(that)i(interface)g(to)f(user)h(functions)e(should)g(destroy)h
(messages)0 1813 y(that)i(have)g(been)g(successfully)e(delivered)i(to)g
(their)f(destination.)71 1870 y(When)k(a)h(protocol)f(passes)g(a)h(message)g
(to)g(an)g(adjacent)f(protocol)g(\(via)h Fq(xPush)p Fr(,)g
Fq(xDemux)p Fr(,)h(etc.\))28 b(its)14 b(view)h(of)f(the)0 1926
y(message)i(becomes)g(invalid.)30 b(The)16 b(contents)e(of)i(the)g(message)g
(after)h(such)e(an)h(operation)f(depend)h(on)f(which)h(lower)0
1983 y(headers)10 b(were)h(pushed)e(onto)g(it.)15 b(Should)9
b(a)i(protocol)e(want)g(to)h(keep)g(a)g(reference)h(to)f(the)g
(message\320e.g.,)i(so)d(it)h(can)g(later)0 2039 y(retransmit)15
b(it\320it)f(must)g(explicitly)f(save)i(a)h(copy)e(using)g(the)h
Fq(msgAssign)d Fr(or)j Fq(msgConstructCopy)e Fr(operation)h(before)0
2095 y(passing)c(the)h(message)g(on)g(to)g(another)f(protocol.)71
2152 y(Note)19 b(that)g(although)f(a)j(protocol)d(which)i(constructs)e(a)i
(message)g(invalidates)e(its)h(view)h(of)g(the)f(message)i(by)0
2208 y(performing)11 b(a)g(UPI)h(operation)e(involving)f(that)h(message,)i
(it)f(is)f(still)g(responsible)f(for)j(destroying)d(the)i(message.)71
2265 y(The)g(stack)h(ownership)e(is)i(a)g(hidden)f(variable)g(in)h(the)f
(message)h(library)g(implementation)e(that)h(af)o(fects)i(whether)e(or)0
2321 y(not)i(storage)g(is)g(automatically)g(allocated)g(on)g
Fq(msgPush)f Fr(operations.)23 b(The)14 b(stack)f(ownership)f(is)h(af)o
(fected)i(by)e(several)0 2378 y(message)f(library)f(operations,)f
(particularly)h Fq(msgAssign,)e(msgJoin,)i(msgPop)p Fr(,)g(and)g
Fq(msgConstructCopy)p Fr(.)16 b(The)11 b(user)h(is)0 2434 y(referred)g(to)f
(the)g(source)g(code)g(for)g(the)g(details)f(of)i(the)e(ownership)g(rules.)71
2491 y(Message)g(attributes)e(passed)i(between)g(protocols)e(should)h
(consist)f(of)i(exportable)g(data,)g(i.e.)17 b(not)9 b(pointers.)15
b(Adher)o(-)0 2547 y(ence)d(to)e(this)g(convention)g(will)g(ensure)h(that)f
(the)h(protocol)f(can)i(be)f(in)g(used)f(in)h(a)h(multi-address)d(space)j
(environment.)952 2753 y(32)p eop
%%Page: 33 33
32 bop 0 124 a Fn(5)60 b(Event)14 b(Library)0 228 y Fr(The)g(event)f(library)
g(provides)f(a)i(mechanism)g(for)g(scheduling)e(a)i(procedure)g(to)f(be)h
(called)f(after)h(a)g(certain)g(amount)f(of)0 284 y(time.)j(By)c(registering)
d(a)i(procedure)g(with)f(the)h(event)f(library)m(,)h(protocols)e(are)j(able)e
(to)h(\252timeout\272)f(and)h(act)g(on)f(messages)0 340 y(that)h(have)g(not)f
(been)h(acknowledged)f(or)h(to)g(perform)h(periodic)e(maintenance)h
(functions.)0 465 y Fl(5.1)50 b(T)l(ype)13 b(De\256nitions)0
552 y Fr(The)g(only)f(event-related)h(type)g(that)f(protocol)g(programmers)i
(need)g(be)f(aware)h(of)f(is)g(the)g(type)g Fq(Event)p Fr(.)22
b(However)n(,)14 b(this)0 608 y(type)d(is)f(de\256ned)h(by)g(the)g
(underlying)f(platform)g(and)h(is)g(opaque)g(to)f(the)h(protocol)f
(programmer)m(.)0 733 y Fl(5.2)50 b(Operations)0 820 y Fm(5.2.1)45
b(evSchedule)0 907 y Fr(Schedules)12 b(an)g(event)h(that)e(executes)h
(function)g Fq(f)g Fr(with)f(ar)o(gument)i Fq(a)f Fr(after)h(delay)f
Fq(t)g Fr(usec;)h Fq(t)f Fr(may)h(equal)f(0.)20 b(A)13 b(handle)f(to)0
963 y(the)e(event)g(is)g(returned,)h(and)f(this)f(can)i(be)g(used)f(to)g
(cancel)g(the)g(event)h(at)f(some)h(later)f(time.)16 b(When)10
b(an)h(event)f(\256res,)h(a)g(new)0 1019 y(thread)j(is)f(created)h(to)f(run)h
(function)f Fq(f)p Fr(.)24 b(Note)13 b(that)g(even)h(after)g(an)g(event)g
(\256res)g(and)g(a)g(thread)f(had)h(been)g(scheduled)f(to)0
1076 y(handle)d(it,)h(the)g(thread)f(does)h(not)f(run)g(until)g(sometime)g
(after)i(the)e(currently)h(executing)e(thread)i(gives)f(up)g(the)h(processor)
m(.)0 1132 y(See)h(Section)f(7)g(for)g(a)h(description)d(of)i(how)g(threads)g
(are)g(scheduled.)71 1214 y Fk(Ev)o(en)o(t)g Fj(evSc)n(hedule)g
Fr(\()p Fk(EvF)m(unc)g Ff(f)p Fr(,)h Fk(v)o(oid)p Fr(*)e Ff(a)p
Fr(,)i Fk(in)o(t)e Ff(t)p Fr(\))71 1270 y Fk(t)o(yp)q(edef)k(v)o(oid)d
Fr(\()p Fj(*)18 b(EvF)-5 b(unc)12 b Fr(\))f(\()h Fk(Ev)o(en)o(t)g
Fr(*,)f Fk(v)o(oid)g Fr(*)g(\))71 1352 y(Function)e Fq(f)i
Fr(must)g(be)g(of)g(type)f Fq(void)g Fr(and)h(take)g(two)f(ar)o(guments:)16
b(the)11 b(\256rst,)g(of)g(type)f Fq(Event)p Fr(,)h(is)g(a)g(handle)f(to)h
(the)g(event)0 1408 y(itself)e(and)g(the)g(second,)h(of)g(type)f
Fq(void)g(*)p Fr(,)h(is)f(the)g(ar)o(gument)h(passed)f(to)g(evSchedule.)16
b(In)10 b(order)f(to)h(satisfy)e(the)h(C)h(compiler)0 1464
y(type)h(checking)g(rules)g(when)g(accessing)g(the)g(ar)o(guments,)h
(function)e Fq(f)i Fr(must)f(begin)g(by)g(casting)f(its)h(second)g(ar)o
(gument)h(to)0 1521 y(be)f(a)h(non-void)d(type.)0 1644 y Fm(5.2.2)45
b(evDetach)0 1731 y Fr(Releases)16 b(a)h(handle)e(to)h(an)g(event.)30
b(As)16 b(soon)f(as)h Fq(f)g Fr(completes,)h(the)f(internal)f(resources)h
(associated)f(with)g(the)h(event)0 1787 y(are)e(freed.)24 b(All)13
b(events)g(should)f(eventually)g(be)i(either)f(detached)g(or)h(canceled)g(to)
f(assure)g(that)g(system)g(resources)h(are)0 1843 y(released.)71
1925 y Fk(v)o(oid)c Fj(evDetac)n(h)h Fr(\()p Fk(Ev)o(en)o(t)h
Ff(e)p Fr(\))0 2072 y Fm(5.2.3)45 b(evCancel)0 2159 y Fr(Cancels)12
b(event)g Fq(e)g Fr(and)g(returns)f(EVENT)p 668 2159 14 2 v
16 w(FINISHED)h(if)g(the)g(event)f(has)h(already)g(happened,)g(EVENT)p
1688 2159 V 15 w(RUNNING)g(if)0 2216 y(the)e(event)g(is)g(currently)g
(running,)f(and)i(EVENT)p 784 2216 V 15 w(CANCELLED)f(if)g(the)g(event)g(has)
g(not)g(run)g(and)g(can)h(be)g(guaranteed)f(to)0 2272 y(not)h(run.)16
b(In)c(the)f(case)g(where)h Fj(evCancel)e Fr(returns)h(EVENT)p
1009 2272 V 15 w(RUNNING,)h(the)f(caller)g(must)g(be)g(careful)h(to)f(not)f
(delete)0 2329 y(resources)h(required)g(by)g(the)g(event.)71
2410 y Fk(EvCancelReturn)h Fj(evCancel)e Fr(\()p Fk(Ev)o(en)o(t)i
Ff(e)p Fr(\))952 2753 y(33)p eop
%%Page: 34 34
33 bop 0 124 a Fm(5.2.4)45 b(evIsCancelled)0 211 y Fr(Returns)11
b(true)f(if)h(an)g Fj(evCancel)g Fr(has)f(been)h(performed)h(on)e(the)h
(event.)16 b(Because)c(event)f(handlers)f(receive)h(their)g(event)0
268 y(as)f(the)g(\256rst)g(calling)g(ar)o(gument,)g(it)g(is)g(possible)e(for)
j(a)f(handler)g(to)g(check)h(for)f(cancellation)f(of)h(itself)g(from)h(other)
e(threads.)71 349 y Fk(in)o(t)i Fj(evIsCancelled)e Fr(\()p
Fk(Ev)o(en)o(t)j Ff(e)p Fr(\))0 472 y Fm(5.2.5)45 b(evDump)0
559 y Fr(Displays)8 b(a)i Fq(ps)p Fr(-style)e(listing)g(of)h
Fq(x)p Fr(-kernel)h(threads)f(in)h Fq(x)p Fr(-kernel')m(s)g(compiled)f(with)g
(DEBUG)g(mode.)16 b(The)10 b(address)f(of)g(the)0 615 y(entry)j(function,)f
(the)h(thread)g(state)f(\(pending,)h(scheduled,)f(running,)h(\256nished,)f
(or)h(blocked\),)g(the)g(time)g(relevant)g(to)f(the)0 672 y(thread)g(state,)f
(and)h(\257ags)g(\(detached)g(or)g(cancelled\),)g(are)h(displayed)d(for)i
(each)g(thread)g(controlled)e(by)i Fq(x)p Fr(-kernel)g(monitor)m(.)0
728 y(The)f(meaning)g(of)h(the)f(time)g(entry)h(varies)f(according)g(to)f
(the)i(state.)k(For)c(pending)e(threads,)i(the)f(time)g(is)g(the)g(time)h
(until)e(it)0 785 y(will)i(be)i(scheduled;)e(for)i(other)e(states)h(it)g(is)f
(the)h(time)h(the)f(thread)g(has)g(spent)f(in)h(that)g(state.)19
b(The)12 b(time)h(is)f(reset)g(on)g(each)0 841 y(transition,)d(i.e.,)k(it)d
(is)h(not)f(cumulative.)71 922 y Fk(v)o(oid)g Fj(evDump)f Fr(\()p
Fk(v)o(oid)p Fr(\))0 1047 y Fl(5.3)50 b(Usage)13 b(Rules)0
1134 y Fm(5.3.1)45 b(Repeating)12 b(Events)0 1221 y Fr(Each)f(event)g(that)g
(is)f(scheduled)g(executes)h(at)g(most)g(one)g(time.)17 b(Repeating)10
b(events)h(are)h(programmed)f(as)h(follows:)218 1383 y Fe(foo_init\(\))218
1440 y({)327 1496 y(...)327 1553 y(evDetach\()30 b(evSchedule\()g(f,)e
(argument,)i(INTERVAL)f(\))f(\);)218 1609 y(})218 1779 y(f\()g(Event)h(self,)
f(void)h(*arg)f(\))218 1835 y({)327 1891 y(actual)h(work)327
1948 y(...)327 2004 y(evDetach\()h(evSchedule\()g(f,)e(arg,)g(INTERVAL)i(\))d
(\);)218 2061 y(})0 2240 y Fm(5.3.2)45 b(Cancellable)11 b(Events)0
2327 y Fr(The)h(evIsCancelled)h(routine)e(is)h(designed)f(to)h(make)h(it)f
(easy)h(to)f(write)g(events)g(which)g(might)f(be)i(cancelled)f(before)h(\(or)
0 2383 y(while\))f(they)g(run.)22 b(It)12 b(is)h(common)g(practice,)g(for)g
(example,)h(for)f(a)g(session)f(to)g(pass)g(session)f(state)i(to)f(a)h
(timeout)f(event.)0 2440 y(The)f(evIsCancelled)g(noti\256cation)e(can)i(be)g
(used)g(to)f(synchronize)g(the)h(timeout)f(event)g(and)h(the)g(possible)e
(destruction)g(of)0 2496 y(the)i(session)f(state.)16 b(Here)11
b(is)g(an)g(example:)952 2753 y(34)p eop
%%Page: 35 35
34 bop 218 124 a Fe(foo_destroy\(\))218 181 y({)327 237 y(...)327
294 y(evCancel\()30 b(state->timeou)q(tEve)q(nt)g(\);)327 350
y(...)218 407 y(})218 576 y(foo_timeout\()h(Event)d(self,)h(void)f(*state)h
(\))218 632 y({)300 689 y(...)300 745 y(xPush\(lls,)h(retransmitMsg)q(\);)300
802 y(/*)327 858 y(*)e(xPush)g(may)h(have)f(blocked)h(--)f(check)h(to)e(see)h
(if)g(state)h(is)327 915 y(*)f(still)g(valid)327 971 y(*/)327
1028 y(if)g(\()g(evIsCancelled\(s)q(elf)q(\))i(\))e({)436 1084
y(return;)327 1140 y(})327 1197 y(state->timeo)q(utEv)q(ent)j(=)c
(evSchedule\()k(foo_timeout,)f(arg,)e(INTERVAL)i(\);)218 1253
y(})0 1432 y Fm(5.3.3)45 b(Event)12 b(Granularity)0 1519 y
Fr(Although)d(the)h(event)h(library)f(uses)g(an)h(ef)o(\256cient)g
(representation)f(\(timing)g(wheels\))g(protocol)f(programmers)j(should)d(be)
0 1576 y(careful)15 b(to)e(not)h(schedule)f(events)h(that)f(are)i(too)f
(\256ne)g(grained.)25 b(For)15 b(example,)g(in)f(TCP)-5 b(,)15
b(it)f(is)f(better)h(to)g(schedule)f(one)0 1632 y(event)e(for)g(every)g
(session)f(rather)i(than)e(for)i(every)f(message)g(that)g(is)f(sent.)952
2753 y(35)p eop
%%Page: 36 36
35 bop 0 124 a Fn(6)60 b(Map)15 b(Library)0 228 y Fr(The)e(map)h(library)e
(provides)g(a)i(facility)e(for)i(maintaining)d(a)j(set)f(of)g(bindings)e
(between)i(identi\256ers.)22 b(The)13 b(map)h(library)0 284
y(supports)e(operations)f(for)j(adding)e(new)i(bindings)d(to)i(the)g(set,)h
(removing)e(bindings)g(from)i(the)f(set,)h(and)f(mapping)f(one)0
340 y(identi\256er)e(into)h(another)n(,)g(relative)f(to)h(a)h(set)f(of)g
(bindings)e(\(lookup\).)15 b(Protocol)c(implementations)e(use)i(these)g
(operations)0 397 y(to)i(translate)g(identi\256ers)f(extracted)h(from)h
(message)g(headers)f(\(e.g.,)i(addresses,)f(port)f(numbers\))g(into)f
(capabilities)g(for)0 453 y(kernel)f(objects)f(\(e.g.,)j Fq(XObj)p
Fr(,)d Fq(Enable)p Fr(\).)0 578 y Fl(6.1)50 b(T)l(ype)13 b(De\256nitions)0
665 y Fr(The)e(map)h(library)e(de\256nes)h(two)g(data)g(structures:)k
Fq(MapElement)9 b Fr(and)i Fq(Map)p Fr(.)16 b Fq(Bind)11 b
Fr(is)f(a)i(pointer)e(to)h(a)g Fq(MapElement)p Fr(.)102 796
y Fk(t)o(yp)q(edef)k(struct)e Fr(mapelement)e Fi(f)295 852
y Fk(struct)16 b(map)q(elemen)o(t)181 b Fr(*next;)295 909 y
Fk(v)o(oid)13 b(*)196 b Fr(internalid;)295 965 y Fk(v)o(oid)13
b(*)196 b Fr(externalid;)102 1022 y Fi(g)11 b Fj(MapElemen)n(t)p
Fr(,)f(*)p Fj(Bind)p Fr(;)102 1135 y Fk(t)o(yp)q(edef)15 b(struct)e
Fi(f)295 1191 y Fk(in)o(t)257 b Fr(nEntries,)10 b(keySize;)295
1247 y Fk(MapElemen)o(t)75 b Fr(*cache;)295 1304 y Fk(MapElemen)o(t)g
Fr(*freelist;)295 1360 y Fk(MapElemen)o(t)g Fr(**table;)295
1417 y Fk(xk)o(ern)p 397 1417 13 2 v 16 w(return)p 525 1417
V 16 w(t)47 b Fr(\(*resolve\)\(\);)295 1473 y Fk(Bind)220 b
Fr(\(*bind\)\(\);)295 1530 y Fk(xk)o(ern)p 397 1530 V 16 w(return)p
525 1530 V 16 w(t)47 b Fr(\(*unbind\)\(\);)295 1586 y Fk(xk)o(ern)p
397 1586 V 16 w(return)p 525 1586 V 16 w(t)g Fr(\(*remove\)\(\);)102
1643 y Fi(g)11 b Fr(*)p Fj(Map)p Fr(;)0 1767 y Fl(6.2)50 b(Operations)0
1854 y Fm(6.2.1)45 b(mapCr)o(eate)0 1941 y Fr(Creates)16 b(a)f(map)g(with)f
Fq(nEntries)g Fr(elements)g(in)h(it.)27 b(External)15 b(ids)f(bound)g(in)g
(this)g(map)h(are)h Fq(keySize)f Fr(bytes)f(long.)27 b(The)0
1997 y(maximum)9 b(value)f(for)h(the)f(key)g(size)g(is)g(MAX)p
727 1997 14 2 v 16 w(MAP)p 841 1997 V 17 w(KEY)p 952 1997 V
16 w(SIZE,)h(currently)f(100)f(bytes.)15 b(Programmers)10 b(will)d(normally)0
2054 y(use)h Fg(sizeof\(structuretype\))f Fr(as)h(the)g(keysize)f(to)h
(facilitate)f(platform)h(independence.)14 b(Note)8 b(that)f(maps)h(never)g
(over\257ow)m(,)0 2110 y(but)i(they)h(perform)h(best)e(if)i
Fq(nEntries)d Fr(is)i(chosen)f(so)h(that)g(the)f(map)i(is)f(at)g(most)g
(50-80\045)f(full.)71 2167 y(If)15 b(the)f Fq(keySize)h Fr(parameter)h(is)e
(any)g(negative)g(number)n(,)j(the)d(resulting)f(map)i(will)f(support)f
(variable)i(length)e(keys.)0 2223 y(The)e(functions)f Fq(mapV)-5
b(arBind)8 b Fr(and)j Fq(mapV)-5 b(arResolve)9 b Fr(should)h(be)h(used)g
(with)f(such)h(a)g(map.)71 2305 y Fk(Map)25 b Fj(mapCreate)10
b Fr(\()p Fk(in)o(t)h Ff(nEntries)p Fr(,)h Fk(in)o(t)f Ff(keySize)p
Fr(\);)0 2427 y Fm(6.2.2)45 b(mapResolve)0 2514 y Fr(Looks)9
b(for)i(the)f(internal)g(identi\256er)g(bound)f(to)h(the)h(external)f
(identi\256er)g Fq(ext)h Fr(in)f(the)g(map)h Fq(Map)p Fr(.)16
b(Note)10 b(that)g(the)g(resolution)0 2571 y(will)h(be)i(done)f(with)f
Fq(keysize)h Fr(bytes)g(of)g(what)g(the)h Fq(ext)f Fr(identi\256er)g(points)f
(to,)h(where)h Fq(keysize)f Fr(is)g(the)g(parameter)i(that)d(was)0
2627 y(used)j(in)f(the)h Fq(mapCr)n(eate)g Fr(call.)25 b(If)14
b(a)h(binding)d(is)h(found,)i Fq(*ptr)e Fr(is)h(assigned)e(the)i(value)g(of)g
(the)g(internal)f(identi\256er)g(and)952 2753 y(36)p eop
%%Page: 37 37
36 bop 0 124 a Fr(XK)p 69 124 14 2 v 16 w(SUCCESS)12 b(is)f(returned.)16
b(If)11 b(no)g(appropriate)f(binding)f(is)i(found,)g(mapResolve)f(returns)h
(XK)p 1590 124 V 16 w(F)m(AILURE.)g(If)g Fq(ptr)g Fr(is)0 181
y(NULL,)g(only)f(the)h(error)h(code)f(is)g(returned.)71 262
y Fk(xk)o(ern)p 173 262 13 2 v 15 w(return)p 300 262 V 16 w(t)h
Fj(mapResolv)n(e)d Fr(\()p Fk(Map)i Ff(Map)p Fr(,)h Fk(v)o(oid)e
Fr(*)p Ff(ext)p Fr(,)i Fk(v)o(oid)e Fr(**)p Ff(ptr)h Fr(\);)0
385 y Fm(6.2.3)45 b(mapV)l(arResolve)0 472 y Fr(This)11 b(is)g(almost)g
(identical)f(to)i Fq(mapResolve)p Fr(.)17 b(Note)11 b(that)g(the)g
(resolution)f(will)h(be)g(done)h(with)e Fq(len)i Fr(bytes)f(of)g(what)h(the)f
Fq(ext)0 528 y Fr(identi\256er)h(points)f(to,)h(where)h Fq(len)f
Fr(is)g(a)h(parameter)g(to)f(this)g(call.)20 b(The)12 b(map)h(used)f(in)g
(this)f(call)i(must)f(have)g(been)h(created)0 585 y(with)d(a)i(negative)e
(key)h(size)g(\(see)h(section)e(6.2.1\).)71 666 y Fk(xk)o(ern)p
173 666 V 15 w(return)p 300 666 V 16 w(t)i Fj(mapV)-5 b(arResolv)n(e)9
b Fr(\()p Fk(Map)j Ff(Map)p Fr(,)g Fk(v)o(oid)e Fr(*)p Ff(ext)p
Fr(,)h Fk(in)o(t)g Ff(len)p Fr(,)h Fk(v)o(oid)f Fr(**)p Ff(ptr)f
Fr(\);)0 789 y Fm(6.2.4)45 b(mapBind)0 876 y Fr(Adds)15 b(a)i(binding)d(of)i
(external)g(id)g Fq(ext)g Fr(to)g(internal)f(id)h Fq(intern)f
Fr(to)h(map)h Fq(Map)p Fr(.)31 b(Note)15 b(that)h(the)g(binding)e(will)h(be)i
(done)0 932 y(with)c Fq(keysize)h Fr(bytes)f(of)g(what)h(the)f
Fq(ext)h Fr(identi\256er)g(points)e(to,)i(where)g Fq(keysize)g
Fr(is)f(the)h(parameter)h(that)e(was)h(used)f(in)g(the)0 989
y Fq(mapCr)n(eate)g Fr(call.)25 b(The)14 b(return)g(value)f(uniquely)f
(identi\256es)h(this)g(binding;)g(it)g(can)i(later)e(be)i(given)e(as)h(an)g
(ar)o(gument)g(to)0 1045 y Fq(mapRemoveBinding)p Fr(.)24 b(A)15
b(return)f(value)h(of)g(ERR)p 833 1045 14 2 v 16 w(BIND)g(indicates)f(that)g
(the)g(external)h(identi\256er)f(is)g(already)g(bound)0 1101
y(in)f(the)f(map)i(to)e(a)h(dif)o(ferent)g(internal)f(id.)22
b(If)13 b(the)g(external)f(identi\256er)h(is)f(already)h(bound)f(to)g(the)h
(same)h(internal)e(id,)h(that)0 1158 y(binding)c(is)i(returned.)71
1239 y Fk(Bind)g Fj(mapBind)f Fr(\()i Fk(Map)f Ff(Map)p Fr(,)h
Fk(v)o(oid)e Fr(*)p Ff(ext)p Fr(,)h Fk(v)o(oid)i(*)e Ff(intern)h
Fr(\);)0 1362 y Fm(6.2.5)45 b(mapV)l(arBind)0 1449 y Fr(This)15
b(is)h(almost)g(identical)f(to)h Fq(mapBind)p Fr(.)31 b(Note)16
b(that)f(the)h(binding)f(will)g(be)i(done)f(with)f Fq(len)h
Fr(bytes)g(of)g(what)g(the)g Fq(ext)0 1505 y Fr(identi\256er)c(points)f(to,)h
(where)h Fq(len)f Fr(is)g(a)h(parameter)g(to)f(this)g(call.)20
b(The)12 b(map)h(used)f(in)g(this)f(call)i(must)f(have)g(been)h(created)0
1562 y(with)d(a)i(negative)e(key)h(size)g(\(see)h(section)e(6.2.1\).)71
1643 y Fk(Bind)h Fj(mapV)-5 b(arBind)11 b Fr(\()g Fk(Map)h
Ff(Map)p Fr(,)f Fk(v)o(oid)g Fr(*)p Ff(ext)p Fr(,)g Fk(in)o(t)g
Ff(len)p Fr(,)h Fk(v)o(oid)h(*)e Ff(intern)h Fr(\);)0 1766
y Fm(6.2.6)45 b(mapRemoveBinding)0 1853 y Fr(Removes)12 b(binding)d
Fq(Bind)h Fr(from)i(map)f Fq(Map)p Fr(.)16 b(Returns)11 b Fq(XK)p
942 1853 V 17 w(F)-6 b(AILURE)11 b Fr(if)g(the)g(item)g(is)f(not)h(in)g(the)g
(map.)71 1934 y Fq(3.1)g(Compatibility)d(note)p Fr(:)15 b(Same)e(as)e(3.1)g
Fq(mapunbindbindi)o(ng)p Fr(.)71 2016 y Fk(xk)o(ern)p 173 2016
13 2 v 15 w(return)p 300 2016 V 16 w(t)h Fj(mapRemo)n(v)n(eBi)o(nding)d
Fr(\()p Fk(Map)i Ff(Map)p Fr(,)h Fk(Bind)f Ff(Bind)p Fr(\);)0
2138 y Fm(6.2.7)45 b(mapUnbind)0 2225 y Fr(Removes)14 b(binding)e(of)i(the)f
(association)f(key)i Fq(ext)g Fr(from)g(the)g(map)g Fq(Map)p
Fr(.)24 b(This)13 b(is)g(the)h(inverse)f(of)h Fq(mapBind)p
Fr(.)23 b(Returns)0 2282 y(XK)p 69 2282 14 2 v 16 w(F)m(AILURE)11
b(if)g(the)g(item)g(is)g(not)f(in)h(the)g(map.)71 2363 y Fq(3.1)g
(Compatibility)d(note:)16 b Fr(Same)c(as)g(3.1)f(mapremove.)71
2444 y Fk(xk)o(ern)p 173 2444 13 2 v 15 w(return)p 300 2444
V 16 w(t)h Fj(mapUn)n(bind)f Fr(\()p Fk(Map)g Ff(Map)p Fr(,)h
Fk(v)o(oid)24 b Fr(*)p Ff(ext)p Fr(\);)952 2753 y(37)p eop
%%Page: 38 38
37 bop 0 124 a Fm(6.2.8)45 b(mapClose)0 211 y Fr(Destroys)15
b(the)h(map)g(and)g(frees)g(its)g(space.)31 b(Any)15 b(elements)h(left)g(in)g
(the)f(map)i(will)e(be)h(unbound)e(before)i(the)g(map)h(is)0
268 y(destroyed.)71 346 y Fk(v)o(oid)10 b Fj(mapClose)g Fr(\()p
Fk(Map)i Ff(Map)p Fr(\);)0 468 y Fm(6.2.9)45 b(mapForEach)0
555 y Fr(Allows)9 b(iterative)g(access)i(to)f(the)f(entries)h(of)g(a)h(map)g
(by)f(the)g(provided)f(function)g Fq(f)p Fr(.)16 b(Each)10
b(call)g(to)g Fq(mapForEach)e Fr(puts)h(the)0 611 y(key)i(and)h(its)f(value)g
(into)g(ar)o(guments)g(passed)g(the)g(function)g Fq(f)p Fr(.)18
b(The)11 b(third)g(ar)o(gument)g(passed)g(to)h Fq(f)f Fr(is)g(the)h(supplied)
e(value)0 668 y Fq(ar)n(g)p Fr(.)25 b(As)14 b(long)f(as)h(the)f(\257ag)i
Fq(MFE)p 559 668 14 2 v 16 w(CONTINUE)g Fr(is)e(set)h(in)f(the)h(function')m
(s)f(return)h(value)g(and)g(there)g(are)g(unprocessed)0 724
y(keys,)d Fq(mapForEach)e Fr(will)h(continue)g(to)h(call)g
Fq(f)p Fr(.)71 780 y(If)i(the)g(\257ag)g Fq(MFE)p 361 780 V
16 w(REMOVE)f Fr(is)h(set)f(in)h(the)g(return)g(value,)g Fq(mapForEach)e
Fr(will)h(remove)i(the)f(entry)f(from)i(the)f(map)0 837 y(after)e(the)g(user)
f(function)g(returns)g(and)g(before)h(it)f(is)h(called)f(with)g(the)g(next)g
(map)h(entry)m(.)16 b(This)10 b(is)g(the)h(only)f(recommended)0
893 y(way)g(to)g(remove)g(the)g(\252current\272)h(map)f(entry)g(during)f(a)i
Fq(mapForEach)d Fr(operation.)15 b(If)c(the)e(user)i(function)d(tries)i(to)g
(remove)0 950 y(the)j(\252current\272)g(entry)g(directly)f(\(via)h(mapRemove)
h(or)f(mapUnbind\),)f Fq(mapForEach)f Fr(may)j(fail)f(to)f(\256nd)h(all)g(of)
g(the)g(map)0 1006 y(entries.)71 1063 y(New)g(map)g(entries)g(added)f(in)h
(the)g(middle)f(of)h(a)h Fq(mapForEach)d Fr(iteration)h(may)h(or)g(may)h(not)
e(show)g(up)h(during)f(that)0 1119 y(iteration.)j(Map)d(manipulations)d
(within)g(a)j Fq(mapForEach)d Fr(user)i(function)f(are)i(generally)f(not)f
(recommended.)71 1176 y Fq(MFE)p 168 1176 V 15 w(REMOVE)j Fr(and)h
Fq(MFE)p 553 1176 V 15 w(CONTINUE)h Fr(are)g(binary)e(\257ags)h(which)f(may)h
(be)g(combined)f(using)f(bitwise)h(OR.)h(A)0 1232 y(return)d(value)g(of)g(0)g
(negates)g(both)f(\257ags.)71 1289 y(The)h(order)g(in)g(which)f(keys)h(are)h
(returned)e(depends)h(on)g(the)f(internal)h(structure)f(of)h(the)g(map.)71
1367 y Fk(v)o(oid)f Fj(mapF)-5 b(orEac)n(h)p Fr(\()p Fk(Map)11
b Ff(m)p Fr(,)h Fk(MapF)m(orEac)o(hF)m(un)f Ff(f)p Fr(,)g Fk(v)o(oid)g
Fr(*)p Ff(ar)o(g)f Fr(\))71 1446 y Fk(t)o(yp)q(edef)k(in)o(t)d
Fj(MapF)-5 b(orEac)n(hF)g(un)14 b Fr(\()d Fk(v)o(oid)g Fr(*)p
Ff(key)p Fr(,)f Fk(v)o(oid)h Fr(*)p Ff(value)p Fr(,)h Fk(v)o(oid)e
Fr(*)p Ff(ar)o(g)h Fr(\))0 1569 y Fl(6.3)50 b(Usage)13 b(Rules)0
1656 y Fm(6.3.1)45 b(External)12 b(Keys)0 1743 y Fr(Maps)j(are)g(used)f(to)g
(bind)g(a)h(variable)f(length)g(external)g(id)g(to)g(an)h(internal)f(id)g(of)
g(type)h Fq(int)p Fr(.)26 b(The)14 b(size)h(of)f(the)h(external)0
1799 y(id)g(is)h(given)f(as)h(an)g(ar)o(gument)f(when)h(a)g(particular)f(map)
i(is)e(created.)31 b(All)15 b(external)g(ids)g(bound)g(using)g(this)f(map)j
(are)0 1856 y(expected)10 b(to)f(be)h(of)g(this)f(size.)16
b(The)10 b(user)g(is)g(warned)f(to)h(use)g(a)g(zero-izing)g(routine)e(like)i
Fg(bzero)h Fr(before)f(assigning)e(values)0 1912 y(to)14 b(a)h(structure)f
(that)f(will)h(be)g(used)g(with)g(the)g(map)h(routines.)25
b(The)14 b(C)h(language)f(can)h(have)f(uninitialized)e(data)i(in)g(the)0
1969 y(interstices)e(of)h(structures)f(\(i.e.,)j(padding)c(areas\),)k(and)e
(these)g(can)g(cause)g(structures)f(that)h(are)h(\252equal\272)f(\(i.e.,)i
(all)e(\256elds)0 2025 y(have)e(the)g(same)h(values\))e(to)h(fail)g(to)g(map)
h(to)e(the)h(same)h(value)f(in)f(the)h Fq(x)p Fr(-kernel.)0
2146 y Fm(6.3.2)45 b(Active)11 b(and)h(Passive)e(Maps)0 2233
y Fr(Protocols)j(generally)h(maintain)f(two)h(maps:)22 b(an)14
b(active)g(map)h(and)f(a)h(passive)e(map.)26 b(Active)14 b(maps)g(are)h(used)
f(to)g(map)0 2290 y(keys)c(found)f(in)h(incoming)g(messages)g(into)f(the)h
(session)f(that)h(will)f(process)h(the)g(message.)17 b(Thus,)10
b(the)g(active)g(map)g(holds)0 2346 y(information)e(about)g(the)h(set)g(of)g
(currently)g(active)g(connections.)14 b(Passive)9 b(maps)g(are)h(used)e(to)h
(bind)f(identi\256ers)h(to)f Fq(Enable)0 2403 y Fr(objects)i(\(section)h
(2.1.2\),)h(thereby)f(allowing)f(a)i(protocol)e(to)h(create)h(a)g(session)e
(when)h(a)h(message)g(that)f(is)g(part)g(of)g(a)h(new)0 2459
y(connection)e(arrives.)71 2516 y(T)m(ypically)m(,)g(a)i(protocol)e(binds)h
(an)g(active)h(key)f(to)g(a)h(session)f(in)g(its)g Fq(open)g
Fr(routine,)g(and)g(a)h(passive)f(key)g(to)h(an)f(enable)0
2572 y(object)f(in)g(its)g Fq(openEnable)f Fr(routine.)15 b(These)10
b(bindings)f(are)i(then)f(used)g(in)g(the)h(protocol')m(s)e
Fq(demux)i Fr(operation,)f(according)0 2629 y(to)h(the)g(general)g(pattern)f
(illustrated)g(in)g(\256gure)i(1.)952 2753 y(38)p eop
%%Page: 39 39
38 bop 574 151 a Fr(Figure)11 b(1:)k(Example)c(of)h(using)d(maps)j(in)e
(demux)0 257 y Fe(static)29 b(xkern_return_t)0 314 y(yap_demux\(sel)q(f,)h
(lls,)f(msg\))109 370 y(XObj)f(self;)109 426 y(XObj)g(lls;)109
483 y(Msg)g(*msg;)0 539 y({)109 596 y(Enable)56 b(*e;)109 709
y(/*)28 b(get)g(protocol-spec)q(ific)j(state)e(from)f(self)g(*/)109
765 y(pstate)h(=)f(self->state;)109 878 y(/*)g(extract)h(the)f(header)h(from)
f(the)h(message)g(*/)109 935 y(msgPop\(msg,)h(yapHdrLoad,)h(&hdr,)d(HLEN,)h
(0\);)109 1047 y(/*)f(make)g(an)g(active)h(key)f(from)g(fields)h(in)f(the)g
(header)h(\(and)g(other)f(info\))h(*/)109 1104 y(/*)f(then)g(see)g(if)g(it)g
(is)g(in)g(active)h(map;)f(if)g(found,)h(call)f(pop)g(*/)109
1160 y(activeid.loca)q(lpor)q(t)i(=)e(hdr.dstport;)109 1217
y(activeid.remo)q(tepo)q(rt)j(=)c(hdr.srcport;)109 1273 y(activeid.lls)k(=)c
(lls;)109 1330 y(if)h(\(mapResolve\(ps)q(tat)q(e->a)q(ctiv)q(ema)q(p,)i
(&activeid,)g(&s\))e(!=)g(XK_FAILURE\))109 1386 y({)218 1443
y(xkr)g(=)g(xPop\(s,)h(msg,)f(lls,)h(&hdr\);)218 1499 y(return)g(xkr;)109
1556 y(})109 1668 y(/*)f(make)g(a)g(passive)h(key)f(from)g(fields)h(in)f(the)
g(header)h(\(and)g(other)f(info\))h(*/)109 1725 y(/*)f(then)g(look)h(for)f
(it)g(in)f(the)h(passive)i(map)e(*/)109 1781 y(/*)g(if)g(found,)h(create)g(a)
e(new)h(session,)i(*/)109 1838 y(/*)e(save)g(a)g(binding)h(to)f(it)g(in)f
(the)i(active)f(map,)h(*/)109 1894 y(/*)f(and)g(call)g(opendone)i(and)e(pop)g
(*/)109 1951 y(passiveid)i(=)d(hdr.dstport;)109 2007 y(if)h(\(mapResolve\(ps)
q(tat)q(e->p)q(assi)q(vem)q(ap,)j(&passiveid,)f(&e\))e(!=)g(XK_FAILURE\))109
2064 y({)218 2120 y(s)g(=)f(yapCreateSes)q(sn\(s)q(elf,)k(e->hlpRcv,)f
(e->hlpType,)g(&activeid\);)218 2177 y(xDuplicate\(ll)q(s\);)218
2233 y(s->binding)g(=)e(mapBind\(pstate)q(->ac)q(tive)q(map)q(,)i(&activeid,)
g(\(int\)s\);)218 2289 y(xOpenDone\(e->)q(hlp)q(Rcv,)h(s,)d(self\);)218
2346 y(xkr)g(=)g(xPop\(s,)h(lls,)f(msg,)h(&hdr\);)218 2402
y(return)g(xkr;)82 2459 y(})109 2572 y(/*)f(don't)h(know)f(how)g(to)g
(process)h(this)f(message,)i(so)e(drop)g(it)g(*/)109 2628 y(return;)0
2685 y(})952 2753 y Fr(39)p eop
%%Page: 40 40
39 bop 71 124 a Fr(Notice)12 b(two)h(things)e(about)h(the)h(example.)23
b(First,)13 b(in)g(the)g(case)g(where)h(a)f(new)g(session)f(is)h(created,)h
(it)f(is)f(necessary)0 181 y(to)h(call)h Fq(xDuplicate)f Fr(on)g(the)h(lower)
o(-level)f(session)f(to)i(make)g(the)g(reference)h(we)f(hold)f(to)g(it)h
(permanent)g(\(see)g(Sections)0 237 y(2.2.15)e(and)g(11\).)19
b(Second,)13 b(it)e(is)h(useful)g(to)f(save)h(the)g(binding)e(of)j(an)f
(active)g(key)g(to)f(the)h(newly)g(created)g(session)f(in)g(the)0
294 y(session)e(object)h(itself.)16 b(\(The)10 b(same)h(thing)f(is)g(done)g
(when)g(a)h(session)e(is)h(created)h(in)g(the)f(protocol')m(s)g
Fq(open)g Fr(routine\).)15 b(This)0 350 y(is)f(because)h(it)f(will)f(be)i
(necessary)f(to)g(be)h(able)f(to)g(remove)h(the)f(binding)f(from)i(the)f
(active)g(map)h(when)f(the)h(session)e(is)0 407 y(closed,)c(and)g(this)f(is)h
(often)g(easier)g(or)h(more)f(ef)o(\256cient)h(if)f(the)g(binding)e(itself)i
(is)f(available.)16 b(Finally)m(,)9 b(the)g(active)g(key)g(in)f(this)0
463 y(example)13 b(includes)e(both)g(\256elds)h(found)g(in)g(the)g(message)h
(header)g(and)f(the)g(lower)o(-level)g(session)f(that)h(called)g(xDemux.)0
519 y(Using)g(the)g(lower)o(-level)g(session)f(as)i(part)g(of)g(the)f(active)
h(key)f(is)h(fairly)f(common;)i(it)e(helps)g(to)g(disambiguate)g(protocol)0
576 y(header)f(\256elds)g(that)g(are)h(not)e(unique)g(across)h(all)g(lower)o
(-level)g(connections.)952 2753 y(40)p eop
%%Page: 41 41
40 bop 0 124 a Fn(7)60 b(Thr)o(ead)14 b(Library)0 228 y Fr(The)c
Fq(x)p Fr(-kernel)h(uses)f(a)h(\252thread-per)o(-message\272)g(model)g(of)f
(computation,)g(and)g(provides)g(primitives)f(for)h(synchronizing)0
284 y(threads.)20 b(The)12 b(following)e(operations)h(af)o(fect)i(thread)g
(scheduling.)18 b(Of)13 b(these,)f(only)g Fq(semW)l(ait)e Fr(can)j(cause)g
(the)f Fq(x)p Fr(-kernel)0 340 y(to)f(run)g(a)g(dif)o(ferent)g(thread)g(than)
g(the)g(current)g(one.)71 397 y(Note)g(that)g(this)f(section)h(does)g(not)g
(de\256ne)g(any)h(operations)e(for)i(creating)f(or)h(destroying)d(threads.)17
b(This)11 b(is)g(because)0 453 y Fq(x)p Fr(-kernel)g(threads)e(are)i(created)
g(and)f(destroyed)f(implicitly:)k(threads)d(are)h(created)g(by)f(the)g
(device)g(driver)g(\(in)g(the)f(case)i(of)0 510 y(incoming)d(messages\),)i
(by)f(the)g(system)f(call)h(interface)h(\(in)f(the)g(case)g(of)g(outgoing)e
(messages\),)j(and)f(by)g(the)g(event)g(library)0 566 y(\(in)i(the)g(case)g
(of)h(an)f(event)g(\256ring\).)16 b(Threads)11 b(are)h(destroyed)e(when)h
(they)f(return)h(from)h(the)f(outer)o(-most)f(procedure.)0
691 y Fl(7.1)50 b(T)l(ype)13 b(De\256nitions)0 778 y Fr(The)e(only)f
(thread-related)h(type)g(that)f(protocol)g(programmers)i(need)f(be)h(aware)g
(of)f(is)g(the)f(type)h Fq(Semaphor)n(e)p Fr(.)16 b(However)n(,)0
834 y(this)10 b(type)h(is)f(de\256ned)i(by)e(the)h(underlying)f(platform)g
(and)h(is)g(opaque)g(to)g(the)f(protocol)g(programmer)m(.)0
958 y Fl(7.2)50 b(Synchr)o(onization)10 b(Operations)0 1045
y Fm(7.2.1)45 b(semInit)0 1132 y Fr(Initializes)10 b(semaphore)i
Fq(s)f Fr(with)f(a)i(count)f(of)h Fq(cnt)p Fr(.)17 b(Semaphores)12
b(in)f(the)g(kernel)g(are)i(normally)d(allocated)h(statically)f(\(i.e.,)0
1189 y Fq(Semaphor)n(e)g(x)p Fr(\))i(and)f(must)g(be)g(initialized)e(\()p
Fq(semInit\(&x,)i(1\))p Fr(\))h(before)f(they)g(are)h(used.)71
1270 y Fk(v)o(oid)e Fj(semInit)f Fr(\()p Fk(Semaphore)i Fr(*)p
Ff(s)p Fr(,)h Fk(in)o(t)f Ff(cnt)p Fr(\))0 1449 y Fm(7.2.2)45
b(semW)m(ait)0 1536 y Fr(Increments)12 b(the)f(use)h(count)e(for)i(the)g
(semaphore.)18 b(The)11 b(current)h(thread)f(will)g(either)g(acquire)g(the)h
(semaphore)g Fq(s)f Fr(or)h(give)0 1593 y(up)f(control)f(until)g(a)h
Fq(semSignal)e Fr(is)i(done)g(by)g(another)f(thread)h(and)g(the)g(scheduler)g
(runs.)71 1674 y Fk(v)o(oid)f Fj(semW)-5 b(ait)10 b Fr(\()p
Fk(Semaphore)h Fr(*)p Ff(s)p Fr(\))0 1853 y Fm(7.2.3)45 b(semSignal)0
1940 y Fr(The)10 b(current)h(thread)f(decrements)g(the)h(use)f(count)f(for)i
(semaphore)g Fq(s)p Fr(.)16 b(The)10 b(current)g(thread)h(continues)d
(executing.)16 b(Note)0 1997 y(that)8 b(if)h(multiple)e(threads)h(are)i
(blocked)e(on)g(the)h(semaphore,)g(there)g(is)f(no)h(policy)e(about)h(which)g
(thread)h(will)e(be)i(awakened)0 2053 y(by)i(the)g Fq(semSignal.)71
2134 y Fk(v)o(oid)f Fj(semSignal)f Fr(\()p Fk(Semaphore)i Fr(*)p
Ff(s)p Fr(\))0 2259 y Fl(7.3)50 b(Delay)0 2346 y Fr(Delays)11
b(the)g(current)g(thread)h(for)f(at)h(least)f Fq(msec)g Fr(milliseconds.)16
b(This)10 b(is)h(not)g(a)h(thread)f(primitive,)g(but)g(a)g(library)g(routine)
0 2402 y(built)h(on)h(top)g(of)g Fq(semW)l(ait)p Fr(/)p Fq(semSignal)o
Fr(.)21 b(Note)13 b(that)g(the)g(ar)o(gument)g(is)g(in)g(milliseconds,)g
(while)f(the)i(time)f(ar)o(gument)h(to)0 2459 y Fq(evSchedule)d
Fr(is)f(in)h(microseconds.)71 2540 y Fk(v)o(oid)f Fj(Dela)n(y)h
Fr(\()g Fk(in)o(t)23 b Fr(msec)11 b(\))952 2753 y(41)p eop
%%Page: 42 42
41 bop 0 124 a Fl(7.4)50 b(Locking)12 b(Operations)0 211 y
Fr(The)i Fq(x)p Fr(-kernel)g(provides)f(a)h(readers/writers)f(lock)g
(synchronization)f(type,)i Fq(ReadW)m(riteLock)p Fr(.)24 b(This)13
b(type)h(is)f(currently)0 268 y(built)d(on)h(top)g(of)g(the)h
Fq(x)p Fr(-kernel)f Fq(Semaphor)n(e)g Fr(type.)17 b(Although)9
b(originally)h(developed)g(for)i(the)f(machNetIPC)h(protocols,)0
324 y(the)g(lock)g(can)g(be)h(used)e(for)i(more)g(general)f(synchronization.)
17 b(The)12 b Fq(ReadW)m(riteLock)g Fr(implementation)f(favors)h(writers)0
381 y(\(i.e.,)g(if)g(queues)e(of)h(readers)h(and)f(writers)g(both)f(exist,)g
(writers)h(will)f(always)h(be)g(favored.\))71 437 y(Note)h(that)g(we)g
(expect)h(these)f(locking)f(operations)g(to)h(be)h(used)f(in)g(a)h
(multiprocessor)e(environment,)h(although)f(we)0 494 y(have)f(not)f(yet)h
(used)f(them)i(for)f(this)f(purpose.)15 b(Protocol)9 b(developers)g(working)g
(in)g(an)h(MP)h(environment)e(should)g(attempt)0 550 y(to)h(adhere)g(to)g
(this)f(interface.)16 b(However)n(,)11 b(we)f(consider)f(locking)g(on)g(an)h
(MP)h(to)f(be)g(an)g(unresolved)f(issue,)h(and)g(so)f(we)h(are)0
606 y(eager)i(to)e(hear)i(about)e(experiences)h(using)f(these)h(operations)f
(in)g(such)h(an)g(environment.)0 729 y Fm(7.4.1)45 b(rwLockInit)0
816 y Fr(Initializes)10 b(the)h(lock)f(for)i(subsequent)d(operations.)71
897 y Fk(v)o(oid)h Fj(rwLo)r(c)n(kInit)g Fr(\()p Fk(ReadW)m(riteLo)q(c)o(k)h
Fr(*\))0 1020 y Fm(7.4.2)45 b(rwLockDestr)o(oy)0 1107 y Fr(All)8
b(threads)h(waiting)e(on)i(this)e(lock)i(will)f(be)h(released)g(and)f(their)h
(locking)e(operations)h(will)f(return)i Fq(XK)p 1629 1107 14
2 v 17 w(F)-6 b(AILURE)p Fr(.)8 b(When)0 1164 y(both)i(the)h(reader)g(and)g
(writer)g(queue)f(are)i(empty)m(,)f(the)g(user)o(-supplied)e(RwlDestroyFunc)h
(will)f(be)i(called)g(with)f(a)h(pointer)0 1220 y(to)g(the)g(lock)f(and)h
(the)g Fq(void)p Fr(*)g(ar)o(gument.)71 1301 y Fk(v)o(oid)f
Fj(rwLo)r(c)n(kDestro)n(y)g Fr(\()i Fk(ReadW)m(riteLo)q(c)o(k)f
Fr(*,)g Fk(RwlDestro)o(yF)m(unc)p Fr(,)h Fk(v)o(oid)e Fr(*\))71
1383 y Fk(t)o(yp)q(edef)k(v)o(oid)d Fr(\()p Fj(*RwlDestro)n(yF)-5
b(unc)11 b Fr(\))h(\()f Fk(ReadW)m(riteLo)q(c)o(k)g Fr(*,)g
Fk(v)o(oid)g Fr(*)g(\);)0 1505 y Fm(7.4.3)45 b(r)o(eaderLock)0
1592 y Fr(Acquires)13 b(a)h(reader)g(lock.)24 b(Many)14 b(readers)g(may)g
(hold)f(the)g(lock)g(at)h(one)f(time,)i(but)e(no)g(writers)g(will)g(acquire)g
(the)h(lock)0 1649 y(while)c(at)i(least)e(one)h(reader)h(holds)e(the)h(lock.)
16 b(W)n(ill)11 b(return)g Fq(XK)p 1008 1649 V 16 w(F)-6 b(AILURE)11
b Fr(if)g(the)g(lock)g(was)g(destroyed)f(before)i(the)f(lock)0
1705 y(was)g(acquired.)71 1787 y Fk(xk)o(ern)p 173 1787 13
2 v 15 w(return)p 300 1787 V 16 w(t)h Fj(readerLo)r(c)n(k)d
Fr(\()j Fk(ReadW)m(riteLo)q(c)o(k)f Fr(*)g(\))0 1909 y Fm(7.4.4)45
b(r)o(eaderUnlock)0 1996 y Fr(Releases)11 b(a)h(reader)g(lock.)k(It)11
b(is)g(an)g(error)h(to)e(call)h Fq(r)n(eaderUnlock)g Fr(without)e(holding)g
(a)j(reader)g(lock.)71 2078 y Fk(v)o(oid)e Fj(readerUnlo)r(c)n(k)g
Fr(\()h Fk(ReadW)m(riteLo)q(c)o(k)g Fr(*)g(\))0 2200 y Fm(7.4.5)45
b(writerLock)0 2287 y Fr(Acquires)13 b(a)i(writer)f(lock.)25
b(While)13 b(a)i(writer)e(lock)h(is)g(held,)g(no)g(other)g(reader)h(or)f
(writer)g(may)g(acquire)g(the)g(lock.)25 b(W)n(ill)0 2344 y(return)11
b Fq(XK)p 181 2344 14 2 v 16 w(F)-6 b(AILURE)11 b Fr(if)g(the)g(lock)g(was)g
(destroyed)f(before)h(the)g(lock)g(was)g(acquired.)71 2425
y Fk(xk)o(ern)p 173 2425 13 2 v 15 w(return)p 300 2425 V 16
w(t)h Fj(writerLo)r(c)n(k)d Fr(\()j Fk(ReadW)m(riteLo)q(c)o(k)f
Fr(*)g(\))952 2753 y(42)p eop
%%Page: 43 43
42 bop 0 124 a Fm(7.4.6)45 b(writerUnlock)0 211 y Fr(Releases)11
b(a)h(writer)f(lock.)16 b(It)11 b(is)g(an)g(error)h(to)e(call)h
Fq(writerUnlock)f Fr(without)f(holding)h(a)h(writer)g(lock.)71
293 y Fk(v)o(oid)f Fj(writerUnlo)r(c)n(k)g Fr(\()h Fk(ReadW)m(riteLo)q(c)o(k)
g Fr(*)g(\))0 417 y Fl(7.5)50 b(Usage)13 b(Rules)0 504 y Fm(7.5.1)45
b(Scheduling)12 b(and)g(Pr)o(eemption)0 591 y Fr(The)g(currently)f(executing)
g(thread)h(gives)f(up)g(control)g(by)h(either)f(terminating)g(or)h(executing)
f(a)h Fq(semW)l(ait)e Fr(operation.)18 b(In)0 647 y(other)d(words,)h(the)f
Fq(x)p Fr(-kernel)h(does)e(not)h(preempt)g(threads;)i(threads)e(voluntarily)e
(give)h(up)h(control)g(of)g(the)g(processor)m(.)0 704 y(However)n(,)9
b(because)g(each)f(protocol)f(is)h(assumed)g(to)g(be)h(an)f(independent)f
(component,)h(protocols)f(are)i(written)e(to)h(assume)0 760
y(that)15 b(control)f(may)i(be)f(given)g(up)g(when)g(a)h(higher)e(or)i(lower)
f(level)g(protocol)f(is)g(invoked.)28 b(Therefore,)17 b(all)e(protocol-)0
817 y(protocol)8 b(operations)h(are)h(considered)f(to)g(have)h(the)f
(potential)f(to)i(cause)g(a)g(thread)f(switch,)g(and)h(all)f(data)h
(structures)f(must)0 873 y(be)i(\252secured\272)h(before)f(calling)f(such)h
(operations.)0 996 y Fm(7.5.2)45 b(Blocking)0 1083 y Fr(Although)15
b(the)i Fq(x)p Fr(-kernel)h(advocates)e(a)i(\252thread-per)o(-message\272)f
(model,)i(and)e(it)g(provides)f(primitives)g(for)h(blocking)0
1139 y(threads,)10 b(as)h(a)g(general)f(rule,)h(threads)f(should)f(not)g
(block)h(except)g(when)g(waiting)f(for)i(a)g(reply)f(in)g(an)g(RPC-like)h
(protocol.)0 1196 y(In)18 b(most)f(other)h(cases,)i(should)c(a)i(thread)g
(\(message\))h(not)e(be)h(able)f(to)h(proceed,)i(it)d(should)g(put)g(the)g
(message)h(in)g(a)0 1252 y(protocol-dependent)11 b(queue)i(and)g(return.)23
b(Later)n(,)14 b(another)f(thread)g(can)g(pick)g(the)g(message)h(up)e(out)h
(of)g(the)g(queue)g(and)0 1309 y(continue)d(processing)g(it.)71
1365 y(For)i(example,)i(when)e(an)g(incoming)f(thread/message)h(arrives)g(in)
g(IP)h(and)g(discovers)e(that)h(it)g(is)f(just)h(one)g(fragment)0
1422 y(of)e(a)h(lar)o(ger)f(datagram,)h(rather)g(than)e(blocking)g(the)g
(thread)h(and)g(waiting)f(for)h(the)g(other)g(fragments)g(to)g(arrive,)h(the)
e(thread)0 1478 y(should)j(insert)i(the)f(fragment)i(into)e(a)h(reassembly)g
(buf)o(fer)g(and)g(return.)25 b(The)14 b(thread)f(that)h(delivers)f(the)h
(last)f(fragment)0 1534 y(will)d(then)h(reassemble)g(the)g(fragments)g(into)f
(a)i(single)e(datagram)h(and)g(continue.)0 1657 y Fm(7.5.3)45
b(External)12 b(Thr)o(eads)0 1744 y Fr(Where)c(the)f Fq(x)p
Fr(-kernel)h(is)f(embedded)g(in)g(another)g(operating)g(system,)h(there)f
(may)h(be)g(asynchronous)d(threads)i(representing)0 1801 y(device)17
b(drivers)f(or)h(user)f(requests)g(that)g(want)g(to)h(enter)g(the)f
Fq(x)p Fr(-kernel.)34 b(These)16 b(threads)g(must,)i(in)f(general,)h(acquire)
0 1857 y(the)e Fq(x)p Fr(-kernel)h(master)g(lock)f(\(i.e.,)j(enter)d(the)g
Fq(x)p Fr(-kernel)h(monitor\))f(with)f Fq(xk)p 1232 1857 14
2 v 17 w(master)p 1374 1857 V 15 w(lock)h Fr(before)h(performing)f(any)g
Fq(x)p Fr(-)0 1913 y(kernel)j(operations,)g(including)e(other)h(thread)h
(synchronization)d(operations.)39 b(\(This)17 b(isn')o(t)i(necessary)f(for)h
(normal)0 1970 y Fq(x)p Fr(-kernel)10 b(threads)e(because)i(threads)e
(started)h(by)g Fq(evSchedule)g Fr(acquire)g(the)g(master)h(lock)e
(automatically)g(when)h(they)g(start)0 2026 y(running.\))15
b(Unless)9 b(a)h(call)g(is)g(explicitly)e(documented)h(otherwise,)h(threads)f
(may)i(not)e(make)i Fq(x)p Fr(-kernel)f(system)g(or)g(library)0
2083 y(calls)h(without)e(holding)g(the)i(master)h(lock.)71
2139 y(A)f(thread)g(acquires)g(and)g(releases)g(the)g(master)g
Fq(x)p Fr(-kernel)h(lock)e(with)h(the)f(following)g(operations.)71
2221 y Fk(v)o(oid)g Fj(xk)p 221 2221 17 2 v 19 w(master)p 408
2221 V 19 w(lo)r(c)n(k)g Fr(\()i Fk(v)o(oid)e Fr(\))71 2302
y Fk(v)o(oid)g Fj(xk)p 221 2302 V 19 w(master)p 408 2302 V
19 w(unlo)r(c)n(k)h Fr(\()g Fk(v)o(oid)g Fr(\))71 2408 y(Note)g(that)h
(normal)g(protocols)e(should)h(not)g(use)h(these)g(operations.)18
b(The)12 b(only)f(place)h(that)g(they)f(are)i(meaningful)f(is)0
2465 y(in)h(anchor)g(protocols,)g(such)g(as)g(device)g(drivers)g(and)g
(application-level)e(interface,)j(that)f(have)g(to)g(transition)f(between)0
2521 y(the)h Fq(x)p Fr(-kernel)g(and)g(the)g(host)f(OS.)h(Also)f(note)h(that)
f(this)g(interface)h(is)g(not)f(part)h(of)g(the)g(of)o(\256cial)g
Fq(x)p Fr(-kernel)g(interface;)h(it)f(is)0 2578 y(internal)d(to)h(the)g
(current)g(implementation)f(of)h(the)g Fq(x)p Fr(-kernel.)952
2753 y(43)p eop
%%Page: 44 44
43 bop 0 124 a Fm(7.5.4)45 b(Thr)o(ead)13 b(T)l(urnar)o(ound)0
211 y Fr(Protocols)f(should)f(refrain)j(from)g(taking)d(threads)i(which)f
(are)i(shepherding)e(outgoing)e(messages)j(down)g(the)g(protocol)0
268 y(stack)i(and)h(turning)f(them)h(around)f(to)g(accompany)h(messages)g
(traveling)f(up)g(the)h(protocol)e(stack.)31 b(Since)16 b(protocols)0
324 y Fq(ar)n(e)h Fr(allowed)g(to)g(reverse)g(thread)g(direction)f(from)i
(incoming)e(to)h(outgoing,)g(allowing)f(turnaround)g(from)h(outgoing)0
381 y(to)h(incoming)f(could)h(lead)g(to)g(a)g(thread)g(caught)g(in)g(a)h
(recursive)f(loop.)37 b(If)19 b(an)f(outgoing)e(thread)i(needs)g(to)g(send)g
(a)0 437 y(message)i(back)g(up,)i(it)d(should)f(start)i(a)g(new)g(thread)f
(to)g(do)h(this.)41 b(The)20 b(push)f(routine)g(of)h(the)f(ethernet)h
(protocol)0 494 y(\()p Fg(/usr/xkernel/protocols/eth)p Fr(\))11
b(has)g(an)h(example)f(of)g(how)g(this)f(is)h(done.)0 616 y
Fm(7.5.5)45 b(Multipr)o(ocessor)11 b(Support)0 703 y Fr(T)m(o)e(date,)h(we)f
(do)g(not)f(have)h(signi\256cant)f(experience)h(running)f(the)h
Fq(x)p Fr(-kernel)g(on)g(a)h(multiprocessor)m(.)15 b(W)l(e)9
b(have)h(introduced)0 760 y(locking)h(operations)g(that)h(are)i(useful)e(in)g
(certain)h(situations)d(on)i(a)h(uniprocessor)n(,)f(and)h(while)e(these)i
(operations)e(might)0 816 y(extend)h(to)h(an)g(MP)g(environment,)g(we)g
(cannot)f(be)h(certain)g(that)f(they)h(will.)20 b(Moreover)n(,)14
b(we)f(certainly)g(expect)f(that)g(the)0 873 y(implementation)7
b(of)i(both)e(the)i(locking)e(and)h(the)h(semaphore)f(operations)g(will)f
(need)i(to)f(change)g(in)h(an)f(MP)i(environment,)0 929 y(even)h(if)g(the)g
(interface)h(remains)f(the)g(same.)71 985 y(It)h(should)g(be)g(noted)g(that)h
(the)f Fq(x)p Fr(-kernel,)i(as)f(currently)f(implemented,)h(is)g(MP-safe,)h
(although)d(probably)h(not)g(MP-)0 1042 y(performant.)34 b(This)17
b(is)f(because)h(all)g(threads)f(executing)g(in)h(the)g Fq(x)p
Fr(-kernel)g(must)g(\256rst)g(acquire)g(a)h(master)f(lock;)i(i.e.,)0
1098 y(the)e Fq(x)p Fr(-kernel)g(is)g(currently)f(implemented)h(as)g(a)g
(single)f(monitor)m(.)34 b(Our)17 b(experience)g(suggests,)g(however)n(,)i
(that)d(this)0 1155 y(implementation)10 b(is)g(reasonably)h(ef)o(\256cient)g
(for)h(a)f(small)g(number)g(of)g(processors.)952 2753 y(44)p
eop
%%Page: 45 45
44 bop 0 124 a Fn(8)60 b(T)l(race)13 b(Library)0 228 y Fr(The)7
b(trace)g(library)g(provides)g(a)g(facility)g(for)g(tracing)g(system)g
(events.)12 b(Most)7 b(importantly)m(,)f(the)h(library)g(allows)g(conditio)o
(nal)0 284 y(printing)i(in)i Fq(printf)e Fr(format)j(of)f(statements)f
(taking)g(from)i(zero)g(to)f(six)f(variables.)0 408 y Fl(8.1)50
b(T)l(ype)13 b(De\256nitions)0 495 y Fr(The)8 b(current)h(value)f(of)h(the)f
(tracing)g(variable)g Fq(tracevar)g Fr(is)g(used)g(to)g(control)g(whether)g
(or)h(not)e(a)i(particular)f(trace)h(operation)0 552 y(takes)h(place.)16
b(The)10 b(trace)h(variable)f(values)g(can)g(be)h(set)f(at)g(system)g(build)f
(time;)h(see)h(section)e(12.)16 b(The)10 b(following)e(de\256ned)0
608 y(constants)i(are)h(suggestive)f(of)h(how)g(to)f(use)h(trace)h(levels:)
102 714 y(TR)p 163 714 14 2 v 17 w(NEVER)398 b(for)12 b(debugging)d
(statements)h(that)h(are)h(unused)e(\(noop\))102 771 y(TR)p
163 771 V 17 w(FULL)p 294 771 V 16 w(TRACE)271 b(every)12 b(subroutine)d
(entry)i(and)g(exit)102 827 y(TR)p 163 827 V 17 w(DET)l(AILED)328
b(all)11 b(functions)f(plus)g(dumps)g(of)i(data)f(structures)f(at)h
(strategic)f(points)102 884 y(TR)p 163 884 V 17 w(FUNCTIONAL)p
471 884 V 15 w(TRACE)95 b(all)11 b(the)g(functions)f(of)h(the)g(module)f(and)
h(their)g(parameters)102 940 y(TR)p 163 940 V 17 w(MORE)p 311
940 V 16 w(EVENTS)228 b(even)11 b(more)h(detail)f(on)f(events)102
997 y(TR)p 163 997 V 17 w(EVENTS)375 b(more)12 b(detail)e(than)h(major)g
(events)102 1053 y(TR)p 163 1053 V 17 w(SOFT)p 291 1053 V 16
w(ERROR)272 b(mild)11 b(warnings)102 1110 y(TR)p 163 1110 V
17 w(MAJOR)p 334 1110 V 16 w(EVENTS)205 b(open,)11 b(close,)g(etc.)102
1166 y(TR)p 163 1166 V 17 w(GROSS)p 326 1166 V 17 w(EVENTS)212
b(the)11 b(coarsest)g(tracing)g(level)102 1223 y(TR)p 163 1223
V 17 w(ERRORS)374 b(serious)10 b(non-fatal)h(errors;)g(some)g(residual)f
(event)h(traces)102 1279 y(TR)p 163 1279 V 17 w(AL)m(W)-5 b(A)l(YS)367
b(normally)11 b(only)f(used)h(during)f(protocol)g(development)0
1403 y Fl(8.2)50 b(Operations)0 1490 y Fm(8.2.1)45 b(xT)m(race)0
1577 y Fr(The)14 b Fq(xT)m(race)p Fe(n)i Fr(macro)f(takes)f
Fe(n)h Fr(ar)o(guments)f(in)g(addition)f(to)h(the)g(variables)f
Fq(tracevar)p Fr(,)i Fq(tracelevel)p Fr(,)g(and)f Fq(formatstring)p
Fr(.)0 1634 y Fq(tracevar)h Fr(is)g(a)h(name)g(associated)f(with)f(the)i
(variable)f(being)g(traced.)30 b Fq(tracelevel)15 b Fr(is)g(compared)h(to)f
(the)h(value)f(of)g(the)0 1690 y(trace)d(variable)f(to)g(determine)h(at)f
(runtime)h(if)f(the)g(trace)i(statement)e(should)e(be)j(printed.)17
b Fq(formatstrin)o(g)9 b Fr(is)i(a)h Fq(printf)p Fr(-style)0
1747 y(formatting)e(statement.)71 1803 y(Each)e(protocol)e(has)i(a)g(trace)h
(variable)e(based)h(on)f(the)h(protocol)f(name)h(with)f(\252p\272)h
(appended;)g(e.g.)16 b(udp)8 b(has)f Fq(traceudpp)p Fr(.)0
1860 y(In)20 b(addition)e(to)i(protocol)e(tracing,)k(there)e(are)h
Fq(x)p Fr(-kernel)f(trace)g(variables)g(for)g(subsystems:)31
b(init,)22 b(processswitch,)0 1916 y(protocol,)16 b(processcreation,)h
(cksum,)g(event,)g(system,)g(msg,)h(ptbl,)e(and)g(sessn.)30
b(Most)16 b(of)g(these)g(are)g(de\256ned)g(in)g(\256le)0 1973
y Fg(xkernel/include/xk)p 364 1973 V 17 w(debug.h)p Fr(.)71
2029 y(Note)9 b(that)h(the)g(trace)h(facility)e(automatically)g(supplies)f(a)
j(newline)e(at)h(the)g(end)h(of)f(the)g(trace)h(message;)f(the)g(supplied)0
2085 y(format)g(string)f(need)h(not.)16 b(Also,)9 b(note)h(that)f(there)h
(should)f(be)h(no)g(whitespace)f(preceding)g(a)i(trace)f(variable)g(name)h
(in)e(any)0 2142 y(tracing)i(statement.)16 b(Whitespace)10
b(will)g(cause)h(errors)h(in)e(the)h(macro)h(expansion)e(and)h(result)f(in)h
(compilation)f(errors.)71 2223 y Fj(xT)-5 b(race)p Fq(n)p Fr(\()p
Fk(in)o(t)10 b Ff(tracevar)p Fr(,)h Fk(in)o(t)g Ff(tracelevel)p
Fr(,)h Fk(c)o(har)g Fr(*)p Ff(formatstring)p Fr(,)f Ff(ar)o(gs,)i(...)18
b Fr(\))0 2305 y(For)11 b(example:)0 2411 y Fe(int)28 b(traceudpp;)82
2524 y(xTrace2\(udpp,)j(TR_ERRORS,)f("input)f(port)f(\045d)g(output)h(port)f
(\045d",)g(inp,)h(outp\);)952 2753 y Fr(45)p eop
%%Page: 46 46
45 bop 0 124 a Fm(8.2.2)45 b(xT)m(raceP)0 211 y Fr(The)10 b
Fq(xT)m(raceP)p Fe(n)g Fr(macros)g(function)f(much)g(the)h(same)g(way)g(as)f
(the)h Fq(xT)m(race)p Fe(n)g Fr(macros,)h(except)f(that)f(they)g(take)g(an)h
(XObject)0 268 y(as)h(their)f(\256rst)g(parameter)i(\(instead)d(of)i(a)g
(trace)g(variable\))f(and)g(they)g(print)g(the)g(protocol)f(instance)h(name)h
(of)g(the)f(XObject)0 324 y(before)h(the)g(rest)g(of)g(the)g(trace)h
(statement.)k(This)10 b(turns)g(out)g(to)h(be)g(very)g(useful)f(when)h
(reading)g(an)g Fq(x)p Fr(-kernel)g(trace)h(where)0 381 y(several)f
(protocols)e(were)j(interleaving)d(trace)j(statements.)k(W)l(e)11
b(recommend)h(using)e(the)h Fq(xT)m(raceP)p Fe(n)h Fr(macros)f(whenever)0
437 y(you)h(have)h(an)g(appropriate)f(XObject)g(in)h(scope,)g(using)e(the)i
Fq(xT)m(race)p Fe(n)h Fr(macros)f(only)f(when)h(there)g(is)f(no)h(such)f
(XObject)0 494 y(available.)71 574 y Fj(xT)-5 b(raceP)p Fq(n)p
Fr(\()p Fk(X)o(Ob)r(j)p Fr(,)11 b Fk(in)o(t)g Ff(tracelevel)p
Fr(,)i Fk(c)o(har)e Fr(*)p Ff(formatstring)p Fr(,)h Ff(ar)o(gs,)g(...)18
b Fr(\))0 720 y Fm(8.2.3)45 b(xIfT)m(race,)12 b(xIfT)m(raceP)0
807 y Fr(If)c(the)g Fq(tracelevel)f Fr(is)g(less)g(than)g(or)h(equal)f(to)g
(the)h(value)f(of)h(the)f Fq(tracevar)p Fr(,)h(then)f(execute)h(the)f
(statement)g(directly)g(following.)71 931 y Fj(xIfT)-5 b(race)10
b Fr(\()p Fk(in)o(t)h Ff(tracevar)p Fr(,)h Fk(in)o(t)f Ff(tracelevel)p
Fr(\))0 1012 y(For)g(example:)218 1114 y Fe(int)28 b(traceudpp;)218
1227 y(xIfTrace\(udpp)q(,)i(TR_ERRORS\))436 1283 y(dump_header\()q(\);)0
1385 y Fr(There)11 b(is)g(also)g(the)g(analogous)e(operation)h(taking)g(an)i
(XObject)e(instead)g(of)h(a)h(trace)f(variable:)71 1466 y Fj(xIfT)-5
b(raceP)11 b Fr(\()p Fk(X)o(Ob)r(j)p Fr(,)h Fk(in)o(t)f Ff(tracelevel)p
Fr(\))0 1588 y Fm(8.2.4)45 b(xAssert)0 1675 y Fr(If)12 b(the)f(expression)e
Fq(exp)j Fr(evaluates)e(to)h(F)m(ALSE,)g(the)g Fq(x)p Fr(-kernel)h(will)e
(print)g(a)i(message)f(and)g(halt.)71 1755 y Fj(xAssert)f Fr(\()p
Fk(b)q(o)q(ol)h Ff(exp)p Fr(\))0 1877 y Fm(8.2.5)45 b(xErr)o(or)0
1964 y Fr(Non-fatal)11 b(error)g(conditions)e(can)i(print)g(warnings)f(even)h
(in)g(nondebugging)d(mode)j(by)g(using)f(the)h Fq(xErr)n(or)f
Fr(call.)71 2044 y Fj(xError)g Fr(\()p Fk(c)o(har)k(*)d Ff(Err)o(orString)p
Fr(\))0 2168 y Fl(8.3)50 b(Usage)13 b(Rules)0 2255 y Fr(T)n(race)21
b(and)e(assert)h(statements)e(are)j(macros)f(which)f(are)h(only)f(active)g
(in)g(DEBUG)h(mode)g(\(see)g(section)e(12\).)42 b(In)0 2311
y(OPTIMIZE)14 b(mode,)h(debugging)d(and)i(trace)h(statements)e(go)g(away)h
(completely)m(.)25 b(One)13 b(should)g(keep)h(this)f(in)g(mind)h(to)0
2368 y(avoid)c(bugs)h(that)f(show)g(up)h(only)f(in)h(OPTIMIZE)h(mode.)k(For)c
(example,)g(the)f(statment:)218 2470 y Fe(xAssert\()30 b(mapResolve\(map,)h
(key,)d(&p\))g(==)g(XK_SUCCESS)i(\);)0 2572 y Fr(will)12 b(have)h(no)f(ef)o
(fect)i(in)e(OPTIMIZE)h(mode.)22 b(One)13 b(should)e(be)i(careful)g(to)g
(separate)g(the)f(operation)g(and)h(the)f(check)h(of)0 2629
y(the)e(return)g(code:)952 2753 y(46)p eop
%%Page: 47 47
46 bop 218 124 a Fe(res)28 b(=)g(mapResolve\(map)q(,)i(key,)f(&p\);)218
181 y(xAssert\()h(res)e(==)g(XK_SUCCESS)i(\);)71 287 y Fr(If)13
b(you)f(are)h(writing)f(a)h(new)f(protocol,)g(you)h(should)e(insert)h(trace)h
(statements.)20 b(Even)13 b(though)e(there)i(will)e(never)i(be)0
343 y(bugs)c(left)i(after)f(you)g(release)h(your)f(protocol,)f(it)h(may)h
(help)f(others)f(in)h(debugging)f(their)g(protocol)g(which)h(sits)f(on)h(top)
g(of,)0 400 y(or)h(below)m(,)g(yours.)16 b(Don')o(t)10 b(delete)h(these)g
(very)g(helpful)f(debugging)g(libraries)g(when)h(you)f(are)i(done.)952
2753 y(47)p eop
%%Page: 48 48
47 bop 0 124 a Fn(9)60 b(Utility)13 b(Routines)0 229 y Fl(9.1)50
b(Storage:)17 b(xMalloc)12 b(and)g(xFr)o(ee)0 316 y Fr(These)f(are)i(just)d
(like)h(Unix)g(malloc)h(and)f(free)i(functions.)j(The)11 b
Fq(xMalloc)g Fr(function)g(will)f(cause)i(an)g Fq(x)p Fr(-kernel)g(abort)f
(if)h(no)0 373 y(storage)f(is)f(available;)g(therefore,)i(it)f(has)g(no)g
(error)g(return)g(value.)71 451 y Fk(c)o(har)g Fj(*xMallo)r(c)p
Fr(\()p Fk(in)o(t)f Ff(size)p Fr(\))71 586 y Fk(in)o(t)h Fj(xF)-5
b(ree)p Fr(\()p Fk(c)o(har)11 b Fr(*)p Ff(buf)p Fr(\))0 709
y Fl(9.2)50 b(T)o(ime)0 796 y Fr(The)11 b Fq(x)p Fr(-kernel)h(uses)e(the)h
(same)h(time)f(structure)f(as)i(Unix:)102 893 y Fk(t)o(yp)q(edef)j(struct)e
Fi(f)295 949 y Fk(long)e Fr(sec;)295 1005 y Fk(long)g Fr(usec;)102
1062 y Fi(g)g Fj(XTime)f Fr(;)0 1240 y Fm(9.2.1)45 b(xGetT)o(ime)0
1327 y Fr(Sets)11 b Fq(*t)g Fr(to)g(the)f(current)i(time)f(of)g(day:)71
1405 y Fk(v)o(oid)f Fj(xGetTime)e Fr(\()p Fk(XTime)i Fr(*)p
Ff(t)p Fr(\))0 1526 y Fm(9.2.2)45 b(xAddT)o(ime)0 1613 y Fr(Sets)12
b(the)f Fq(r)n(es)h Fr(to)g(the)f(sum)h(of)g Fq(t1)f Fr(and)h
Fq(t2.)18 b Fr(Assumes)11 b Fq(t1)g Fr(and)h Fq(t2)f Fr(are)i(in)e(standard)g
(time)h(format)g(\(i.e.,)i(does)d(not)g(check)h(for)0 1670
y(integer)f(over\257ow)g(of)g(the)g(usec)g(value.\))71 1748
y Fk(v)o(oid)f Fj(xAddTime)f Fr(\()p Fk(XTime)i Fr(*)p Ff(r)o(es)p
Fr(,)g Fk(XTime)f Ff(t1)p Fr(,)i Fk(XTime)e Ff(t2)p Fr(\))0
1870 y Fm(9.2.3)45 b(xSubT)o(ime)0 1957 y Fr(Sets)11 b(the)g
Fq(r)n(es)g Fr(to)g(the)g(dif)o(ference)h(of)f Fq(t1)g Fr(and)g
Fq(t2.)16 b Fr(The)11 b(resulting)e(value)i(may)h(be)f(negative.)71
2035 y Fk(v)o(oid)f Fj(xSubTime)f Fr(\()p Fk(XTime)h Fr(*)p
Ff(r)o(es)p Fr(,)i Fk(XTime)e Ff(t1)p Fr(,)i Fk(XTime)e Ff(t2)p
Fr(\))0 2180 y Fl(9.3)50 b(Byte)12 b(Order:)18 b(ntohs,)12
b(ntohl,)g(htons,)g(and)f(htonl)0 2267 y Fr(The)g(byte)g(order)g(functions)e
(are)j(the)f(same)h(as)f(the)g(Unix)f(functions.)102 2386 y
Fk(u)p 127 2386 13 2 v 15 w(short)i Fj(n)n(tohs)p Fr(\()p Fk(u)p
416 2386 V 16 w(short)g Ff(n)p Fr(\))102 2442 y Fk(u)p 127
2442 V 15 w(long)f Fj(n)n(tohl)p Fr(\()p Fk(u)p 394 2442 V
15 w(long)f Ff(n)p Fr(\))102 2499 y Fk(u)p 127 2499 V 15 w(short)i
Fj(h)n(tons)p Fr(\()p Fk(u)p 416 2499 V 16 w(short)g Ff(n)p
Fr(\))102 2555 y Fk(u)p 127 2555 V 15 w(long)f Fj(h)n(tonl)p
Fr(\()p Fk(u)p 394 2555 V 15 w(long)f Ff(n)p Fr(\))952 2753
y(48)p eop
%%Page: 49 49
48 bop 0 124 a Fl(9.4)50 b(Checksum)0 211 y Fm(9.4.1)45 b(inCkSum)0
298 y Fr(Calculates)10 b(a)g(16-bit)f(1')m(s)i(complement)f(checksum)g(over)g
(the)g(buf)o(fer)h Fq(*buf)e Fr(\(of)i(length)e Fq(len)p Fr(\))h(and)g(the)g
(msg)g Fq(*m)p Fr(,)g(returning)0 355 y(the)g(bit)g(complement)h(of)g(the)f
(sum.)17 b Fq(len)10 b Fr(should)f(be)i(even)g(and)g(the)f(buf)o(fer)h(must)f
(be)h(aligned)f(on)g(a)i(16-bit)d(boundary)m(.)15 b Fq(len)0
411 y Fr(may)d(be)f(zero.)71 493 y Fk(u)p 96 493 13 2 v 15
w(short)h Fj(inCkSum)e Fr(\()p Fk(Msg)h Fr(*)p Ff(m)p Fr(,)h
Fk(u)p 666 493 V 15 w(short)g Fr(*)p Ff(buf)p Fr(,)e Fk(in)o(t)h
Ff(len)p Fr(\);)0 615 y Fm(9.4.2)45 b(ocsum)0 702 y Fr(Returns)13
b(the)f(1')m(s)i(complement)f(sum)g(of)g(the)g Fq(count)f Fr(16-bit)g(words)g
(pointed)f(to)i(by)g Fq(hdr)p Fr(,)g(which)f(must)h(be)g(aligned)f(on)h(a)0
759 y(16-bit)d(boundary)m(.)71 840 y Fk(u)p 96 840 V 15 w(short)i
Fj(o)r(csum)d Fr(\()j Fk(u)p 430 840 V 15 w(short)g Fr(*)p
Ff(hdr)p Fr(,)f Fk(in)o(t)g Ff(count)p Fr(\);)0 964 y Fl(9.5)50
b(Strings)12 b(to)g(Hosts)0 1051 y Fr(Utility)6 b(routines)g(exist)h(for)i
(converting)d(from)j(string)d(representations)h(of)h(IP)g(and)g(Ethernet)f
(addresses)g(to)h(their)f(structural)0 1108 y(counterparts)j(and)h
(vice-versa.)0 1230 y Fm(9.5.1)45 b(ipHostStr)0 1317 y Fr(Returns)11
b(a)h(string)f(with)g(a)h(\252dotted-decimal\272)f(representation)f(of)i(IP)g
(host)f Fq(h)h Fr(\(e.g.,)h(\252192.12.69.1\272\))e(This)g(string)f(is)i(in)f
(a)0 1374 y(static)f(buf)o(fer)n(,)i(so)f(it)g(must)g(be)g(copied)f(if)i(its)
e(value)h(is)f(to)h(be)g(preserved.)71 1455 y Fk(c)o(har)j(*)d
Fj(ipHostStr)g Fr(\()g Fk(IPhost)h Fr(*)p Ff(h)f Fr(\))0 1578
y Fm(9.5.2)45 b(str2ipHost)0 1665 y Fr(Interprets)10 b Fq(str)h
Fr(as)g(a)g(\252dotted-decimal\272)g(representation)f(of)h(an)g(IP)h(host)e
(and)h(assigns)e(the)i(\256elds)g(of)g Fq(h)g Fr(accordingly)m(.)k(The)0
1721 y(operation)10 b(fails)h(if)g Fq(str)f Fr(does)h(not)f(seem)i(to)f(be)g
(in)g(dotted-decimal)f(form.)71 1803 y Fk(xk)o(ern)p 173 1803
V 15 w(return)p 300 1803 V 16 w(t)i Fj(str2ipHost)e Fr(\()i
Fk(IPhost)g Fr(*)p Ff(h)p Fr(,)f Fk(c)o(har)26 b Fr(*)p Ff(str)11
b Fr(\))0 1925 y Fm(9.5.3)45 b(ethHostStr)0 2012 y Fr(Returns)14
b(a)g(string)f(with)g(a)h(representation)f(of)h(Ethernet)f(host)g
Fq(h)h Fr(\(e.g.,)i(\2528:0:2b:ef:23:11)o(\272\))c(This)h(string)g(is)g(in)h
(a)g(static)0 2069 y(buf)o(fer)n(,)e(so)f(it)g(must)f(be)i(copied)e(if)h(its)
g(value)f(is)h(to)g(be)g(preserved.)71 2150 y Fk(c)o(har)j(*)d
Fj(ethHostStr)f Fr(\()i Fk(ETHhost)g Fr(*)p Ff(h)f Fr(\))0
2273 y Fm(9.5.4)45 b(str2ethHost)0 2360 y Fr(Interprets)12
b Fq(str)g Fr(as)g(a)h(six-hex-digit-colon)o(-separated)d(representation)h
(of)i(an)f(Ethernet)g(host)f(and)i(assigns)e(the)h(\256elds)g(of)0
2416 y Fq(h)f Fr(accordingly)m(.)k(The)d(operation)e(fails)g(if)h
Fq(str)g Fr(does)f(not)h(seem)h(to)e(be)i(in)e(the)h(correct)h(format.)71
2498 y Fk(xk)o(ern)p 173 2498 V 15 w(return)p 300 2498 V 16
w(t)g Fj(str2ethHost)e Fr(\()i Fk(ETHhost)g Fr(*)p Ff(h)p Fr(,)f
Fk(c)o(har)26 b Fr(*)p Ff(str)11 b Fr(\))952 2753 y(49)p eop
%%Page: 50 50
49 bop 0 124 a Fl(9.6)50 b(Host)12 b(Name)h(Service)0 211 y
Fr(A)d(simple)g(way)g(of)h(mapping)e(host)h(name)h(strings)d(to)i(host)g(IP)h
(addresses)e(is)h(provided)f(via)h(rom)h(\256le)g(entries)f(\(see)g(section)0
268 y(13.2\))h(and)g(the)g(interface)g(function)f Fq(xk)p 626
268 14 2 v 17 w(gethostbyname)p Fr(.)71 324 y(During)g Fq(x)p
Fr(-kernel)h(startup,)f(rom)i(\256le)f(lines)f(beginning)f(with)h(the)h
(string)e(\252dns\272)i(are)h(parsed)e(into)g(name)i(and)f(address)0
381 y(components)f(and)h(added)g(to)g(the)g(host)f(name)i(table.)k(E.g.,)0
487 y Fe(dns)28 b(umbra)h(192.12.69.97)71 593 y Fr(The)11 b(host)f(name)i
(must)e(be)i(less)e(than)h(64)g(characters)g(in)g(length.)0
716 y Fm(9.6.1)45 b(xk)p 187 716 V 17 w(gethostbyname)0 803
y Fr(This)10 b(function)g(will)g(look)g(up)h(a)h(hostname)f(and)g(return)f
(its)h(IP)h(address)e(in)h(storage)g(provided)f(with)g(the)h(call.)16
b(The)c(name)0 859 y(must)d(be)h(an)g(exact)f(match)h(to)f(a)h(rom)g(\256le)g
(entry)m(,)g(NB)g(no)f(substrings)e(are)k(allowed.)k(If)10
b(the)f(name)i(is)e(not)g(found,)g(the)g(return)0 916 y(code)i(indicates)f
(failure.)71 997 y Fk(xk)o(ern)p 173 997 13 2 v 15 w(return)p
300 997 V 16 w(t)i Fj(xk)p 405 997 17 2 v 19 w(gethostb)n(yname)e
Fr(\()p Fk(c)o(har)h Fr(*)p Ff(name)p Fr(,)h Fk(IPhost)g Fr(*)p
Ff(addr)f Fr(\);)0 1121 y Fl(9.7)50 b(ROM)12 b(\256le)g(parsing)g(utilities)0
1208 y Fr(When)g(writing)f(a)i(protocol)f(that)g(provides)f(user)o
(-con\256gurable)h(ROM)h(\256le)g(options,)f(one)g(can)h(make)g(use)f(of)h
(the)f(ROM)0 1265 y(\256le)f(parsing)g(utilities)d(to)j(process)g(the)g(ROM)h
(\256le)f(entries.)16 b(T)m(o)11 b(use)g(these)f(utilities:)57
1371 y(1.)23 b(W)n(rite)10 b(separate)g(routines)f(to)g(handle)h(each)g(ROM)h
(option)e(your)g(protocol)g(will)g(support.)15 b(These)10 b(routines)f
(should)114 1428 y(be)i(of)g(the)g(following)e(type:)193 1552
y Fk(t)o(yp)q(edef)15 b(xk)o(ern)p 443 1552 13 2 v 15 w(return)p
570 1552 V 16 w(t)d Fr(\()p Fj(*X)n(Ob)s(jRomOptF)-5 b(unc)12
b Fr(\))432 1609 y(\()f Fk(X)o(Ob)r(j)h Ff(pr)o(otl)p Fr(,)g
Fk(c)o(har)g Fr(**)p Ff(\256elds)p Fr(,)g Fk(in)o(t)f Ff(numFields)p
Fr(,)i Fk(in)o(t)e Ff(lineNumber)p Fr(,)h Fk(v)o(oid)f Fr(*)p
Ff(ar)o(g)f Fr(\))114 1734 y(The)j(ROM)i(\256le)f(parsing)f(code)h(will)e
(call)i(this)f(handler)g(when)g(it)h(\256nds)f(an)h(appropriate)f(line)g(in)g
(the)h(ROM)h(\256le.)114 1790 y(The)10 b(number)h(of)g(\256elds)g(on)f(that)g
(line)g(and)h(the)g(\256elds)f(themselves)g(will)g(be)h(placed)f(in)h
Ff(numFields)h Fr(and)f Ff(\256elds)p Fr(,)114 1847 y(respectively)m(.)k(The)
c(line)g(number)g(is)g(provided)f(to)g(allow)h(the)g(handler)f(to)h(produce)g
(error)g(messages)g(if)h(desired.)114 1922 y(If)i(the)f(handler)g(returns)g
(XK)p 586 1922 14 2 v 16 w(F)m(AILURE,)h(the)f(parsing)g(code)h(will)e(print)
h(a)h(generic)f(\252ROM)i(\256le)f(format)g(error)r(\272)114
1978 y(message,)d(specifying)f(the)h(name)h(of)f(the)g(protocol)f(and)h(the)g
(line)f(number)m(.)57 2072 y(2.)23 b(Create)18 b(an)f(array)h(of)f
(XObjRomOpt)f(structures)g(which)h(bind)f(option)g(names)h(to)g(their)g
(handling)e(functions.)114 2129 y(There)c(is)g(one)g(XObjRomOpt)f(structure)g
(for)h(each)h(ROM)g(option.)193 2254 y Fk(t)o(yp)q(edef)j(struct)e
Fi(f)341 2310 y Fk(c)o(har)321 b Fr(*name;)82 b Fh(/*)13 b(name)g(of)g(the)h
(option)g(as)f(sp)q(eci\014ed)j(in)d(R)o(OM)h(\014le)g(*/)341
2367 y Fk(in)o(t)348 b Fr(minFields;)20 b Fh(/*)13 b(Minim)o(um)d(n)o(um)o(b)
q(er)j(of)g(\014elds)i(for)e(this)h(option)f(*/)341 2423 y
Fk(X)o(Ob)r(jRomOptF)m(unc)51 b Fr(func;)122 b Fh(/*)13 b(Handler)h(function)
g(*/)193 2479 y Fi(g)d Fj(X)n(Ob)s(jRomOpt)p Fr(;)952 2753
y(50)p eop
%%Page: 51 51
50 bop 57 124 a Fr(3.)23 b(Somewhere)12 b(in)e(your)h(protocol')m(s)f
(initialization)e(code,)k(call)f(\256ndXObjRomOpts.)170 199
y Fk(xk)o(ern)p 272 199 13 2 v 15 w(return)p 399 199 V 16 w(t)h
Fj(\014ndX)n(Ob)s(jRomOpts)p Fr(\()g Fk(X)o(Ob)r(j)p Fr(,)g
Fk(X)o(Ob)r(jRomOpt)e Fr(*,)h Fk(in)o(t)g Ff(numOpts)p Fr(,)h
Fk(v)o(oid)25 b Fr(*)p Ff(ar)o(g)10 b Fr(\);)114 275 y(This)k(routine)h
(scans)g(through)f(the)i(ROM)g(\256le,)i(looking)13 b(for)j(lines)f(where)h
(the)f(\256rst)h(\256eld)f(matches)h(either)f(the)114 331 y(protocol)7
b(name)j(or)f(the)f(full)g(instance)g(name)i(of)f(the)f(XObject)g(\(e.g.,)j
(if)e(the)f(protocol)g(instance)g(is)g Fe(ethdrv/SE0)p Fr(,)114
387 y(ROM)j(\256le)h(entries)e(with)g(either)h Fe(ethdrv/SE0)j
Fr(or)d Fe(ethdrv)h Fr(would)e(match.\))17 b(When)11 b(such)f(a)i(match)f(is)
g(found,)114 444 y(the)16 b(array)i(of)f(XObjRomOpts)f(is)g(scanned.)34
b(If)18 b(the)e(second)h(\256eld)g(of)g(the)g(line)f(matches)i(the)e(name)i
(\256eld)f(of)114 500 y(one)c(of)h(the)f(XObjRomOpts,)g(or)g(if)h(the)f(name)
h(\256eld)g(of)f(one)h(of)f(the)h(XObjRomOpts)e(is)h(the)g(empty)g(string,)g
(the)114 557 y(XObjRomOptFunc)c(for)h(that)g(option)f(is)h(called)g(with)f
(the)h(object,)g(all)g(ROM)i(\256elds)e(on)g(that)f(line,)i(the)f(number)g
(of)114 613 y(\256elds)g(on)h(that)g(line,)g(the)g(line)f(number)h(and)g(the)
g(user)o(-supplied)f(ar)o(gument.)114 688 y(If)17 b(the)f(\256rst)h(\256eld)g
(of)g(a)g(ROM)h(line)e(appears)h(to)f(match)h(the)g(XObject)f(but)g(none)g
(of)h(the)g(supplied)e(RomOpts)114 745 y(matches)e(the)f(second)g(\256eld,)i
(an)e(error)i(message)f(will)e(be)i(printed)f(and)g(XK)p 1341
745 14 2 v 16 w(F)m(AILURE)h(will)f(be)g(returned.)21 b(The)114
801 y(rest)11 b(of)g(the)g(ROM)h(entries)f(will)f(not)h(be)h(scanned.)k(This)
11 b(same)h(behavior)e(results)g(from)i(the)g(XObjRomOptFunc)114
858 y(returning)e(XK)p 361 858 V 16 w(F)m(AILURE)h(and)g(from)g(a)h(ROM)g
(line)e(with)g(too)h(few)g(\256elds)g(for)h(its)e(associated)g(handler)m(.)71
964 y(As)h(an)g(example,)h(consider)f(a)g(protocol)f(which)h(supports)f(two)g
(ROM)i(options,)e(a)i Fq(port)e Fr(option)g(and)h(an)h Fq(mtu)e
Fr(option,)0 1020 y(both)i(of)g(which)g(take)h(single)f(integer)g
(parameters.)21 b(This)12 b(example)h(shows)f(how)g(this)f(protocol)h(would)f
(interface)i(with)0 1077 y(the)e(romopt)g(parsing)f(utilities:)952
2753 y(51)p eop
%%Page: 52 52
51 bop 0 181 a Fe(static)29 b(xkern_return_t)i(readMtu\()e(XObj,)g(char)f
(**,)h(int,)f(int,)g(void)h(*)e(\);)0 237 y(static)i(xkern_return_t)i
(readPort\()f(XObj,)e(char)h(**,)f(int,)g(int,)h(void)f(*)f(\);)0
407 y(static)i(XObjRomOpt)h(opts[])f(=)e({)109 463 y({)h("mtu",)h(3,)e
(readMtu)j(},)109 519 y({)e("port",)h(3,)f(readPort)h(})0 576
y(};)0 745 y(static)g(xkern_return_t)0 802 y(readMtu\()g(XObj)g(self,)f(char)
h(**arr,)g(int)f(nFields,)h(int)f(line,)h(void)f(*arg)h(\))0
858 y({)109 915 y(PState)g(*ps)f(=)g(\(PState)h(*\)self->state;)109
1028 y(return)g(sscanf)g(\(arr[2],)g("\045d",)g(&ps->mtu\))h(<)d(1)55
b(?)28 b(XK_FAILURE)i(:)d(XK_SUCCESS;)0 1084 y(})0 1197 y(static)i
(xkern_return_t)0 1253 y(readPort\()h(XObj)e(self,)h(char)f(**arr,)h(int)f
(nFields,)i(int)e(line,)g(void)h(*arg)f(\))0 1310 y({)109 1366
y(PState)h(*ps)f(=)g(\(PState)h(*\)self->state;)109 1479 y(return)g(sscanf)g
(\(arr[2],)g("\045d",)g(&ps->port\))h(<)e(1)54 b(?)28 b(XK_FAILURE)i(:)d
(XK_SUCCESS;)0 1536 y(})0 1761 y(foo_init\()j(XObj)e(self)g(\))0
1818 y({)109 1874 y(...)109 1931 y(findXObjRomOp)q(ts\(s)q(elf)q(,)i(opts,)f
(sizeof\(opts\)/s)q(izeo)q(f\(XO)q(bjR)q(omOp)q(t\),)i(0\);)109
1987 y(...)0 2044 y(})952 2753 y Fr(52)p eop
%%Page: 53 53
52 bop 0 124 a Fn(10)74 b(Contr)o(ol)15 b(Operations)0 228
y Fr(Control)h(operations)g(are)i(used)e(to)h(perform)h(arbitrary)e
(operations)g(on)h(protocols)e(and)i(sessions,)g(via)g(the)g
Fq(xContr)n(ol)0 284 y Fr(operation)c(described)g(in)h(section)e(2.2.12.)25
b Fq(xContr)n(ol)13 b Fr(returns)g(an)h(integer)g(that)f(indicates)g(the)g
(length)g(in)g(bytes)g(of)h(the)0 340 y(information)c(which)g(was)h(written)g
(into)f(the)h(buf)o(fer)n(,)h(or)f(-1)g(to)g(indicate)f(an)h(error)m(.)71
397 y(All)j(implementations)e(of)j(control)f(operations)f(should)g(check)i
(the)f(length)g(\256eld)g(before)h(reading)g(or)f(writing)f(the)0
453 y(buf)o(fer)n(,)g(returning)e(-1)h(if)g(the)f(buf)o(fer)i(is)e(too)g
(small.)19 b(The)11 b Fg(checkLen\(actualLength,)16 b(expectedLength\))d
Fr(macro)g(can)0 510 y(be)e(used)g(for)g(this.)71 566 y(The)h
Fq(opcode)g Fr(\256eld)g(in)h Fq(xContr)n(ol)e Fr(speci\256es)h(the)h
(operation)e(to)h(be)h(performed)g(on)f(the)g(protocol)f(or)i(session.)19
b(There)0 623 y(are)c(two)f(\252classes\272)g(of)h(operations:)21
b(standard)14 b(ones)g(that)g(may)h(be)f(implemented)g(by)h(more)g(than)f
(one)g(protocol,)g(and)0 679 y(protocol-speci\256c)c(ones.)0
803 y Fl(10.1)62 b(Standard)11 b(Contr)o(ol)h(Operations)0
890 y Fm(10.1.1)56 b(Pr)o(otocol)11 b(and)h(Session)f(Operations)0
977 y Fr(These)g(operations)f(can)h(be)g(performed)h(on)f(both)f(sessions)f
(and)i(protocols.)114 1084 y(GETMYHOST)m(,)f(GETMYHOSTCOUNT)214
1178 y(When)g(used)g(on)g(a)h(protocol,)e(GETMYHOST)h(asks)g(for)g(all)g
(possible)f(host)g(addresses)h(for)h(the)214 1234 y(local)e(host.)16
b(When)10 b(used)f(on)h(a)h(session,)e(GETMYHOST)h(asks)g(for)g(the)g(local)g
(host)f(addresses)214 1290 y(actually)i(being)g(used)h(on)f(the)h
(connection.)18 b(If)13 b(the)e(buf)o(fer)i(is)f(too)f(small)h(for)g(all)g
(of)g(the)g(hosts,)214 1347 y(GETMYHOST)e(will)f(write)h(as)g(many)h(hosts)e
(as)h(the)h(buf)o(fer)f(allows)g(\(GETMYHOST)g(with)f(a)214
1403 y(buf)o(fer)k(lar)o(ge)g(enough)f(to)g(hold)g(one)h(host)f(will)f
(return)i(the)f(most)h(common)g(or)g(default)f(host.\))214
1460 y(GETMYHOSTCOUNT)17 b(asks)h(for)h(the)g(number)f(of)h(hosts)e(which)h
(will)g(be)h(returned)f(by)214 1516 y(GETMYHOST)m(.)114 1610
y(GETMAXP)l(ACKET)m(,)10 b(GET)o(OPTP)l(ACKET)214 1704 y(T)n(reats)15
b(the)g(buf)o(fer)h(as)g(a)f(pointer)g(to)g(an)g(integer)g(and)g(sets)g(it)g
(to)g(the)g(length)f(of)i(the)f(longest)214 1760 y(message)c(that)f(the)g
Fq(XObj)g Fr(can)h(deliver)f(\(GETMAXP)l(ACKET\))g(or)h(the)f(length)g(of)h
(the)f(longest)214 1817 y(message)d(that)g(can)g(be)g(delivered)g(witho)o(ut)
g(fragmentati)o(on)g(\(GET)n(OPTP)l(ACKET)m(.\))g(A)g(pro)o(tocol)214
1873 y(typically)f(implements)h(this)g(operation)f(by)i(querying)f(the)g
(lower)h Fq(XObj)p Fr(s)e(and)i(then)f(subtracting)214 1930
y(its)j(header)h(length.)214 2007 y(Although)h(GETMAXP)l(ACKET)i(and)h(GET)o
(OPTP)l(ACKET)f(can)h(be)g(performed)h(on)e(proto-)214 2063
y(cols,)i(it)f(is)g(preferable)h(to)f(use)g(them)g(on)g(sessions,)g(since)g
(dif)o(ferent)h(sessions)d(of)j(the)f(same)214 2120 y(protocol)10
b(may)h(return)g(dif)o(ferent)g(values.)114 2214 y(RESOL)l(VE,)g(RRESOL)l(VE)
214 2307 y(These)d(operations)e(map)j(high-level)e(addresses)g(into)g
(low-level)g(addresses)h(\(RESOL)l(VE\))g(and)214 2364 y(vice)j(versa)g
(\(RRESOL)l(VE.\))952 2753 y(53)p eop
%%Page: 54 54
53 bop 0 124 a Fm(10.1.2)56 b(Session)11 b(Operations)114 211
y Fr(GETPEERHOST)m(,)f(GETPEERHOSTCOUNT)214 305 y(GETPEERHOST)j(returns)g
(the)g(host)g(addresses)g(of)g(all)h(peers)f(of)h(a)g(session.)23
b(It)13 b(is)g(an)h(error)214 362 y(to)d(submit)h(a)g(buf)o(fer)h(that)e(is)h
(too)f(small)h(for)h(all)f(of)g(the)g(peer)g(hosts,)g(and)g(-1)g(will)f(be)i
(returned.)214 418 y(GETPEERHOSTCOUNT)h(asks)g(for)i(the)f(number)g(of)g
(hosts)f(which)h(will)f(be)h(returned)g(by)214 474 y(GETPEERHOST)m(.)114
568 y(GETMYPROT)o(O,)c(GETPEERPROT)o(O)214 662 y(T)n(reats)j(the)g(buf)o(fer)
h(as)g(a)f(pointer)g(to)g(a)g(long)g(and)g(sets)g(it)f(to)h(the)h(local)e(or)
i(remote)g(\252protocol)214 719 y(number)r(\272)j(of)h(the)f(session.)37
b(For)18 b(example,)j(UDP)e(returns)f(the)g(local)g(UDP)g(port)g(from)h(a)214
775 y(GETMYPROT)o(O)11 b(operation.)114 869 y(GETP)l(AR)m(TICIP)l(ANTS)214
963 y(T)n(reats)h(the)g(buf)o(fer)h(as)f(a)h(simple)e(array)i(of)f(bytes.)19
b(The)12 b(lower)g(session)f(creates)h(a)h(participant)214
1019 y(list)e(with)g(data)i(that)f(was)g(used)g(to)g(open)g(the)h(session.)19
b(This)11 b(participant)g(list)h(is)g(then)g(written)214 1076
y(into)e(the)i(control)f(buf)o(fer)h(using)e Fq(partExternalize)f
Fr(\(see)j(section)f(3.\))18 b(The)12 b(caller)g(will)e(have)i(to)214
1132 y(run)f Fq(partInternali)o(ze)e Fr(on)h(the)h(buf)o(fer)h(before)f(it)g
(can)h(be)f(used)f(as)i(a)f(participant)f(list.)214 1197 y(Sessions)17
b(typically)f(implement)i(this)g(control)f(op)h(by)g(\256rst)g(executing)f
(it)h(on)g(their)g(lower)214 1253 y(session.)f(If)12 b(their)g(protocol)e
(uses)i(information)e(on)i(participant)e(stacks,)i(they)f(then)h(run)f
Fq(part-)214 1310 y(Internalize)f Fr(on)h(the)h(buf)o(fer)n(,)h(push)d(their)
i(protocol-speci\256c)e(information)h(on)g(the)h(participant)214
1366 y(stacks,)e(and)h(then)g(re-externalize)g(the)g(participant)f(list)g
(into)g(the)h(buf)o(fer)m(.)114 1460 y(FREERESOURCES)214 1554
y(T)n(reats)j(the)f(buf)o(fer)h(as)g(a)g(pointer)f(to)g(an)h
Fq(xmsg)p 965 1554 14 2 v 16 w(handle)p 1106 1554 V 15 w(t)p
Fr(.)25 b(This)12 b(value)i(is)f(interpreted)g(as)h(the)214
1610 y(result)c(of)h(a)h(previous)e Fq(xPush)g Fr(and)h(frees)h(the)f
(resources)g(associated)f(with)g(that)h(message.)114 1704 y(SETNONBLOCKINGIO)
214 1798 y(T)n(reats)19 b(the)h(buf)o(fer)g(as)f(a)h(pointer)e(to)i(an)f
Fq(int)g Fr(\(non-zero)g(==)g(TRUE.\))h(This)f(operation)f(is)214
1854 y(interpreted)k(by)g(sessions)f(which)i(do)f(output)f(buf)o(fering.)52
b(Such)23 b(sessions)e(may)i(block)214 1911 y(threads)18 b(executing)g(an)h
(xPush)g(until)f(suf)o(\256cient)g(buf)o(fer)i(space)f(is)g(available)f(to)h
(hold)f(the)214 1967 y(outgoing)c(message.)32 b(If)16 b
(SETNONBLOCKINGIO\(true\))g(is)g(performed)g(on)g(such)g(a)h(ses-)214
2024 y(sion,)k(a)g(thread)f(which)f(would)g(normally)h(block)f(in)h(such)f(a)
i(situation)d(returns)h(with)g(an)214 2080 y(XMSG)p 348 2080
V 16 w(ERR)p 452 2080 V 17 w(WOULDBLOCK)11 b(message)g(handle)g(instead.)0
2204 y Fl(10.2)62 b(Pr)o(otocol-Speci\256c)12 b(Contr)o(ol)f(Operations)0
2291 y Fr(Protocol-speci\256c)h(opcodes)h(are)h(de\256ned)f(relative)f(to)h
(an)g(identi\256er)g(that)f(has)h(been)g(assigned)f(to)h(each)h(protocol.)21
b(For)0 2348 y(example,)c(the)e(protocol)f(ARP)i(has)f(been)h(assigned)e(the)
h(id)g Fg(ARP)p 1092 2348 V 17 w(CTL)p Fr(.)g(Individual)f(opcodes)g(are)i
(then)f(de\256ned)g(\(in)0 2404 y Fg(arp.h)p Fr(\))d(as)136
2511 y Fe(#define)30 b(ARP)p 439 2511 V 17 w(INSTALL)449 b(\(ARP)p
1202 2511 V 17 w(CTL*MAXOPS)30 b(+)e(0\))136 2567 y(#define)i(ARP)p
439 2567 V 17 w(IPINTERFACES)314 b(\(ARP)p 1202 2567 V 17 w(CTL*MAXOPS)30
b(+)e(1\))136 2623 y(#define)i(ARP)p 439 2623 V 17 w(IPADDRS)449
b(\(ARP)p 1202 2623 V 17 w(CTL*MAXOPS)30 b(+)e(2\))952 2753
y Fr(54)p eop
%%Page: 55 55
54 bop 0 124 a Fr(This)9 b(scheme)i(is)f(used)g(to)f(ensure)h(that)g(all)g
(control)f(opcodes)h(are)g(unique.)16 b(By)10 b(convention,)f
(protocol-speci\256c)g(opcodes)0 181 y(de\256ned)k(by)f(protocol)f(XYZ)i(are)
g(pre\256xed)g(with)e Fg(XYZ)p 890 181 14 2 v 17 w Fr(.)21
b(Also,)13 b(until)e(an)i(identi\256er)f(has)g(been)h(assigned)e(to)h(a)i
(protocol)0 237 y(you)d(are)h(writing)f(\(i.e.,)i Fg(upi.h)f
Fr(has)g(been)f(edited\),)h(you)f(can)h(use)f(a)i(set)e(of)h(temporary)f
(ids:)16 b Fg(TMP0)p 1592 237 V 17 w(CTL)p Fr(,)c Fg(TMP1)p
1839 237 V 17 w(CTL)p Fr(,)0 294 y(etc.)71 350 y(Protocol-speci\256c)e
(control)g(operations)g(are)i(described)e(in)h(the)g(manual)g(page)g(for)h
(each)f(protocol)f(in)h(appendix)f(A.)0 474 y Fl(10.3)62 b(Forwarding)12
b(Contr)o(ol)g(Operations)0 561 y Fr(There)e(are)h(several)f(situations)e
(where)i(an)g Fq(XObj)f Fr(may)i(not)e(be)h(prepared)h(to)e(handle)h(a)g
(control)f(operation.)15 b(For)c(example,)0 618 y(a)k(protocol-speci\256c)e
(control)g(operation)g(may)i(be)g(sent)e(through)g(several)i(intermediate)e
Fq(XObj)p Fr(s)g(in)h(a)h(graph)f(before)h(it)0 674 y(reaches)i(an)g
Fq(XObj)e Fr(that)h(understands)f(the)i(operation.)31 b(Because)17
b(of)g(this,)g Fq(XObj)p Fr(s)f(should)f(be)h(prepared)h(to)f(forward)0
731 y(control)10 b(operations)g(which)g(they)h(don')o(t)f(understand)g(or)h
(can')o(t)h(satisfy)e(to)h(their)f(lower)h Fq(XObj)p Fr(s.)952
2753 y(55)p eop
%%Page: 56 56
55 bop 0 124 a Fn(11)60 b(Refer)o(ence)12 b(Counting)j(XObjs)0
228 y Fr(V)-5 b(ersion)14 b(3.2)g(of)h(the)g Fq(x)p Fr(-kernel)g(maintains)e
(reference)j(counts)e(for)g(sessions)f(in)i(order)f(to)h(facilitate)e(their)i
(destruction.)0 284 y(The)10 b(following)f(implementation)g(notes)h(should)f
(guide)h(the)g(protocol)f(writer)i(towards)e(programming)i(techniques)e(that)
0 340 y(are)j(consistent)d(with)h(the)h(reference)i(count)d(mechanism.)71
397 y(In)h(v3.1,)h(the)f Fq(XObj)f Fr(structure)h(had)g(a)h(reference)g
(count)f(\256eld)g(which)g(was)g(supposed)f(to)h(keep)g(track)h(of)f(the)g
(number)0 453 y(of)16 b(external)g(references)h(to)e(that)h(object.)30
b(The)16 b(intent)f(was)g(that)h(the)g(object)f(could)g(safely)h(be)g
(destroyed)f(when)g(the)0 510 y(reference)d(count)f(fell)g(to)f(zero.)71
566 y(Unfortunately)m(,)15 b(the)g(proper)g(use)g(of)h(reference)h(counts)d
(was)h(never)h(documented.)29 b(W)n(ith)14 b(each)i(protocol)e(writer)0
623 y(deciding)e(to)h(handle)f(session)g(reference)j(counts)d(in)g(a)i(dif)o
(ferent)f(manner)h(\(if)f(at)g(all\),)h(reference)h(counts)d(were)i(seldom)0
679 y(accurate.)22 b(This)12 b(resulted)g(in)g(idle)h(sessions)e(that)h(were)
h(never)g(freed)h(and)e(in)h(dangling)e(references)i(to)g(sessions)e(which)0
736 y(had)g(been)g(destroyed.)71 792 y(Constructing)17 b(a)j(protocol)f
(which)g(directly)g(manipulates)f(reference)j(counts)e(and)g(does)g(so)h
(correctly)f(can)h(be)0 849 y(awkward)11 b(and)g(tedious.)k(V)-5
b(ersion)10 b(3.2)h(of)h(the)f Fq(x)p Fr(-kernel)g(has)g(addressed)g(this)f
(dif)o(\256culty)g(by:)68 954 y Fi(\017)23 b Fr(moving)10 b(all)h(direct)g
(reference)h(count)e(manipulation)g(into)g(the)h Fq(x)p Fr(-kernel)g
(infrastructure.)68 1048 y Fi(\017)23 b Fr(changing)10 b(the)h(semantics)f
(of)h(some)h(of)f(the)g(UPI)g(functions)68 1141 y Fi(\017)23
b Fr(explicitly)9 b(documenting)g(how)i(references)h(to)f(other)g
Fq(XObj)p Fr(s)f(may)h(be)h(used.)68 1235 y Fi(\017)23 b Fr(adding)10
b(system)g(support)g(for)h(session)f(caching)h(and)g(garbage)g(collection.)71
1340 y(The)g(rest)g(of)h(this)f(section)f(discusses)g(the)h(system)h(support)
e(for)h(reference)i(counts)e(and)g(explains)f(how)i(to)f(modify)g(a)0
1397 y(v3.1)g(protocol)f(to)g(properly)h(use)g(reference)h(counts)e(in)h
(v3.2.)71 1453 y(W)l(e)j(discuss)e Fq(XObj)h Fr(reference)j(counts)c(in)i
(the)f(context)g(of)h(sessions)e(\(rather)i(than)g(protocols\))e(because)i
(protocols)0 1510 y(are)e(relatively)e(static)g(objects)g(and)h(the)g(issues)
f(surrounding)f(their)i(reference)h(counts)e(are)i(not)f(very)g(interesting.)
0 1634 y Fl(11.1)50 b(Refer)o(ences)0 1721 y Fr(An)11 b Fq(XObj)f
Fr(reference)j(is)d(a)i(pointer)e(to)h(an)g Fq(XObj)p Fr(.)16
b(References)c(come)g(in)f(two)f(\257avors:)16 b Fd(permanent)11
b Fr(and)g Fd(temporary)p Fr(.)71 1777 y(A)f(permanent)g(reference)h(can)f
(be)g(used)g(inde\256nitely)m(.)15 b(As)9 b(long)g(as)h(the)g(holder)g(of)g
(a)g(permanent)g(reference)h(does)f(not)0 1834 y(call)i Fq(xClose)g
Fr(on)f(the)h(reference,)i(the)d(holder)g(knows)g(that)h(the)f(pointer)g
(will)g(remain)h(valid.)18 b(Permanent)13 b(references)g(are)0
1890 y(returned)e(by)g Fq(xOpen)p Fr(.)71 1947 y(An)e Fq(XObj)g
Fr(pointer)f(received)i(as)g(a)g(parameter)g(in)f(a)h(function)e(call)i(is)f
(a)h(temporary)f(reference.)18 b(It)9 b(can)h(only)f(be)g(safely)0
2003 y(used)i(for)g(the)g(duration)f(of)h(that)g(function)e(call.)71
2060 y(A)f(permanent)h(reference)h(may)f(be)g(created)g(from)h(a)f(temporary)
f(reference)i(by)f(using)e(the)i(UPI)g(function)e Fq(xDuplicate)p
Fr(.)0 2116 y(For)14 b(example,)h Fq(xDemux)e Fr(passes)g(a)h(reference)h(to)
e(the)h(lower)f(session)f(as)i(a)g(parameter)g(to)f(the)h(upper)f(protocol.)
22 b(If)14 b(the)0 2172 y(upper)f(protocol)f(wishes)h(to)g(save)g(this)f
(reference)j(beyond)d(the)h(extent)g(of)h(the)f(demux)g(call,)h(the)f
(protocol)g(should)e(call)0 2229 y Fq(xDuplicate)f Fr(on)h(the)g(session.)k
(The)c(protocol)f(can)h(then)g(safely)g(use)f(the)h(reference)i(until)d(it)g
(calls)h Fq(xClose)p Fr(.)0 2353 y Fl(11.2)50 b(Refer)o(ence)12
b(counts)0 2440 y Fr(Session)e(reference)j(counts)d(in)g(v3.2)h(are)h(a)g
(sum)f(of:)168 2546 y Fm(\261)23 b Fr(the)11 b(number)g(of)g(permanent)g
(external)g(references)h(to)f(the)g(session)168 2619 y Fm(\261)23
b Fr(the)11 b(number)g(of)g(outstanding)d Fq(xPop)p Fr(')m(s)k(on)e(the)h
(session)952 2753 y(56)p eop
%%Page: 57 57
56 bop 0 124 a Fm(11.2.1)56 b(Counting)12 b(External)f(Refer)o(ences)0
211 y Fr(Several)h(of)g(the)g(UPI)g(functions)e(are)j(involved)d(in)h
(maintaining)f(the)i(count)f(of)h(permanent)g(external)f(references.)20
b(They)0 268 y(are)14 b(listed)f(here)h(along)f(with)g(their)g(semantics)g
(with)g(respect)h(to)f(reference)i(counts)e(\(and)g(how)h(these)f(semantics)g
(have)0 324 y(changed)e(from)h Fq(x)p Fr(-kernel)f(version)f(3.1\):)114
430 y Fq(xCr)n(eateSessn\()g(...)18 b(\))214 524 y Fr(The)11
b(newly)f(created)i(session)d(has)i(an)h(initial)d(reference)j(count)f(of)g
(0)g(\(it)g(was)g(1)g(in)g(v3.1.\))114 631 y Fq(xOpen\()g(...)17
b(\))214 724 y Fr(The)10 b(session)g(returned)g(by)g(invoking)f(the)i(lower)f
(protocol')m(s)g(open)g(routine)g(has)g(its)g(reference)214
781 y(count)15 b(incremented)g(before)h(it)g(is)f(returned)g(to)h(the)f
(caller)h(of)g Fq(xOpen)p Fr(,)h(indicating)d(that)h(the)214
837 y(caller)h(now)g(has)h(a)f(permanent)h(reference)h(to)e(the)g(session.)31
b(\()p Fq(xOpen)17 b Fr(did)f(not)f(manipulate)214 894 y(reference)d(counts)e
(in)h(v3.1.\))114 1000 y Fq(xClose\()g(XObj)f(s)h(\))214 1094
y Fr(Decrements)f(the)g(reference)h(count)e(of)h(the)g(session,)f(indicating)
f(that)i(a)g(permanent)g(reference)214 1150 y(to)17 b(the)g(session)g(has)g
(been)h(released.)37 b(The)17 b(lower)h(protocol')m(s)f(close)g(operation)g
(is)g(called)214 1207 y Fd(only)10 b Fr(if)i(the)f(session')m(s)g(new)h
(reference)h(count)d(is)i(zero.)18 b(\()p Fq(xClose)12 b Fr(always)f(invoked)
f(the)i(lower)214 1263 y(protocol')m(s)e(close)h(operation)f(in)g(v3.1.\))114
1369 y Fq(xDuplicate\()g(XObj)g(s)h(\))214 1476 y Fr(By)d(default,)h
(increments)f(the)g(session')m(s)g(reference)h(count,)g(indicating)d(that)i
(a)h(new)f(permanent)214 1532 y(reference)g(to)f(the)g(session)f(has)i(been)f
(created.)16 b(If)8 b(the)f(session)f(has)h(its)f(own)h(duplicate)g
(function,)214 1589 y(that)j(is)h(called)g(instead.)k(\()p
Fq(xDuplicate)10 b Fr(did)h(not)f(exist)g(in)h(v3.1.\))0 1711
y Fm(11.2.2)56 b(Counting)12 b(xPops)0 1798 y Fr(T)m(o)f(understand)e(the)i
(second)g(component)f(of)h(the)g(reference)h(count,)f(the)g(number)g(of)g
(outstanding)e Fq(xPop)p Fr(s)h(on)h(a)g(session,)0 1855 y(it)e(is)h
(important)f(to)g(realize)h(that)g(a)g(protocol)e(does)i(not)f(have)h
(explicit)e(references)j(to)f(its)f(own)g(sessions.)14 b(That)c(is,)g(while)f
(a)0 1911 y(protocol)h(usually)g(maintains)h(pointers)f(to)h(its)g(sessions)f
(\(in)h(a)h(map\))g(and)g(invokes)e(operations)g(on)h(them,)i(the)e
(sessions')0 1968 y(reference)h(counts)e(do)g(not)g(take)h(these)f(pointers)f
(into)h(account.)16 b(\(This)10 b(is)g(why)g Fq(xCr)n(eateSessn)g
Fr(returns)g(an)h(object)f(with)g(a)0 2024 y(reference)i(count)f(of)g(0)g
(and)g(not)g(1.\))71 2081 y(For)e(a)h(protocol)e(to)h(safely)g(send)g(this)f
(session)g(pointer)h(outside)e(of)j(the)f(protocol)f(\(e.g.,)j(as)f(a)f
(parameter)i(in)e Fq(xDemux)p Fr(\),)0 2137 y(it)g(needs)h(to)g(turn)f(the)h
(pointer)f(into)g(a)h(reference)h(by)f(incrementing)f(the)h(session')m(s)e
(reference)k(count.)j(It)10 b(could)f(do)h(this)f(by)0 2193
y(calling)j Fq(xDuplicate)f Fr(on)h(the)g(session)f(as)i(soon)f(as)g(it)g(is)
h(extracted)f(from)h(the)f(session)g(map,)h(making)f(the)h(external)f(call,)0
2250 y(and)g(then)f(closing)f(the)i(session.)k(But)c(since)f(all)h(protocols)
e(must)h(do)h(this)e(for)i(incoming)f(messages,)h(this)f(functionality)0
2306 y(has)k(been)g(absorbed)f(into)g Fq(xPop)p Fr(.)28 b Fq(xPop)15
b Fr(increments)g(the)f(reference)j(count)d(of)h(the)g(session)f(before)h
(calling)f(the)h(pop)0 2363 y(function)10 b(and)h(decrements)g(it)g
(\(possibly)e(calling)h(the)h(session')m(s)f(close)h(operation\))f
(afterwards.)71 2419 y(It)18 b(could)g(be)h(ar)o(gued)g(that)f(all)h(UPI)g
(functions,)g(not)f(just)g Fq(xPop)p Fr(,)i(should)e(indicate)f(their)i(use)f
(of)h(a)g(session)f(by)0 2476 y(incrementing)9 b(the)h(reference)h(count)e
(at)h(their)f(start)g(and)h(decrementing)g(it)f(at)h(their)f(completion.)15
b(T)m(o)9 b(perform)i(any)f(other)0 2532 y(UPI)g(operation)e(on)h(a)g
(session,)g(however)n(,)g(one)h(must)e(already)i(have)f(a)g(reference)i(to)e
(that)f(session.)15 b(As)8 b(long)h(as)g(an)g Fq(xClose)0 2589
y Fr(is)14 b(not)g(performed)h(on)f(that)g(reference,)j(the)d(session)f(is)h
(not)g(going)f(to)h(go)g(away;)i(maintaining)d(reference)j(counts)d(for)952
2753 y(57)p eop
%%Page: 58 58
57 bop 0 124 a Fr(these)10 b(operations)g(is)g(not)g(necessary)m(.)17
b Fq(xPop)p Fr(s)10 b(are)h(dif)o(ferent)g(in)f(that)h(a)g(session')m(s)f
(reference)i(count)e(does)g(not)g(re\257ect)i(that)0 181 y(its)e(protocol)g
(may)i(send)e(messages)i(up)e(through)g(it.)71 237 y(Note)e(that)f(reference)
j(counts)e(will)f(not)h(help)g(a)h(protocol)e(which)h(performs)g(an)h
Fq(xClose)f Fr(on)g(a)h(session)e(reference)j(while)0 294 y(another)e(thread)
h(has)f(an)h(outstanding)e(operation)g(on)i(that)f(same)h(reference.)17
b(T)m(o)9 b(perform)g(such)f(a)h(sequence)g(is)f(a)i(protocol)0
350 y(error)m(.)25 b(If)14 b(two)f(threads)g(share)h(a)f(session)g
(reference,)i(they)e(should)f(either)i(synchronize)e(to)h(avoid)g(such)g
(sequences)g(or)0 407 y(they)f(should)f(duplicate)h(the)g(reference)i(with)e
Fq(xDuplicate)f Fr(and)h(each)i(thread)e(should)f Fq(xClose)i
Fr(its)e(reference)j(when)f(it)f(is)0 463 y(through.)0 587
y Fl(11.3)50 b(Internal)12 b(vs.)19 b(External)11 b(Refer)o(ence)i(Counts)0
674 y Fr(Session)c(reference)i(counts)e(are)h(meant)h(to)e(count)g(the)h
(number)g(of)g Fq(external)f Fr(references)h(to)g(the)g(session)e(\(i.e.,)j
(references)0 731 y(held)j(outside)f(of)i(the)f(protocol.\))26
b(If)16 b(a)f(protocol)e(must)h(keep)h(track)g(of)f(session)g(references)h
(internal)f(to)g(the)h(protocol)0 787 y(itself,)c(a)g(separate)g(mechanism)h
(must)f(be)g(used.)71 844 y(This)d(requirement)h(is)f(driven)h(by)g(upper)g
(protocols)e(which)i(require)g(that)f(when)h(they)g(release)g(all)g(of)h
(their)e(references)0 900 y(to)j(a)g(lower)g(session)e(that)h(the)h(session')
m(s)f(reference)i(count)e(goes)h(to)f(zero.)17 b(V)m(irtual)11
b(protocols)e(which)h(manipulate)h(lower)0 957 y(session')m(s)f(upper)h
(protocol)f(pointers)g(are)h(speci\256c)h(examples)f(of)g(these)g(upper)g
(protocols.)0 1081 y Fl(11.4)50 b(Session)12 b(Caching)g(Strategies)0
1168 y Fr(In)g(the)g(presence)g(of)g(correct)h(management)f(of)h(reference)g
(counts,)e(protocols)g(may)h(want)g(to)g(implement)f(some)i(sort)e(of)0
1224 y(session)j(caching.)28 b(For)16 b(example,)g(many)g(of)f(the)g
(sessions)f(created)h(on)g(the)g(receiving)g(end)g(of)g(a)h(remote)f
(procedure)0 1281 y(call)g(will)f(have)h(their)g(reference)h(counts)e(go)h
(to)g(zero)h(after)f(the)g(reply)g(has)g(been)g(sent,)h(and)f(without)e
(caching,)j(all)f(of)0 1337 y(those)f(sessions)f(will)h(be)i(destroyed.)27
b(While)14 b(caching)h(may)g(not)g(be)g(important)f(for)h(all)g(protocols,)g
(it)f(is)h(vital)f(to)g(the)0 1394 y(performance)e(of)f(protocols)f(that)g
(experience)i(a)f(high)f(frequency)h(of)h(traf)o(\256c)g(from)f(the)g(same)h
(sources.)71 1450 y(If)f(a)g(protocol)f(does)g(cache)i(idle)e(sessions,)g(it)
g(is)h(important)e(to)i(make)g(the)g(caching)g(transparent)f(to)g(upper)h
(protocols)0 1507 y(\(i.e.,)h(an)f(upper)g(protocol)f(should)f(not)i(be)g
(able)g(to)f(distinguish)e(a)j(newly)g(created)g(lower)g(session)e(from)j(a)f
(cached)g(lower)0 1563 y(session)f(that)g(is)h(being)f(reused.\))17
b(One)11 b(aspect)g(of)g(this)g(requirement)g(is)f(that)h(protocols)f(which)g
(cache)i(sessions)d(must)i(be)0 1619 y(sure)i(to)g(check)g(for)h(the)e
(presence)i(of)f(openEnables)f(when)g(reusing)h(sessions)e(which)h(would)g
(otherwise)h(be)g(passively)0 1676 y(created)f(and)f(to)f(call)h(xOpenDone)f
(when)h(reusing)f(such)h(sessions)e(from)j(the)f(cache.)71
1732 y(Here)f(are)h(some)f(examples)g(of)g(caching)f(strategies)g(and)h(how)g
(a)g(protocol)f(might)g(implement)h(them.)16 b(These)10 b(are)g(just)0
1789 y(examples)h(\261)g(other)g(strategies)f(are)i(certainly)e(possible:)68
1895 y Fi(\017)23 b Fr(Destroy)10 b(the)h(session)e(if)j(inactive.)114
1970 y(In)f(this)f(\252null)g(caching\272)h(strategy)m(,)g(the)g(session')m
(s)f(close)g(routine)h(destroys)e(the)i(session:)332 2095 y
Fe(foo_close\(s\))550 2152 y(xAssert\(s->rc)q(nt)30 b(==)e(0\);)550
2208 y(xDestroy\(s\);)68 2333 y Fi(\017)23 b Fr(Garbage)11
b(collector)f(on)h(a)h(per)o(-session)e(basis)114 2408 y(A)16
b(garbage)g(collector)g(event)g(is)g(started)g(for)g(each)h(idle)f(session.)
30 b(When)16 b(the)g(event)g(expires,)i(the)e(session)f(is)114
2465 y(collected.)293 2579 y Fc(foo_demux)q(\(\))472 2624 y(if)24
b(\()e(active)j(session)h(does)e(not)f(exist)i(\))e({)952 2753
y Fr(58)p eop
%%Page: 59 59
58 bop 652 124 a Fc(if)23 b(\()g(openEnable)j(exists)f(\))e({)831
170 y(if)g(\()g(cached)i(session)g(exists)g(\))e({)1010 216
y(evCancel)q(\(ss)q(ta)q(te)q(->g)q(c\))q(;)1010 261 y(sstate->)q(gc)j(=)d
(0;)831 307 y(})g(else)h({)1010 353 y(s)f(=)g(foo_open\()q(\);)831
398 y(})831 444 y(xOpenDone)q(\(s)q(,)i(...\);)652 490 y(})d(else)j({)831
535 y(drop)f(packet;)h(return;)652 581 y(})472 627 y(})472
672 y(xPop\(\))293 764 y(foo_open\()q(\))472 809 y(...)472
855 y(if)f(\()e(active)j(session)h(does)e(not)f(exist)i(\))e({)652
901 y(if)g(\(cached)i(session)h(exists)e(\))f({)831 946 y(evCancel\()q(ss)q
(tat)q(e-)q(>gc)q(\);)831 992 y(sstate->g)q(c)j(=)c(0;)652
1037 y(})472 1083 y(})472 1129 y(...)293 1220 y(foo_close)q(\(s)q(\))472
1266 y(sstate->)q(gc)k(=)d(evRegister)q(\(f)q(oo)q(_gc)q(,)j(s\);)472
1311 y(mark)e(session)i(as)d(cached)293 1403 y(foo_gc\(s\))472
1448 y(xDestroy)q(\(s\))q(;)68 1569 y Fi(\017)g Fr(Garbage)11
b(collector)f(on)h(a)h(per)o(-protocol)e(basis)114 1643 y(There)h(is)f(a)i
(single)d(garbage)j(collector)e(for)h(the)g(protocol\320it)e(runs)i(every)g
(so)f(often)h(and)g(looks)e(for)j(idle)e(sessions)114 1700
y(in)g(the)h(protocol')m(s)f(session)g(map,)i(calling)e(a)i
(protocol-speci\256c)e(destroy)g(function)g(if)h(it)f(\256nds)h(one.)114
1774 y(The)i Fq(x)p Fr(-kernel)h(has)f(a)h(default)f(session)f(garbage)i
(collector)e(which)h(a)h(protocol)e(can)i(use)g(for)f(this)g(purpose.)22
b(See)114 1831 y(xkernel/include/gc.h)8 b(for)k(the)f(interface.)305
1951 y Fb(foo_init\(\))495 2008 y(...)495 2064 y
(initSessionCollector\(cacheMap)o(,)21 b(interval,)i(foo_destroy\);)305
2177 y(foo_demux\(\))495 2233 y(if)h(\()g(active)f(session)g(does)g(not)g
(exist)h(\))f({)686 2290 y(if)h(\()g(openEnable)e(exists)h(\))h({)877
2346 y(if)g(\()g(cached)f(session)g(exists)g(\))g({)1068 2403
y(move)g(sessn)h(from)f(cached)g(map)g(to)1068 2459 y(active)g(map)877
2516 y(})h(else)f({)1068 2572 y(s)h(=)g(foo_open\(\);)877 2629
y(})952 2753 y Fr(59)p eop
%%Page: 60 60
59 bop 877 124 a Fb(xOpenDone\(s,)22 b(...\);)686 181 y(})i(else)f({)877
237 y(drop)h(packet;)e(return;)686 294 y(})495 350 y(})495
407 y(xPop\(\))305 519 y(foo_open\(\))495 576 y(...)495 632
y(if)i(\()g(active)f(session)g(does)g(not)g(exist)h(\))f({)686
689 y(if)h(\(cached)f(session)g(exists)g(\))h({)877 745 y(move)g(sessn)f
(from)g(cached)g(map)h(to)f(active)g(map)686 802 y(})495 858
y(})495 915 y(...)305 1028 y(foo_close\(s\))495 1084 y(xAssert\(s->rcnt)f(==)
i(0\);)495 1140 y(move)g(sessn)f(from)g(active)g(map)h(to)f(cached)g(map)305
1253 y(foo_destroy\(s\))495 1310 y(xDestroy\(s\);)0 1490 y
Fl(11.5)50 b(Modifying)11 b(v3.1)h(pr)o(otocols)0 1577 y Fr(In)f(addition)f
(to)h(the)g(other)g(modi\256cations)e(one)j(needs)f(to)f(make)i(to)f
(translate)g(an)g(existing)e(protocol)h(from)i(v3.1)f(to)g(v3.2,)0
1633 y(one)g(should)f(make)h(the)g(following)e(modi\256cations)h(with)g
(respect)i(to)e(reference)j(counts:)68 1737 y Fi(\017)23 b
Fe(foo)p 198 1737 14 2 v 17 w(open)12 b Fr(should)e(not)g(increment)h(the)g
(reference)i(count)114 1811 y(v3.1)e(protocols)e(often)i(followed)f(the)h
(format:)550 1933 y Fe(foo_open\(\))768 1990 y(if)28 b(\(session)h(s)f
(exists\))h({)986 2046 y(s->rcnt++;)768 2103 y(})f(else)g({)986
2159 y(s)g(=)f(xCreateSessn)q(\(\);)986 2216 y(fill)i(in)f(state;)768
2272 y(})768 2328 y(return)h(s;)114 2450 y Fq(xOpen)11 b Fr(now)f
(automatically)g(increments)h(the)g(reference)h(count)f(so)f(the)h(format)h
(should)d(be)j(more)f(like:)550 2572 y Fe(foo_open\(\))768
2629 y(if)28 b(\(session)h(s)f(does)g(not)g(exist\))h({)952
2753 y Fr(60)p eop
%%Page: 61 61
60 bop 986 124 a Fe(s)28 b(=)f(xCreateSessn)q(\(\);)986 181
y(fill)i(in)f(state;)768 237 y(})768 294 y(return)h(s;)68 419
y Fi(\017)23 b Fe(foo)p 198 419 14 2 v 17 w(close)13 b Fr(should)c(not)i
(decrement)g(the)g(reference)i(count)114 494 y(In)e(v3.1,)g
Fe(foo)p 349 494 V 17 w(close)i Fr(was)e(called)g(whenever)g
Fq(xClose)g Fr(was)g(called,)g(so)g Fe(foo)p 1385 494 V 17
w(close)i Fr(often)e(looked)f(like:)550 619 y Fe(foo_close\(\))768
675 y(if)28 b(\(--s->rcnt)i(==)e(0\))g({)986 732 y(xDestroy\(s\);)768
788 y(})114 913 y Fr(In)14 b(v3.2,)i(the)e(protocol')m(s)g(close)g(function)g
(is)g(called)g(only)g(when)g(the)h(reference)g(count)f(reaches)h(zero)g
(\(see)g(the)114 969 y(examples)c(in)f(the)h(caching)g(section.\))68
1063 y Fi(\017)23 b Fq(xPop)10 b Fr(should)g(not)g(be)i(bypassed)114
1138 y(Since)f Fq(xPop)f Fr(in)h(v3.1)g(did)f(nothing)f(more)j(than)e(call)h
(the)f(session')m(s)g(pop)h(operation,)f(v3.1)h(protocols)e(often)i(either)
114 1195 y(called)e(their)h(pop)f(routine)g(directly)g(or)n(,)h(if)g(their)g
(pop)f(routine)g(was)g(small,)i(they)e(absorbed)g(this)g(functionality)e
(into)114 1251 y(their)k(demux)g(routine)f(and)h(bypassed)g
Fq(xPop)g Fr(altogether)m(.)16 b(Since)c Fq(xPop)f Fr(manipulates)f
(reference)j(counts)d(in)h(v3.2,)114 1308 y(it)f(can)i(not)e(be)h(bypassed.)
68 1402 y Fi(\017)23 b Fq(xDemux)11 b Fr(should)e(not)i(use)g
Fq(xOpen)g Fr(to)g(create)g(new)h(sessions)114 1477 y(It)f(is)f(common)i
(practice)f(for)g(a)g(protocol)f(to)h(create)h(passive)e(sessions)f(\(where)i
(session)f(creation)h(is)f(triggered)h(by)114 1533 y(an)h(incoming)e(packet)i
(rather)g(than)f(an)h(xOpen\))f(by)h(having)e Fe(foo)p 1171
1533 V 17 w(demux)k Fr(call)d Fe(foo)p 1495 1533 V 18 w(open)i
Fr(and)e(then)g(possibly)114 1590 y(customizing)d(the)j(session.)j(There)d
(is)f(nothing)e(wrong)i(with)g(this)f(practice,)i(but)f(such)g(a)g(protocol)f
(should)g(invoke)114 1646 y Fe(foo)p 198 1646 V 17 w(open)17
b Fr(directly)d(rather)i(than)f(using)f Fq(xOpen)p Fr(.)30
b(The)16 b(passively)e(created)i(session)e(should)g(have)h(an)h(initial)114
1703 y(reference)c(count)e(of)i(0,)f(but)g Fq(xOpen)g Fr(would)f(return)g(a)i
(session)e(with)g(an)h(initial)f(reference)i(count)e(of)i(1.)952
2753 y(61)p eop
%%Page: 62 62
61 bop 0 124 a Fn(12)60 b(Con\256guring)14 b(a)h(Kernel)0 228
y Fr(This)10 b(section)g(describes)h(how)f(to)h(con\256gure)g(and)g(build)f
(an)h Fq(x)p Fr(-kernel.)0 351 y Fl(12.1)50 b(Specifying)11
b(a)h(Pr)o(otocol)h(Graph)0 438 y Fr(A)8 b(new)g(instance)f(of)h(the)g
Fq(x)p Fr(-kernel)g(is)f(con\256gured)h(by)g(specifying)e(the)i(collection)e
(of)i(protocols)e(that)i(are)g(to)g(be)g(included)f(in)0 494
y(the)h(kernel)f(in)g(a)i(\256le)f(called)f Fg(graph.comp)p
Fr(.)17 b(Example)7 b Fg(graph.comp)i Fr(\256les)f(can)g(be)g(found)f(in)g
Fg(xkernel/build/T)-5 b(emplate)p Fr(.)71 551 y(The)20 b Fg(graph.comp)h
Fr(\256le)g(is)e(divided)g(into)g(three)h(sections:)33 b(device)20
b(drivers,)i(protocols,)f(and)f(miscellaneous)0 607 y(con\256guration)11
b(parameters.)22 b(The)12 b(sections)g(are)h(separated)f(by)h(lines)e
(beginning)g(with)h Fg(@;)h Fr(and)f(each)h(section)f(may)h(be)0
663 y(empty)m(.)71 720 y(The)h(\256rst)g(two)f(sections,)h(device)g(drivers)f
(and)h(protocols,)g(describe)f(the)h(protocol)f(graph)h(to)f(be)i
(con\256gured)e(into)0 776 y(your)f(kernel.)22 b(The)13 b(only)f(dif)o
(ference)i(between)e(the)h(two)f(sections)g(is)h(that)f(drivers)g(in)h(the)g
(\256rst)g(section)f(are)h(initialized)0 833 y(directly)8 b(from)h(the)g
Fq(x)p Fr(-kernel)g(boot)e(thread,)j(whereas)f(protocols)e(in)h(the)g
(protocol)g(section)g(are)h(initialized)e(from)i(a)g(distinct)0
889 y(protocol)i(initialization)e(thread.)19 b(For)13 b(the)f(device)g
(drivers)f(and)h(platforms)g(in)g(this)f(distributio)o(n,)f(this)h
(distinction)e(is)j(of)0 946 y(no)f(consequence)f(and)h(device)g(drivers)g
(may)h(be)f(con\256gured)g(in)f(either)h(the)g(\256rst)g(or)g(the)g(second)g
(section.)71 1002 y(Device)g(drivers)f(and)h(protocols)f(are)i(described)e
(by)h(the)g(same)h(types)e(of)h(entries,)g(as)g(in)g(the)g(example:)0
1089 y Fc(name=yap)26 b(files=yap,)q(ya)q(p_)q(cln)q(t,)q(yap)q(_s)q(rv)q(r)f
(dir=yap)h(protocols=)q(ip)q(,e)q(th)g(trace=TR_)q(MAJ)q(OR)q(_EV)q(EN)q(TS)q
(;)0 1187 y Fr(The)11 b(\256rst)f(\256eld)h(gives)f(the)h(protocol')m(s)f
(name.)17 b(The)10 b(rest)h(of)g(the)f(\256elds)h(are)g(optional)e(and)i(may)
g(occur)g(in)g(any)f(order)m(.)17 b(The)0 1243 y Fg(dir)c Fr(and)f
Fg(\256les)g Fr(\256elds)f(describe)h(the)g(names)g(and)g(locations)f(of)h
(the)f(source)h(\256les)g(used)g(to)f(build)g(the)h(protocol.)18
b(Files)12 b(are)0 1300 y(speci\256ed)g(without)e(extensions.)18
b(These)12 b(two)g(\256elds)g(should)f(not)g(be)i(used)e(in)h(the)g(common)h
(case)g(where)f(one)g(wants)g(to)0 1356 y(link)e(in)h(protocol)e(object)i
(code)g(from)g(the)g(public)f(system)h(object)f(area.)17 b(The)11
b Fg(dir)h Fr(and)f Fg(\256les)g Fr(\256elds)g(should)e(only)i(be)g(used)0
1413 y(when)f(one)h(wants)f(to)g(compile)h(and)f(link)g(code)h(from)g(one')m
(s)g(private)f(build)g(area)h(instead.)16 b(If)11 b(a)g Fg(\256les)g
Fr(entry)f(exists)g(but)g(no)0 1469 y Fg(dir)i Fr(entry)f(is)f(speci\256ed,)i
(the)e(current)h(directory)g(\(i.e.,)h(the)f(build)f(directory\))h(is)f
(assumed.)16 b(If)c(a)g Fg(dir)f Fr(entry)g(exists)f(without)0
1526 y(a)i Fg(\256les)f Fr(entry)m(,)g(the)g Fg(\256les)g Fr(\256eld)g
(defaults)f(to)h(a)h(single)e Fg(.c)g Fr(\256le)i(with)e(the)h(protocol')m(s)
f(name.)71 1582 y(The)15 b Fg(protocols)h Fr(\256eld)g(indicates)e(the)h
(protocols)f(below)h(the)g(current)h(protocol)e(in)h(the)g(graph.)30
b(When)15 b(this)f(\256eld)0 1639 y(contains)9 b(multiple)g(protocols,)h
(order)h(is)f(signi\256cant)f(\(the)h(lower)g(protocols)f(will)h(be)g(loaded)
g(into)g(the)g(upper)g(protocol')m(s)0 1695 y(down)f(vector)g(in)h(the)f
(order)h(in)f(which)g(they)g(are)i(listed.\))j(A)c(protocol)f(which)f
(expects)i(multiple)e(protocols)g(below)h(it)g(will)0 1752
y(describe)i(the)g(expected)g(semantics)f(of)h(the)g(lower)g(protocols)f(in)h
(its)f(manual)h(page)g(in)g(appendix)f(A.)71 1808 y(The)h Fg(trace)h
Fr(\256eld)f(de\256nes)h(the)f(debugging)e(level)i(used)g(in)g(trace)h
(statements)f(depending)f(on)h(the)g(protocol)g(variable)0
1864 y Fg(traceyapp)p Fr(.)17 b(See)12 b(section)e(8)i(for)f(the)g(symbolic)f
(names)h(associated)g(with)f(trace)h(levels.)71 1921 y(Multiple)d
(instantiations)f(of)j(protocols)f(are)i(supported)d(by)i(using)f(a)h
(\252/\272)h(character)g(after)f(the)g(protocol)f(name)i(to)e(add)0
1977 y(an)g(extension.)14 b(In)9 b(the)g(following)e(example,)j(two)f
(instantiation)o(s)d(of)j(\252yap\272)g(are)h(indicated,)f(one)g(over)g
(\252ip\272)g(and)f(one)h(over)0 2034 y(\252eth,\272)j(and)g(both)f(are)h
(used)g(by)f(the)h(\252prt\272)g(protocol.)17 b(In)12 b(this)e(example,)j
(the)e(instance)g(suf)o(\256xes)h(for)g(the)f(\252yap\272)i(protocol)0
2090 y(are)f(the)e(names)h(of)g(the)g(protocol)f(below)g(the)g(instance,)h
(but)f(this)g(is)g(just)g(a)h(convention)e(\261)i(they)f(could)h(have)f(any)h
(distinct)0 2147 y(string)f(as)h(an)g(instance)g(suf)o(\256x.)0
2224 y Fc(name=yap/)q(ip)26 b(files=yap)q(,y)q(ap_)q(cl)q(nt,)q(ya)q(p_)q
(srv)q(r)g(dir=yap)f(protocols)q(=i)q(p)g(trace=TR)q(_M)q(AJO)q(R_)q(EVE)q
(NT)q(S;)0 2269 y(name=yap/)q(et)q(h)g(protocol)q(s=)q(eth)q(;)0
2315 y(name=prt)h(files=prt)g(dir=prt)f(protocol)q(s=y)q(ap)q(/ip)q(,y)q(ap)q
(/et)q(h)h(trace=TR_E)q(RR)q(ORS)q(;)0 2403 y Fr(Only)10 b(the)h(\256rst)g
(of)g(multiple)f(instantiations)e(should)i(have)h Fg(dir)p
Fr(,)h Fg(\256les)p Fr(,)g(or)f Fg(trace)g Fr(\256elds.)71
2459 y(The)h(third)h(section)e(of)j(graph.comp)f(contains)e(the)i(names)g(of)
g(\256les)g(with)f(protocol)g(number)h(tables)f(that)h(are)h(to)e(be)0
2516 y(loaded)i(during)f(initialization)o(.)23 b(It)14 b(also)g(contains)f
(the)h(names)g(of)g(subsystems)f(and)h(their)f(con\256guration)g(parameters.)
0 2572 y(Currently)d(trace)h(variables)f(are)h(the)g(only)e(parameters)j
(that)e(can)g(be)h(set)f(here.)17 b(The)11 b(following)d(illustrates)h(a)i
(typical)e(use)0 2629 y(of)i(the)g(third)f(section:)952 2753
y(62)p eop
%%Page: 63 63
62 bop 0 124 a Fc(@;)0 170 y(#)0 216 y(#)23 b(You)g(can)h(also)g(specify)i
(protocol)f(tables)g(to)e(be)h(read)g(in)f(at)g(boot)h(time.)0
261 y(#)0 307 y(prottbl=/)q(us)q(r/x)q(ke)q(rne)q(l/)q(et)q(c/p)q(ro)q(ttb)q
(l;)0 353 y(prottbl=.)q(/p)q(rot)q(tb)q(l.l)q(oc)q(al)q(;)0
444 y(#subsyste)q(m)i(tracing)f(for)f(messages)h(and)f(protocol)i(operations)
0 490 y(name=msg)g(trace=TR_G)q(RO)q(SS)q(_EV)q(EN)q(TS;)0
535 y(name=prot)q(oc)q(ol)g(trace=TR_)q(MAJ)q(OR)q(_EV)q(EN)q(TS)q(;)71
641 y Fr(The)10 b(graph.comp)h(\256le)g(is)g(read)g(by)g(an)g
Fq(x)p Fr(-kernel)g(utility)e(program)i(called)f Fq(compose)g
Fr(which)h(generates)f(startup)g(code)0 698 y(to)j(build)f(the)h(protocol)f
(graph)h(and)g(set)g(up)f(the)h(described)g(con\256guration.)21
b(The)14 b(protocol)d(graph)i(is)g(built)f(bottom-up;)0 754
y(when)f(a)g(protocol')m(s)g(initialization)d(function)i(is)g(called,)i(the)e
(lower)h(level-protocols)e(have)j(already)f(been)g(initialized.)0
879 y Fl(12.2)50 b(Build)12 b(Pr)o(ocedur)o(e)0 966 y Fr(A)i(given)g
(instance)g(of)g(the)g Fq(x)p Fr(-kernel)h(is)f(built)f(in)h(a)h(working)e
(directory)m(.)25 b(Each)15 b(working)e(directory)h(can)g(support)f(one)0
1022 y Fq(x)p Fr(-kernel)e(con\256guration)e(at)h(a)h(time.)16
b(W)l(orking)10 b(directories)f(may)i(be)f(or)o(ganized)g(within)f(the)h
Fq(x)p Fr(-kernel)h(source)f(tree)h(\(e.g.,)0 1079 y(as)g(subdirectories)f
(of)h Fg(xkernel/build)p Fr(\))h(or)g(outside)d(of)j(the)e(source)h(tree)h
(\(e.g.,)g(in)f(an)g Fq(x)p Fr(-kernel)h(user)r(')m(s)f(home)g(directory)m
(.\))71 1135 y(For)d(the)f(purpose)g(of)h(the)g(following)e(discussion,)g(we)
i(assume)g(the)g(user)g(is)f(con\256guring)g(a)h(kernel)g(so)f(as)h(to)g
(implement)0 1192 y(and)13 b(evaluate)g(protocol)g(Y)-5 b(AP)13
b(\(yet)g(another)g(protocol.\))23 b(A)13 b(user)g(con\256guring)g(a)g
(kernel)h(that)e(contains)h(only)f(existing)0 1248 y(protocols)d(should)h
(ignore)g(all)h(references)h(to)e(Y)-5 b(AP)g(.)12 b(The)e(machine)i
(architecture)e(in)h(this)f(example)h(is)f(\252sparc\272)i(\(used)f(by)0
1304 y(the)g(sunos)f(platform\);)g(other)h(supported)f(architectures)g(are)i
(\252mips\272)f(\(for)h(the)f(DECstation)e(5000\),)i(and)g(\252intelx86\272.)
57 1411 y(1.)23 b(Put)11 b Fg(xkernel/bin/sparc)h Fr(and)f
Fg(xkernel/bin)h Fr(in)f(your)g(search)h(path.)k(These)c(must)e(be)i(before)g
Fg(/bin)f Fr(and)h Fg(/usr/bin)p Fr(.)114 1467 y(This)f(will)h(allow)f(use)h
(of)h(the)f(version)g(of)g Fg(make)h Fr(distributed)d(with)i(the)g
Fq(x)p Fr(-kernel)h(\(GNU)f(make)h(v)m(.)21 b(3.66\))12 b(rather)114
1524 y(than)e(the)h(standard)g(Unix)f Fg(make)p Fr(.)57 1617
y(2.)23 b(Create)12 b(a)f(new)g(working)f(directory)h(to)f(hold)g(your)h
(kernel.)57 1711 y(3.)23 b(Change)11 b(to)g(your)f(new)h(working)f(directory)
m(.)57 1805 y(4.)23 b(Copy)9 b(the)h(Make\256le)h(from)f Fg(xkernel/build/T)
-5 b(emplate/Make\256le.sunos)11 b Fr(into)e(your)h(working)e(directory)i
(under)114 1861 y(the)h(name)g(Make\256le:)214 1968 y Fg(cp)h
(xkernel/build/T)-5 b(emplate/Make\256le.sunos)14 b(Make\256le)57
2130 y Fr(5.)23 b(Make)12 b(the)e(Make\256le)i(writable:)214
2224 y Fg(chmod)h(u+w)f(Make\256le)57 2375 y Fr(6.)23 b(Edit)8
b(the)i(Make\256le.)16 b(Select)10 b(an)g(appropriate)f Fg(HOWT)o(OCOMPILE)p
Fr(.)i(Generally)m(,)f(you)f(want)g Fg(DEBUG)i Fr(until)d(you)114
2431 y(are)k(ready)f(to)g(run)f(serious)h(performance)h(tests,)e(then)h
(change)g(it)g(to)f Fg(OPTIMIZE)p Fr(.)i(\(See)g(Section)f(8.\))114
2506 y(Check)g(to)g(see)g(that)g(the)g(variable)f(XR)m(T)i(in)f(your)f
(Make\256le)i(is)f(a)h(path)e(to)h(the)g(root)f(of)i(the)f(xkernel)f(source)h
(tree.)952 2753 y(63)p eop
%%Page: 64 64
63 bop 57 124 a Fr(7.)23 b(If)11 b(you)g(are)h(including)d(a)j(new)f
(protocol)f(in)h(your)g(kernel,)g(then)g(create)h(\(at)f(least\))g(a)h(shell)
e(for)i(that)e(protocol;)g(e.g.,)114 181 y(create)f(a)g(shell)e(version)h(of)
h Fg(yap.c)p Fr(.)15 b(The)9 b(protocol)e(shell)h(should)f(de\256ne)h(an)h
(initialization)d(routine;)i(e.g.,)i Fg(yap)p 1867 181 14 2
v 17 w(init)p Fr(.)114 237 y(Y)-5 b(ou)12 b(will)g(also)g(need)g(to)g(put)g
(an)h(entry)f(for)h(your)f(protocol)f(in)h(one)h(of)f(the)h(protocol)e
(tables)h(referenced)h(by)g(your)114 294 y(graph.comp)f(\(see)i(section)d
(13.1.\))22 b(If)13 b(you)f(are)i(con\256guring)d(a)i(kernel)g(that)f
(contains)g(only)g(existing)e(protocols,)114 350 y(then)g(this)g(step)h(is)g
(not)f(necessary)m(.)57 444 y(8.)23 b(Create)16 b(a)f Fg(graph.comp)h
Fr(in)f(your)g(build)f(directory)m(,)h(as)h(discussed)d(in)i(section)f(12.1,)
i(to)f(specify)g(the)g(protocol)114 500 y(graph)c(for)g(your)g(kernel.)16
b(Example)11 b(graph.comps)g(are)h(located)e(in)h(the)g Fg(xkernel/build/T)-5
b(emplate)12 b Fr(directory)m(.)114 588 y(In)f(steps)f(9,)i(10,)f(and)g(11,)g
(you)f(may)i(see)g(one)f(or)g(more)h(compiler)e(warning)h(messages)g(of)g
(the)g(form:)328 713 y Fb(make[n]:)23 b(fopen:)g([filename]:)g(No)g(such)g
(file)h(or)f(directory)114 838 y Fr(These)15 b(messages)h(are)g(expected)g
(and)g(can)g(be)g(ignored.)29 b(The)16 b(\256les)g(referenced)h(by)e(these)h
(messages)f(will)g(be)114 894 y(created)c(in)g(steps)f(10)h(and)g(11.)114
969 y(The)g(following)e(two)h(steps)h(must)f(be)i(redone)f(if)g
Fg(graph.comp)h Fr(is)f(later)g(modi\256ed:)57 1063 y(9.)23
b Fg(make)12 b(compose)34 1157 y Fr(10.)23 b Fg(make)12 b(depend)34
1251 y Fr(11.)23 b(If)11 b(you)f(are)h(the)g(\256rst)g(person)f(building)e(a)
j(kernel)g(of)g(this)e(con\256guration)h(at)h(your)f(site)g(\(i.e.,)i(if)f
(you)f(are)h(building)e(a)114 1307 y(kernel)h(as)g(part)g(of)h(the)f
(installation)e(procedure\),)j(you)e(will)h(need)g(to)g(run)g(an)g
(initialization)e(tar)o(get)i(for)h(the)f(system)114 1364 y(areas:)214
1458 y Fg(make)i(system)114 1551 y Fr(This)d(will)g(run)h(the)g(tar)o(gets)g
Fq(allCompose)p Fr(,)g Fq(allDepend)p Fr(,)f(and)h Fq(libs)g
Fr(for)g(the)g(con\256guration)f(and)h(platform)g(indicated)114
1608 y(by)k(your)g(Make\256le,)j(building)12 b(con\256guration)i(\256les,)i
(dependency)e(\256les,)i(and)e(object)g(\256les)h(for)g(most)f(of)h(the)f
Fq(x)p Fr(-)114 1664 y(kernel)c(system.)16 b(Again,)11 b(you)f(will)f(get)i
(error)g(messages)g(about)f(missing)f(dependency)h(\256les,)h(but)f(the)h
Fq(allDepend)114 1721 y Fr(tar)o(get)h(will)g(generate)h(the)f(missing)g
(\256les.)21 b(This)11 b(will)h(take)h(a)g(long)f(time)g(to)h(run.)21
b(The)12 b(installer)g(of)g(the)h Fq(x)p Fr(-kernel)114 1777
y(should)e(run)h(this)g(tar)o(get)g(for)h(all)f(con\256gurations)f
(\(DEBUG,OPTIMIZE\))i(and)g(platforms)f(that)g(will)f(be)i(used)f(at)114
1834 y(the)f(site.)34 1927 y(12.)23 b Fg(make)114 1984 y Fr(Object)15
b(\256les)i(will)e(be)h(placed)g(in)g(a)h(subdirectory)d(whose)i(name)h
(re\257ects)g(your)e(con\256guration)g(and)h(platform)114 2040
y(\(DEBUGsunos,)21 b(OPTIMIZEmach3,)i(etc.\))43 b(This)19 b(is)h(the)f(same)i
(way)f(in)g(which)f(object)g(\256les)h(are)h(stored)114 2097
y(throughout)12 b(the)j Fq(x)p Fr(-kernel)g(hierarchy)m(.)28
b(The)15 b(\256nal)g Fq(x)p Fr(-kernel)g(executable)f(\()p
Fb(xkernel)p Fr(\))h(will)e(be)i(placed)g(in)g(your)114 2153
y(build)9 b(directory)m(.)0 2278 y Fl(12.3)50 b(Debug)12 b(versus)h
(Optimized)e(Mode)0 2365 y Fr(The)f Fq(x)p Fr(-kernel)h(uses)g(a)g(trace)g
(package)f(to)h(generate)f(debugging)f(information.)15 b(T)m(o)10
b(enable)h(the)f(tracing)g(facility)m(,)g(edit)g(the)0 2421
y(Make\256le)i(to)f(set)g Fg(HOWT)o(OCOMPILE)i Fr(to)e Fg(DEBUG)p
Fr(;)h(tracing)f(can)g(be)h(disabled)e(by)h(setting)f Fg(HOWT)o(OCOMPILE)j
Fr(to)0 2478 y Fg(OPTIMIZE)p Fr(.)e(Then)g(type)g Fg(make)p
Fr(.)17 b(See)12 b(also)e(section)g(8.)71 2534 y(If)f(you)f(are)h(interested)
f(in)g(accurate)i(performance)f(timings,)f(you)h(should)e(set)h
Fg(HOWT)o(OCOMPILE)i Fr(to)e Fg(OPTIMIZE)0 2590 y Fr(in)j(the)g(Make\256le.)
17 b(This)10 b(causes)h(all)g(trace)h(of)f(tracing)f(code)i(to)e(be)i
(eliminated)e(from)i(the)f(kernel.)952 2753 y(64)p eop
%%Page: 65 65
64 bop 0 124 a Fl(12.4)50 b(Useful)12 b(Make)g(T)-5 b(argets)0
211 y Fr(The)7 b(previously)g(mention)o(ed)g(make)g(tar)o(gets)g(\()p
Fq(com)o(pose)p Fr(,)e Fq(depend)p Fr(,)i Fq(xkernel)g Fr(\(the)g
(default\)\))g(are)g(the)g(minimal)g(set)g(necessary)0 268
y(to)k(build)f(an)h Fq(x)p Fr(-kernel.)17 b(This)10 b(section)g(describes)h
(some)g(additional)e(useful)i(make)g(tar)o(gets.)71 324 y(Some)g(of)f(these)h
(descriptions)d(refer)j(to)g(\252)p Fq(x)p Fr(-kernel)g(system)f(areas\272.)
17 b(These)10 b(areas)h(contain)f(source)g(and)g(object)g(code)0
381 y(shared)h(by)g(all)g(users)f(of)i(the)f Fq(x)p Fr(-kernel.)16
b(Each)c(platform)f(has)g(four)g(main)g(system)g(areas:)114
484 y(prot:)214 578 y(Code)g(for)g(the)g Fq(x)p Fr(-kernel)h(protocols.)j(\()
p Fb(/usr/xkernel/protocols)p Fr(\))114 683 y(pi:)214 776 y
(Platform-independent)9 b(code)j(common)f(to)g(all)g(platforms.)16
b(\()p Fb(/usr/xkernel/pi)p Fr(\))114 881 y(pxk:)214 974 y
(Platform-speci\256c)e(code)h(including)d(device)j(drivers)e(and)i
(application)d(programmer)k(inter)o(-)214 1031 y(faces)11 b(\(APIs\).)17
b(\(e.g.,)c Fb(/usr/xkernel/mach3)p Fr(,)c Fb(/usr/xkernel/sunos)p
Fr(,)g(etc.\))114 1136 y(user:)214 1229 y(Platform-speci\256c)g(user)g
(libraries)g(that)g(can)g(be)h(linked)e(with)g(user)h(applications)e(to)i
(access)h(the)214 1285 y Fq(x)p Fr(-kernel)g(through)e(one)i(of)g(the)g
Fq(x)p Fr(-kernel)g(APIs.)17 b(\(e.g.,)11 b Fb(/usr/xkernel/mach3/user)p
Fr(\))c(Not)214 1342 y(all)j(platforms)h(have)g(such)g(libraries.)71
1476 y(These)f(tar)o(gets)h(are)h(all)f(executed)g(from)h(a)f(build)f
(directory)m(.)114 1580 y(prot,)h(pi,)g(pxk,)g(user)n(,)g(libs:)214
1673 y(Rebuilds)g(any)h(out-of-date)g(source)g(code)g(in)g(the)h(indicated)e
(area.)21 b(The)12 b(tar)o(get)h Fq(libs)e Fr(rebuilds)214
1729 y(code)g(in)g(the)f Fq(pr)n(ot)p Fr(,)h Fq(pi)p Fr(,)g(and)g
Fq(pxk)h Fr(areas.)114 1835 y(clean:)214 1928 y(removes)f(object)f(\256les)i
(in)e(the)h(build)f(directory)m(.)114 2033 y(protClean,)h(piClean,)g
(pxkClean,)g(userClean,)g(allClean:)214 2126 y(Removes)f(object)f(\256les,)h
(libraries)f(and)h(other)g(generated)f(\256les)h(from)g(the)g(indicated)f
(area.)17 b(The)214 2183 y Fq(allClean)10 b Fr(tar)o(get)h(runs)f(in)h(all)g
(areas)h(except)f(the)f(user)i(area.)114 2288 y(protCompose,)e(piCompose,)h
(pxkCompose,)g(allCompose:)214 2381 y(Rebuilds)j(ComposeFiles)h(lists)f(for)i
(the)f(indicated)g(area.)31 b(These)15 b(\256les)h(group)f(object)g(\256les)
214 2437 y(together)d(so)g(the)h(compose)g(program)g(knows)f(which)g(\256les)
h(to)f(link)g(in)g(for)i(which)e(protocols.)214 2494 y(These)h(\256les)h(are)
g(generated)f(by)h(the)f Fq(system)g Fr(make)h(tar)o(get)g(during)e(system)h
(installation,)f(but)214 2550 y(they)g(are)i(only)d(updated)h(when)h(these)f
(tar)o(gets)h(are)g(run)g(explicitly)m(.)20 b(The)12 b Fq(allCompose)g
Fr(tar)o(get)214 2607 y(runs)e(in)h(all)g(areas)h(except)f(the)f(user)i
(area.)952 2753 y(65)p eop
%%Page: 66 66
65 bop 114 124 a Fr(protDepend,)10 b(piDepend,)g(pxkDepend,)h(userDepend,)f
(allDepend:)214 218 y(Rebuilds)f(the)i(dependency)f(lists)f(in)i(the)f
(indicated)g(area.)17 b(The)11 b Fq(allDepend)e Fr(tar)o(get)i(runs)g(in)f
(all)214 275 y(areas)h(except)g(the)g(user)g(area.)114 381
y(srcList,)f(hdrList:)214 475 y(Builds)h(\256les)h(in)g(the)g(local)g(build)f
(directory)h(listing)e(all)i(of)g(the)g(active)g Fq(x)p Fr(-kernel)h(source)f
(\256les.)214 531 y(These)d(tar)o(gets)h(will)f(do)g(nothing)f(if)i(the)g
(\256les)g(already)g(exist.)15 b(T)m(o)10 b(force)g(the)g(\256les)g(to)f(be)h
(rebuilt,)214 588 y(use)h(the)g(tar)o(gets)f Fq(Sr)n(cList)h
Fr(and)g Fq(HdrList)f Fr(instead.)114 694 y(grep:)214 788 y(greps)h(for)h
(the)f(tar)o(get)g(G)h(in)f(all)g Fq(x)p Fr(-kernel)h(source)g(and)f(header)h
(\256les)g(produced)f(by)g(the)g Fq(sr)n(cList)214 844 y Fr(and)g
Fq(hdrList)e Fr(tar)o(gets.)214 909 y(Example)i(usage:)299
986 y Fb(make)23 b(grep)g(G="xCreate")114 1092 y Fr(tags:)214
1186 y(Creates)10 b(an)g(emacs)h(tag)f(\256le)g Fb(TAGS)f Fr(in)h(the)g
(local)f(build)g(directory)g(for)h(all)g Fq(x)p Fr(-kernel)g(source)g(and)214
1243 y(header)h(\256les)g(produced)g(by)g(the)f Fq(sr)n(cList)h
Fr(and)g Fq(hdrList)f Fr(tar)o(gets.)0 1379 y Fl(12.5)50 b(Modifying)11
b(Code)h(in)g(System)h(Ar)o(eas)0 1466 y Fr(In)f(order)g(to)f(make)i(the)e
(common)h(case)h(as)f(fast)f(as)h(possible,)f(the)g Fq(x)p
Fr(-kernel)i(build)d(procedure)i(normally)f(doesn')o(t)g(check)0
1523 y(to)i(see)h(if)f(any)g(source)h(code)f(in)g(the)h(system)e(areas)i
(needs)g(to)f(be)g(recompiled.)23 b(If)14 b(you)f(make)h(a)g(change)g(to)f
(any)g(of)g(the)0 1579 y(system)g(areas,)i(that)e(code)g(will)f(have)i(to)f
(be)g(recompiled)g(explicitly)f(from)i(the)f(build)f(area)i(using)e(the)h
(tar)o(gets)g(for)h(that)0 1636 y(area.)20 b(For)13 b(example,)g(if)f(you)f
(add)h(a)h(protocol)e(to)g(the)h(system)g(protocol)f(area,)i(in)f(addition)e
(to)i(modifying)f(the)h(protocol)0 1692 y(Make\256le)g(you)e(should)g(run)h
(these)g(tar)o(gets:)191 1798 y Fb(make)23 b(protDepend)191
1855 y(make)g(protCompose)191 1911 y(make)g(prot)952 2753 y
Fr(66)p eop
%%Page: 67 67
66 bop 0 124 a Fn(13)60 b(Running)15 b(a)g(Kernel)0 228 y Fr(This)c(section)f
(describes)h(the)h(procedure)g(for)f(running)g(an)h Fq(x)p
Fr(-kernel,)g(including)e(general)h(instructions)e(for)j(setting)e(up)i(a)0
284 y(run-time)e(environment)f(for)h(your)g Fq(x)p Fr(-kernel,)h(as)f(well)f
(as)i(instructions)c(for)j(running)f(an)h Fq(x)p Fr(-kernel)h(in)e
(speci\256c)h(platforms.)0 408 y Fl(13.1)50 b(Pr)o(otocol)12
b(T)-5 b(ables)0 495 y Fr(The)12 b Fq(x)p Fr(-kernel)h(runtime)f(environment)
g(always)f(includes)h(a)g(protocol)g(table.)20 b(For)12 b(each)h(protocol,)f
(this)f(table)h(de\256nes)h(a)0 551 y(numbering)c(space)h(for)g(identifying)e
(other)i(protocols.)k(The)c Fq(x)p Fr(-kernel)g(builds)f(a)h(table)g(of)g
(protocol)e(numbers)i(by)g(reading)0 608 y(con\256guration)g(\256les)g(at)h
(boot)f(time,)i(and)e(provides)g(an)h(operation)f(for)h(protocols)e(to)i
(query)f(this)g(table)h(\(see)g(section)f(3.3\).)0 664 y(This)g(frees)i
(protocols)d(from)j(embedding)e(explicit)g(protocol)g(numbers)h(in)g(the)g
(protocol)e(code)j(itself.)71 720 y(If)k(you)g(have)g(not)f(con\256gured)h
(any)f(non-standard)g(protocols)g(in)g(your)h(graph,)h(you)e(can)i(safely)f
(use)f(one)h(of)g(the)0 777 y(default)11 b(protocol)e(tables)i(in)g
Fg(/usr/xkernel/etc)f Fr(and)h(may)h(skip)e(to)h(section)f(13.1.1.)71
833 y(The)h(following)e(is)h(an)i(example)f(con\256guration)f(\256le)h
(de\256ning)g(a)g(protocol)f(table:)0 935 y Fb(#)0 991 y(#)24
b(prottbl)0 1048 y(#)0 1104 y(#)g(This)f(file)g(describes)g(absolute)g
(protocol)g(id's)0 1161 y(#)h(and)f(gives)g(relative)g(protocol)g(numbers)g
(for)g(those)0 1217 y(#)h(protocols)e(which)i(use)f(them)0
1274 y(#)0 1330 y(#)h(x-kernel)e(v3.2)0 1443 y(eth)214 b(1)0
1499 y({)191 1556 y(ip)g(x0800)191 1612 y(arp)190 b(x0806)191
1669 y(rarp)166 b(x8035)191 1725 y(#)191 1782 y(#)24 b(ethernet)e(types)i
(x3***)f(are)g(not)h(reserved)191 1838 y(#)191 1895 y(blast)142
b(x3001)0 1951 y(})0 2008 y(ip)238 b(2)0 2064 y({)191 2120
y(icmp)166 b(1)191 2177 y(tcp)190 b(6)191 2233 y(udp)g(17)191
2290 y(#)191 2346 y(#)24 b(IP)f(protocol)g(numbers)g(n,)g(91)h(<)g(n)g(<)f
(255,)h(are)f(unassigned)191 2403 y(#)191 2459 y(blast)142
b(101)0 2516 y(})0 2572 y(arp)214 b(3)0 2629 y(rarp)190 b(4)952
2753 y Fr(67)p eop
%%Page: 68 68
67 bop 0 124 a Fb(udp)214 b(5)0 181 y(tcp)g(6)0 237 y(icmp)190
b(7)0 294 y(blast)166 b(8)0 350 y(sunrpc)142 b(9)0 512 y Fr(Each)11
b(protocol)f(has)h(an)g(entry)g(of)g(the)g(form:)114 643 y
Fb(name)23 b(idNumber)g([)g Fi(f)h Fb(hlp1)f(relNum1)g(hlp2)h(relNum2)e(...)
48 b Fi(g)23 b Fb(])0 773 y Fr(where)11 b(the)g(idNumber)g(uniquely)e
(identi\256es)h(each)i(protocol.)71 829 y(There)k(are)i(two)d(ways)i(for)f(a)
h(protocol)e(to)i(de\256ne)f(its)g(protocol)f(number)i(space.)33
b(The)16 b(\256rst)h(technique)e(uses)h(an)0 886 y Fq(explicit)e(numbering)f
Fr(scheme;)k(the)e(protocol)f(explicitly)f(indicates)h(which)g(protocols)g
(may)h(be)g(con\256gured)g(above)g(it)0 942 y(and)d(the)h(relative)f(number)h
(that)f(should)f(be)h(used)g(for)h(each)g(higher)o(-level)f(protocol.)19
b(Use)13 b(of)f(this)g(numbering)g(scheme)0 999 y(is)f(indicated)f(by)g(the)h
(presence)h(of)f(the)g(optional)e(hlp)i(list)f(after)h(the)g(protocol')m(s)f
(idNumber)m(.)71 1055 y(The)16 b(second)g(technique)g(uses)g(an)g
Fq(implicit)f(numbering)g Fr(scheme;)k(the)e(protocol)e(does)h(not)g
(explicitly)f(name)i(its)0 1112 y(allowed)d(upper)h(protocols,)g(but)f(will)g
(implicitly)f(use)i(each)g(protocol')m(s)f(unique)g(idNumber)h(as)g(its)f
(relative)h(protocol)0 1168 y(number)m(.)i(BLAST)m(,)9 b(for)g(example,)i
(employs)d(this)g(technique)h(and)g(would)f(use)h(SUNRPC')m(s)i(idNumber)d(9)
i(as)f(its)g(protocol)0 1224 y(number)15 b(relative)f(to)g(BLAST)m(.)g
(Protocol)g(ID)h(numbers)f(are)h(4-byte)f(quantities)e(in)i(the)h
Fq(x)p Fr(-kernel,)h(so)e(protocols)f(using)0 1281 y(implicit)d(numbering)g
(have)h(a)h(4-byte)e(\256eld)i(in)e(their)h(headers)g(for)g(the)g(upper)g
(protocol)f(number)m(.)71 1337 y(Implicit)16 b(numbering)g(clearly)h(allows)e
(more)j(\257exibility)d(in)h(how)h(protocols)e(may)j(be)f(composed.)33
b(As)17 b(\257exible)0 1394 y(composability)11 b(is)i(one)h(of)f(the)g(goals)
g(of)g(the)h Fq(x)p Fr(-kernel,)g(all)f(new)h(protocols)e(written)g(in)h(the)
g Fq(x)p Fr(-kernel)h(should)e(use)h(this)0 1450 y(implicit)d(numbering)g
(scheme.)71 1507 y(The)15 b Fq(x)p Fr(-kernel)g(is)g(distributed)e(with)h
(two)h(useful)f(con\256guration)g(\256les)h(for)g(building)e(protocol)h
(tables,)i(located)f(in)0 1563 y Fg(/usr/xkernel/etc)p Fr(:)28
b Fg(prottbl.std)17 b Fr(and)g Fg(prottbl.nonstd)p Fr(.)36
b(The)18 b(\256rst)f(of)h(these)f(two)g(\256les,)i Fg(prottbl.std)e
Fr(contains)f(the)0 1620 y(standard)h(protocol)f(numbers;)k(e.g.,)g(TCP)e(is)
g(known)e(as)i(protocol)e(\2526\272)i(relative)f(to)g(IP)-5
b(,)18 b(IP)g(is)f(known)g(as)g(protocol)0 1676 y(\252x0800\272)11
b(relative)h(to)g(the)g(ethernet,)g(and)g(so)g(on.)20 b(This)11
b(\256le)h(should)f(be)h(used)g(when)g(there)g(is)g(no)g(danger)g(of)g
(interfering)0 1733 y(with)g(the)g(standard)g(protocol)g(suite)g(on)g(the)g
(platform)h(you)f(are)i(using.)20 b(The)12 b(second)g(\256le,)i
Fg(prottbl.nonstd)p Fr(,)g(uses)f(non-)0 1789 y(standard)i(protocol)f
(numbers.)29 b(Y)-5 b(ou)15 b(will)f(want)h(to)g(use)h(this)e(\256le)i(when)f
(there)g(is)g(a)h(danger)f(of)h(interfering)e(with)g(the)0
1846 y(platform')m(s)d(native)g(protocol)e(stack;)i(e.g.,)h(both)e(the)h
Fq(x)p Fr(-kernel)h(and)f(the)f(native)h(stack)g(are)g(running)f(and)h
(getting)f(packets)0 1902 y(diverted)g(their)h(way)g(by)g(a)g(packet)g
(\256lter)m(.)71 1958 y(All)e Fq(x)p Fr(-kernels)i(must)f(load)g(at)h(least)f
(one)g(protocol)g(table,)g(and)h(all)f(protocols)f(con\256gured)h(in)g(a)h
(kernel)f(must)h(have)f(an)0 2015 y(entry)h(in)g(the)h(protocol)e(table.)18
b(If)12 b(you)f(are)h(writing)e(a)i(new)g(protocol,)e(you)h(will)g(probably)f
(want)i(to)f(de\256ne)h(an)f(auxiliary)0 2071 y(protocol)i(table)h(which)g
(assigns)e(a)j(temporary)f(idNumber)g(to)g(your)g(new)g(protocol)f(and)i
(then)e(con\256gure)i(your)e(kernel)0 2128 y(to)g(read)h(in)g(both)e(the)i
(system)f(table)g(and)h(your)f(auxiliary)f(table)h(\(see)h(section)f(12.1)g
(for)h(con\256guration)f(examples.\))24 b(If)0 2184 y(you)10
b(need)g(to)f(con\256gure)i(your)e(new)h(protocol)f(above)h(an)g(existing)f
(protocol)g(which)g(uses)h(explicit)e(numbering,)i(you)g(can)0
2241 y(augment)h(the)g(table)g(for)g(the)g(existing)e(protocol)h(as)h(in)g
(this)f(example:)0 2346 y Fb(#)0 2403 y(#)24 b(Auxiliary)e(protocol)h(table)0
2459 y(#)0 2572 y(yap)g(1000)952 2753 y Fr(68)p eop
%%Page: 69 69
68 bop 0 124 a Fb(ip)24 b(2)47 b({)191 181 y(yap)23 b(200)0
237 y(})71 343 y Fr(Here,)12 b(we)g(de\256ne)g(our)f(new)h(protocol)e(Y)-5
b(AP)12 b(and)f(indicate)g(that)g(it)g(has)h(protocol)e(number)i(200)f
(relative)g(to)g(IP)-5 b(.)13 b(Note)0 400 y(that)j(when)h(augmenting)f(the)g
(tables)g(of)h(other)g(protocols,)g(the)f(idNumber)h(of)g(the)f(other)h
(protocol)e(must)i(match)g(its)0 456 y(number)11 b(in)g(the)g(system)f
(\256le.)71 513 y(The)j Fq(x)p Fr(-kernel)h(runs)f(consistency)e(checks)j(on)
f(the)g(protocol)f(tables)h(and)g(will)f(give)h(error)h(messages)f(and)h
(abort)f(in)0 569 y(the)e(presence)g(of)g(inconsistencies.)0
692 y Fm(13.1.1)45 b(ROM)12 b(options)0 779 y Fr(Protocol)d(table)g
(con\256guration)f(\256les)i(can)g(be)f(speci\256ed)h(in)f(either)g
(graph.comp)h(\(see)g(section)e(12\))i(or)f(in)h(a)g(ROM)g(\256le)g(\(see)0
835 y(section)g(13.2\).)17 b(The)11 b(ROM)h(\256le)f(format)h(is:)114
942 y Fb(prottbl)23 b(FILENAME1)114 998 y(prottbl)g(FILENAME2)114
1055 y(...)0 1161 y Fr(In)11 b(both)e(cases,)i(the)g(named)g(protocol)e
(tables)h(are)h(loaded)f(at)g(run-time.)16 b(Platforms)11 b(for)g(which)f
(loading)f(protocol)g(tables)0 1217 y(at)14 b(run-time)h(is)f(impractical)g
(\(e.g.,)i(inside)e(the)g(Mach)h(kernel\))f(provide)g(platform-speci\256c)g
(mechanisms)h(to)f(support)0 1274 y(protocol)c(tables)g(\(see,)i(for)g
(example,)f(section)f(17\).)0 1398 y Fl(13.2)50 b(ROM)12 b(\256les)0
1485 y Fr(T)m(o)c(support)f(run-time)i(options)d(for)j(protocols)e(and)h
(various)g(subsystems,)g(the)g Fq(x)p Fr(-kernel)h(provides)f(the)g(notion)f
(of)h(a)h(ROM)0 1541 y(\256le.)28 b(When)14 b(a)i(protocol)d(instance)h(or)h
Fq(x)p Fr(-kernel)g(subsystem)f(initializes,)g(it)g(typically)f(scans)i(a)g
(list)f(of)g(user)o(-provided)0 1598 y(options)8 b(in)h(the)g(ROM)i(\256le)f
(to)f(see)h(if)g(it)f(should)f(adjust)g(its)h(default)g(parameters)h(for)g
(that)f(particular)g(instantiation.)k(ROM)0 1654 y(options)8
b(are)j(used)e(for)h(a)g(variety)g(of)g(purposes,)f(such)h(as)g(providing)d
(initial)i(values)g(for)h(databases,)g(specifying)e(numbers)0
1711 y(of)j(network)g(shepherd)f(threads,)h(and)g(providing)e(IP)j(gateway)f
(information.)71 1767 y(Each)f(ROM)h(\256le)g(entry)f(consists)e(of)j(a)g
(single)e(line.)16 b(The)10 b(\256rst)g(\256eld)h(in)f(each)h(line)e
(speci\256es)i(the)f(particular)f(protocol)0 1824 y(or)k(subsystem)e(that)h
(should)g(interpret)g(that)g(line.)21 b(The)12 b(rest)h(of)g(the)f(\256elds)h
(are)g(speci\256c)g(to)f(that)g(particular)h(protocol)e(or)0
1880 y(subsystem.)k(Comments)d(can)f(be)g(added)g(following)e(a)j
Fb(#)p Fr(.)k(As)11 b(an)h(example:)143 2043 y Fb(#)143 2099
y(#)24 b(Example)f(ROM)g(file)143 2156 y(#)143 2269 y(simeth)47
b(port)g(1234)143 2382 y(arp)24 b(192.12.69.49)46 b(192.12.69.1)22
b(1234)143 2438 y(arp)i(192.12.69.45)46 b(192.12.69.1)22 b(9876)143
2551 y(prottbl)h(/usr/xkernel/etc/prottbl.no)o(nstd)952 2753
y Fr(69)p eop
%%Page: 70 70
69 bop 71 124 a Fr(The)12 b(SIMETH)h(protocol)e(will)h(interpret)f(the)i
(\256rst)f(line,)h(the)f(ARP)h(protocol)e(will)h(interpret)g(the)g(second)g
(and)g(third)0 181 y(lines)e(and)h(the)g(protocol)f(table)h(subsystem)e(will)
i(interpret)f(the)h(last)f(line.)71 237 y(The)g(exact)h(method)g(for)g
(providing)e(ROM)i(\256les)g(is)g(speci\256c)g(to)f(the)h(individual)d
(platforms)j(and)f(is)h(documented)f(for)0 294 y(each)i(platform)f(in)f
(section)g(13.)71 350 y(Protocols)e(which)i(provide)f(ROM)h(\256le)h
(con\256gurable)e(options)f(will)h(describe)h(the)f(format)i(of)f(these)f
(options)f(in)i(their)0 407 y(man)i(pages)e(in)h(appendix)f(A.)0
529 y Fm(13.2.1)45 b(ROM)12 b(File)e(Generators)0 616 y Fr(The)17
b(\252rom\272)i(\256le)f(used)f(during)f Fq(x)p Fr(-kernel)i(initialization)d
(has)i(a)h(cryptic)f(format)h(that)f(can)h(be)f(dif)o(\256cult)g(specify)g
(and)0 673 y(maintain)11 b(manually)m(.)17 b(The)11 b Fq(genr)n(om.sh)g
Fr(and)g Fq(genr)n(om2.sh)g Fr(utility)e(programs)j(can)f(ameliorate)h(the)f
(problem)g(by)h(using)e(a)0 729 y(\252rom\272)f(\256le)g(template)g(and)f
(expanding)f(it)h(into)g(one)g(more)h(\256les)g(for)g(use)f(with)g(testing)f
(con\256gurations.)14 b(This)7 b(is)h(especially)0 786 y(helpful)14
b(for)h(use)g(with)e(the)i Fq(simeth)f Fr(\(see)h(appendix)f(B\))h(and)g
Fq(simsimeth)e Fr(\(see)i(appendix)f(A\))h(protocols,)f(or)h(in)g(testing)0
842 y(con\256gurations)9 b(where)j(an)f Fq(ARP)g Fr(server)g(is)g(not)f
(available.)71 898 y(The)i Fq(genr)n(om.sh)g Fr(utility)f(generates)h(rom)h
(\256les)g(for)g(the)f Fq(x)p Fr(-kernel)i(from)f(prototype)e(\256les.)21
b(It)13 b(includes)e(information)0 955 y(about)f(the)h(addresses)f(of)h
(hosts)e(speci\256ed)i(by)f(name)i(on)e(the)h(command)g(line.)16
b(For)11 b(example,)g(using)f(the)h(prototype)e(rom)0 1011
y(\256le)i(\252romgen\272)h(with)e(the)h(three)g(lines:)0 1118
y Fb(simeth)0 1174 y(arp)0 1231 y(dns)0 1337 y Fr(and)16 b(the)g(command)h
Fb(genrom.sh)22 b(romgen)h(umb)h(lei)p Fr(,)17 b(two)f(rom)h(\256les)f(are)h
(produced,)g(rom.umb.1)g(and)f(rom.lei.2)0 1393 y(with)10 b(the)h(contents)0
1500 y Fb(rom.umb.1:)0 1556 y(simeth)23 b(4724)0 1612 y(arp)g(192.12.69.97)g
(192.12.69.97)f(4724)0 1669 y(arp)h(192.12.69.116)g(192.12.69.116)f(4725)0
1725 y(dns)h(umb)h(192.12.69.97)0 1782 y(dns)f(lei)h(192.12.69.116)0
1895 y(rom.lei.2:)0 1951 y(simeth)f(4725)0 2008 y(arp)g(192.12.69.97)g
(192.12.69.97)f(4724)0 2064 y(arp)h(192.12.69.116)g(192.12.69.116)f(4725)0
2121 y(dns)h(umb)h(192.12.69.97)0 2177 y(dns)f(lei)h(192.12.69.116)71
2283 y Fr(The)16 b(\252dns\272)h(lines)f(refer)i(to)e(the)h(simulated)f(IP)h
(addresses)g(for)g Fq(simeth)e Fr(and)i Fq(simsimeth)e Fr(\256les.)34
b(See)18 b(the)e(manual)0 2340 y(sections)10 b(on)h(simsimeth)f(and)h(simeth)
f(for)i(detailed)e(explanations)f(of)i(the)g(simulated)g(address)f(numbers.)
71 2396 y(The)g Fq(genr)n(om2.sh)f Fr(utility)f(generates)i(two)f(rom)i
(\256les)f(for)g(the)g Fq(x)p Fr(-kernel)h(from)f(two)g(prototype)e(rom)j
(\256le)f(\256les.)17 b(This)9 b(is)0 2453 y(generally)g(used)g(for)g
(developing)f(rom)h(\256les)h(to)f(be)g(used)g(between)g(a)h(machine)f
(running)f(simeth)h(and)g(a)h(machine)g(running)0 2509 y(simsimeth.)16
b(For)11 b(example,)h(given)e(two)h(prototype)e(rom)j(\256les,)f(romgen1)g
(and)g(romgen2,)0 2615 y Fb(romgen1:)952 2753 y Fr(70)p eop
%%Page: 71 71
70 bop 0 124 a Fb(simeth)0 181 y(arp)0 294 y(romgen2:)0 350
y(ethdrv/SE0)22 b(priority)h(200)0 407 y(arp/lower)0 463 y(eth/upper)g(mtu)g
(1440)0 519 y(simsimeth)0 576 y(arp/upper)71 679 y Fr(The)9
b(command)h Fb(genrom2.sh)22 b(romgen1)h(romgen2)g(umbra)g(moz)9
b Fr(produces)g(two)g(rom)h(\256les,)g(rom.umbra.1)g(and)0
735 y(rom.tch.2)i(with)e(contents:)0 839 y Fb(rom.umbra.1:)0
895 y(simeth)23 b(1690)0 952 y(arp)g(192.12.69.97)g(192.12.69.97)f(1690)0
1008 y(arp)h(192.12.69.99)g(192.12.69.99)f(1691)0 1121 y(rom.tch.2:)0
1177 y(ethdrv/SE0)g(priority)h(200)0 1234 y(arp/lower)g(192.12.69.97)f
(192.12.69.97)g(1690)0 1290 y(arp/lower)h(192.12.69.99)f(192.12.69.99)g(1691)
0 1347 y(simsimeth)h(1691)0 1403 y(eth/upper)g(mtu)g(1440)0
1460 y(arp/upper)g(192.12.69.97)f(c0:0c:45:61:06:9a)0 1516
y(arp/upper)h(192.12.69.99)f(c0:0c:45:63:06:9b)0 1638 y Fm(13.2.2)45
b(CA)-6 b(VEA)m(TS)0 1725 y Fr(Both)11 b(genrom.sh)g(and)g(genrom2.sh)g(work)
g(by)f(running)g(the)h(Unix)g(command)g(\252arp\272)h(to)f(get)g(the)g
(ethernet)g(addresses)f(of)0 1782 y(the)h(machines.)18 b(The)12
b(tar)o(get)f(machines)h(must)f(be)h(running)e(in)h(order)h(to)f(get)h(this)e
(information.)17 b(If)12 b(they)f(aren')o(t)h(running,)0 1838
y(a)g(bogus)e(ethernet)h(number)h(will)f(be)g(used)g(as)h(a)g(substitute.)j
(There)d(is)f(a)h(further)f(complication)f(in)i(that)f(you)g(cannot)f(get)0
1895 y(the)15 b(ethernet)f(address)h(of)g(the)g(machine)g(you)f(are)i
(running)d(on.)28 b(T)m(o)15 b(overcome)g(this)f(failure,)i(the)f(programs)g
(will)f(try)0 1951 y(to)e(run)g(\252arp\272)i(on)e(another)g(machine)h(using)
e(\252rsh\272.)21 b(The)12 b(default)g(machine)h(is)f(\252cheltenham\272)h
(\(this)e(default)h(should)f(be)0 2008 y(changed)f(for)h(sites)e(other)h
(than)g(University)e(of)j(Arizona\);)f(if)g(you)g(do)g(not)g(have)g(an)h
(account)f(on)g(that)f(machine,)j(you)d(will)0 2064 y(need)j(to)f(set)h(the)g
(environment)f(variable)g(ROMGEN)p 876 2064 14 2 v 16 w(HOST)h(to)g(some)g
(other)f(host)g(on)h(your)f(network)g(where)i(you)e(can)0 2120
y(execute)h(the)f(command)h Fb(/usr/etc/arp)f Fr(via)g(the)h(\252rsh\272)f
(command.)19 b(It)12 b(may)g(be)g(necessary)g(to)f(establish)f(a)i
Fb(.rhosts)0 2177 y Fr(\256le)f(on)g(the)g(ROMGEN)p 393 2177
V 16 w(HOST)h(for)f(this)f(to)h(work)f(properly)m(.)71 2233
y(T)m(o)j(get)g(the)h(arp)g(addresses)f(into)g(the)g(routing)g(table,)h(each)
g(host)f(is)h(probed)f(using)f(\252ping\272.)24 b(Output)12
b(from)j(\252ping\272)0 2290 y(indicating)9 b(whether)i(the)g(host)f(is)h
(dead)g(or)g(alive)g(will)f(be)h(printed)f(on)h(stdout.)71
2346 y(It)h(is)g(important)f(that)h(the)g(arp)h(lines)f(come)h(after)g(the)f
(simeth)g(or)g(simsimeth)g(line)g(they)g(are)h(related)f(to.)20
b(I.e.,)14 b(in)e(the)0 2403 y(romgen2)f(\256le)h(above,)g(the)g(arp/lower)f
(line)g(generates)g(arp)h(entries)f(appropriate)g(to)g(a)h(real)g(ethernet)f
(because)h(there)f(has)0 2459 y(been)i(no)f(previous)g(mention)f(of)i(a)g
(simeth)f(or)h(simsimeth)f(protocol.)20 b(After)13 b(the)f(\252simsimeth\272)
g(line,)h(the)g(next)f(arp)h(line)0 2516 y(produces)d(entries)h(appropriate)f
(to)h(the)g(simsimeth)f(protocol.)71 2572 y(The)f(port)f(numbers)h(used)g
(for)g(encapsulating)f(traf)o(\256c)i(sent)e(over)i(UDP)f(are)h(assigned)e
(at)h(random.)16 b(Y)-5 b(ou)9 b(can)h(override)0 2629 y(this)g(by)h
(assigning)e(a)i(base)h(number)f(in)g(decimal)g(using)f(the)h(environment)f
(variable)h(ROMGEN)p 1569 2629 V 16 w(BASE)p 1701 2629 V 16
w(POR)m(T)m(.)952 2753 y(71)p eop
%%Page: 72 72
71 bop 71 124 a Fr(Normally)15 b(the)i(simeth)e(arp)i(lines)e(use)i(the)f
(same)h(address)f(for)g(the)g(real)h(and)f(simulated)g(host)f(address.)32
b(If)17 b(you)0 181 y(use)d(the)h(same)g(host)e(twice)i(on)f(the)g(command)h
(line)f(\(e.g.)28 b Fb(genrom.sh)22 b(romgen)h(umb)h(umb)p
Fr(\),)16 b(then)e(the)g(second)g(arp)0 237 y(entry)d(will)g(use)g(a)h(host)f
(address)g(of)g(\252192.12.69.1\272,)h(and)f(further)h(redundancies)e(in)h
(host)g(names)h(will)e(simply)h(result)g(in)0 294 y(incrementing)e(the)g
(fourth)g(component)g(of)h(the)f(network)g(address.)16 b(This)9
b(might)g(cause)h(clashes)f(with)f(other)i(host)f(names.)0
350 y(Y)-5 b(ou)13 b(can)h(change)f(the)g(base)g(number)h(used)e(for)i
(assigning)d(the)i(fourth)g(component)f(using)g(the)h(environment)g(variable)
0 407 y(ROMGEN)p 200 407 14 2 v 16 w(F)m(AKE)p 332 407 V 16
w(IP)p 388 407 V 17 w(BASE.)71 463 y(Another)c(problem)i(occurs)f(when)h(one)
f(real)h(host)f(is)g(used)g(to)h(simulate)f(more)h(than)f(one)h(test)f(host.)
15 b(The)c(\252dns\272)f(lines)0 519 y(that)j(are)i(generated)f(must)g(use)g
(a)g(simulated)f(host)g(name.)26 b(This)13 b(is)h(achieved)g(by)f(attaching)g
(a)i(number)f(to)f(hostname,)0 576 y(i.e.)20 b Fb(genrom)j(romproto)g(umb)g
(umb)12 b Fr(will)f(result)h(in)f(dns)h(records)g(for)g(\252umb\272)h(and)f
(\252umb2\272.)19 b(Currently)m(,)12 b(this)g(is)f(only)0 632
y(detected)g(when)g(the)g(hostname)f(occurs)h(consecutively)e(on)i(the)g
(command)h(line,)f(i.e.)71 689 y Fb(genrom)23 b(romproto)f(umb)i(ush)f(umb)71
745 y Fr(would)11 b(not)g(be)h(handled)g(correctly;)g(it)f(would)g(be)i
(necessary)f(to)f(edit)h(the)g(generated)g(rom)h(\256les)f(to)f(correct)i
(the)f(dns)0 802 y(lines)e(for)i(the)e(second)h(occurrence)h(of)f
(\252umb\272.)71 858 y(Only)h(the)h(\256rst)g(word)g(on)g(each)g(line)g(is)f
(examined)i(in)e(the)h(prototype)f(\256le;)i(if)f(you)g(have)g(\252arp)g(xxx)
g(yyyy\272)f(or)i(\252dns)0 915 y(name)e(number)r(\272)f(lines,)f(they)h
(will)f(be)h(interpreted)g(exactly)f(as)i(if)f(they)f(were)i(simply)e
(\252arp\272)i(or)f(\252dns\272.)0 1037 y Fl(13.3)50 b(SunOS4)0
1124 y Fr(How)10 b(the)h Fq(x)p Fr(-kernel)g(runs)f(on)g(top)g(of)h(SunOS)g
(depends)f(on)g(what)g(\252device)h(drivers\272)f(are)i(con\256gured)e(into)f
(the)i(kernel.)16 b(In)0 1181 y(the)9 b(standard)g(release,)h(the)g(ethernet)
f(driver)g(is)g(really)g(a)h(simulator)e(that)h(uses)g(UDP)g(to)g(send)g
(packets)g(between)g(hosts.)15 b(In)0 1237 y(this)c(case,)i(if)f(you)g
(implement)f(IP)i(and)f(UDP)g Fq(within)f Fr(the)h Fq(x)p Fr(-kernel,)h(then)
e(the)h(simulated)f(UDP)h(packets)g(you)g(send)f(are,)0 1294
y(in)f(turn,)g(encapsulated)f(in)g(real)i(UDP)f(packets.)15
b(This)10 b(means)g(that)f(protocols)g(and)h(programs)g(built)e(on)i(top)f
(of)h(simulated)0 1350 y(UDP)h(can)f(only)g(talk)g(to)g(their)g(peers)h(in)f
(other)g(simulators;)f(they)h(cannot)g(communicate)g(with)g(\252real\272)h
(versions)e(of)i(those)0 1406 y(protocols)f(running)f(stand-alone,)i(for)g
(example,)h(on)e(a)i(Unix)e(machine.)71 1463 y(An)e(alternative)h(is)f(to)h
(write)g(an)g(ETH)g(protocol)e(that)i(sends)f(and)h(receives)g(real)h
(ethernet)f(packets,)g(perhaps)g(by)g(using)0 1519 y(the)g(STREAM)h
(interface)f(to)g(the)g(driver)g(available)g(in)g(SunOS)g(4.1.)16
b(Similarly)m(,)10 b(one)f(could)f(imagine)h(writing)f(a)i(UNIXIP)0
1576 y(device)j(driver)f(that)g(sends)g(and)h(receives)g(real)g(IP)g(packets)
g(using)e(a)i(raw)g(datagram)h(socket.)20 b(The)13 b(rest)g(of)g(this)e
(section)0 1632 y(assumes)g(the)g(simulator)f(version)g(of)h(ETH)g(that)g
(runs)f(on)h(top)f(of)i(the)f(UDP)g(protocol)f(provided)g(by)g(the)h(SunOS)h
(kernel.)71 1689 y(As)j(the)h(result)f(of)h(con\256guring)f(a)h(kernel)g
(\(section)f(12\),)i(a)f(\256le)g(named)h Fg(xkernel)f Fr(should)e(exist)h
(in)h(your)f(current)0 1745 y(directory)10 b(\()p Fg(/usr/xkernel/build/yap)p
Fr(\).)17 b(While)10 b(in)g(this)f(directory)m(,)i(create)g(a)g
(sub-directory)e(for)h(each)h(host)f(you)g(want)g(to)0 1802
y(simulate;)g(e.g.,)114 1895 y Fb(mkdir)23 b(client)114 1952
y(mkdir)g(server)71 2046 y Fr(In)14 b(each)g(of)g(these)g(directories,)g
(create)h(a)g(\256le)f(named)g Fg(rom)p Fr(.)26 b(This)13 b(is)h(the)g(ROM)h
(\256le)f(described)f(in)h(section)f(13.2.)0 2102 y(The)e(following)e(are)j
(example)f Fg(rom)h Fr(\256les)f(that)g(might)f(be)h(contained)g(in)f
Fg(client)i Fr(and)f Fg(server)p Fr(,)h(respectively)m(.)114
2196 y Fb(simeth)23 b(3050)114 2252 y(arp)g(128.10.5.54)f(192.12.69.1)h(3050)
114 2309 y(arp)g(128.10.5.23)f(192.12.69.1)h(3051)114 2459
y(simeth)g(3051)114 2516 y(arp)g(128.10.5.54)f(192.12.69.1)h(3050)114
2572 y(arp)g(128.10.5.23)f(192.12.69.1)h(3051)952 2753 y Fr(72)p
eop
%%Page: 73 73
72 bop 0 124 a Fr(For)17 b(the)e(simeth)h(entry)m(,)i(the)e(second)f(\256eld)
h(indicates)f(the)h(UDP)h(port)e(number)i(on)e(which)h(this)f(simulated)g
(host)g(will)0 181 y(receive)c(network)g(packets.)16 b(A)11
b(unique)f(port)g(number)h(must)g(be)g(used)g(for)g(each)h(simulated)e(host)g
(running)f(on)i(any)g(given)0 237 y(real)16 b(processor)m(.)32
b(Simulated)15 b(hosts)g(running)g(on)h(dif)o(ferent)g(processors)f(can)h
(use)g(the)g(same)h(port)e(number)m(.)32 b(\(In)16 b(this)0
294 y(example,)d(the)f(two)g(simulated)f(hosts)g(run)i(on)f(the)g(same)h
(real)f(processor)g(\(192.12.69.1\))g(and)g(use)g(dif)o(ferent)g(UDP)h(port)0
350 y(numbers:)22 b Fg(3051)15 b Fr(and)f Fg(3050)p Fr(.\))27
b(Note)14 b(that)f(the)h(name)h(of)f(the)g(ethernet)g(protocol)e(appears)j
(exactly)e(as)h(it)g(does)g(in)f(the)0 407 y Fg(graph.comp)f
Fr(\256le.)71 463 y(For)h(the)h(arp)g(entries,)g(each)g(line)f(corresponds)f
(to)h(a)h(simulated)f(IP)h(host.)23 b(The)13 b(second)g(\256eld)h(is)f(the)g
(simulated)g(IP)0 519 y(host)e(number)n(,)j(the)e(third)f(\256eld)i(is)f(the)
g(actual)g(IP)h(host)e(number)i(where)f(the)g(simulator)g(runs,)g(and)h(the)f
(third)f(\256eld)i(is)e(the)0 576 y(simulator)r(')m(s)e(UDP)i(port)f(number)m
(.)16 b(Note)10 b(that)g(the)g(simulated)f(IP)i(host)f(numbers)g(do)g(not)g
(necessarily)f(correspond)h(to)f(the)0 632 y(real)i(IP)h(address)f(of)g(the)g
(machine)g(on)g(which)g(the)g(simulated)f(host)g(is)h(running.)71
689 y(Each)g(simulated)f(host)g(runs)h(as)g(a)g(separate)h(Unix)e(process.)16
b(If)c(you)e(using)g(a)i(windowing)c(user)j(interface,)h(then)f(you)0
745 y(will)f(probably)f(want)h(to)h(start)f(each)h(process)f(in)h(a)g
(separate)f(window)m(.)16 b(Y)-5 b(ou)10 b(will)g(also)g(want)g(to)g(have)h
(each)g Fg(rom)h Fr(\256le)f(in)f(a)0 802 y(subdirectory)h(below)g(the)h
(xkernel)g(image)h(that)f(is)f(being)h(tested.)19 b(For)13
b(each)g(simulated)e(host,)h(open)g(a)g(shell)g(command)0 858
y(window)m(,)d Fg(cd)g Fr(to)g(the)g(sub-directory)f(that)g(contains)g(that)h
(host')m(s)f Fg(rom)i Fr(\256le\320e.g.,)h Fg(cd)g(client)p
Fr(\320and)f(then)f(type)f Fg(../xkernel)p Fr(.)0 915 y(T)m(o)j(stop)f(a)h
(simulated)f(host,)h(type)g Fg(DELETE)h Fr(or)f Fg(CTRL-C)p
Fr(.)0 1036 y Fm(13.3.1)45 b(ROM)12 b(options)0 1123 y Fr(The)j(number)h(of)f
(input)f(threads)h(used)g(by)g(the)g(sunos)g(SIMETH)g(driver)g(can)h(be)g
(set)f(with)f(the)h(following)f(ROM)i(\256le)0 1180 y(option:)114
1278 y Fb(shepherd)22 b(threads)h(N)0 1400 y Fm(13.3.2)56 b(Pr)o(oblems)11
b(with)h(gcc)f(version)g(2)0 1487 y Fr(W)l(e)h(recommend)g(building)d(the)i
(sunos)e(version)i(of)g(the)g Fq(x)p Fr(-kernel)g(with)g(a)g(gcc)h(earlier)f
(than)g(2.0,)g(if)g(possible.)0 1610 y Fl(13.4)50 b(Mach)12
b(3)0 1697 y Fr(As)e(the)f(result)g(of)h(con\256guring)f(a)h(kernel)g
(\(section)f(12\),)h(a)g(\256le)g(named)h Fg(xkernel)f Fr(should)e(exist)h
(in)h(your)f(current)h(directory)0 1754 y(\()p Fg(/usr/xkernel/build/yap)p
Fr(\).)23 b(Y)-5 b(ou)12 b(may)i(optionally)c(create)k(a)f(\256le)g(named)g
Fg(rom)h Fr(in)e(this)g(directory)m(.)21 b(This)11 b(is)i(the)f(ROM)0
1810 y(\256le)f(described)g(in)g(section)f(13.2.)16 b(This)10
b(is)h(an)g(example)h Fg(rom)f Fr(\256le)h(for)f(the)g(mach3)h(platform:)114
1909 y Fb(ethdrv/SE0)22 b(priority)h(20)114 1965 y(arp)g(192.12.69.88)f
(8:0:20:1:51:E6)114 2022 y(arp)h(192.12.69.89)f(8:0:20:1:50:40)71
2177 y Fr(Each)9 b(ARP)h(entry)e(corresponds)g(to)h(an)g(initial)f(binding)f
(between)i(the)g(IP)h(address)e(and)h(the)g(ethernet)g(address.)15
b(These)0 2233 y(entries)f(are)i(not)e(necessary)g(if)h(you)f(have)h(hosts)e
(on)h(your)h(network)e(which)h(will)g(respond)g(to)g(your)g(RARP)i(and)f(ARP)
0 2290 y(requests.)71 2346 y(The)e(ethdrv)f(entry)h(indicates)f(the)h
(priority)f(of)i(the)f(Mach)h(packet)f(\256lter)g(used)g(by)g(the)g
Fq(x)p Fr(-kernel.)23 b(Priorities)13 b(>)g(100)0 2403 y(cause)d(the)f
Fq(x)p Fr(-kernel)h(to)f(grab)g(ethernet)h(packets)f(and)g(not)g(allow)g(the)
g(native)g(Mach)h(networking)e(code)h(to)g(see)h(them.)16 b(This)0
2459 y(allows)10 b(the)h Fq(x)p Fr(-kernel)g(to)g(fully)f(communicate)i(with)
e(other)h(hosts,)f(but)g(makes)i(it)e(dif)o(\256cult)h(to)f(run)h
Fq(x)p Fr(-kernel)h(tests)e(from)i(a)0 2516 y(remote)g(host.)71
2572 y(By)g(using)e(a)i(\256lter)g(priority)e(below)h(100,)h(both)e(Mach)j
(and)e(the)h Fq(x)p Fr(-kernel)g(see)g(all)f(ethernet)g(packets.)18
b(This)11 b(is)g(useful)0 2629 y(for)h(allowing)d(normal)j(network)e
(activity)g(while)h(running)f Fq(x)p Fr(-kernel)i(tests,)f(but)g(can)h
(result)e(in)h(troublesome)g(interaction)952 2753 y(73)p eop
%%Page: 74 74
73 bop 0 124 a Fr(between)10 b(the)g Fq(x)p Fr(-kernel)g(protocols)f(and)g
(the)h(Mach)h(protocols)e(running)f(on)i(the)g(same)h(host.)k(If)10
b(you)g(want)f(to)h(use)g(a)h(lower)0 181 y(\256lter)g(priority)m(,)f(we)i
(recommend)g(either)68 287 y Fi(\017)23 b Fr(Con\256guring)11
b(your)i Fq(x)p Fr(-kernel)g(without)e(TCP)-5 b(,)14 b(SUNRPC)f(and)g(any)g
(other)f(protocols)f(which)h(might)g(cause)h(inter)o(-)114
343 y(action)d(problems)114 419 y(or)68 512 y Fi(\017)23 b
Fr(using)11 b(the)h(non-standard)g(protocol)f(table)h(\()p
Fg(/usr/xkernel/etc/prottbl.nonstd)p Fr(\).)21 b(In)13 b(this)f(case,)h(of)g
(course,)g(the)114 569 y Fq(x)p Fr(-kernel)h(protocols)f(will)g(only)h(be)g
(able)g(to)g(communicate)g(with)g(other)g(hosts)f(running)f(the)i
Fq(x)p Fr(-kernel)h(with)e(the)114 625 y(alternate)d(protocol)g(table.)71
732 y(Since)i(the)g Fq(x)p Fr(-kernel)g(reads)g(from)h(the)f(ethernet)f
(device,)i(it)e(needs)h(to)g(run)g(with)f(root)g(uid.)19 b(Y)-5
b(ou)12 b(will)f(need)h(to)g(either)0 788 y(su)g(to)g(root)f(before)i
(running)d(it)i(or)g(run)g(it)g(setuid)f(root.)19 b(Some)13
b(Unix)e(servers)h(will)f(allow)h(members)h(of)f(group)f Fq(kmem)i
Fr(to)0 844 y(read)f(the)e(device;)h(in)g(this)f(case)h(members)h(of)g(the)f
(group)f(need)h(not)g(su)f(to)h(root.)71 901 y(See)20 b(the)g(man)g(page)g
(for)g(the)f(Mach)h(ethernet)g(driver)f Fq(ethdrv)g Fr(in)h(appendix)e(A)i
(for)g(additional)e(con\256guration)0 957 y(requirements.)71
1014 y(Since)11 b(the)f Fq(x)p Fr(-kernel)h(on)g(the)f(Mach)i(platform)e
(does)h(not)f(respond)g(well)g(to)g(CTRL-C')m(s,)j(we)e(recommend)g(running)f
(it)0 1070 y(in)h(the)g(background)f(so)g(you)h(can)g(easily)g(send)f(it)h(a)
h(SIGKILL)f(with)f(the)h('kill')f(command.)0 1193 y Fm(13.4.1)45
b(ROM)12 b(options)0 1280 y Fr(The)f(number)g(of)h(input)d(threads)i(and)g
(buf)o(fers)g(used)g(by)g(the)g(ethernet)g(drivers)f(in)h(the)g(Mach3)h
(platform)f(can)g(be)g(set)g(with)0 1336 y(the)g(following)e(ROM)j(\256le)f
(options:)114 1443 y Fb(shepherd)22 b(threads)h(N)114 1518
y(shepherd)f(buffers)h(M)0 1624 y Fr(There)11 b(should)f(be)h(at)g(least)g
(as)g(many)h(buf)o(fers)f(as)g(input)f(threads.)0 1748 y Fl(13.5)50
b(Mach)12 b(3)h Fa(x)p Fl(-kernel)f(in)g(the)f(Mach)i(kernel)0
1835 y Fr(See)i(section)e(17)h(for)g(a)g(description)f(of)h(how)f(to)h(build)
e(an)j Fq(x)p Fr(-kernel)f(within)f(the)g(Mach)i(kernel)f(and)g(how)f(to)h
(establish)0 1892 y(ROM)h(\256le)f(options)e(for)j(this)e(platform.)25
b(Be)15 b(sure)f(to)g(see)g(appendix)f(C)i(for)f(information)f(on)h
(con\256guring)e(the)i(device)0 1948 y(driver)d(you)f(wish)h(to)f(use.)0
2073 y Fl(13.6)50 b(Running)11 b(T)-5 b(est)13 b(Suites)0 2160
y Fr(Most)c(protocols)f(distributed)f(with)i(the)g Fq(x)p Fr(-kernel)h(come)g
(with)e(a)i(test)f(protocol)f(in)h(the)g Fg(protocols/test)g
Fr(directory)m(.)15 b(These)0 2216 y(protocols)c(typically)f(send)i(a)h
(number)f(of)h(round)e(trips)h(for)g(messages)g(of)h(various)e(sizes)h(and)g
(report)g(the)g(total)g(time)g(for)0 2272 y(the)f(test.)17
b(The)11 b(most)g(common)h(test)f(protocols)f(are)i(con\256gured)f(into)g
(the)g(protocol)f(library)m(,)h(but)g(some)h(may)g(have)f(to)g(be)0
2329 y(copied)f(and)h(compiled)f(directly)g(in)g(a)i(user)r(')m(s)e(build)g
(area.)17 b(T)m(est)10 b(protocols)g(compiled)g(into)g(the)g(protocol)g
(graph)g(start)h(up)0 2385 y(automatically)f(with)g(the)h(rest)g(of)g(the)g
(protocols.)71 2442 y(The)f(behavior)g(of)g(test)g(protocols)f(can)i(be)f
(modi\256ed)h(by)f(various)f(command-line)h(and)h(ROM)g(\256le)g(options.)j
(See)d(the)0 2498 y(man)h(page)f(for)g(the)g(TEST)g(protocol)f(in)h(appendix)
f(A.)952 2753 y(74)p eop
%%Page: 75 75
74 bop 0 124 a Fl(13.7)50 b(T)l(r)o(oubleshooting)0 211 y Fr(Many)13
b(of)g(the)g(problems)f(encountered)h(when)f(running)g(an)h
Fq(x)p Fr(-kernel)g(turn)g(out)f(to)h(be)g(con\256guration)e(problems.)22
b(Here)0 268 y(are)11 b(a)f(few)g(common)g(symptoms)g(and)f(some)h(things)f
(you)g(might)g(want)h(to)f(check)h(if)g(these)g(symptoms)f(occur)h(\(setting)
e(the)0 324 y(debugging)h(variable)i Fb(traceprotocol)f Fr(to)g
Fb(TR)p 780 324 15 2 v 17 w(EVENTS)h Fr(or)g(higher)g(can)g(be)g(very)g
(helpful)g(in)f(identifying)f(problems\):)68 430 y Fi(\017)23
b Fr(The)11 b Fq(x)p Fr(-kernel)g(aborts)g(before)g(a)h(the)f(\256rst)g
(protocol')m(s)f(init)g(routine)g(is)h(called.)114 506 y(Y)-5
b(our)7 b Fq(x)p Fr(-kernel)h(may)g(have)g(been)f(con\256gured)h(without)d(a)
j(protocol)e(table.)15 b(Make)9 b(sure)e(your)g(graph.comp)h(or)f(ROM)114
562 y(\256les)k(mention)f(at)h(least)g(one)g(protocol)f(table)h(and)g(that)f
(the)h(speci\256ed)g(protocol)f(table)h(exists)e(and)i(is)g(readable.)68
656 y Fi(\017)23 b Fq(x)p Fr(-kernel)11 b(hangs)g(in)f(arp)p
499 656 14 2 v 17 w(init.)114 731 y(ARP')m(s)i(initialization)d(routine)h
(will)h(not)g(return)g(until)f(it)h(has)h(discovered)e(the)i(binding)d(for)j
(its)f(local)g(IP)h(address.)114 787 y(If)j(the)f Fq(x)p Fr(-kernel)i(hangs)e
(in)g(arp)p 626 787 V 16 w(init,)h(ARP)h(is)e(probably)f(sending)h(out)g
(RARP)h(requests)f(which)g(are)i(not)e(being)114 844 y(answered.)i(Multiple)
10 b(warning)g(messages)h(of)h(the)e(form:)214 950 y Fb(ARP:)23
b(Could)g(not)h(get)f(my)h(IP)f(address)g(for)h(interface)e(eth)i(\(still)f
(trying\))114 1056 y Fr(are)12 b(an)f(indicator)f(of)h(this)f(problem.)114
1132 y(If)15 b(you)f(are)i(running)d(the)i(sunos)e(simulator)n(,)i(you)g
(must)f(have)h(an)g(ARP)g(binding)e(in)i(your)f(ROM)i(\256le)f(for)g(your)114
1188 y(local)d(host)f(\(see)i(section)e(13.3.\))20 b(On)12
b(other)g(platforms,)h(an)f(ARP)h(binding)e(for)h(the)g(local)g(host)g(is)g
(not)f(necessary)114 1244 y(if)g(another)g(host)f(on)i(your)e(network)h(will)
f(respond)h(to)g(RARP)h(broadcasts.)17 b(If)12 b(you)f(do)g(not)f(have)i
(such)f(a)h(host)e(\(or)114 1301 y(if)j(it)h(is)f(not)g(responding)f(for)i
(whatever)f(reason\),)i(adding)e(a)h(local)f(binding)f(to)h(your)h(ROM)g
(\256le)g(should)e(\256x)i(the)114 1357 y(problem.)68 1451
y Fi(\017)23 b Fr(Messages)11 b(sent)f(out)h(on)g(one)g(host)f(are)i(never)f
(received)g(on)g(the)g(destination)e(host.)114 1526 y(Check)j(your)g(ROM)g
(\256le.)20 b(If)12 b(it)g(contains)f(an)h(initial)e(binding)g(for)j(the)e
(destination)f(host)h(which)h(is)f(incorrect,)h(the)114 1583
y(destination)c(host)j(will)f(not)g(see)i(packets)e(from)i(the)f(sending)f
(host.)68 1677 y Fi(\017)23 b Fr(An)11 b(xOpen)f(hangs)g(for)i(a)f(while)g
(and)g(then)f(fails.)114 1752 y(An)f(open)h(may)g(fail)f(if)h(ARP)h(can)f
(not)f(resolve)g(the)h(IP)g(address)f(of)h(the)g(destination)d(\(turning)i
(ARP)h(tracing)f(on)h(can)114 1808 y(help)j(identify)f(this)g(problem.\))23
b(ARP)14 b(requests)e(should)g(never)i(be)f(sent)g(on)g(the)g(sunos)f
(simulator)h(platform.)23 b(If)114 1865 y(you)11 b(are)i(running)e(on)h(the)h
(sunos)e(platform)h(and)g(you)g(see)g(ARP)h(requests)f(being)g(sent,)g(check)
h(the)f(ROM)h(\256le)g(on)114 1921 y(the)e(sending)e(host)h(and)h(make)h
(sure)f(there)h(is)e(an)i(ARP)f(binding)f(for)h(the)g(destination)e(host.)68
2015 y Fi(\017)23 b Fr(The)11 b Fq(x)p Fr(-kernel)g(aborts)g(before)g(a)h
(speci\256c)f(protocol')m(s)f(init)g(routine)g(is)h(called.)114
2090 y(If)h(the)g Fq(x)p Fr(-kernel)h(can')o(t)g(\256nd)f(a)h(protocol)d
(number)j(for)f(your)g(protocol)f(in)h(any)g(of)g(its)g(tables,)g(it)g(will)f
(abort)h(before)114 2146 y(calling)e(the)i(protocol')m(s)f(initialization)e
(routine.)17 b(Y)-5 b(ou)12 b(will)f(need)h(to)f(add)h(an)g(entry)f(for)h
(your)g(protocol)e(in)h(one)h(of)114 2203 y(the)f(tables)f(\(see)h(section)g
(13.1.\))68 2297 y Fi(\017)23 b Fr(Messages)11 b(get)g(to)f(the)h
(destination)e(host)h(but)h(never)g(make)h(it)e(up)h(to)g(the)g(appropriate)f
(protocol.)114 2372 y(Make)k(sure)g(that)f(the)g(source)h(and)f(destination)e
(hosts)i(are)h(running)e(with)h(identical)f(protocol)h(table)g(entries)g(for)
114 2428 y(the)e(protocol)f(in)h(question.)16 b(If)c(the)f(numbers)h(are)g
(dif)o(ferent,)g(messages)f(won')o(t)g(get)g(to)h(the)f(appropriate)g
(protocol)114 2485 y(on)f(the)h(destination)e(host.)952 2753
y(75)p eop
%%Page: 76 76
75 bop 0 124 a Fn(14)60 b(Releasing)13 b(a)i(Pr)o(otocol)0
228 y Fr(Once)d(you)f(have)h(debugged)e(and)i(tuned)f(a)h(new)g(protocol,)f
(you)g(can)h(make)g(it)f(available)g(for)h(others)f(to)h(use)f(by)h(creating)
0 284 y(a)f(new)g(directory)f(in)g Fg(/usr/xkernel/protocols)p
Fr(,)h(copying)f(your)g(source)g(\256les)h(into)f(that)g(directory)m(,)g
(creating)g(a)h(make\256le)0 340 y(in)g(that)f(directory)m(,)h(and)g
(modifying)f(the)h(make\256le)h(in)f Fg(/usr/xkernel/protocols)p
Fr(.)16 b(If)c(your)f(protocol)f(is)g(a)i(device)f(driver)n(,)0
397 y(put)f(the)h(source)g(\256les)g(in)g Fg(/usr/xkernel/PLA)m
(TFORM/drivers)g Fr(instead)f(of)i Fg(/usr/xkernel/protocols)p
Fr(.)71 453 y(If)j(you)f(want)h(to)f(make)i(your)e(new)h(protocol)e
(available)i(to)f(other)h(sites,)g(then)f(make)i(a)f(tar)g(\256le)g(of)g
(your)g(protocol)0 510 y(available)f(and)h(drop)f(a)h(note)f(to)h
Fg(xkernel-bugs@cs.arizona.edu)p Fr(.)29 b(W)l(e)16 b(will)d(include)h(your)g
(protocol)g(in)g(the)h(next)0 566 y(release.)22 b(Y)-5 b(ou)13
b(should)f(also)g(create)i(a)f(\252man)h(page\272)f(for)g(you)f(protocol)g
(similar)g(to)h(those)f(found)g(in)h(Appendix)e(A.)i(The)0
623 y(source)e(\256les)g(for)g(these)g(man)h(pages)f(are)h(in)e
Fg(/usr/xkernel/doc/manual/protocols)p Fr(.)952 2753 y(76)p
eop
%%Page: 77 77
76 bop 0 124 a Fn(15)60 b(System)14 b(Installation)0 228 y
Fr(This)c(section)g(describes)h(how)f(to)h(install)e(V)-5 b(ersion)10
b(3.2)i(of)f(the)g Fq(x)p Fr(-kernel.)17 b(By)11 b(installing)d(the)j
Fq(x)p Fr(-kernel)h(we)f(mean)h(setting)0 284 y(up)f(the)g
Fq(x)p Fr(-kernel)g(environment)f(so)h(that)g(programmers)g(can)h(begin)e
(writing)g(protocols)f(and)i(con\256guring)f(new)i(kernels.)71
340 y(The)f Fq(x)p Fr(-kernel)h(is)f(commonly)h(used)f(for)h(both)f(research)
h(and)g(instruction.)j(A)d(typical)f(scenario)g(is)g(for)h(a)g(researcher)0
397 y(\(instructor\))7 b(to)g(install)f(the)h Fq(x)p Fr(-kernel)g(for)g(use)g
(by)g(vario)o(us)g(net)o(work)g(proj)o(ects)g(\(st)o(udent)o(s\).)13
b(Individual)7 b(projects)g(\(st)o(udent)o(s\))0 453 y(then)14
b(build)f(and)h(test)g(kernels)g(in)g(private)g(working)f(directories.)26
b(This)13 b(section)h(describes)g(the)g(work)g(the)g(researcher)0
510 y(\(instructor\))c(needs)h(to)f(do)h(to)g(set)g(up)g(the)g
Fq(x)p Fr(-kernel)g(directory)m(.)0 634 y Fl(15.1)50 b(Unpacking)11
b(the)h Fa(tar)g Fl(\256le)0 721 y Fr(If)j(you)e(haven')o(t)h(done)g(so)g
(already)m(,)h(create)g(a)g(new)f(directory)g(for)g(installing)e(the)i
Fq(x)p Fr(-kernel.)26 b(For)15 b(the)f(purpose)f(of)h(this)0
778 y(report,)i(we)g(refer)g(to)f(this)f(directory)g(as)i Fb(/usr/xkernel)p
Fr(.)27 b(Y)-5 b(ou)15 b(may)h(chose)f(another)f(name,)k(however)m(.)28
b Fb(cd)16 b Fr(to)e(this)0 834 y(directory)c(and)h(type)114
940 y Fb(tar)23 b(xf)11 b Fq(\256le)0 1047 y Fr(where)17 b
Fq(\256le)g Fr(is)f(the)h(disk)f(or)h(tape)g(\256le)g(of)g(the)f
Fq(x)p Fr(-kernel)i(distribution)o(.)31 b(This)16 b(will)g(create)i(several)f
(subdirectories)e(in)0 1103 y Fb(/usr/xkernel)p Fr(.)i(A)12
b(description)e(of)i(the)f Fq(x)p Fr(-kernel)h(directory)f(hierarchy)h(can)g
(be)g(found)f(in)g(the)h(README)g(\256le)g(at)f(the)0 1159
y(top)f(level)h(of)g(the)g Fq(x)p Fr(-kernel)h(hierarchy)m(.)0
1284 y Fl(15.2)50 b(About)11 b(Compilers)0 1371 y Fr(V)-5 b(ersion)10
b(3.2)h(of)g(the)f Fq(x)p Fr(-kernel)h(uses)g(either)f(the)h(Gnu)f(C)h
(compiler)g(\()p Fb(gcc)p Fr(\))g(or)g(the)f(standard)g(Unix)g(compiler)h(\()
p Fb(cc)p Fr(\).)17 b(If)11 b(you)0 1427 y(do)d(not)f(currently)h(have)g(Gnu)
g(C)h(at)f(your)f(site,)i(you)f(can)g(get)g(a)h(copy)e(by)h(doing)f
(anonymous)g(FTP)i(to)f Fb(prep.ai.mit.edu)p Fr(,)0 1484 y(and)j(retrieving)f
Fb(pub/gnu/gcc.xtar)p Fr(.)71 1540 y(W)l(e)h(recommend)h(building)d(the)i
(sunos)f(version)g(of)h(the)g Fq(x)p Fr(-kernel)h(with)e(a)i(gcc)f(earlier)h
(than)e(2.0,)i(if)f(possible.)0 1664 y Fl(15.3)50 b(Building)11
b(the)h(Utility)f(pr)o(ograms)0 1751 y Fr(The)17 b Fq(x)p Fr(-kernel)h
(requires)f(a)h(few)f(utility)e(programs.)35 b(W)l(e)18 b(distribute)e
(binary)g(versions)g(of)i(these)f(programs,)i(so)e(you)0 1808
y(probably)10 b(don')o(t)g(need)i(to)e(rebuild)g(these)h(programs)g(and)g
(can)h(skip)e(to)h(the)g(next)f(section.)71 1864 y(If)j(you)f(decide)g(to)g
(rebuild)g(the)g(utility)e(programs,)j(you)f(will)g(need)g(to)h(de\256ne)f
(the)h(environment)e(variable)h Fb(ARCH)h Fr(to)0 1921 y(correspond)d(to)h
(the)g(type)g(of)g(binaries)f(you)h(want)f(created:)17 b Fb(sparc)p
Fr(,)11 b Fb(mips)p Fr(,)g(or)g Fb(intelx86)p Fr(.)71 1977
y(The)i Fq(x)p Fr(-kernel)g(depends)g(on)g(gnumake,)h(so)e(you)h(must)g
(\256rst)g(have)g(gnumake)g(built)f(and)h(installed.)21 b(A)13
b(copy)g(of)g(the)0 2034 y(source)d(code)g(and)f(build)g(instructions)e(for)j
(gnumake)g(version)f(3.66)h(can)g(be)g(found)f(in)g(util/make.)15
b(After)10 b(you)g(have)g(built)0 2090 y(gnumake,)g(place)g(the)f(binary)g
(in)g(the)g(appropriate)g(/usr/xkernel/bin/A)o(RCH)f(directory)m(,)h(where)h
(ARCH)g(is)f(as)h(described)0 2147 y(above.)71 2203 y(Next,)15
b(put)f Fb(/usr/xkernel/bin/ARCH)e Fr(and)i Fb(/usr/xkernel/bin)f
Fr(in)h(your)g(search)h(path.)27 b(They)14 b(should)f(ap-)0
2260 y(pear)k(before)g Fb(/bin)f Fr(and)h Fb(/usr/bin)f Fr(in)g(order)h(to)f
(pick)g(up)g(gnumake)h(before)g(the)f(standard)g(Unix)g Fb(make)p
Fr(.)33 b(Finally)m(,)0 2316 y Fb(cd)24 b(/usr/xkernel/util)11
b Fr(and)j(type)f Fb(make)23 b(setup)14 b Fr(followed)e(by)i
Fb(make)23 b(install)p Fr(.)g(This)13 b(will)g(install)f(a)i(handful)0
2372 y(of)g(programs)f(used)h(to)f(develop)g(new)g(kernels.)24
b(\()p Fb(make)g(setup)13 b Fr(may)h(produce)f(a)h(warning)f(of)h(the)g
(form:)21 b Fb(make[1]:)0 2429 y(fopen:)47 b(Makedep.ARCH:)22
b(No)i(such)f(file)g(or)h(directory)p Fr(.)30 b(These)15 b(missing)g(\256les)
h(will)f(be)h(created)g(during)0 2485 y(this)10 b(step)h(and)g(the)g(warning)
f(can)h(be)h(ignored.\))952 2753 y(77)p eop
%%Page: 78 78
77 bop 0 124 a Fl(15.4)50 b(Building)11 b(and)h(testing)g(the)f(system)0
211 y Fr(As)29 b(the)f(\256rst)h(person)g(installing)d(the)j
Fq(x)p Fr(-kernel)g(at)g(your)g(site,)k(you)28 b(should)g(look)g(over)h(the)f
(make\256les)i(in)0 268 y(/usr/xkernel/buil)o(d/T)l(emplate.)40
b(They)19 b(have)h(many)g(site-speci\256c)f(parameters)h(referring)g(to)f
(compilers,)j(libraries)0 324 y(and)11 b(the)g(like)f(which)h(should)e(be)j
(set)f(to)f(re\257ect)i(the)f(environment)f(at)i(your)e(site.)71
381 y(The)d Fq(x)p Fr(-kernel)h(is)f(distributed)e(with)h(two)h(versions)f
(of)i(the)f(protocol)f(number)h(table)g(in)g Fg(/usr/xkernel/etc)p
Fr(,)h Fg(prottbl.std)0 437 y Fr(and)14 b Fg(prottbl.nonstd)p
Fr(.)24 b(Since)14 b(several)g(example)g(graph.comp)g(and)f(rom)h(\256les)g
(refer)h(to)e(a)h(\256le)g(named)g Fg(prottbl)h Fr(in)e(that)0
494 y(directory)m(,)i(you)g(should)e(probably)h(copy)g(or)h(link)f(the)g
(version)g(most)g(appropriate)g(for)i(your)e(site)g(to)g(this)g(name.)28
b(See)0 550 y(section)10 b(13.1)h(for)g(a)h(description)d(of)j(the)e(dif)o
(ference)i(between)f(the)g(two.)71 606 y(T)m(o)g(install)f(the)i(system,)g
(build)e(a)j(kernel)e(as)h(described)g(in)f(section)g(12,)h(paying)f
(attention)f(to)i(the)g(notes)f(for)h(system)0 663 y(installers.)i(Y)-5
b(ou)9 b(will)f(want)h(to)f(con\256gure)h(a)h(kernel)e(that)h(includes)e(one)
i(or)g(more)h(of)f(the)g(test)f(protocols)g(\(e.g.,)i Fb(udptest)p
Fr(\).)0 719 y(Y)-5 b(ou)11 b(should)f(then)g(be)i(able)f(to)f(run)h(your)g
(test)g(kernel)f(as)i(described)e(in)h(section)f(13.)952 2753
y(78)p eop
%%Page: 79 79
78 bop 0 124 a Fn(16)60 b(Installing)14 b(MachNetIPC)h(-)f(A)i(Network)e
(Extension)g(of)h(Mach3)g(IPC)0 228 y Fr(By)c(compiling)e(a)i(protocol)e
(graph)h(with)g(the)g(machnetipc)g(protocol)g(and)g(its)g(supporting)e
(protocols,)h(one)i(can)f(construct)0 284 y(a)f(server)h(that)e(runs)h(in)g
(the)f(Mach3)i(environment)e(and)h(turns)f(the)h(native)f(IPC)i(mechanism)g
(into)e(one)h(that)f(extends)g(across)0 340 y(a)14 b(set)g(of)g(machines.)26
b(This)13 b(can)h(be)g(used)g(as)g(replacement)g(for)h(the)e(Mach)i(program)f
(known)f(as)i(the)e(\252netmsgserver)m(.\272)0 397 y(MachNetIPC)c(is)e
(faster)g(than)g(the)h(netmsgserver)f(and)g(supports)f(all)h(Mach3)h(IPC)g
(semantics)f(and)h(the)f(netname)h(interface.)0 453 y(In)13
b(addition,)f(the)h(protocols)f(can)h(work)g(over)g(internetworked)e
(con\256gurations.)21 b(This)12 b(release)i(is)e(a)i(beta)f(test)f(release.)0
510 y(W)l(e)e(expect)f(and)g(welcome)h(problem)f(reports)f(\(see)i(section)e
(16.7\).)16 b(Our)9 b(testing)f(has)h(established)f(that)g(the)h
(transmission)0 566 y(of)k(simple)f(messages)h(appears)g(correct)g(and)f
(robust;)g(complex)h(messages)g(involving)d(port)i(transfers)h(are)g(correct)
g(and)0 623 y(robust)h(in)g(so)g(far)i(as)f(our)f(environment)g(has)h
(allowed)f(testing.)25 b(Our)15 b(test)f(platforms)g(have)h(been)g(HP)g(720')
m(s)g(running)0 679 y(OSF/1)9 b(from)h(Utah,)g(DecStations,)f(running)f(MK74)
h(and)g(UX35)g(and)g(higher)n(,)h(and)f(Intel)g(486-based)f(machines)i
(running)0 736 y(MK82)h(and)g(UX41.)71 792 y(The)c(\256les)h(in)f(the)h
(mach3/api/netipc)e(directory)h(comprise)h(the)f(interface)h(between)g(the)f
(user)h(tasks)f(and)g(the)h(protocols)0 849 y(that)15 b(transport)f(data.)28
b(When)15 b(they)g(are)h(composed)f(with)f(a)h(protocol)f(graph)h(providing)f
(the)g(transport)g(and)i(liveness)0 905 y(services)f(they)h(require,)h(the)e
(resulting)g Fg(xkernel)h Fr(image)g(\256le)g(can)g(run)g(as)g(a)g(task)f
(that)g(supports)f(the)i(netnameserver)0 961 y(interface)d(for)h(registering)
d(and)i(retrieving)g(Mach)g(ports)g(on)f(other)h(machines)g(running)f(the)h
(same)h(software.)22 b(NB)13 b(this)0 1018 y(software)e(will)f(not)g
(interoperate)h(with)f(the)h(netmsgserver)g(distributed)d(by)j(CMU.)71
1074 y(The)d(implementation)g(of)h(MachNetIPC)h(is)f(described)f(in)g(the)h
(Usenix)f(Proceedings)g(of)h(the)g(Mach)h(III)f(Symposium,)0
1131 y(Santa)i(Fe)h(NM,)g(April)e(1993.)0 1255 y Fl(16.1)50
b(Building)11 b(MachNetIPC)0 1342 y Fr(T)m(o)i(build)g(a)h(MachNetIPC)h
(service,)f(begin)f(by)h(creating)f(a)h(\252build\272)f(directory)g(as)h
(described)f(in)g(12.2.)24 b(Copy)13 b(the)h(\256le)0 1399
y Fg(mach3/api/netipc/graph.comp)f Fr(to)f(that)f(directory)h(and)g
(con\256gure)f(the)h(graph.comp)g(\256le)h(to)e(refer)i(to)f(the)f(name)i(of)
0 1455 y(the)e(ethernet)g(device)g(for)g(your)g(system.)71
1511 y(Y)-5 b(ou)11 b(can)g(then)g(type)f Fb(make)24 b(compose;)e(make)i
(depend;)f(make)11 b Fr(to)f(build)g(an)h(xkernel)g(image)g(\256le.)0
1636 y Fl(16.2)50 b(Running)11 b(MachNetIPC)0 1723 y Fr(Application)i
(programs)h(registering)g(and)g(using)g(cross-machine)h(services)f(make)h
(use)g(of)g(the)g(netname)g(interface)g(to)0 1779 y(MachNetIPC.)f(The)e
(\252nns\272)g(interface)g(to)g(MachNetIPC)h(can)f(operate)h(either)e(as)i
(the)f(sole)f(name)i(server)f(on)g(a)h(node,)f(or)0 1836 y(in)h(cooperation)g
(with)g(a)h(service)g(that)g(is)f(already)h(running)f(\(such)g(as)h
(\252snames\272)g(or)g(\252netmsgserver)r(\272\),)h(although)d(this)0
1892 y(latter)f(con\256guration)g(slightly)e(complicates)i(the)h(initial)e
(contact)h(with)g(the)g(service.)19 b(See)12 b(the)g(appendix)e(section)h
(about)0 1949 y(\252nns\272)f(for)h(more)g(information)f(on)g(how)g(to)g(use)
h(this)e(service.)16 b(The)11 b(host)e(administrator)h(should)f(decide)h
(whether)g(to)g(run)0 2005 y(MachNetIPC)i(alone)f(or)g(in)g(cooperation)f
(with)g(other)h(services.)71 2062 y(The)e(MachNetIPC)h(service)f(can)g(be)g
(added)g(to)g(the)g(boot)f(time)h(server)g(startup)f(script)h
Fg(nanny)m(.con\256g)g Fr(in)g(place)g(of)g(the)0 2118 y(\252netmsgserver)r
(\272.)19 b(Consult)11 b(your)g(local)h(system)g(administration)d(guide)j
(for)g(more)h(information)e(about)g(server)h(startup)0 2174
y(procedures.)23 b(Note)13 b(that)g(the)h Fq(x)p Fr(-kernel)f(must)h(be)f
(started)g(with)g(a)h(user)f(id)g(that)g(has)g(permission)g(to)g(access)h
(the)f(master)0 2231 y(device)g(port.)24 b(If)14 b(your)f(site)g(does)g(not)g
(a)h(RARP)g(server)g(\(an)g(unusual)e(circumstance\),)j(you)e(may)h(\256nd)f
(it)g(necessary)h(to)0 2287 y(create)e(a)f(ROM)h(\256le)f(and)g(start)f(the)h
(xkernel)f(image)h(\256le)h(from)f(the)g(directory)f(with)g(the)h(rom)g
(\256le.)17 b(See)12 b(section)e(13.2)g(and)0 2344 y(the)h(ARP)h(man)f(page)g
(in)g(appendix)f(A)h(for)h(details.)71 2400 y(If)f(the)g Fq(x)p
Fr(-kernel)h(terminates)e(or)i(is)e(terminated,)h(it)g(can)h(be)f(restarted)g
(easily)f(\(\252xkernel)h(&\272\).)952 2753 y(79)p eop
%%Page: 80 80
79 bop 0 124 a Fl(16.3)50 b(Using)12 b(MachNetIPC)0 211 y Fr(Y)-5
b(ou)9 b(can)g(use)f(the)h(xkernel)f(image)h(built)e(with)h(MachNetIPC)i(in)e
(place)h(of)f(the)h(older)f(netmsgserver)m(.)16 b(The)9 b(most)f(common)0
268 y(way)j(of)g(utilizing)d(it)j(takes)f(advantage)h(of)g(the)f(netname)i
(interface,)f(which)f(is)h(supported)e(by)i(the)f(netmsgserver)h(and)g(by)0
324 y(the)i(\252snames\272)g(program.)23 b(This)12 b(supports)f(registering)h
(a)h(name)h(string)d(and)i(a)h(port)e(for)h(access)h(by)e(remote)i(machines,)
0 381 y(and)d(lookup)f(of)h(the)h(port)e(corresponding)g(to)h(the)g(name.)18
b(The)11 b(ports)g(can)g(be)h(used)f(just)f(like)h(any)g(other)g(Mach)h(port)
f(port)0 437 y(\(with)f(respect)h(to)g(send)g(and)g(receive)g(operations\).)
71 494 y(Documentation)e(for)j(the)e(netname)i(interface)f(can)h(be)f(found)f
(in)h(either)g(the)g(/usr/mach/man)f(area)i(on)f(your)g(system)0
550 y(or)g(in)g(this)f Fq(x)p Fr(-kernel)i(distributio)o(n)d(in)h(the)h
Fg(mach3/api/netipc/netname)p 1203 550 14 2 v 18 w(*.3)g Fr(\256les.)71
606 y(CA)-6 b(VEA)h(T)n(:)9 b(This)g(release)h(does)g(support)e(using)h(DNS)h
(hostnames)f(for)h(netname)h(lookups.)j(Use)c(the)g(full)f(IP)i(address)0
663 y(of)g(remote)h(hosts.)j(See)d(also)f(the)g(protocol)e(appendix)h
(section)h(for)g(the)g(\252nns\272)g(service.)71 719 y(There)g(is)f(an)h
(aspect)f(of)h(the)g(netname)g(interface)g(that)f(depends)g(on)g(having)g(a)h
(broadcast)f(address)g(available.)16 b(If)11 b(one)0 776 y(machine)h(wants)f
(to)g(look)g(up)h(a)g(name)h(without)c(specifying)i(the)g(IP)i(address)e(of)h
(the)g(destination,)e(a)i(broadcast)f(query)h(is)0 832 y(used.)k(If)11
b(the)f(machine)h(of)o(fering)f(the)h(name)g(is)f(not)g(accessible)g(via)g
(broadcast,)h(then)f(the)g(lookup)f(will)h(fail.)16 b(See)11
b(section)0 889 y(16.4)g(for)g(information)f(about)h(setting)e(the)i(UDP)g
(port)g(number)g(for)h(this)e(service.)71 945 y(W)n(ith)j(the)h(exception)f
(of)h(broadcast)g(name)h(lookup,)e(all)h(MachNetIPC)i(functions)c(work)i
(transparently)f(between)0 1002 y(machines)e(with)f(local)h(area)h(network)e
(or)i(Internet)e(connectivity)m(.)0 1124 y Fl(16.4)50 b(Pr)o(otocol)12
b(T)-5 b(ables)0 1211 y Fr(The)13 b(protocol)e(table)i(de\256nes)g(the)f(UDP)
h(port)g(number)g(to)f(use)h(for)g(broadcasts.)21 b(W)l(e)13
b(have)g(set)g(it)f(to)h(be)g(the)f(same)i(as)f(is)0 1268 y(used)e(by)f(the)h
(netmsgserver)m(.)17 b(If)12 b(this)e(causes)h(problems)f(at)h(your)g(site,)g
(you)g(can)g(change)g(the)g(entry)g(at)g(the)g(nns)f(line:)114
1363 y Fb(udp)119 b(5)114 1420 y({)305 1476 y(pmap)94 b(111)305
1533 y(nns)118 b(x7823)114 1589 y(})71 1685 y Fr(The)11 b(illustration)d
(shows)i(that)h(the)f(hex)h(number)h(\2527823\272)e(is)h(used.)71
1741 y(If)17 b(your)f(site)h(will)e(not)i(be)g(using)e(the)i(broadcast)f
(mechanism)h(for)g(netname)g(lookup,)h(the)e(protocol)g(number)h(is)0
1798 y(irrelevant.)0 1921 y Fl(16.5)50 b(Large)13 b(Messages)0
2008 y Fr(There)h(is)f(no)h(inherent)e(limit)h(on)h(the)f(total)g(size)g(of)h
(a)g(message)g(sent)f(using)g(Mach)h(IPC.)h(MachNetIPC)g(has)f(a)g(default)0
2064 y(con\256guration)7 b(that)g(is)h(limited)f(to)h(sending)f(datagrams)h
(no)g(lar)o(ger)h(than)f(64K.)g(Programs)g(that)g(transfer)g(lar)o(ge)h
(amounts)e(of)0 2120 y(out-of-line)g(data)g(may)g(be)g(inconvenienced)g(by)f
(thi)o(s.)12 b(W)l(e)7 b(provide)g(an)g(alternate)g(con\256guration)g(that)g
(sup)o(port)o(s)g(arbitraril)o(y)0 2177 y(lar)o(ge)13 b(messages.)22
b(W)l(e)13 b(also)g(note)f(that)g(very)h(lar)o(ge)g(message)g(transfers)g
(may)g(adversely)g(af)o(fect)g(the)g(performance)h(of)f(a)0
2233 y(host)c(node,)h(due)g(to)g(having)f(to)h(buf)o(fer)g(the)g(message)h
(in)e(the)h Fq(x)p Fr(-kernel)h(task)e(while)h(it)f(is)h(being)f(transferred)
i(\(this)e(is)g(worse)0 2290 y(for)i(the)g(receiver)h(than)f(the)g(sender\).)
71 2346 y(The)18 b(\256le)g Fg(mach3/api/netipc/graph.comp.large)j
Fr(can)d(be)h(used)e(in)h(place)h(of)f(the)g(standard)f(graph.comp)i(to)0
2403 y(support)10 b(lar)o(ge)h(messages.)17 b(It)11 b(relies)g(on)g(a)h
(newly)e(developed)h(protocol)f(\(RA)-5 b(T\))11 b(that)g(implements)f(a)i
(reliable)f(datagram)0 2459 y(protocol)f(over)h(TCP)-5 b(.)71
2516 y(If)12 b(you)f(wish)g(to)h(use)g(RA)-5 b(T)12 b(for)g(very)g(lar)o(ge)g
(messages)g(\(more)g(than)g(1M)g(byte)f(or)h(so\),)h(you)e(will)g(need)h(to)f
(recompile)0 2572 y(several)h Fq(x)p Fr(-kernel)g(\256les)f(in)g(a)h(special)
g(manner)m(.)19 b(W)l(e)12 b(recommend)g(that)f(you)g(recompile)h(these)f
(\256les)h(in)f(your)g(local)h(build)0 2629 y(directory)e(in)h(order)g(to)g
(avoid)g(con\257icts)f(with)g(other)h(users.)16 b(The)11 b(relevant)g
(\256les)g(are:)952 2753 y(80)p eop
%%Page: 81 81
80 bop 114 124 a Fb(xkernel/pi/msg.c)114 181 y(xkernel/pi/msg_internal)o(.h)
114 237 y(xkernel/mach3/pxk/mallo)o(c.c)114 294 y(xkernel/mach3/pxk/stack)o
(.c)0 400 y Fr(The)7 b(\256le)g Fg(msg.c)g Fr(contains)g(the)g(message)g
(tool)g(implementation,)f(which)h(must)g(be)g(compiled)g(with)g(the)g(MSG)p
1734 400 14 2 v 16 w(NON)p 1849 400 V 16 w(REC)0 456 y(\257ag)13
b(to)e(work)h(with)f(lar)o(ge)h(messages.)20 b(The)12 b(standard)f(Mach)i
(malloc)f(doesn')o(t)f(return)h(and)g(reuse)g(lar)o(ge)h(storage)e(blocks)0
513 y(very)h(well,)g(so)f(we)h(recommend)h(compiling)d(our)i(distributed)e
(version)h(of)h Fg(malloc.c)f Fr(for)h(lar)o(ge)g(messages.)19
b(Y)-5 b(ou)12 b(might)0 569 y(also)d(wish)g(to)g(compile)g(and)g(use)g(the)h
Fg(stack.c)e Fr(that)h(we)h(provide;)e(it)h(limits)g(cthread)g(stacks)g(to)g
(64K)g(and)g(uses)g(less)g(virtual)0 626 y(memory)m(.)71 682
y(T)m(o)h(compile)h(special)g(versions)f(of)h(these)g(\256les:)68
788 y Fi(\017)23 b Fr(Copy)9 b(\(or)g(link\))g(these)g(\256les)g(to)g(your)g
(build)f(directory)m(.)15 b(Edit)9 b(your)f(Make\256le)j(in)e(your)f(build)g
(directory)h(to)g(indicate)114 845 y(that)h(these)h(\256les)g(will)f(be)h
(locally)g(compiled,)f(by)h(adding)f(to)h(the)g(PRIVSRC)i(and)e(PRIVOBJ)h
(variables:)214 951 y Fb(PRIVSRC)23 b(=)g(\\)405 1008 y(msg.c)94
b(\\)405 1064 y(malloc.c)22 b(\\)405 1121 y(stack.c)214 1233
y(PRIVOBJ)h(=)g(\\)405 1290 y(./$\(HOW\)/msg.o)93 b(\\)405
1346 y(./$\(HOW\)/malloc.o)21 b(\\)405 1403 y(./$\(HOW\)/stack.o)68
1509 y Fi(\017)i Fr(Add)10 b(-DMSG)p 352 1509 V 17 w(NON)p
468 1509 V 16 w(REC)i(to)e(the)h(TMP)p 790 1509 V 17 w(CPPFLAGS)h(variable)f
(in)g(your)f(Make\256le.)68 1603 y Fi(\017)23 b Fr(Run)11 b
Fb(make)23 b(depend)11 b Fr(and)g Fb(make)p Fr(.)0 1727 y Fl(16.6)50
b(Access)14 b(Contr)o(ol)d(and)h(Privacy)0 1814 y Fr(This)18
b(release)i(of)f(MachNetIPC)i(has)e(no)g(access)g(control)f(or)i(privacy)e
(mechanisms.)41 b(W)l(e)20 b(have)f(expectations)f(of)0 1871
y(providing)9 b(these)i(services)g(in)f(1994.)0 1995 y Fl(16.7)50
b(Reporting)11 b(Pr)o(oblems)0 2082 y Fr(Problems)h(can)g(be)f(reported)h(to)
f(xkernel-bugs@cs.arizona.edu,)g(but)g(problems)g(and)g(discussion)e(that)i
(are)i(speci\256c)f(to)0 2138 y(MachNetIPC)k(should)c(go)j(to)f
(xkernel-mnipc@cs.arizona.edu;)h(if)f(you)g(wish)f(to)i(be)f(a)h(member)h(of)
e(this)g(list)f(send)h(a)0 2195 y(note)d(to)f(xkernel-mnipc-request.)16
b(If)11 b(you)g(aren')o(t)g(sure)g(which)g(list)f(to)h(use)g(for)g(a)g
(problem,)h(use)f(xkernel-bugs.)952 2753 y(81)p eop
%%Page: 82 82
81 bop 0 124 a Fn(17)60 b(Installing)14 b(within)h(a)g(Mach3)f(Kernel)0
228 y Fr(The)8 b Fq(x)p Fr(-kernel)h(can)g(be)f(compiled)g(as)g(an)h
(integral)e(part)h(of)h(the)f(Mach3)h(kernel.)15 b(This)8 b(facility)f(is)h
(provided)f(for)i(researchers)0 284 y(developing)j(highly)h(ef)o(\256cient)h
(protocols)e(and)i(for)h(obtaining)d(timing)h(results)f(that)i(are)h
(exclusive)e(of)h(Mach)g(IPC)h(and)0 340 y(Unix)e(server)g(overhead.)24
b(At)13 b(the)g(present)g(time,)i(there)e(is)g(no)g(user)h(interface)f(for)h
(accessing)f(the)g Fq(x)p Fr(-kernel)h(services)f(\261)0 397
y(the)d(Mach3)i(kernel)e(can)h(boot,)f(run)h(an)g Fq(x)p Fr(-kernel)g(timing)
e(test)h(and)h(print)f(the)g(results.)15 b(A)c(more)g(usable)g(interface)f
(will)g(be)0 453 y(provided)g(in)h(the)g(future.)71 510 y(These)e(are)h
(instructions)d(for)i(building)f(a)i(version)e(of)i(the)f Fq(x)p
Fr(-kernel)h(that)f(resides)f(in)h(the)h(Mach3)g(kernel.)15
b(Y)-5 b(ou)10 b(should)0 566 y(be)k(familiar)g(with)g(the)f(build)g
(instructions)f(for)i(the)g(\252out)f(of)h(kernel\272)h(version)e(before)h
(starting.)24 b(Y)-5 b(ou)14 b(should)f(also)g(be)0 623 y(familiar)e(with)f
(the)h(procedure)g(for)h(building)d(the)i(Mach)g(kernel)g(and)g(have)h(a)f
(working)f(environment)g(set)h(up.)71 679 y(The)f(\256les)g(distributed)e
(\(and)i(these)g(directions\))f(have)h(been)h(used)e(with)h(the)g(MK82)g
(Mach)h(kernel)f(for)g(a)h(DecStation)0 736 y(5000)f(and)h(an)h(Intel)e(486)h
(PC.)71 792 y(Set)g(your)g(path)f(to)h(include)f(the)h(/usr/xkernel/bin)d
(and)j(/usr/xkernel/bin/ARCH)e(directories.)57 898 y(1.)23
b(Place)17 b(the)f Fq(x)p Fr(-kernel)h(source)f(tree)h(in)f(the)g(mach)h
(source)g(tree.)33 b(In)16 b(the)g(src/mk/kernel)g(directory)m(,)i(in)e
(either)g(a)114 955 y(shadow)9 b(area)i(or)f(the)g(primary)g(source)g(area,)i
(create)f(a)f(link)f(named)i('xkern')f(to)g(the)g(head)g(of)g(the)g
Fq(x)p Fr(-kernel)g(source)114 1011 y(tree.)57 1105 y(2.)23
b(Patch)10 b(some)g(mach)h(kernel)e(source)h(\256les.)16 b(The)10
b(tree)h(rooted)e(at)h(xkernel/mach3/machkernel)f(is)h(a)g(parallel)f(of)h
(the)114 1162 y(mach)h(kernel)f(source)g(tree,)h(containing)d
(modi\256cations)h(to)h(support)f(the)h Fq(x)p Fr(-kernel.)17
b(These)10 b(modi\256cations)f(are)i(all)114 1218 y(conditional)g(on)j
Fq(x)p Fr(-kernel)g(compilation)e(\257ags,)k(so)d(you)g(can)i(use)e(these)h
(modi\256ed)g(\256les)f(to)h(build)f(non-)p Fq(x)p Fr(-kernel)114
1274 y(Mach)8 b(kernels)g(if)g(you)f(desire.)16 b(Y)-5 b(ou)7
b(can)i(either)e(go)h(through)f(these)g(\256les)h(one)g(at)g(a)h(time)f(and)g
(make)g(the)g(appropriate)114 1331 y(\256le-by-\256le)13 b(substituti)o(ons)o
(,)e(or)i(you)g(can)g(set)f(up)h(a)g(mach)h(shadow)d(directory)i(and)f
(link/copy)f(the)i(directories)f(in)114 1387 y(xkernel/mach3/machkernel)i(to)
h(the)h(shadow)e(area.)31 b(The)16 b(latter)f(should)f(be)i(the)f(easier)h
(approach)f(\(and)h(less)114 1444 y(intrusive)9 b(to)i(your)f(original)g
(mach)i(source)f(tree.\))114 1519 y(Note)f(that)h(one)g(can)g(not)g
(transparently)e(shadow)i(the)g(mk/kernel/conf)f(directory)m(.)16
b(Since)11 b(the)g(directory)114 1575 y(xkernel/mach3/machkernel/conf)f(only)
h(includes)g(\256les)h(that)f(we)h(have)g(modi\256ed,)g(it)g(should)e(be)i
(overlayed)g(on)114 1632 y(top)e(of)h(a)h(copy)f(of)g(an)g(original)f
(mk/kernel/conf)g(directory)m(.)57 1726 y(3.)23 b(Compose)12
b(an)h Fq(x)p Fr(-kernel)g(graph.)21 b(Create)14 b(a)f(directory)f
(xkern.local)g(under)g(src/mk/kernel.)21 b(This)11 b(directory)h(will)114
1782 y(contain)j(the)h(\256les)h(created)f(by)g(composing)f(the)i
(graph.comp.)32 b(Change)16 b(to)g(the)g(new)h(xkern.local)f(directory)m(.)
114 1839 y(Copy)11 b(or)g(create)h(your)e(graph.comp)h(here.)17
b(T)m(o)11 b(compose)g(this)f(graph.comp)h(run:)214 1945 y
Fb(compose)23 b(-f)g(<)h(graph.comp)114 2051 y Fr(This)10 b(must)i(be)f
(explicitly)f(done)h(each)h(time)g(the)f(graph.comp)h(changes.)17
b(The)12 b(\256les)g(traceLevels.c,)g(protocols.c,)114 2108
y(protocols.h)k(and)h(protTbl.c)f(will)h(be)g(created.)36 b(The)18
b(\256les)f(that)g(were)h(created)g(here)g(are)g(referenced)g(by)f(the)114
2164 y(`conf/\256les')10 b(\256le)i(for)f(inclusion)e(in)i(the)g(mach)h
(kernel.)57 2258 y(4.)23 b(In)11 b(your)f(xkern.local)g(directory)m(,)h
(build)e(a)i(compilable)f(version)g(of)h(the)g(protocol)e(table)h(by)h
(running)e(the)i Fq(x)p Fr(-kernel)114 2314 y(utility)e(program)i(ptbldump:)
214 2421 y Fb(ptbldump)22 b(/usr/xkernel/etc/prottbl)f(>)j(ptblData.c)114
2527 y Fr(This)10 b(\256le)h(will)f(be)i(automatically)d(included)h(by)h(an)g
Fq(x)p Fr(-kernel)h(source)f(\256le.)57 2621 y(5.)23 b(In)11
b(your)g(xkern.local)f(directory)m(,)h(create)h(a)f(compilable)g(rom)g
(\256le)h(by)f(running)e(the)i(genrom.awk)h(script:)952 2753
y(82)p eop
%%Page: 83 83
82 bop 214 124 a Fb(awk)23 b(-f)h(/usr/x32/merge/bin/genro)o(m.awk)d(<)i(rom)
h(>)f(initRom.c)114 231 y Fr(This)10 b(\256le)h(will)f(be)i(automatically)d
(included)h(by)h(an)g Fq(x)p Fr(-kernel)h(source)f(\256le.)57
324 y(6.)23 b(Build)7 b(a)i(con\256guration)f(including)e(the)j
Fq(x)p Fr(-kernel.)16 b(If)9 b(your)f(con\256guration)f(includes)g(the)i
(string)e Fb(+xk)p Fr(,)i(the)g Fq(x)p Fr(-kernel)114 381 y(will)h(be)j
(built)d(in)h(DEBUG)h(con\256guration)f(\(with)g(tracing)g(enabled.\))19
b(If)12 b(the)g(con\256guration)e(includes)h(the)g(string)114
437 y Fb(+xko)p Fr(,)g(the)g Fq(x)p Fr(-kernel)g(will)f(be)i(built)d(in)i
(OPTIMIZE)h(con\256guration)d(\(with)i(no)f(tracing.\))57 531
y(7.)23 b(If)12 b(you)g(have)h(problems)e(with)h(kernels)g(crashing)f
(because)i(of)f(storage)g(exhaustion,)f(you)h(might)g(want)f(to)h(adjust)114
588 y(the)g(zone)i(block)e(table)h(in)f(the)h(Mach)h(kernel)f(\256le)g
(kalloc.c.)22 b(See)14 b(the)f Fq(x)p Fr(-kernel)h(\256le)f(xkernel/pi/msg)p
1766 588 14 2 v 14 w(internal.h)114 644 y(for)e(the)g(size)g(of)g(a)h
(message)f(block;)f(these)h(account)g(for)g(most)g(of)g(the)g
Fq(x)p Fr(-kernel)g(storage)g(use.)57 738 y(8.)23 b(The)15
b(machkernel)g(will)f(come)h(up)g(by)g(default)f(with)g(both)g(the)h(Unix)f
(server)h(and)g(the)g Fq(x)p Fr(-kernel)g(receiving)f(and)114
794 y(sending)c(network)g(packets)h(\(incoming)f(packets)h(are)h(copied)f(to)
g(both)f(the)h Fq(x)p Fr(-kernel)h(and)f(the)g(Unix)g(server)m(.\))18
b(For)114 851 y(accurate)10 b(kernel-kernel)g(timings)f(of)h
Fq(x)p Fr(-kernel)h(protocols,)e(boot)g(the)h(mach)p 1332 851
V 17 w(kernel)g(image)h(\(which)e(doesn')o(t)h(start)114 907
y(the)e(user)g(task\))g(instead)f(of)h(the)g(mach.boot)h(image)f(and)g
(con\256gure)h(the)f(in-kernel)f(driver)h(\(xklance\))g(to)g(not)g(deliver)
114 964 y(incoming)i(packets)g(to)h(the)g(user)g(task)g(as)g(described)f(in)h
(Appendix)f(A.)952 2753 y(83)p eop
%%Page: 84 84
83 bop 0 124 a Fn(A)60 b(Pr)o(otocol)13 b(Speci\256cations)0
228 y Fr(This)g(appendix)g(describes)g(each)i(of)f(the)f(protocols)g
(currently)g(implemented)g(in)h(the)g Fq(x)p Fr(-kernel.)25
b(The)14 b(description)e(for)0 284 y(each)g(protocol)d(provides)h(the)h
(following)e(information.)0 408 y Fl(NAME)0 495 y Fr(Name)16
b(of)f(the)g(protocol.)27 b(This)14 b(name,)j(given)d(in)h(all)f(lower)o
(-case)h(letters,)h(can)f(be)h(given)e(as)h(an)g(ar)o(gument)g(to)g
Fg(xGet-)0 552 y(ProtlByName)e Fr(to)f(get)g(a)g(capability)f(for)h(the)g
(protocol.)18 b(Note)11 b(that)h(there)g(are)h(multiple)e(implementations)f
(of)i(various)0 608 y(protocols;)d(i.e.,)j(a)f(given)g(name)g(might)f(map)i
(to)e(multiple)g(implementations.)15 b(The)10 b(implementation)g(bound)g(to)g
(a)i(name)0 665 y(in)f(a)g(given)g(kernel)g(is)f(set)h(in)g
Fb(graph.comp)p Fr(.)0 789 y Fl(SPECIFICA)l(TION)0 876 y Fr(Reference)g(to)f
(a)g(document)g(that)f(gives)g(the)h(speci\256cation)f(for)h(the)g(protocol.)
15 b(In)10 b(cases)g(where)g(no)g(formal)g(speci\256cation)0
932 y(exists,)g(this)g(section)g(gives)h(a)g(high-level)f(description)f(of)j
(the)e(protocol.)0 1057 y Fl(SYNOPSIS)0 1144 y Fr(A)f(brief)g(description)e
(of)i(what)f(the)h(protocol)e(does.)16 b(Outlines)7 b(any)i(unusual)e
(features)i(and)g(bugs,)g(including)d(any)j(features)0 1200
y(of)i(the)g(protocol)f(speci\256cation)g(not)h(implemented.)0
1324 y Fl(REALM)0 1411 y Fr(Indicates)i(whether)g(the)g(protocol)f(is)h(in)g
(the)g(ASYNC)g(realm)h(\(supporting)d(push,)j(demux)f(and)g(pop\),)h(the)f
(RPC)i(realm)0 1468 y(\(supporting)9 b(call,)j(calldemux)f(and)h(callpop\),)f
(the)g(CONTROL)h(realm)g(\(existing)e(only)h(to)g(allow)g(control)f
(operations\),)0 1524 y(or)h(the)g(ANCHOR)g(realm)h(\(interfacing)f(with)f
(the)h(host)f(system.\))0 1649 y Fl(P)l(AR)n(TICIP)l(ANTS)0
1736 y Fr(A)16 b(discussion)d(of)i(the)h(number)f(of)h(participants)e(the)h
(protocol)f(expects)h(to)g(see)h(and)f(what)g(it)g(expects)g(to)h(see)f(on)g
(the)0 1792 y(participants')10 b(stacks.)0 1916 y Fl(CONTROL)i(OPERA)l(TIONS)
0 2003 y Fr(Non-standard)d(control)g(operations)g(supported)g(by)g(the)h
(protocol.)15 b(For)c(each)g(control)e(operation,)h(the)g(type)f(of)i(the)f
(input)0 2060 y(and)j(output)f(ar)o(gument)h(is)g(given)f(\(i.e.,)j(the)e
(type)g(used)g(to)g(interpret)f(the)h(buf)o(fer)h(ar)o(gument\))f(and)g
(whether)g(the)g(control)0 2116 y(operation)c(is)g(understood)g(by)g
Fb(x)p 517 2116 15 2 v 17 w(controlsessn)g Fr(or)h Fb(controlprotl)e
Fr(\(or)i(both\))g(is)f(speci\256ed.)16 b(In)10 b(the)g(case)g(of)g(control)0
2173 y(operations)h(that)i(take)f(multiple)g(ar)o(guments,)h(we)g(give)f(a)i
(set)e(of)h(types.)21 b(Non-primitive)11 b(types)h(are)h(generally)f
(de\256ned)0 2229 y(in)f(the)g(protocol')m(s)f Fb(.h)h Fr(\256le.)0
2354 y Fl(EXTERNAL)i(INTERF)l(ACE)0 2441 y Fr(Interfaces)f(not)e
(encapsulated)g(within)g Fq(x)p Fr(-kernel)h(operations)952
2753 y(84)p eop
%%Page: 85 85
84 bop 0 124 a Fl(CONFIGURA)l(TION)0 211 y Fr(A)8 b(description)e(of)i
(con\256guration)e(options)g(for)i(the)f(protocol,)h(including)e
(descriptions)f(of)j(of)g(what)g(this)e(protocol)h(expects)0
268 y(of)14 b(the)f(protocols)f(below)h(it.)23 b(If)14 b(the)f(protocol)f
(can)i(only)e(be)i(con\256gured)f(above)g(a)h(certain)g(protocol,)f(the)g
(appropriate)0 324 y(graph.comp)e(line)g(is)f(given)h(explicitly)m(.)0
448 y Fl(AUTHORS)0 535 y Fr(Who)g(to)f(complain)h(to)g(if)g(the)g(protocol)f
(fails)g(to)h(work)g(as)g(advertized.)952 2753 y(85)p eop
%%Page: 86 86
85 bop 0 124 a Fl(NAME)0 211 y Fr(ARP)12 b(\(Address)e(Resolution)g
(Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(D.)17 b(Plummer)m(.)34
b Fq(An)16 b(Ethernet)f(Addr)n(ess)h(Resolution)e(Pr)n(otocol)p
Fr(.)31 b(Request)17 b(for)f(Comments)h(826,)h(USC)f(Information)0
479 y(Sciences)11 b(Institute,)f(Marina)i(del)f(Ray)m(,)h(Calif.,)g(Nov)m(.)k
(1982.)0 603 y Fl(SYNOPSIS)0 690 y Fr(ARP)f(translates)e(IP)i(addresses)e
(into)g(ethernet)h(addresses,)h(and)e(vice)i(versa)f(\(i.e.,)i(it)e(also)f
(implements)h(RARP\).)h(This)0 747 y(implementation)h(of)h(ARP)g(supports)e
(a)j(single)d(interface,)k(but)e(may)g(be)g(multiply)e(instantiated)g(to)i
(support)e(several)0 803 y(network)10 b(interfaces.)0 928 y
Fl(REALM)0 1015 y Fr(ARP)i(is)f(in)g(the)g(CONTROL)g(realm.)18
b(There)12 b(are)g(no)f(ARP)h(sessions)d(\261)j(control)e(operations)g(may)i
(be)f(performed)h(on)f(the)0 1071 y(protocol)f(object)g(only)m(.)0
1195 y Fl(CONTROL)i(OPERA)l(TIONS)0 1282 y Fb(RESOLVE:)22 b
Fr(Maps)11 b(an)g(IP)h(address)f(into)f(an)h(ethernet)g(address.)114
1376 y(Input:)21 b Fb(IPhost)114 1449 y Fr(Output:)f Fb(ETHhost)0
1543 y(RRESOLVE:)h Fr(Maps)12 b(an)f(ethernet)g(address)g(into)f(an)h(IP)h
(address.)114 1637 y(Input:)21 b Fb(ETHhost)114 1710 y Fr(Output:)f
Fb(IPhost)0 1804 y(ARP)p 75 1804 15 2 v 17 w(INSTALL:)h Fr(Installs)10
b(an)h(IP)h(address)f(to)g(ETH)f(address)h(binding.)114 1897
y(Input:)21 b(ArpBinding)9 b(==)i Fi(f)p Fb(ETHhost)23 b(eth;)g(IPhost)g(ip;)
p Fi(g)114 1971 y Fr(Output:)d(none)0 2064 y Fb(ARP)p 75 2064
V 17 w(GETMYBINDING:)h Fr(Return)11 b(the)g(IP)g(and)g(ETH)g(address)g(of)g
(the)g(local)g(host)f(for)h(the)g(interface.)114 2158 y(Input:)21
b(none)114 2231 y(Output:)f(ArpBinding)10 b(==)g Fi(f)p Fb(ETHhost)23
b(eth;)g(IPhost)g(ip;)p Fi(g)0 2325 y Fb(ARP)p 75 2325 V 17
w(FOREACH:)e Fr(This)d(is)h(a)g(kludge)f(to)h(allow)f(non-broadcast)g(device)
g(drivers,)j(such)e(as)g(SIMETH,)g(to)g(simulate)114 2381 y(broadcast)14
b(without)f(having)i(to)f(keep)h(their)g(own)g(tables)f(of)h(reachable)h
(hosts.)27 b(When)15 b(the)g(ARP)p 1724 2381 14 2 v 17 w(FOREACH)114
2438 y(control)e(operation)g(is)g(invoked,)h(ARP)g(will)f(call-back)h(the)g
(invoking)e(protocol)h(once)h(for)g(each)g(binding)e(in)i(its)114
2494 y(table.)114 2588 y(Input:)21 b(ArpForEach)11 b(==)g Fi(f)23
b Fb(void)h(*arg;)f(ArpForEachFunc)f(f;)h Fi(g)952 2753 y Fr(86)p
eop
%%Page: 87 87
86 bop 114 124 a Fr(Output:)20 b(none)114 218 y Fk(t)o(yp)q(edef)14
b(in)o(t)d Fr(\()p Fj(ArpF)-5 b(orEac)n(hF)g(unc)p Fr(\))14
b(\()d Fk(ArpBinding)h Fr(*,)f Fk(v)o(oid)g Fr(*)g(\);)0 312
y Fb(ETH)p 75 312 15 2 v 17 w(REGISTER)p 284 312 V 16 w(ARP:)22
b Fr(ARP)12 b(invokes)f(this)g(control)f(operation)h(on)h(its)f(lower)g
(protocol)g(at)g(initialization)e(time)j(so)f(the)114 368 y(driver)g(knows)f
(which)g(protocol)g(to)h(use)g(if)g(it)f(has)h(to)g(invoke)f(an)h(ARP)p
1242 368 14 2 v 17 w(FOREACH.)h(This)e(is)h(not)f(pretty)m(.)114
462 y(Input:)21 b Fb(XObj)114 535 y Fr(Output:)f(none)0 660
y Fl(CONFIGURA)l(TION)0 747 y Fb(name=arp)j(protocols=eth;)0
871 y Fl(AUTHORS)0 958 y Fr(Larry)11 b(Peterson)g(and)g(Norm)h(Hutchinson)952
2753 y(87)p eop
%%Page: 88 88
87 bop 0 124 a Fl(NAME)0 211 y Fr(BID)12 b(\(Boot)f(ID)g(Protocol\))0
336 y Fl(SPECIFICA)l(TION)71 423 y Fr(BID)d(is)g(the)g(\256ltering)f(modu)o
(le)h(o)o(f)g(th)o(e)g(BootId)f(prot)o(ocol.)12 b(The)c(BootId)g(protocol)f
(is)g(desi)o(gned)g(to)g(advi)o(se)h(wo)o(rkst)o(ation)o(s)0
479 y(that)18 b(a)g(peer)h(has)f(rebooted,)h(to)f(protect)g(protocols)f(from)
h(receiving)g(messages)g(generated)g(during)f(previous)g(boot)0
535 y(incarnations,)10 b(and)h(to)g(inform)g(higher)f(protocols)g(of)h(a)h
(peer)r(')m(s)f(reboot)g(in)f(a)i(timely)e(fashion.)71 592
y(If)j(an)h(upper)f(protocol)f(registers)g(with)h(BIDCTL)g(protocol)f(and)i
(messages)f(from)h(its)e(session)g(pass)h(through)f(BID)0 648
y(sessions,)h(the)g(BootId)g(protocol)f(guarantees)h(that)g(a)h(message)g
(from)g(a)f(rebooted)g(peer)h(will)f(not)f(be)i(sent)f(to)g(an)h(upper)0
705 y(protocol)c(until)g(the)g(upper)h(protocol)f(has)h(been)g(informed)g(of)
h(the)e(reboot.)0 829 y Fl(SYNOPSIS)0 916 y Fr(BID)19 b(sessions)e(stamp)h
(all)h(outgoing)d(messages)j(with)e(a)i(local)f(and)h(remote)g(BootId)f(and)g
(\256lter)h(out)f(all)g(incoming)0 973 y(messages)d(which)g(do)g(not)g(have)g
(the)g(correct)h(BootIds.)28 b(Determination)14 b(of)i(the)f(\252correct\272)
h(BootId)f(is)f(made)i(by)f(the)0 1029 y(BIDCTL)c(protocol.)16
b(BID)11 b(requires)g(BIDCTL.)71 1085 y(BID)e(is)f(not)g(reliable.)15
b(If)9 b(there)f(is)h(confusion)e(between)h(two)g(peers)g(as)h(to)f(what)g
(their)g(mutual)g(BootIds)g(are,)i(messages)0 1142 y(between)h(them)g(will)f
(be)h(silently)f(dropped)g(until)g(the)h(confusion)e(is)i(resolved.)0
1266 y Fl(REALM)0 1353 y Fr(BID)h(is)e(in)h(the)g(ASYNC)g(realm.)0
1478 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1565 y Fr(BID)g(expects)f(an)h(IPhost)f(on)
g(the)h(top)e(of)i(each)g(participant.)k(It)c(examines)f(this)g(value)g(but)g
(does)g(not)g(remove)h(it)f(form)h(the)0 1621 y(participant)f(stack)h(before)
g(opening)f(its)g(transport)g(protocol.)0 1745 y Fl(CONFIGURA)l(TION)0
1832 y Fr(BID)j(expects)f(to)f(be)i(con\256gured)f(above)g(two)f(protocols.)
19 b(The)12 b(\256rst)g(is)g(the)g(transport)f(protocol)g(and)h(the)g(second)
g(is)f(the)0 1889 y(BIDCTL)g(protocol.)0 2013 y Fl(AUTHOR)0
2100 y Fr(Ed)g(Menze)952 2753 y(88)p eop
%%Page: 89 89
88 bop 0 124 a Fl(NAME)0 211 y Fr(BIDCTL)11 b(\(Bootid)g(Control)f
(Protocol\))0 335 y Fl(SPECIFICA)l(TION)0 422 y Fr(BIDCTL)e(is)g(the)g
(control)f(modu)o(le)h(of)f(the)g(BootId)g(prot)o(ocol.)12
b(The)c(BootId)g(protocol)f(is)g(desi)o(gned)g(to)g(advi)o(se)h(wo)o(rkst)o
(ation)o(s)0 478 y(that)18 b(a)g(peer)h(has)f(rebooted,)h(to)f(protect)g
(protocols)f(from)h(receiving)g(messages)g(generated)g(during)f(previous)g
(boot)0 535 y(incarnations,)10 b(and)h(to)g(inform)g(higher)f(protocols)g(of)
h(a)h(peer)r(')m(s)f(reboot)g(in)f(a)i(timely)e(fashion.)71
591 y(If)j(an)h(upper)f(protocol)f(registers)g(with)h(BIDCTL)g(protocol)f
(and)i(messages)f(from)h(its)e(session)g(pass)h(through)f(BID)0
647 y(sessions,)h(the)g(BootId)g(protocol)f(guarantees)h(that)g(a)h(message)g
(from)g(a)f(rebooted)g(peer)h(will)f(not)f(be)i(sent)f(to)g(an)h(upper)0
704 y(protocol)c(until)g(the)g(upper)h(protocol)f(has)h(been)g(informed)g(of)
h(the)e(reboot.)0 827 y Fl(SYNOPSIS)0 914 y Fr(Upper)i(protocols)f(register)g
(their)h(desire)g(to)g(be)g(informed)g(of)g(a)h(peer)r(')m(s)g(reboot)e(by)h
(openEnabling)e(BIDCTL)j(with)e(that)0 971 y(remote)g(peer)r(')m(s)g(IPhost.)
16 b(When)10 b(BIDCTL)h(determines)f(that)g(the)g(remote)h(peer)g(has)f
(rebooted,)g(it)g(informs)g(all)g(interested)0 1027 y(upper)i(protocols)e
(via)i(a)g(control)f(operation)f(\(see)j(below)m(.\))18 b(If)12
b(an)g(upper)g(protocol)f(is)g(no)h(longer)f(interested)g(in)g(learning)0
1084 y(about)f(a)i(peer)r(')m(s)f(reboot,)g(it)g(may)h(openDisable)d(BIDCTL.)
0 1207 y Fl(REALM)0 1294 y Fr(BIDCTL)i(is)g(in)g(the)g(CONTROL)g(realm.)17
b(There)11 b(are)h(no)f(BIDCTL)h(sessions.)0 1417 y Fl(P)l(AR)n(TICIP)l(ANTS)
0 1504 y Fr(BIDCTL)f(openEnable)f(and)h(openDisable)f(expect)h(a)h(single)e
(participant)f(containing)h(the)g(IPhost)h(of)g(the)g(remote)h(peer)m(.)0
1628 y Fl(CONTROL)g(OPERA)l(TIONS)0 1715 y Fb(BIDCTL)p 147
1715 15 2 v 16 w(PEER)p 259 1715 V 17 w(REBOOTED:)21 b Fr(Invoked)14
b Fq(by)g Fr(BIDCTL)g(on)f(registered)h(upper)f(protocols)g(to)g(inform)h
(them)g(that)f(a)i(peer)114 1771 y(has)8 b(rebooted.)15 b(The)8
b Fq(id)g Fr(\256eld)g(of)h(the)f(BidctlBootMsg)f(contains)g(the)h(new)g
(remote)h(BootId.)15 b(The)8 b(upper)g(protocol')m(s)114 1828
y(control)i(function)g(should)f(not)i(block)f(while)g(handling)g(this)g
(noti\256cation.)114 1930 y(Input:)21 b Fb(BidctlBootMsg)h(==)i
Fi(f)f Fb(IPhost)g(h;)h(BootId)f(id;)g Fi(g)114 2002 y Fr(Output:)d(none)71
2104 y(The)8 b(remaining)g(control)g(operations)f(are)j(not)e(necessary)g
(for)h(most)g(users)f(of)h(BIDCTL.)g(They)f(are)i(provided)d(mostly)0
2161 y(for)k(the)g(use)g(of)g(\256ltering)g(protocols)e(\(e.g.,)k(BID\))f
(which)e(work)h(in)g(conjunction)e(with)h(BIDCTL.)0 2260 y
Fb(BIDCTL)p 147 2260 V 16 w(FIRST)p 283 2260 V 17 w(CONTACT:)21
b Fr(Invoked)9 b Fq(by)h Fr(BIDCTL)g(on)g(registered)f(upper)g(protocols)f
(to)i(inform)f(them)h(that)f(an)h(initial)114 2317 y(bootid)i(for)i(the)f
(given)g(peer)i(has)e(been)h(discovered.)24 b(The)13 b Fq(id)h
Fr(\256eld)f(of)h(the)g(BidctlBootMsg)e(contains)h(the)g(new)114
2373 y(remote)e(BootId.)114 2465 y(Input:)21 b Fb(BidctlBootMsg)114
2537 y Fr(Output:)f(none)0 2629 y Fb(BIDCTL)p 147 2629 V 16
w(GET)p 235 2629 V 17 w(LOCAL)p 372 2629 V 17 w(BID:)i Fr(Returns)11
b(the)f(current)i(BootId)e(of)h(the)g(local)g(host.)952 2753
y(89)p eop
%%Page: 90 90
89 bop 114 124 a Fr(Input:)21 b(none)114 197 y(Output:)f Fb(BootId)0
291 y(BIDCTL)p 147 291 15 2 v 16 w(GET)p 235 291 V 17 w(PEER)p
348 291 V 17 w(BID:)i Fr(Returns)12 b(the)g(last)g(con\256rmed)h(BootId)f(of)
g(the)g(given)g(remote)g(host.)20 b(If)13 b(the)f Fq(id)g Fr(\256eld)g(of)g
(the)114 348 y(input)i(structure)g(is)h(non-zero,)i(it)e(indicates)f(a)i
(possible)d(new)i(value.)29 b(If)16 b(this)e(value)h(dif)o(fers)h(from)g
(BIDCTL)l(')m(s)114 404 y(con\256rmed)10 b(value)f(for)h(that)e(peer)n(,)j
(BIDCTL)f(will)f(start)g(a)h(handshake)e(with)h(the)g(remote)h(peer)g(to)f
(determine)g(a)h(new)114 460 y(con\256rmed)k(value.)25 b(The)14
b(input)f(id)h(can)g(be)g(used)g(by)g(a)g(\256ltering)f(protocol)g(to)h
(indicate)f(that)g(it)h(has)g(seen)g(a)g(new)114 517 y(remote)d(BootId)g
(value.)114 592 y(The)k(BootId)h(of)f(the)h(output)e(structure)h(will)g(be)h
(0)f(\(an)h(invalid)f(BootId\))g(if)h(BIDCTL)g(doesn')o(t)f(yet)g(know)g(the)
114 649 y(peer)r(')m(s)c(BootId.)114 742 y(Input:)21 b Fb(BidctlBootMsg)114
815 y Fr(Output:)f Fb(BidctlBootMsg)0 909 y(BIDCTL)p 147 909
V 16 w(GET)p 235 909 V 17 w(PEER)p 348 909 V 17 w(BID)p 437
909 V 17 w(BLOCKING:)h Fr(Dif)o(fers)d(from)h Fb(BIDCTL)p 1088
909 V 16 w(GET)p 1176 909 V 17 w(PEER)p 1289 909 V 16 w(BID)f
Fr(in)g(that)f(the)h(calling)f(thread)g(will)114 966 y(block)d(if)g(BIDCTL)h
(has)g(not)f(yet)h(learned)f(the)h(peer)r(')m(s)g(BootId)f(or)h(if)g(the)f
(suggested)f Fq(id)i Fr(\256eld)g(is)f(non-zero)g(and)114 1022
y(dif)o(fers)9 b(from)h(the)g(protocol')m(s)e(current)i(value)f(for)h(the)g
(peer)g(BootId.)15 b(If)10 b(the)g(operation)e(blocks,)h(it)g(will)g(not)g
(release)114 1079 y(the)i(calling)f(thread)h(until)e(the)i(peer)h(BootId)e
(has)h(been)h(con\256rmed.)17 b(There)11 b(is)g(no)g(timeout.)114
1185 y(Input:)21 b Fb(BidctlBootMsg)114 1258 y Fr(Output:)f
Fb(BidctlBootMsg)0 1382 y Fl(CONFIGURA)l(TION)0 1469 y Fr(BIDCTL)e(expects)f
(only)f(its)h(transport)f(protocol)g(below)h(it.)35 b(It)17
b(will)g(open)g(the)g(transport)f(protocol)g(with)h(a)g(single)0
1526 y(participant)10 b(consisting)e(of)k(the)f(remote)g(IP)h(host.)71
1582 y(BIDCTL)17 b(uses)f(an)h(internal)e(checksum)i(and)g(works)f(correctly)
g(in)g(the)h(presence)g(of)f(dropped)g(messages,)j(so)d(a)0
1639 y(reliable)11 b(transport)f(protocol)f(is)i(not)g(necessary)m(.)71
1695 y(As)f(an)g(optimization,)f(BIDCTL)i(can)f(perform)h(an)g(IP)g
(local-net)e(broadcast)h(to)g(inform)g(interested)f(peers)i(that)f(it)f(has)0
1751 y(rebooted.)16 b(A)11 b(rom)h(\256le)f(entry)g(of)g(the)g(form:)215
1845 y Fb(bidctl)23 b(bcast)0 1939 y Fr(will)10 b(cause)h(the)g(broadcast)g
(and)g(an)g(entry)g(of)g(the)g(form:)215 2033 y Fb(bidctl)23
b(nobcast)0 2127 y Fr(will)29 b(suppress)f(it.)72 b(W)n(ithout)29
b(a)h(rom)g(\256le)g(entry)m(,)35 b(BIDCTL)30 b(will)f(perform)h(the)g
(broadcast)f(unless)g(BID-)0 2183 y(CTL)p 89 2183 14 2 v 16
w(NO)p 171 2183 V 16 w(BOOT)p 311 2183 V 16 w(BCAST)12 b(is)f(de\256ned)g
(during)f(compilation.)0 2308 y Fl(AUTHOR)0 2395 y Fr(Ed)h(Menze)952
2753 y(90)p eop
%%Page: 91 91
90 bop 0 124 a Fl(NAME)0 211 y Fr(BIND)11 b(\()h(A)f(Layered)g(Encryption)f
(Key)h(Manager)h(\))0 336 y Fl(DISTRIBUTION)i(NOTE)0 423 y
Fq(This)c(pr)n(otocol)g(will)g(not)h(be)g(distributed)d(via)i(anonymous)g
(ftp.)15 b(If)c(inter)n(ested,)f(contact)g(xkernel-bugs@cs.arizona.edu)0
479 y(about)g(obtaining)f(this)h(pr)n(otocol.)0 603 y Fl(SPECIFICA)l(TION)0
690 y Fr(BIND)h(sits)f(on)h(top)f(of)h(an)g(instance)f(of)h(the)f(KM)i
(protocol)d(and)i(maps)g(a)h(participant)d(to)i(a)g(id)f(which)h(is)f(then)g
(used)h(by)f(the)0 747 y(KM)i(to)e(provide)h(a)g(key)m(.)0
871 y Fl(SYNOPSIS)0 958 y Fr(As)k(we)g(have)h(discovered)e(in)h(decomposing)f
(Kerberos,)i(any)f(binding)e(between)i(network)g(addresses)f(and)h(keys)g
(can)0 1015 y(be)g(very)g(transient.)28 b(The)15 b(BIND)h(protocol)d(was)j
(designed)e(to)g(be)i(inserted)e(between)h(CR)m(YPT)h(and)f(KM)h(to)f(manage)
0 1071 y(temporary)e(bindings.)20 b(Thus)12 b(the)h(KM)h(data)f(base)g(will)f
(contain)g(name)h(to)g(key)g(bindings)e(while)h(the)h(BIND)g(data)g(base)0
1127 y(will)g(contain)g(address)g(to)g(name)i(bindings.)22
b(CR)m(YPT)15 b(will)e(open)g(a)i(BIND)f(session)e(just)h(as)h(it)f(would)g
(a)h(KM)g(session.)0 1184 y(When)d(the)f(address)h(to)f(name)h(mapping)g(is)f
(set)g(\(through)g(calling)g(a)h(KM)p 1172 1184 14 2 v 17 w(SET)f(or)h(BIND)p
1440 1184 V 17 w(SET)g(control)f(op\))g(BIND)h(will)0 1240
y(open)k(a)h(KM)g(session)e(using)g(the)i(name)g(as)f(its)g(participant.)29
b(When)15 b(CR)m(YPT)i(performs)e(a)h(KM)p 1599 1240 V 17 w(RESLOVE)f(on)g
(the)0 1297 y(BIND)c(session)f(it)h(in)f(turns)h(perform)h(a)f(KM)p
716 1297 V 17 w(RESLOVE)g(on)f(the)h(corresponding)f(KM)h(session.)71
1353 y(In)17 b(this)f(or)o(ganization)f(the)i(KM)h(data)f(base)g(is)g(fairly)
f(stable)h(and)g(managed)g(via)g(a)h(separate)f(key)g(management)0
1410 y(protocol)h(suite.)40 b(The)19 b(address)g(name)h(bindings)d(are)k(set)
e(by)g(performing)g(a)g(CR)m(YPT)p 1469 1410 V 18 w(IN\(or)g(OUT\))p
1716 1410 V 16 w(SET)g(on)g(the)0 1466 y(appropriate)12 b(session)f(with)h
(the)h(name)g(which)f(corresponds)g(to)g(this)g(session.)20
b(Note)13 b(names)g(in)f(this)g(version)g(are)h(\256xed)0 1523
y(length)d(byte)h(strings.)71 1579 y(Note)h(that)g(a)h(KM)p
362 1579 V 17 w(RESLOVE)f(on)h(BIND)g(gets)f(you)g(a)h(key)g(from)g(the)f(KM)
i(data)e(base)h(while)f(a)h(KM)p 1716 1579 V 17 w(SET)f(takes)h(a)0
1636 y(name)f(not)e(DES)h(key)m(.)17 b(This)10 b(is)h(not)f(symmetric)i(and)f
(exists)e(only)i(to)f(support)g(Kerberos.)71 1692 y(Names)h(are)h(simply)e
(\256xed)h(length)f(byte)h(strings.)71 1748 y(The)k(keys)h(\256le)g(name)h
(is)e(formed)i(by)e(concatenating)g(the)h(strings)e(\252bindings\272)g(with)h
(the)h(instance)f(name)h(of)g(the)0 1805 y(protocol)10 b(\(which)g(may)i(be)f
(null\).)0 1929 y Fl(REALM)0 2016 y Fr(BIND)g(is)g(in)g(the)g(ASYNC)g(realm.)
0 2140 y Fl(P)l(AR)n(TICIP)l(ANTS)0 2227 y Fr(BIND)e(accepts)g(participants)e
(in)h(order)h(to)f(do)h(a)g(table)f(lookup)f(to)i(\256nd)f(the)h(key)m(.)16
b(The)8 b(entire)h(participant)e(list)h(is)g(converted)0 2284
y(into)i(a)i(byte)e(string)g(which)h(is)f(then)h(used)g(to)f(lookup)g(the)h
(key)m(.)0 2408 y Fl(CONTROL)h(OPERA)l(TIONS)0 2495 y Fr(BIND)p
114 2495 V 16 w(RESOL)l(VE)18 b(returns)g(a)h(copy)e(of)i(the)f(name)h
(stored)e(in)h(that)g(session.)36 b(This)17 b(name)i(is)f(the)g(name)h(which)
f(is)0 2552 y(associated)10 b(with)g(the)h(participant)e(list)h(passed)g(at)h
(open)g(time.)16 b(BIND)c(can)f(fail)g(if)f(no)h(key)g(has)g(been)g(set)f(or)
h(that)g(key)f(has)0 2608 y(been)h(invalidated.)952 2753 y(91)p
eop
%%Page: 92 92
91 bop 71 124 a Fr(BIND)p 185 124 14 2 v 16 w(SET)11 b(sets)g(the)g(name)g
(for)h(that)e(session)g(to)h(the)g(value)g(passed.)71 181 y(BIND)p
185 181 V 16 w(INV)-6 b(ALIDA)h(TE)15 b(marks)g(the)h(name)g(as)f(invalid)f
(and)i(removes)g(the)f(BIND)h(session)e(from)i(the)f(map.)30
b(The)0 237 y(session)10 b(is)g(not)h(destroyed)f(until)g(all)g(users)h(of)g
(that)g(session)f(have)h(closed)f(it.)71 294 y(BIND)p 185 294
V 16 w(ISEMPTY)i(succeeds)f(if)g(no)g(name)h(for)f(this)f(session)g(has)h
(been)g(de\256ned.)71 350 y(BIND)p 185 350 V 16 w(ISV)-6 b(ALID)11
b(succeeds)g(if)g(there)h(is)e(a)i(valid)e(name)i(for)f(this)f(session.)71
407 y(BIND)p 185 407 V 16 w(ISINV)-6 b(ALID)11 b(succeeds)g(if)g(a)h(BIND)p
791 407 V 16 w(INV)-6 b(ALIDA)h(TE)10 b(operation)g(has)h(been)h(performed)f
(in)g(this)f(session.)71 463 y(BIND)h(also)g(supports)e(all)i(of)g(the)g(KM)h
(control)e(operations.)15 b(The)c(only)f(two)h(which)f(should)g(ever)h(be)h
(used)e(are:)71 519 y(KM)p 147 519 V 16 w(RESOL)l(VE)h(performs)g(a)h(KM)p
655 519 V 16 w(RESLOVE)f(on)g(the)g(corresponding)e(KM)i(session.)k(\(ie)d
(it)e(returns)h(a)g(DES)g(key)0 576 y(not)f(a)i(name\).)71
632 y(KM)p 147 632 V 16 w(SET)f(is)g(identical)f(to)h(BIND)p
623 632 V 16 w(SET)m(.)0 757 y Fl(CONFIGURA)l(TION)0 844 y
Fr(BIND)g(must)g(be)g(con\256gured)g(on)g(top)g(of)g(KM)g(and)g(any)g
(protocol)f(which)h(uses)f(KM)i(can)f(use)g(BIND.)0 968 y Fl(KEY)h(FILES)0
1055 y Fr(BIND)f(key)g(\256les)h(are)f(identical)f(to)h(KM)h(key)f(\256les.)0
1204 y Fl(AUTHOR)0 1291 y Fr(Sean)h(W)l(.)f(O'Malley)952 2753
y(92)p eop
%%Page: 93 93
92 bop 0 124 a Fl(NAME)0 211 y Fr(BLAST)11 b(\(RPC)i(Blast)e
(Micro-Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(S.)h(O'Malley)g(and)
f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fq(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479
y(10)p Fr(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 560 y(B.)i(W)l(elch.)21
b Fq(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fr(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 617 y(86/302,)d(June)h(1986.)0 741 y Fl(SYNOPSIS)0
828 y Fr(BLAST)h(is)f(a)h(micro-protocol)e(version)h(of)g(Sprite)h(RPC')m(s)h
(fragmentation)d(algorithm.)17 b(The)11 b(algorithm)g(was)g(extracted)0
885 y(from)i(Sprite)e(and)h(made)h(into)d(a)j(stand-alone)e(protocol.)17
b(BLAST)12 b(takes)g(a)g(lar)o(ge)g(message,)h(fragments)f(it)f(into)g
(smaller)0 941 y(packets,)k(and)f(sends)f(them.)25 b(The)14
b(maximum)h(packet)f(size)g(accepted)g(by)g(BLAST)g(\(as)g(returned)g(by)g
(the)f(GETMAX-)0 997 y(P)l(ACKET)8 b(control)g(op\))g(is)g(the)g(product)f
(of)i(the)f(maximum)h(number)f(of)h(fragments)f(handled)g(by)g(BLAST)g(\(16)h
(by)f(default\))0 1054 y(and)h(the)f(optimal)h(packet)f(size)h(of)g(BLAST')m
(s)h(lower)e(protocol.)15 b(Blast)8 b(is)h(tuned)f(for)h(the)g(local)f(area)i
(networks)e(and)h(should)0 1110 y(not)h(be)i(used)e(across)h(the)g(Internet.)
71 1167 y(The)g(receiver)h(gathers)f(all)h(of)f(the)h(packets)f(and)g(sends)g
(a)h(NACK)g(if)g(it)f(has)g(reason)h(to)f(believe)g(\(through)f(time-outs)0
1223 y(or)15 b(other)f(considerations\))f(that)h(a)h(packet)g(has)f(been)h
(dropped.)27 b(BLAST)15 b(can)g(handle)f(any)h(number)f(on)h(outstanding)0
1280 y(messages)i(between)g(two)g(hosts)f(\(buf)o(fer)i(space)f(permitting,)h
(of)f(course\).)35 b(The)17 b(protocol)f(is)h(bidirectional;)h(i.e.,)i(it)0
1336 y(supports)c(blasts)h(in)g(both)g(directions)f(over)i(the)g(same)g
(session.)35 b(Small)19 b(messages)e(take)h(a)g(short)f(cut)h(through)e(the)0
1393 y(protocol)10 b(and)h(do)g(not)f(require)h(the)g(allocation)f(of)h(any)g
(resources.)71 1449 y(The)16 b(sender)g(keeps)g(a)g(copy)g(of)g(the)g
(message)h(around)e(until)g(a)i(time-out)e(occurs)h(or)g(the)g(higher)g
(level)g(protocol)0 1506 y(that)d(sent)g(the)g(message)h(noti\256es)e(BLAST)i
(that)f(it)g(can)g(free)i(the)e(message)h(\(through)e(a)i(FREERESOURCES)g
(control)0 1562 y(op.\))k(Users)12 b(of)g(blast)f(are)h(strongly)f
(encouraged)g(to)h(free)g(messages)g(as)g(soon)f(as)h(possible.)17
b(The)11 b(sender)h(knows)f(which)0 1618 y(BLAST)h(\(BLAST)g(can)g(be)g
(instantiated)d(more)k(than)e(once\))h(and)f(which)g(message)h(to)g(free)g
(because)g(when)f(a)i(push)d(was)0 1675 y(performed)16 b(blast)e(writes)g
(into)g(a)h(message)g(attribute)f(attached)h(by)f(CHAN)h(\(or)h(some)f(other)
f(high)g(level)h(protocol\))f(a)0 1731 y(pointer)c(to)h(itself)f(and)h(a)h
(32)e(bit)h(integer)f(ticket)h(which)f(uniquely)g(identi\256es)g(the)h
(message.)71 1788 y(Because)20 b(the)f(sending)f(BLAST)h(may)h(time-out)f
(and)g(release)h(a)f(message)h(before)f(all)g(fragments)h(have)f(been)0
1844 y(received,)12 b(BLAST)f(is)g(not)f(reliable.)16 b(It)11
b(is,)g(however)n(,)h(very)f(persistent.)71 1901 y(BLAST)k(performance)h(is)f
(critically)f(dependent)h(upon)f(the)h(time-out)g(strategy)g(used)f(and)i
(the)f(initial)e(values)i(of)0 1957 y(those)10 b(timers.)16
b(As)10 b(mentioned)g(earlier)h(the)f(sender)h(uses)f(a)h(timer)g(to)f(free)i
(resources)e(after)h(a)g(set)f(interval)g(has)h(occurred.)0
2014 y(T)n(uning)f(this)h(timer)g(for)h(use)f(with)f(higher)h(level)g
(protocols)e(which)i(do)g(not)g(explicitly)e(free)j(resources)f(is)g(very)h
(dif)o(\256cult.)0 2070 y(For)g(applications)e(which)h(do)h(free)h(resources)
e(this)g(time-out)g(interval)g(has)h(no)g(ef)o(fect)g(on)g(performance)h
(unless)e(it)g(is)h(set)0 2127 y(to)h(too)g(small)g(a)g(value.)23
b(The)13 b(receiver)h(sets)f(a)h(timer)f(whenever)g(a)h(fragment)g(from)g(a)f
(new)h(packet)f(arrives.)23 b(The)13 b(only)0 2183 y(purpose)h(of)i(this)e
(timer)h(is)g(to)g(detect)g(the)g(drop)g(of)g(the)g(last)g(fragment.)29
b(This)14 b(timer)i(is)e(set)h(to)g(some)h(constant)e(times)0
2239 y(the)f(number)g(of)g(fragments)g(in)g(the)g(message.)22
b(If)14 b(this)e(timer)h(expires)g(to)f(early)h(this)f(is)h(detected)g(by)g
(the)f(code)i(and)e(the)0 2296 y(constant)d(is)g(increased)h(by)g(a)g(factor)
g(of)g(two.)16 b(After)10 b(a)g(NACK)g(is)f(set)h(to)g(the)f(round)h(trip)f
(time)h(plus)f(some)h(constant)e(times)0 2352 y(the)14 b(number)h(of)f
(fragments.)27 b(The)14 b(purpose)g(of)g(this)f(time)i(is)f(to)g(generate)g
(a)h(new)g(NACK)f(if)g(the)h(original)e(NACK)h(or)0 2409 y(retransmitted)c
(segments)h(are)h(lost.)0 2533 y Fl(REALM)0 2620 y Fr(BLAST)f(is)g(in)g(the)g
(ASYNC)g(realm.)952 2753 y(93)p eop
%%Page: 94 94
93 bop 0 124 a Fl(P)l(AR)n(TICIP)l(ANTS)0 211 y Fr(BLAST)11
b(neither)g(removes)g(nor)g(adds)g(anything)e(to)i(the)g(participant)f
(stacks.)0 336 y Fl(CONTROL)i(OPERA)l(TIONS)0 423 y Fb(FREERESOURCES:)21
b Fr(Free)16 b(the)e(storage)h(associated)f(with)g(the)g(message)h(handle)g
(passed)f(as)h(ar)o(gument.)28 b(The)15 b(handle)114 479 y(should)9
b(be)i(a)h(value)f(returned)g(by)f(xPush.)16 b(\(protocol)10
b(and)h(session\).)114 573 y(Input:)21 b Fb(xmsg)p 344 573
15 2 v 17 w(handle)p 505 573 V 16 w(t)114 646 y Fr(Output:)f(none)0
740 y Fb(CHAN)p 99 740 V 17 w(RETRANSMIT:)h Fr(This)7 b(is)g(CHAN')m(s)g(way)
g(of)g(asking)g(BLAST)g(if)g(it)g(shoul)o(d)g(go)g(ahead)g(and)g(retransmit)g
(t)o(he)g(message.)114 796 y(BLAST)14 b(returns)g(true)g(\(1\))h(if)f(and)h
(only)e(it)h(has)g(received)h(no)f(NACK')m(s)g(for)h(this)e(message)i(since)f
(the)g(message)114 853 y(was)e(sent)h(or)g(the)f(last)h(time)g(CHAN)p
706 853 14 2 v 16 w(RETRANSMIT)g(was)g(called.)22 b(The)12
b(idea)h(being)f(that)h(CHAN)g(should)e(not)114 909 y(retransmit)f(while)h
(BLAST)g(is)g(in)f(the)h(process)g(of)g(sending)f(the)h(message.)114
1003 y(Input:)21 b(none)114 1076 y(Output:)f Fb(0)k(or)g(1)0
1170 y(BLAST)p 123 1170 15 2 v 16 w(SETOUTSTANDINGMSGS:)d Fr(Set)11
b(the)g(number)g(of)g(outstanding)e(messages)i(allowed)f(\(protocol)g
(only\).)114 1264 y(Input:)21 b Fb(int)114 1337 y Fr(Output:)f(none)0
1430 y Fb(BLAST)p 123 1430 V 16 w(GETOUTSTANDINGMSGS:)h Fr(Get)11
b(the)g(number)g(of)g(outstanding)d(messages)k(allowed)e(\(protocol)g
(only\).)114 1524 y(Input:)21 b(none)114 1597 y(Output:)f Fb(int)0
1722 y Fl(CONFIGURA)l(TION)0 1809 y Fr(BLAST)14 b(requires)f(only)g(its)f
(lower)i(transport)e(protocol.)23 b(Since)13 b(BLAST)h(doesn')o(t)f(use)g
(host)g(addresses,)h(it)f(can)h(sit)f(on)0 1865 y(top)d(of)i(protocols)d
(using)h(dif)o(ferent)h(address)g(types)f(without)f(modi\256cation.)0
1989 y Fl(AUTHORS)0 2076 y Fr(Sean)j(O'Malley)f(and)g(Ed)g(Menze)952
2753 y(94)p eop
%%Page: 95 95
94 bop 0 124 a Fl(NAME)0 211 y Fr(CHAN)11 b(\(RPC)i(Channel)d
(Micro-Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(S.)i(O'Malley)g(and)
f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fq(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479
y(10)p Fr(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 560 y(B.)i(W)l(elch.)21
b Fq(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fr(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 617 y(86/302,)d(June)h(1986.)0 741 y Fl(SYNOPSIS)0
828 y Fr(CHAN)18 b(is)f(a)h(single)e(protocol)g(version)h(of)h(Sprite)f(RPC')
m(s)i(reliable)e(request-reply)g(channel.)35 b(The)18 b(algorithm)e(was)0
885 y(extracted)9 b(from)g(Sprite)g(and)g(made)h(into)e(a)h(stand-alone)f
(protocol.)15 b(Each)9 b(CHAN)g(session)e(supports)h(the)g(Birrell-Nelson)0
941 y(implicit)i(acking)g(RPC)j(algorithm)d(between)h(two)f(hosts.)71
997 y(CHAN)i(provides)f(\252at)h(most)g(once\272)h(RPC)g(semantics.)20
b(When)12 b(a)h(CHAN)f(call)g(returns)g(successfully)m(,)f(the)i(protocol)0
1054 y(guarantees)e(that)g(the)h(request)f(has)g(been)h(processed)f(exactly)g
(once)h(by)f(the)h(server)m(.)18 b(If)13 b(CHAN)e(returns)g(unsuccessfully)0
1110 y(\(XK)p 84 1110 14 2 v 16 w(F)m(AILURE\),)g(the)g(server)g(may)h(have)f
(processed)f(the)h(request)f(once,)i(or)f(it)f(may)i(not)e(have)h(seen)g(the)
g(request)f(at)h(all.)71 1167 y(Channel)k(numbers)g(are)h(entirely)e
(internal)h(to)g(the)g(CHAN)g(protocol.)28 b(When)15 b(a)h(new)f(client)g
(channel)g(session)f(is)0 1223 y(created,)20 b(a)e(new)g(host-host)e(channel)
h(number)h(is)f(selected)h(internally)e(by)i(CHAN.)g(When)f(protocols)f
(openEnable)0 1280 y(CHAN,)d(they)e(will)h(receive)h(connections)d(from)j
(any)f(channel)g(number)h(on)f(any)g(remote)g(host.)20 b(Each)12
b(open)g(of)g(CHAN)0 1336 y(by)f(a)g(client)g(session)e(will)h(result)h(in)g
(the)f(passive)h(creation)f(of)i(a)f(corresponding)f(session)f(on)i(the)g
(server)m(.)71 1393 y(Each)j(channel)g(session)g(will)f(accept)i(only)f(a)h
(single)e(outstanding)f(request.)26 b(Sending)14 b(additional)f(requests)h
(on)g(a)0 1449 y(channel)d(before)g(the)g(\256rst)g(request)g(has)g(returned)
g(is)f(not)h(allowed.)71 1506 y(CHAN)f(relies)h(on)f(the)h(BIDCTL)g(and)g
(BID)g(protocols)e(to)i(determine)f(when)h(a)g(peer)g(has)g(rebooted.)16
b(When)10 b(noti\256ed)0 1562 y(of)19 b(a)h(peer)r(')m(s)g(reboot,)h(CHAN)f
(will)e(disable)g(all)h(active)h(channels)e(to)h(that)g(host.)40
b(Outstanding)17 b(calls)i(will)f(return)0 1618 y(XK)p 69 1618
V 16 w(F)m(AILURE,)d(as)f(will)g(all)g(subsequent)e(calls)i(on)h(that)e
(channel)i(session.)25 b(Replies)14 b(sent)g(through)f(disabled)g(server)0
1675 y(channels)d(will)g(be)i(discarded.)71 1731 y(CHAN)g(must)h(know)f
(several)h(things)e(about)h(the)g(transport)g(protocol)g(used)g(to)g
(actually)g(send)h(the)f(message.)22 b(This)0 1788 y(information)10
b(is)h(represented)g(in)f(the)h(following)e(structure:)0 1894
y Fb(typedef)23 b(struct)g({)95 1951 y(XObj)h(transport;)95
2007 y(int)48 b(ticket;)95 2063 y(int)g(reliable;)95 2120 y(int)g(expensive;)
95 2176 y(unsigned)23 b(int)h(timeout;)0 2233 y(})g(chan_info_t;)71
2339 y Fr(This)10 b(structure)h(is)g(de\256ned)g(in)g(the)g(CHAN)h(session)e
(state)h(and)g(a)h(pointer)e(to)h(it)g(is)g(attached)g(as)h(an)g(attribute)e
(to)h(each)0 2396 y(outgoing)h(message.)26 b(Before)15 b(the)f(message)h(is)e
(send)h(CHAN)g(zero')m(s)h(out)f(all)g(\256elds)g(of)g(the)g(structure.)25
b(When)14 b(xPush)0 2452 y(returns)d(CHAN)g(assumes)g(that)f(some)h(lower)g
(level)g(protocol)f(may)i(have)f(\256lled)g(in)f(the)h(\256elds.)71
2508 y(If)h(transport)f(has)h(been)g(de\256ned)g(CHAN)g(will)f(perform)i(a)f
(FREERESOURCES)i(control)d(operation)g(on)g(transport)0 2565
y(when)e(the)g(current)g(message)h(has)f(been)h(acked.)16 b(If)10
b(the)f(lower)g(level)g(protocol)f(is)h(reliable)g(CHAN)g(will)f(never)i
(retransmit)0 2621 y(the)17 b(entire)h(message)g(and)f(will)g(not)g(start)g
(a)h(timer)m(.)37 b(If)18 b(the)g(lower)f(level)g(protocol)g(is)g(expensive)g
(CHAN)g(will)g(not)952 2753 y(95)p eop
%%Page: 96 96
95 bop 0 124 a Fr(retransmit)10 b(the)g(entire)g(message)h(when)f(it)g(times)
g(out.)16 b(It)10 b(simply)g(requests)f(an)i(ACK.)g(The)f(timeout)g(\256eld)g
(is)g(ignored)g(for)0 181 y(the)j(moment.)23 b(If)13 b(transport)f(has)h
(been)g(de\256ned)g(CHAN)h(will)e(invoke)g(a)h(CHAN)p 1319
181 14 2 v 16 w(RETRANSMIT)h(control)e(operation)0 237 y(on)j(it)f(before)h
(retransmitting.)26 b(If)16 b(this)d(control)h(operation)g(returns)h(0)f
(CHAN)h(will)f(not)g(retransmit)h(the)f(body)g(of)h(the)0 294
y(message.)24 b(This)13 b(allows)f(a)i(lower)g(level)f(protocol)f(like)h
(BLAST)h(to)f(discourage)g(CHAN)h(from)g(retransmitting)e(while)0
350 y(the)f(message)g(is)g(still)f(being)g(sent.)0 474 y Fl(REALM)0
561 y Fr(CHAN)f(lies)g(on)g(the)f(boundary)g(between)h(the)g(ASYNC)h(realm)g
(and)f(the)g(RPC)h(realm.)16 b(That)9 b(is,)h(it)e(looks)g(like)h(an)g(ASYNC)
0 618 y(protocol)h(to)h(protocols)e(below)i(it,)g(and)g(an)g(RPC)h(protocol)e
(to)h(protocols)e(above)i(it.)0 742 y Fl(CONTROL)h(OPERA)l(TIONS)0
829 y Fb(CHAN)p 99 829 15 2 v 17 w(ABORT)p 236 829 V 16 w(CALL:)22
b Fr(When)10 b(invoked)f(on)h(a)h(channel)f(session,)f(it)h(causes)h(the)f
(current)g(call)g(\(if)h(one)f(is)g(outstanding\))e(to)114
886 y(abort)i(and)h(return)g(XK)p 484 886 14 2 v 16 w(F)m(AILURE.)114
979 y(Input:)21 b Fb(none)114 1052 y Fr(Output:)f Fb(none)0
1177 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1264 y Fr(CHAN)14 b(neither)g(removes)g
(from)h(nor)f(adds)g(to)f(the)h(participant)f(stacks,)i(passing)e(the)g
(participants)g(untouched)g(to)g(the)0 1320 y(transport)d(protocol)g(on)h(an)
g(open)g(and)g(ignoring)e(the)i(participant)f(structure)g(on)h(an)g
(openenable.)0 1445 y Fl(CONFIGURA)l(TION)0 1532 y Fr(CHAN)h(requires)h(its)e
(lower)h(transport)g(protocol)f(con\256gured)h(as)g(the)h(\256rst)f(lower)g
(protocol)f(and)i(BIDCTL)g(con\256gured)0 1588 y(as)h(the)g(second)g(lower)f
(protocol.)25 b(CHAN)14 b(requires)f(that)h(it')m(s)g(transport)f(protocol)g
(will)g(deliver)g(incoming)g(messages)0 1644 y(from)e(dif)o(ferent)g(hosts)e
(through)g(dif)o(ferent)h(lower)g(sessions)f(and)i(that)e(all)i(CHAN)f
(messages)h(from)g(the)f(same)h(host)f(come)0 1701 y(from)i(the)f(same)g
(lower)g(session.)71 1757 y(CHAN)g(is)g(a)g(realm)h(boundary)f(protocol)f
(which)g(assumes)h(its)g(transport)f(protocol)g(is)g(symmetric)i(\(in)f(the)g
(ASYNC)0 1814 y(realm.\))71 1870 y(Because)i(CHAN)h(af)o(\256xes)f(a)h
(pointer)e(to)h(the)g(outgoing)e(message)i(it)g(must)g(be)g(in)g(the)g(same)h
(address)f(space)g(as)g(any)0 1927 y(transport)d(protocol)g(which)g(will)g
(attempt)h(to)g(set)g(the)g(structure)f(passed)h(in)f(the)h(attribute.)0
2051 y Fl(AUTHOR)0 2138 y Fr(Sean)h(O'Malley)952 2753 y(96)p
eop
%%Page: 97 97
96 bop 0 124 a Fl(NAME)0 211 y Fr(CR)m(YPT)12 b(and)f(TCR)m(YPT)h(\(DES)g
(Encryption)d(Protocols\))0 336 y Fl(DISTRIBUTION)14 b(NOTE)0
423 y Fq(This)c(pr)n(otocol)g(will)g(not)h(be)g(distributed)d(via)i
(anonymous)g(ftp.)15 b(If)c(inter)n(ested,)f(contact)g
(xkernel-bugs@cs.arizona.edu)0 479 y(about)g(obtaining)f(this)h(pr)n(otocol.)
0 603 y Fl(SPECIFICA)l(TION)0 690 y Fr(CR)m(YPT)j(encrypts)e(all)h(bytes)f
(of)h(all)g(packets)f(sent)h(using)f(the)g(DES)h(encryption)f(algorithm)g(in)
h(cipher)o(-block-chaining)0 747 y(mode.)25 b(CR)m(YPT)15 b(uses)e(the)g(key)
h(manager)h(protocol)d(\(KM,)j(page)f(107\))f(to)g(map)i(from)f(the)g(source)
f(address)g(passed)h(in)0 803 y(at)e(open)f(time)h(to)f(a)h(DES)g(key)m(.)18
b(Each)11 b(message)h(is)f(encrypted)g(independently)m(.)16
b(CR)m(YPT)d(is)e(designed)g(to)g(be)h(composed)0 860 y(over)j(any)g
(datagram)g(protocol,)h(and)e(it)h(accepts)g(arbitrary)g(address)g(types)f
(at)h(open)g(time.)28 b(CR)m(YPT)16 b(lengthens)e(each)0 916
y(packet)d(by)g(1)g(to)g(8)g(bytes,)f(to)h(the)g(next)g(lar)o(ger)g(multiple)
f(of)h(8)g(bytes.)71 973 y(TCR)m(YPT)g(is)g(the)f(same)h(as)g(CR)m(YPT)m(,)h
(except)f(that)f(packet)h(lengths)e(are)i(usually)f(unchanged.)15
b(However)n(,)c(TCR)m(YPT)0 1029 y(alters)d(packets)f(in)h(the)g(size)g
(range)g(1)g(to)g(7)g(bytes.)15 b(All)7 b(of)h(the)g(information)f(below)g
(for)i(CR)m(YPT)g(also)e(applies)h(to)f(TCR)m(YPT)m(,)0 1085
y(except)k(for)g(packet)g(sizes.)0 1210 y Fl(SYNOPSIS)0 1297
y Fr(When)g(a)h(CR)m(YPT)h(session)d(is)h(opened,)h(it)f(opens)f(the)i
(protocol)e(con\256gured)h(below)g(it)g(with)f(the)i(addresses)f(passed)g(to)
g(it)0 1353 y(during)g(open.)18 b(It)12 b(then)f(performs)h(a)h(GETP)l(AR)m
(TICP)l(ANTS)e(operation)g(on)h(the)f(newly)g(opened)h(session)e(to)i
(acquire)f(the)0 1410 y(fully)h(resolved)g(addresses)h(of)g(the)g
(participants.)20 b(The)13 b(set)g(of)g(participants)f(is)g(then)h(used)f(as)
i(the)e(ar)o(gument)i(to)e(open)h(a)0 1466 y(key)e(manager)h(\(KM\))g
(session.)71 1523 y(When)f(a)i(message)f(is)g(pushed)f(to)g(a)i(CR)m(YPT)g
(session)e(a)h(KM)p 1062 1523 14 2 v 17 w(RESOL)l(VE)f(operation)g(is)h(done)
f(on)h(the)g(opened)f(key)0 1579 y(manger)k(session)f(to)g(get)h(the)f
(current)h(local)f(key)m(.)28 b(Because)15 b(DES)g(operates)g(on)f(blocks)g
(of)h(8)g(bytes,)g(the)g(message)g(is)0 1636 y(zero-padded)g(to)f(the)h(next)
f(lar)o(ger)h(multiple)f(of)h(8)g(bytes;)g(the)g(last)f(byte)g(is)h(set)f(to)
h(the)f(number)h(of)g(pad)g(bytes)f(added.)0 1692 y(T)m(otal)d(padding)g(is)g
(at)h(least)g(1)f(and)h(at)g(most)g(8)g(bytes.)18 b(The)12
b(receiver)g(uses)g(KM)p 1274 1692 V 16 w(RRESOL)l(VE)g(to)g(ask)f(his)h(key)
g(manager)0 1748 y(for)f(the)f(remote)i(key)m(.)k(He)11 b(decrypts)f(the)g
(message)h(and)g(removes)f(the)h(padding.)k(If)c(the)g(pad)f(bytes)g(are)i
(not)e(0,)h(or)f(the)h(last)0 1805 y(byte)g(has)g(an)g(out-of-range)g(value)g
(for)h(the)f(amount)g(of)g(padding,)g(the)g(message)g(is)g(dropped.)16
b(Assuming)10 b(the)h(incoming)0 1861 y(length)g(is)g(a)h(multiple)f(of)g(8)h
(bytes,)f(the)h(probability)d(that)j(a)g(message)g(decrypted)f(with)g(a)h
(bad)f(key)h(will)f(pass)g(the)g(length)0 1918 y(and)g(pad)g(checks)g(is)g
(about)f(1/255.)71 1974 y(TCR)m(YPT)i(preserves)g(packet)g(lengths,)f(except)
g(those)g(in)h(range)g(of)f(1-7)h(bytes.)18 b(For)12 b(this)f(reason,)h(TCR)m
(YPT)h(is)e(not)0 2031 y(expected)d(to)h(be)g(used)f(below)g(protocols)f
(that)h(produce)h(very)f(short)g(messages.)16 b(The)8 b(\256rst)h(part)g(of)g
(the)f(packet)h(encryption)0 2087 y(algorithm)g(is)h(the)g(same)h(as)g(for)f
(CR)m(YPT)n(:)h(as)g(much)f(of)h(the)f(packet)g(as)g(possible)f(is)h
(encrypted)g(in)g(blocks)f(of)h(eight)g(bytes.)0 2144 y(If)g(there)f(are)h
(leftover)f(bytes)g(at)g(the)g(end)g(of)g(the)g(packet,)h(enough)f(\(already)
g(encrypted\))g(adjacent)g(bytes)f(from)i(the)f(packet)0 2200
y(are)15 b(used)f(to)h(make)g(up)f(a)h(complete)g(block)e(of)i(eight)f
(bytes,)h(which)f(is)g(encrypted.)26 b(Decryption)13 b(is)h(straightforward.)
0 2257 y(Because)c(the)g(map)g(is)f(length)g(preserving,)g(there)h(is)f(no)g
(possibility)e(of)i(decryption)g(failing)f(\(although)g(it)i(might)f(produce)
0 2313 y(garbage\).)20 b(CR)m(YPT)14 b(and)e(TCR)m(YPT)h(have)f(each)h(been)f
(tested)g(on)g(both)f(big-endian)g(and)h(little-endian)f(machines,)h(and)0
2369 y(between)f(machines)g(of)g(dif)o(ferent)g(endianness.)71
2426 y(CR)m(YPT)h(discards)e(the)g(attributes)g(attached)g(to)h(any)g
(outgoing)d(message.)17 b(This)10 b(is)h(done)f(to)h(minimize)f(out-of-band)0
2482 y(information)f(transmittal.)15 b(CR)m(YPT)c(does)f(not)f(touch)g(any)h
(attributes)f(attached)g(to)h(incoming)f(messages,)i(and)e(forwards)0
2539 y(them)i(along)g(with)f(the)h(decrypted)f(data)h(up)g(to)g(the)g(next)f
(protocol.)952 2753 y(97)p eop
%%Page: 98 98
97 bop 71 124 a Fr(On)11 b(outgoing)f(messages,)j(if)f(the)g(key)f(manager)i
(should)e(return)g(a)i(key)f(of)g(all)g(0s,)g(indicating)e(it)h(does)h(not)f
(have)h(the)0 181 y(real)f(key)m(,)h(the)f(message)g(is)g(dropped.)16
b(For)11 b(incoming)f(messages,)i(a)f(key)g(of)g(all)g(0s)g(is)g(allowed.)0
304 y Fl(REALM)0 391 y Fr(CR)m(YPT)h(is)f(in)g(the)g(ASYNC)g(realm.)0
514 y Fl(P)l(AR)n(TICIP)l(ANTS)0 601 y Fr(CR)m(YPT)16 b(passes)e
(participants)g(to)g(the)h(lower)f(protocols)g(without)f(manipulating)g
(them.)28 b(It)14 b(uses)h(the)f(participants)g(to)0 657 y(lookup)c(the)h
(keys)f(for)i(encryption)d(and)i(decryption.)0 781 y Fl(CONTROL)h(OPERA)l
(TIONS)0 868 y Fr(CR)m(YPT)18 b(supports)d(16)i(control)e(operations.)33
b(8)16 b(of)h(these)g(operations)e(are)j(passed)e(to)g(the)h(incoming)f(key)h
(manager)0 924 y(and)h(8)h(are)g(passed)f(to)h(the)f(out)g(going)f(key)i
(manager)m(.)40 b(Every)18 b(KM)i(control)d(operation)h(as)g(two)g(CR)m(YPT)i
(control)0 980 y(operation.)c(CR)m(YPT)p 346 980 14 2 v 17
w(IN)p 411 980 V 16 w(SET)c(sets)e(the)h(key)g(on)g(the)g(incoming)f(key)h
(manager)h(by)f(performing)g(a)g(KM)p 1672 980 V 17 w(SET)g(operation)0
1037 y(on)i(it.)22 b(Likewise)12 b(CR)m(YPT)p 444 1037 V 17
w(IN)p 509 1037 V 16 w(SET)h(performs)h(a)f(KM)p 903 1037 V
17 w(SET)g(on)g(the)g(outgoing)d(key)j(manager)m(.)24 b(The)13
b(CR)m(YPT)h(control)0 1093 y(operations)c(are)i(listed)d(below:)0
1191 y Fb(CRYPT_IN_RESOLVE)0 1248 y(CRYPT_IN_SET)0 1304 y
(CRYPT_IN_INVALIDATE)0 1361 y(CRYPT_IN_ISEMPTY)0 1417 y(CRYPT_IN_ISVALID)0
1474 y(CRYPT_IN_ISINVALID)0 1530 y(CRYPT_IN_KEYSIZE)0 1587
y(CRYPT_IN_HOSTSIZE)0 1643 y(CRYPT_OUT_RESOLVE)0 1699 y(CRYPT_OUT_SET)0
1756 y(CRYPT_OUT_INVALIDATE)0 1812 y(CRYPT_OUT_ISEMPTY)0 1869
y(CRYPT_OUT_ISVALID)0 1925 y(CRYPT_OUT_ISINVALID)0 1982 y(CRYPT_OUT_KEYSIZE)0
2038 y(CRYPT_OUT_HOSTSIZE)71 2136 y Fr(CR)m(YPT)18 b(diminishes)d(the)h
(results)g(of)h(GET)o(OPTP)l(ACKET)f(and)g(GETMAXP)l(ACKET)h(to)f(the)g(next)
h(lower)f(size)0 2193 y(congruent)9 b(to)h(7)g(\(mod)h(8\);)f(this)f(will)g
(reduce)i(the)f(size)g(by)g(at)h(least)e(1)i(and)f(at)g(most)g(8)g(bytes.)16
b(TCR)m(YPT)11 b(does)f(not)f(change)0 2249 y(the)i(packet)g(sizes,)g(except)
g(that)g(values)f(less)h(than)f(8)h(are)h(set)f(to)g(0.)71
2306 y(CR)m(YPT)18 b(forwards)f(all)g(other)f(control)g(operations)g(to)h
(the)g(transport)f(protocol)f(con\256gured)i(below)g(it.)34
b(Due)17 b(to)0 2362 y(security)10 b(concerns)h(CR)m(YPT)i(zero')m(s)e(out)g
(the)g(buf)o(fer)g(of)h(any)f(control)f(it)g(passes)h(down)f(the)h(graph.)0
2485 y Fl(CONFIGURA)l(TION)0 2572 y Fr(CR)m(YPT/TCR)m(YPT)j(expect)e(to)g(be)
g(con\256gured)g(on)g(top)f(of)i(a)f(transport)f(protocol)g(and)h(a)h(key)f
(manager)m(.)21 b(The)12 b(transport)0 2629 y(protocol)f(must)g(preserve)h
(packet)g(boundaries)f(\(i.e.)19 b(CR)m(YPT/TCR)m(YPT)14 b(will)d(not)g(work)
g(on)h(top)f(of)h(TCP\).)h(Because)g(it)952 2753 y(98)p eop
%%Page: 99 99
98 bop 0 124 a Fr(changes)9 b(packet)g(lengths,)g(CR)m(YPT)i(will)d(only)h
(work)g(between)g(IP)h(and)g(\(UDP)g(or)f(TCP\))h(if)g(checksumming)f(is)g
(disabled;)0 181 y(TCR)m(YPT)h(is)f(acceptable)h(here.)16 b(Any)9
b(protocol)f(con\256gured)h(above)g(TCR)m(YPT)i(should)d(not)g(generate)i
(packets)f(of)g(length)0 237 y(between)i(1)g(and)g(7)g(inclusive,)f(because)h
(the)g(length)f(will)g(not)h(be)g(preserved.)71 294 y(Example)g(of)g(a)g
(graph.comp)h(\256le:)0 387 y Fb(--------------------------)o(-------)0
444 y(@;)0 500 y(name=simeth/0;)0 557 y(name=eth)23 b(protocols=simeth/0;)0
613 y(name=arp)g(protocols=eth;)0 670 y(name=vnet)g(protocols=eth,arp;)0
726 y(name=ip)g(protocols=vnet;)0 783 y(name=km)g(trace=TR_ERRORS;)0
839 y(name=crypt)f(protocols=ip,km)g(trace=TR_ERRORS;)0 896
y(name=udp)h(protocols=crypt;)0 952 y(name=udpcrypttest)f(protocols=udp;)0
1008 y(@;)0 1065 y(prottbl)h(=)h(DEFAULT;)0 1121 y
(--------------------------)o(-------)0 1246 y Fl(SHOR)n(TCOMINGS,)12
b(THINGS)g(T)o(O)h(BE)g(DONE)0 1333 y Fr(This)6 b(version)h(of)h(CR)m
(YPT/TCR)m(YPT)h(is)e(experimental,)h(and)f(some)h(software)f(engineering)f
(and)h(cryptographic)g(changes)0 1389 y(have)i(yet)h(to)e(be)i(implemented.)
16 b(The)9 b(protocol)f(does)h(not)f(zero)i(out)f(message)h(plaintext)d
(after)j(encryption,)f(or)g(ciphertext)0 1446 y(after)18 b(decryption.)32
b(Keys)17 b(are)h(not)e(zeroed)h(out)g(when)f(the)h(sessions)f(are)h(closed.)
34 b(There)17 b(is)g(a)g(small)g(storage)f(leak)0 1502 y(when)d(a)g(session)f
(is)g(closed)h(because)g(the)g(key)f(memory)i(is)f(not)f(returned.)22
b(The)13 b(cipher)o(-block-chaining)e(algorithm)h(is)0 1558
y(always)i(reinitialized,)f(for)h(every)h(message,)g(with)e(a)i(starting)d
(vector)i(of)g(0s,)h(rather)f(than)g(random)g(salt.)25 b(There)14
b(is)g(no)0 1615 y(inter)o(-message)g(cryptographic)g(chaining.)25
b(Our)14 b(current)h(system)f(of)h(one)f(key)g(per)h(host)f(is)g(suitable)f
(for)i(testing,)f(but)0 1671 y(would)c(not)g(be)i(appropriate)e(for)h(a)h
(real)f(application.)71 1728 y(The)16 b(information)f(passed)h(during)g
(opening)f(of)i(a)g(session)e(includes)g(arbitrary)h(participants;)h(this)f
(provides)f(an)0 1784 y(outbound)h(information)i(channel)g(for)h(T)n(rojan)f
(Horse)g(client)g(programs.)39 b(The)18 b(lengths)f(of)i(outgoing)d(packets)i
(are)0 1841 y(another)12 b(channel.)19 b(The)13 b(presence)f(or)g(absence)h
(of)f(communication)g(is)f(a)i(third)e(channel.)20 b(A)12 b(T)n(rojan)g
(Horse)g(client)g(can)0 1897 y(also)f(originate)f(known)g(plaintext)f(to)i
(help)f(out)h(a)g(remote)h(attacker)m(.)71 1954 y(The)h(source)g(and)g
(destination)e(IP)j(addresses)f(appear)g(in)g(clear)h(for)g(every)f(packet)g
(on)g(the)g(net,)h(so)f(traf)o(\256c)i(analysis)0 2010 y(is)d(trivial)g(for)h
(a)g(properly)f(located)h(eavesdropper)m(.)22 b(Message)13
b(length)e(is)i(also)f(available)g(to)h(the)f(eavesdropper)m(.)22
b(Many)0 2067 y(protocols)12 b(have)i(standard)g(length)e(messages)i(they)g
(send)f(\(acknowledgements,)h(routing)f(updates,)h(etc.\),)i(often)d(with)0
2123 y(\256xed,)f(known,)e(or)h(easily)g(guessable)f(contents.)15
b(These)c(are)h(also)e(available)h(to)g(an)g(opponent.)0 2247
y Fl(AUTHORS)0 2334 y Fr(Richard)g(Schroeppel,)g(David)g(C.)h(Schwartz,)g
(and)f(Sean)h(O'Malley)952 2753 y(99)p eop
%%Page: 100 100
99 bop 0 124 a Fl(NAME)0 211 y Fr(ETH)11 b(\(Ethernet)f(Protocol\))0
336 y Fl(SYNOPSIS)0 423 y Fr(This)j(hardware-independent)g(protocol)h
(provides)f(the)h(interface)h(between)f(the)g(rest)g(of)h(the)f
Fq(x)p Fr(-kernel)h(protocols)d(and)0 479 y(the)e(actual)h(ethernet)f
(drivers.)16 b(It)10 b(has)g(a)h(UPI)g(interface)g(to)f(protocols)f(above)i
(it)f(and)g(interacts)g(with)f(the)i(drivers)f(through)0 535
y(a)15 b(specialized)e(UPI)i(interface.)26 b(There)14 b(should)f(be)h(a)h
(separate)f(instantiation)d(of)k(the)f(ETH)f(protocol)g(for)i(each)f(driver)0
592 y(protocol.)0 716 y Fl(REALM)0 803 y Fr(ETH)d(is)f(in)h(the)g(ASYNC)g
(realm.)0 928 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1015 y Fr(ETH)17
b(expects)f(a)i(single)e(remote)h(participant)f(with)g(an)h(ETHhost)e
(pointer)h(on)h(the)g(top)f(of)i(the)e(stack.)34 b(If)18 b(the)f(local)0
1071 y(participant)10 b(is)g(present)h(it)g(is)f(ignored.)0
1195 y Fl(CONTROL)i(OPERA)l(TIONS)0 1282 y Fb(ETH)p 75 1282
15 2 v 17 w(SETPROMISCUOUS:)20 b Fr(Sets)12 b(the)f(corresponding)f(device)h
(controller)g(in)g(promiscuous)f(mode)i(and)f(deliver)g(copies)114
1339 y(of)g(all)g(packets)f(to)h(this)f(session.)15 b(\(session)10
b(only\))114 1433 y(Input:)21 b(none)114 1506 y(Output:)f(none)0
1630 y Fl(EXTERNAL)13 b(INTERF)l(ACE)0 1717 y Fr(Ethernet)e(driver)g
(protocols)g(should)f(include)g(the)i(\256le)g Fg(protocols/eth/eth)p
1223 1717 14 2 v 16 w(i.h)g Fr(which)f(de\256nes)h(the)g(interface)g(between)
0 1773 y(ETH)f(and)g(the)g(drivers.)71 1830 y(ETH)f(will)g(openenable)g(its)g
(driver)h(protocol)f(once)h(at)f(initialization)e(time,)k(without)d(a)i
(participant)f(list.)15 b(This)10 b(gives)0 1886 y(the)h(driver)g(protocol)f
(the)h(XObj)f(it)h(should)e(use)i(in)g(xDemux)g(when)g(it)f(delivers)g
(messages.)71 1943 y(ETH)f(calls)h(xPush)g(with)f(the)h(driver)g
Fq(pr)n(otocol)f Fr(object)g(\(not)h(a)g(session\))f(to)h(send)g(a)g
(message.)17 b(ETH)10 b(never)g(opens)f(the)0 1999 y(lower)i(protocol.)71
2056 y(ETH)f(will)g(attach)h(a)h(pointer)e(to)h(an)g(ETHhdr)f(as)i(a)f
(message)g(attribute)f(for)i(each)f(outgoing)e(message:)191
2218 y Fb(typedef)23 b(struct)g({)286 2275 y(ETHhost)119 b(dst;)286
2331 y(ETHhost)g(src;)286 2388 y(u_short)g(type;)191 2444 y(})24
b(ETHhdr;)941 2753 y Fr(100)p eop
%%Page: 101 101
100 bop 71 124 a Fr(ETH)16 b(requires)g(that)g(the)g(driver)g(attach)g(a)h
(message)g(attribute)e(pointing)f(to)i(an)h(appropriate)e(ETHhdr)h(structure)
0 181 y(for)d(every)g(incoming)f(message.)23 b(For)13 b(both)f(incoming)g
(and)h(outgoing)e(messages,)i(the)g(ETHhdr)f(type)h(\256eld)g(will)f(be)h(in)
0 237 y(network)d(byte)h(order)m(.)71 294 y(ETH)f(requires)h(the)g(driver)g
(protocol)f(to)g(implement)h(the)g(control)f(op)h(GETMYHOST)m(.)71
350 y(ETH)f(provides)f(support)g(for)i(IEEE)g(802.3)f(packet)g(formats.)17
b(An)10 b(upper)h(protocol)e(registering)g(with)h(Ethernet)g(type)0
407 y(0)15 b(is)h(assumed)f(to)g(the)g(recipient)g(for)h(all)f(IEEE)g(802.3)g
(packets.)30 b(Conversely)m(,)16 b(a)g(protocol)e(using)g(an)i(Ethernet)f
(type)0 463 y(smaller)f(than)f(the)h(maximum)g(IEEE)g(802.3)f(data)h(size)g
(will)f(have)g(its)h(packets)f(sent)g(using)g(IEEE)g(802.3)h(format)g
(\(i.e.,)0 519 y(with)c(the)h(packet)g(length)f(overwriting)g(the)g(type)h
(\256eld.\))0 644 y Fl(CONFIGURA)l(TION)0 731 y Fr(Each)g(instantiation)d(of)
k(ETH)e(should)g(be)h(con\256gured)g(above)g(its)f(corresponding)g(driver)g
(protocol.)0 837 y(ETH)h(recognizes)f(the)h(following)e(ROM)j(options:)71
906 y Fb(eth/xxx)22 b(mtu)i(N)p Fr(:)11 b(Instantiation)d(xxx)j(of)g(ETH)g
(should)f(an)h(MTU)g(of)g(N.)h(Default)f(is)f(1500.)0 1030
y Fl(AUTHOR)0 1117 y Fr(Ed)h(Menze)941 2753 y(101)p eop
%%Page: 102 102
101 bop 0 124 a Fl(NAME)0 211 y Fr(ICMP)12 b(\(Internet)f(Control)g(Message)g
(Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(J.)j(Postel.)23
b Fq(Internet)12 b(Pr)n(otocol)p Fr(.)22 b(Request)13 b(for)h(Comments)g
(792,)f(USC)h(Information)f(Sciences)h(Institute,)f(Marina)g(del)0
479 y(Ray)m(,)f(Calif.,)g(Sept.)17 b(1981.)e(;)0 603 y Fl(SYNOPSIS)0
690 y Fr(ICMP)k(handles)f(control)f(messages)h(for)g(IP)-5
b(.)19 b(This)e(implementation)g(is)g(complete)h(in)g(that)f(it)h(handles)f
(all)h(possible)0 747 y(incoming)10 b(ICMP)j(requests.)0 871
y Fl(REALM)0 958 y Fr(ICMP)f(is)f(in)g(the)g(CONTROL)g(realm.)17
b(ICMP)c(sessions)c(may)j(be)f(opened)f(to)h(allow)g(control)f(operations.)0
1082 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1169 y Fr(ICMP)i(neither)f(removes)g(nor)g
(adds)g(anything)f(to)g(the)h(participant)f(stacks.)16 b(It)11
b(passes)f(the)h(participants)f(directly)g(to)h(IP)-5 b(.)0
1294 y Fl(CONTROL)12 b(OPERA)l(TIONS)0 1381 y Fb(ICMP)p 99
1381 15 2 v 17 w(ECHO)p 212 1381 V 16 w(REQ:)22 b Fr(Send)14
b(an)f(ICMP)i(Echo)d(Request)h(message)g(to)g(the)g(peer)h(host)e(and)h(wait)
g(for)g(a)g(reply)m(.)23 b(The)13 b(buf)o(fer)114 1437 y(contains)c(the)i
(length)f(of)i(the)f(message.)16 b(Returns)11 b(0)g(if)g(successful,)g(-1)g
(if)g(a)h(timeout)e(occurred.)17 b(\(session)10 b(only\))114
1531 y(Input:)21 b Fb(int)114 1604 y Fr(Output:)f(none)0 1728
y Fl(CONFIGURA)l(TION)0 1815 y Fb(name=icmp)j(protocols=ip;)0
1940 y Fl(AUTHOR)0 2027 y Fr(Clinton)10 b(Jef)o(fery)941 2753
y(102)p eop
%%Page: 103 103
102 bop 0 124 a Fl(NAME)0 211 y Fr(IP)12 b(\(Internet)f(Protocol\))0
332 y Fl(SPECIFICA)l(TION)0 419 y Fr(J.)j(Postel.)23 b Fq(Internet)12
b(Pr)n(otocol)p Fr(.)22 b(Request)13 b(for)h(Comments)g(768,)f(USC)h
(Information)f(Sciences)h(Institute,)f(Marina)g(del)0 475 y(Ray)m(,)f
(Calif.,)g(Aug.)k(1980.)0 596 y Fl(SYNOPSIS)0 683 y Fr(IP)9
b(handles)f(fragmentation)g(and)g(routing)f(required)h(in)h(transmitting)d
(messages)j(across)f(heterogeneous)f(interconnected)0 739 y(networks.)15
b(This)c(implementation)e(is)i(complete,)g(with)g(the)f(exception)h(of)g
(some)g(of)g(the)g(optional)f(header)h(\256elds.)0 859 y Fl(REALM)0
946 y Fr(IP)h(is)e(in)h(the)g(ASYNC)g(realm.)0 1067 y Fl(P)l(AR)n(TICIP)l
(ANTS)0 1154 y Fr(IP)k(removes)f(a)h(pointer)e(to)g(an)i(IPhost)e(from)i(the)
f(top)f(of)h(the)g(stack)g(of)g(each)h(participant.)24 b(If)14
b(the)g(local)g(participant)f(is)0 1210 y(missing)d(or)h(if)g(the)g(local)g
(IPhost)f(pointer)g(is)h(ANY)p 819 1210 14 2 v 16 w(HOST)m(,)g(IP)h(will)e
(select)h(an)g(appropriate)f(local)h(IPhost.)0 1331 y Fl(CONTROL)h(OPERA)l
(TIONS)0 1418 y Fb(IP)p 51 1418 15 2 v 17 w(MYNET:)22 b Fr(Return)11
b(local)g(host')m(s)f(IP)i(network)e(number)m(.)18 b(This)10
b(is)h(an)g(IP)h(address)e(with)h(the)g(host)f(component)g(set)h(to)g(0.)114
1474 y(\(session)e(only\))114 1560 y(Input:)21 b(none)114 1625
y(Output:)f Fb(IPhost)0 1711 y(IP)p 51 1711 V 17 w(REDIRECT:)h
Fr(Modi\256es)12 b(routing)d(table)i(to)g(use)g(a)h(speci\256ed)f(gateway)g
(when)g(delivering)e(packets)i(to)g(a)h(speci\256ed)f(IP)114
1768 y(address.)k(The)9 b(\256rst)h(address)f(is)g(for)g(the)g(destination)e
(and)j(the)f(second)g(is)f(for)i(the)f(gateway)m(.)16 b(\(session)8
b(or)h(protocol\))114 1854 y(Input:)21 b Fb(IPhost[2])114 1919
y Fr(Output:)f(none)0 2005 y Fb(IP)p 51 2005 V 17 w(GETPSEUDOHDR:)h
Fr(Fills)10 b(the)g(buf)o(fer)h(with)f(a)h(partial)f(IP)h(pseudoheader)n(,)g
(containing)d(the)j(source)f(address,)h(destina-)114 2061 y(tion)g(address,)j
(and)e(the)h(upper)f(protocol)g(type.)21 b(The)13 b(packet)f(length)g
(\256eld)h(and)g(the)f(zero-block)h(are)g(both)f(set)h(to)114
2118 y(zero.)k(\(session)9 b(only\))114 2204 y(Input:)21 b(none)114
2269 y(Output:)f Fb(IPpseudoHdr)0 2355 y(IP)p 51 2355 V 17
w(PSEUDOHDR:)h Fr(Used)15 b(by)f(protocols)f(that)h(use)g(the)h(IP)g
(pseudoheader)f(\(e.g.,)i(TCP)g(and)e(UDP\))h(to)f(alert)h(protocols)114
2411 y(between)g(them)i(and)f(IP)g(that)g(they)f(must)h(not)f(change)h(the)g
(length)f(of)h(packets)g(without)e(worrying)h(about)g(the)114
2468 y(length)10 b(\256eld)h(in)g(the)f(pseudoheader)m(.)17
b(IP)11 b(itself)g(simply)f(absorbs)g(this)g(control)g(operation)g(and)h
(returns.)114 2554 y(Input:)21 b(none)114 2619 y(Output:)f(none)941
2753 y(103)p eop
%%Page: 104 104
103 bop 0 124 a Fl(CONFIGURA)l(TION)0 211 y Fr(IP)12 b(must)f(be)g
(con\256gured)g(above)f(VNET)n(:)215 318 y Fb(name=ip)23 b(protocols=vnet;)71
449 y Fr(If)13 b(an)g(explicit)e(route)i(for)g(a)g(remote)h(network)e(is)g
(not)h(speci\256ed,)g(IP)h(will)d(forward)i(packets)g(for)g(that)f(network)g
(to)h(a)0 505 y Fq(default)g(gateway)p Fr(,)i(if)g(one)f(has)g(been)h
(con\256gured.)26 b(The)14 b(default)g(gateway)g(can)h(be)g(set)f(with)f(a)i
(rom)g(\256le)g(entry)f(of)g(the)0 562 y(form:)215 655 y Fb(ip)95
b(gateway)118 b(127.1.22.11)71 749 y Fr(If)12 b(no)f(default)g(gateway)g(has)
g(been)h(con\256gured,)g(or)f(the)h(speci\256ed)f(default)g(gateway)g(can)h
(not)f(be)h(reached)g(directly)m(,)0 806 y(IP)f(will)e(operate)h(without)f(a)
i(default)e(gateway)h(and)h(ERR)p 923 806 14 2 v 16 w(XOBJ)f(will)g(be)g
(returned)g(in)g(cases)h(where)f(a)h(default)f(gateway)0 862
y(would)g(otherwise)g(have)h(been)g(used.)0 986 y Fl(AUTHORS)0
1073 y Fr(Clinton)f(Jef)o(fery)m(,)i(David)e(Kays)h(and)g(Ed)g(Menze)941
2753 y(104)p eop
%%Page: 105 105
104 bop 0 124 a Fl(NAME)0 211 y Fr(JOIN)0 336 y Fl(SPECIFICA)l(TION)0
424 y(SYNOPSIS)71 511 y Fr(JOIN)10 b(mer)o(ges)h(up)g(to)f(N)h(outgoing)e
(messages)h(pushed)g(to)g(N)h(dif)o(ferent)g(sessions)e(into)g(a)i(single)f
(outgoing)f(message.)0 568 y(When)16 b(this)f(message)i(arrives)f(it)g(its)g
(broken)g(up)g(into)f(its)h(original)f(con\256guration)g(and)h(demuxed)g(to)g
(N)h(potentially)0 624 y(dif)o(ferent)f(protocols.)29 b(JOIN)16
b(is)g(bidirectional)e(and)h(will)g(perform)i(the)f(same)g(action)g(on)f(the)
h(reply)m(.)31 b(N)16 b(can)g(be)g(any)0 681 y(number)f(between)g(1)g(and)g
(16.)28 b(The)15 b(default)g(value)g(for)g(N)g(is)g(four)g(and)g(other)g
(values)f(may)i(be)f(set)g(using)f(ROM)i(\256le)0 737 y(options.)71
793 y(The)i(number)h(of)f(xOpen')m(s)g(and)h(xOpenenable')m(s)f(that)g
(should)f(be)h(performed)h(on)g(JOIN)f(and)g(the)h(number)f(of)0
850 y(xOpenDone')m(s)c(JOIN)g(will)f(perform)i(on)f(higher)g(level)g
(protocols)e(should)h(be)i(equal)f(to)g(N)g(+)g(1.)27 b(The)14
b(\256rst)g(open)g(will)0 906 y(return,)c(and)g(the)g(\256rst)g(open)g(done)g
(will)f(produce,)h(a)g(control)g(session)e(which)i(is)f(not)h(used)f(to)h
(transmit)f(data.)16 b(T)m(o)10 b(transmit)0 963 y(a)h(message)g(to)g(user)g
(of)g(JOIN)f(would)g(push)g(a)h(single)f(message)h(to)f(one)h(or)g(more)h(of)
f(the)f(remaining)h(N)g(sessions)e(and)h(the)0 1019 y(perform)15
b(and)f(JOINDONE)f(done)h(on)g(the)g(control)g(session.)24
b(When)14 b(JOINDONE)g(is)f(called)h(on)g(JOIN)g(the)h(protocol)0
1076 y(gathers)c(all)f(of)i(the)f(packets)f(pushed)g(and)h(joins)f(them)h
(into)g(a)g(single)f(packet)h(and)g(transmits)f(them.)71 1132
y(When)g(the)g(packet)g(arrives)g(at)h(the)f(receiver)h(it)f(is)f(broken)h
(up)g(into)g(its)f(original)g(con\256guration)g(and)h(demuxed)h(to)e(the)0
1189 y(appropriate)j(higher)g(level)h(protocols.)19 b(If)14
b(no)e(packet)h(has)f(been)h(pushed)f(to)g(a)i(speci\256c)e(JOIN)h(session)e
(no)i(packet)f(will)0 1245 y(be)h(demuxed)h(at)f(the)g(corresponding)f(join)g
(session)g(at)h(the)g(receiver)m(.)24 b(When)13 b(this)g(is)f(\256nished)h
(JOIN)g(will)f(perform)i(an)0 1302 y(upward)e(JOINDONE)f(control)h(operation)
f(on)h(the)h(session)e(or)h(protocol)f(passed)h(to)g(JOIN)g(by)g(the)h
(receiving)e(protocol)0 1358 y(using)i(the)h(JOINSETCONTROL)g(operation.)25
b(This)14 b(allows)f(the)h(user)h(to)f(detect)g(if)h(any)f(of)g(the)h
(incoming)e(message)0 1414 y(fragments)j(has)f(been)h(lost)e(or)i(never)g
(sent.)30 b(NOTE)15 b(some)g(protocol)g(must)g(know)g(that)g(it)g(is)g(using)
g(JOIN)g(and)h(must)0 1471 y(perform)e(JOINSETCONTROL)f(immediately)g(after)i
(the)e(\256rst)h(openDone)f(performed)h(by)f(JOIN)h(on)f(the)h(SESSION)0
1527 y(passed)d(up)f(by)h(the)g(openDone.)71 1584 y(The)f(order)g(in)g(which)
g(JOIN)g(will)f(demux)h(the)g(messages)h(to)f(the)g(higher)f(level)h
(protocol\(s\))f(can)i(be)f(set)g(in)g(the)g(ROM)0 1640 y(\256le.)0
1765 y Fl(REALM)0 1852 y Fr(JOIN)h(is)f(in)h(the)g(ASYNC)h(realm.)0
1976 y Fl(P)l(AR)n(TICIP)l(ANTS)0 2063 y Fr(JOIN)i(takes)f(arbitrary)h
(participants.)24 b(The)14 b(only)f(restriction)f(is)i(that)f(JOIN)h(must)g
(be)g(opened)f(N+1)h(times)g(with)f(each)0 2119 y(open)c(having)g(exactly)g
(the)g(same)h(participant)e(list.)15 b(The)9 b(best)g(way)h(to)f(achieve)g
(these)h(duplicate)e(opens)h(is)g(for)h(the)f(higher)0 2176
y(level)k(protocol)f(to)g(perform)i(one)f(open)g(which)g(eventually)e
(trickles)i(down)f(to)h(JOIN)g(and)g(then)f(do)h(a)h(get)f(participants)0
2232 y(on)h(the)h(resulting)e(session.)25 b(This)14 b(participant)f(list)g
(should)g(be)i(used)f(to)g(perform)h(the)g(remaining)f(opens.)26
b(JOIN)14 b(will)0 2289 y(create)e(one)f(and)g(only)g(one)g(set)g(of)g(JOIN)g
(session)f(for)i(each)f(unique)g(address.)16 b(Attempts)10
b(to)h(open)g(another)g(set)g(of)h(JOIN)0 2345 y(sessions)h(with)h(the)g
(same)h(address)f(will)g(fail.)27 b(Note)14 b(there)h(is)f(a)h(huge)f
(potential)f(race)j(condition)d(if)h(the)h(higher)f(level)0
2402 y(protocol)c(which)g(knows)g(about)h(join)f(is)g(in)h(a)h(dif)o(ferent)f
(scheduling)e(domain)i(from)h(JOIN.)0 2526 y Fl(CONTROL)g(OPERA)l(TIONS)0
2613 y Fr(JOINGETNUMSEG:)e(Returns)g(N.)941 2753 y(105)p eop
%%Page: 106 106
105 bop 71 124 a Fr(JOINGET)o(ORDER:)10 b(Returns)h(an)g(array)h(of)g(16)f
(integer)g(which)g(gives)f(the)h(order)h(in)f(which)g(JOIN)g(will)f(demux)h
(the)0 181 y(messages)i(fragments.)21 b(While)12 b(all)g(16)g(ints)g(are)h
(returned)g(only)e(the)i(\256rst)f(N)h(of)g(them)g(should)e(be)i(considered)e
(valid.)21 b(If)0 237 y(N=4)11 b(then)f(0)h(1)g(2)g(3)h(4)f(is)f(a)i(valid)e
(order)h(and)g(4)g(3)h(2)f(1)g(is)f(also)h(a)h(valid)e(order)m(.)71
294 y(JOINDONE:)j(When)h(called)g(on)g(the)h(JOIN)f(control)f(session)g(it)h
(cause)h(join)e(to)h(collect)g(all)g(fragments)h(currently)0
350 y(available)10 b(and)h(send)g(a)g(composite)f(message.)17
b(JOIN)11 b(invokes)e(JOINDONE)h(on)h(the)g(higher)f(level)h(protocol)f(or)h
(session)0 407 y(passed)j(to)f(it)h(by)g(JOINSETCONTROL)f(when)h(it)g(is)f
(\256nished)h(demultiplexing)d(message)k(fragments.)25 b(JOINDONE)0
463 y(takes)11 b(no)g(ar)o(guments.)71 519 y(JOINSETCONTROL:)d(T)m(akes)h(a)h
(protocol)f(or)h(session)e(as)i(ar)o(gument.)16 b(Some)10 b(higher)f(level)h
(protocol)e(must)h(invoke)0 576 y(this)g(operation)f(on)i(the)f(JOIN)h
(control)f(session)f(before)i(any)g(packets)f(are)i(delivered.)k(The)10
b(protocol)e(implementor)i(must)0 632 y(implement)h(a)g(JOINDONE)f(control)h
(operation)f(in)g(the)h(control)f(procedure.)71 689 y(subsection*CONFIGURA)-5
b(TION)71 745 y(The)10 b(composability)e(of)i(JOIN)g(is)g(rather)h(complex)f
(and)g(not)g(particularly)f(well)h(understood.)k(There)d(must)f(be)g(some)0
802 y(higher)j(level)g(protocol)g(that)g(knows)g(it)g(is)g(being)g(compose)h
(on)f(top)h(of)f(JOIN.)h(This)f(protocol)g(will)f(be)i(con\256gured)g(on)0
858 y(top)f(of)h(N+1)f(protocols.)23 b(The)13 b(\256rst)h(protocol)f(must)g
(be)h(JOIN.)g(Between)g(this)e(protocol)h(JOIN)g(any)h(number)g(of)g(other)0
915 y(protocols)e(may)j(be)f(composed)g(on)f(each)i(of)f(the)g(remaining)f(N)
h(paths.)25 b(For)14 b(example)g(the)g(following)e(is)i(a)g(valid)f(join)0
971 y(protocol)d(graph.)0 1074 y Fb(name=auth)23 b(protocols=)f(join,)h
(join,join,crypt/one,join,cry)o(pt/two;)0 1130 y(name=crypt/one)f
(protocols=join;)0 1187 y(name=crypt/two)g(protocols=join;)0
1243 y(name=join)h(....)71 1346 y Fr(Note)17 b(that)h(the)g(participant)f
(lists)g(that)g(propagate)h(to)g(join)f(through)g(each)h(of)h(these)f(paths)f
(must)h(be)g(identical.)0 1403 y(Therefore)h(if)g(one)g(path)f(to)g(JOIN)h
(modi\256es)f(the)h(participant)e(list)h(all)g(other)h(paths)e(must)i(also)f
(perform)h(identical)0 1459 y(modi\256cations.)37 b(For)19
b(situations)d(where)j(the)f(incoming)g(and)g(outgoing)e(paths)i(dif)o(fer)h
(it)f(may)h(be)g(possible)d(to)i(use)0 1516 y(standard)9 b(asymmetric)g
(protocol)f(graph)i(techniques)e(to)h(allow)f(the)h(incoming)g(and)g
(outgoing)e(message)j(to)f(pass)g(through)0 1572 y(dif)o(ferent)j(protocol)f
(graphs.)20 b(Note)11 b(that)h(any)g(protocol)f(composed)h(between)g(AUTH)g
(and)g(JOIN)g(must)g(xPush)f(zero)i(or)0 1629 y(one)f(message)f(down)g(for)h
(each)g(xPush)f(done)h(to)f(it.)18 b(Protocols)10 b(which)h(fragment)h
(messages)g(should)e(not)h(be)h(composed)0 1685 y(between)f(AUTH)f(and)h
(JOIN.)0 1809 y Fl(ROM)h(File)0 1896 y Fr(The)g(ROM)g(\256le)g(is)g(used)f
(to)h(set)f(N)h(and)g(the)f(order)h(in)g(which)f(the)h(message)g(parts)f
(should)f(be)i(demuxed)g(to)f(higher)h(level)0 1952 y(protocols.)j(The)c
(following)e(is)i(an)g(example)g(ROM)h(\256le:)0 2055 y Fb(join)23
b(segments)g(4)0 2112 y(join)g(order)g(3)h(2)g(1)g(0)71 2215
y Fr(After)10 b(the)f(user)h(has)g(set)g(the)f(number)h(of)g(segments)g(to)f
(be)h(joined)f(he)h(should)e(set)i(the)g(order)g(at)g(which)f(he)h(would)f
(like)0 2271 y(the)k(message)h(segments)f(to)g(be)h(demuxed.)23
b(In)14 b(this)e(case)i(JOIN)g(will)e(demux)h(the)h(messages)f(in)g(reverse)h
(order)m(.)25 b(Note)0 2328 y(the)11 b(default)g(N)h(is)f(4)h(and)f(the)g
(default)g(order)h(is)f(\(0)h(1)f(2)h(3)f(4)h(5)g(6)f(7)h(8)f(9)h(10)f(11)g
(12)g(13)h(14)f(15\).)18 b(However)11 b(the)g(user)h(should)0
2384 y(always)f(set)f(N)i(and)f(the)g(order)m(.)0 2532 y Fl(AUTHOR)0
2619 y Fr(Sean)h(W)l(.)f(O'Malley)941 2753 y(106)p eop
%%Page: 107 107
106 bop 0 124 a Fl(NAME)0 211 y Fr(KM)12 b(\()f(An)g(Encryption)e(Key)i
(Manager)h(\))0 336 y Fl(DISTRIBUTION)i(NOTE)0 423 y Fq(This)c(pr)n(otocol)g
(will)g(not)h(be)g(distributed)d(via)i(anonymous)g(ftp.)15
b(If)c(inter)n(ested,)f(contact)g(xkernel-bugs@cs.arizona.edu)0
479 y(about)g(obtaining)f(this)h(pr)n(otocol.)0 603 y Fl(SPECIFICA)l(TION)0
690 y Fr(KM)i(provides)d(a)j(key)f(that)g(matches)g(a)g(participant)f(list.)0
815 y Fl(SYNOPSIS)0 902 y Fr(KM)h(maps)f(addresses)g(to)f(keys.)16
b(Both)10 b(keys)g(and)g(addresses)f(are)i(uninterpreted)e(byte)h(strings)e
(to)i(KM.)h(KM)f(reads)h(a)f(key)0 958 y(\256le)j(at)h(start)e(up.)23
b(The)13 b(\256rst)g(line)f(of)h(the)g(key)g(\256le)h(contains)e(the)h
(length)f(of)h(the)g(addresses)f(in)h(bytes,)g(the)g(length)f(of)h(the)0
1015 y(keys)g(in)g(bytes)g(and)g(the)g(size)g(to)g(pass)g(when)g(creating)g
(the)h(key)f(map.)24 b(The)13 b(remaining)g(lines)f(of)i(the)f(key)g(\256le)h
(contain)0 1071 y(address)d(key)g(pairs.)71 1127 y(When)e(a)i(protocol)d
(such)i(as)g(CR)m(YPT)h(needs)f(to)f(look)g(up)h(a)g(key)m(,)g(it)g(opens)f
(a)h(session)f(to)g(KM.)i(The)f(entire)g(participant)0 1184
y(list)f(is)h(converted)f(into)g(a)i(byte)f(string)f(and)h(used)f(to)h
(lookup)f(a)h(session)f(in)h(the)g(key)g(map.)16 b(Note)10
b(if)g(you)g(wish)f(to)h(associate)0 1240 y(a)h(key)f(with)f(a)i(single)e
(participant)g(in)h(a)h(participant)e(list)g(you)g(must)h(create)h(a)g(new)f
(participant)f(list)h(with)f(that)h(participant)0 1297 y(as)j(its)e(only)h
(member)m(.)22 b(\(Not)13 b(an)f(easy)h(thing)e(to)h(do)g(with)g(the)g
(current)h(participant)e(structure.\))20 b(The)13 b(control)e(operation)0
1353 y(KM)p 76 1353 14 2 v 17 w(RESOL)l(VE)d(is)f(used)h(to)g(lookup)f(the)h
(actual)g(keys.)16 b(The)8 b(control)f(operation)g(KM)p 1372
1353 V 17 w(SET)h(is)g(used)g(to)g(change)g(the)h(value)0 1410
y(of)i(a)h(key)m(.)17 b(The)11 b(control)f(operation)g(KM)p
653 1410 V 17 w(INV)-6 b(ALIDA)h(TE)10 b(is)g(used)h(to)g(invalidate)f(a)h
(key)m(.)17 b(The)11 b(state)g(of)g(the)g(KM)h(session)0 1466
y(can)e(be)g(determined)f(by)h(calling)f(the)g(control)g(operations)f(KM)p
1009 1466 V 17 w(ISEMPTY)-6 b(,)11 b(KM)p 1309 1466 V 16 w(ISV)-6
b(ALID,)10 b(KM)p 1595 1466 V 17 w(ISINV)-6 b(ALID.)10 b(If)g(the)0
1523 y(state)g(is)g(empty)h(no)f(key)g(value)h(has)f(ever)h(been)g(set)f(for)
h(this)e(address.)16 b(If)11 b(the)g(state)f(is)g(valid)g(there)g(is)g(a)h
(valid)f(key)h(for)f(this)0 1579 y(address)j(if)g(the)g(state)g(is)g(invalid)
e(an)j(invalidate)e(operation)g(has)h(been)g(performed)h(on)f(this)f
(session.)22 b(If)13 b(a)h(higher)f(level)0 1636 y(protocol)d(is)g(no)h
(longer)f(interested)g(in)h(a)h(speci\256c)f(key)g(it)f(should)g(perform)h(a)
h(close)e(operation)g(on)h(the)g(KM)g(session.)k(No)0 1692
y(messages)c(are)h(pushed)e(or)h(popped)f(to)h(KM.)71 1748
y(The)g(keys)g(\256le)h(name)g(is)f(formed)h(by)f(concatenating)f(the)h
(string)f(\252keys\272)h(with)g(the)g(instance)g(name)h(of)f(the)h(protocol)0
1805 y(\(which)f(may)g(be)g(null\).)0 1929 y Fl(REALM)0 2016
y Fr(KM)h(is)e(in)h(the)g(ASYNC)g(realm.)0 2140 y Fl(P)l(AR)n(TICIP)l(ANTS)0
2227 y Fr(KM)g(accepts)g(participants)e(in)i(order)f(to)h(do)f(a)h(table)g
(lookup)e(to)i(\256nd)f(the)h(key)m(.)16 b(The)11 b(entire)f(participant)g
(list)f(is)i(converted)0 2284 y(into)f(a)i(byte)e(string)g(which)h(is)f(then)
h(used)g(to)f(lookup)g(the)h(key)m(.)0 2408 y Fl(CONTROL)h(OPERA)l(TIONS)0
2495 y Fr(KM)p 76 2495 V 17 w(RESOL)l(VE)d(returns)h(a)g(copy)g(of)g(the)g
(key)g(stored)f(in)h(that)g(session.)k(This)c(key)g(is)f(the)h(key)g(which)f
(is)h(associated)f(with)0 2552 y(the)i(participant)g(list)f(passed)h(at)h
(open)f(time.)18 b(KM)p 805 2552 V 16 w(RESOL)l(VE)12 b(can)f(fail)h(if)g(no)
f(key)g(has)h(been)f(set)h(or)f(that)g(key)h(has)f(been)0 2608
y(invalidated.)941 2753 y(107)p eop
%%Page: 108 108
107 bop 71 124 a Fr(KM)p 147 124 14 2 v 16 w(SET)11 b(sets)g(the)g(key)g(for)
g(that)g(session)e(to)i(the)g(value)g(passed.)71 181 y(KM)p
147 181 V 16 w(INV)-6 b(ALIDA)h(TE)10 b(marks)h(the)g(key)f(as)h(invalid)e
(and)i(removes)g(the)f(KM)i(session)d(from)i(the)g(map.)17
b(The)10 b(session)g(is)0 237 y(not)g(destroyed)h(until)e(all)i(users)g(of)g
(that)g(session)e(have)i(closed)g(it.)71 294 y(KM)p 147 294
V 16 w(ISEMPTY)h(succeeds)f(if)g(no)g(key)g(for)g(this)f(session)g(has)h
(been)g(de\256ned.)71 350 y(KM)p 147 350 V 16 w(ISV)-6 b(ALID)11
b(succeeds)g(if)g(there)h(is)e(a)i(valid)e(key)h(for)h(this)e(session.)71
407 y(KM)p 147 407 V 16 w(ISINV)-6 b(ALID)11 b(succeeds)g(if)g(a)h(KM)p
715 407 V 17 w(INV)-6 b(ALIDA)h(TE)10 b(operation)g(has)h(been)g(performed)h
(in)e(this)g(session.)0 528 y Fl(CONFIGURA)l(TION)0 615 y Fr(KM)i(is)e
(con\256gured)h(with)f(cryptographic)g(protocols)g(such)g(as)h(CR)m(YPT)m(.)0
736 y Fl(CR)n(YPT)o(OGRAPHIC)i(SHOR)n(TCOMINGS)0 823 y Fr(The)f(system)f(of)h
(one)g(key)f(per)h(host)f(is)g(not)h(cryptographically)d(strong.)18
b(The)11 b(operating)g(system)g(\256le)i(protections)d(must)0
879 y(be)h(used)g(to)g(protect)f(the)h(keys)g(\256le)g(from)h(unauthorized)e
(snooping.)0 1000 y Fl(EXAMPLE)k(KEY)e(FILES)0 1087 y Fr(Here)g(are)g(four)f
(examples)g(of)g(key)g(\256les.)71 1144 y(The)h(\256rst)h(example)g(shows)f
(a)i(key)e(\256le)i(which)e(maps)h(4)g(byte)f(IP)i(addresses)e(to)h(8)g(byte)
f(DES)h(keys.)22 b(The)12 b(57)h(is)f(the)0 1200 y(number)e(passed)g(to)f
(mapCreate)i(as)f(the)g(size)g(of)g(the)g(key)g(map.)16 b(The)10
b(IP)h(address)f(is)f(followed)g(by)h(a)g(DES)g(key)m(,)h(of)f(16)f(hex)0
1256 y(digits.)16 b(Hex)11 b(letters)g(may)h(be)f(in)g(upper)g(or)h(lower)f
(case.)18 b(A)11 b(trailing)f(comment)i(is)f(optional,)f(but)h(it)g(helps)g
(to)g(keep)g(track)0 1313 y(of)f(the)g(machine)h(name.)17 b(This)9
b(keying)g(method)h(is)f(appropriate)h(if)g(the)g(CR)m(YPT)h(module)f(is)g
(con\256gured)g(above)g(IP)-5 b(.)11 b(Note)0 1369 y(that)g(for)g(historical)
e(reasons)i(the)g(id)g(\256eld)g(begins)f(with)g(0x)h(while)f(the)h(key)g
(\256eld)g(does)g(not.)0 1452 y Fb(--------------------------)o(-------)0
1509 y(4)24 b(8)f(57)0 1565 y(0xc00c4582)f(0807060504030201)0
1622 y(0xc00c4587)g(080706050403d213)0 1678 y(0xc00c456e)g(0103040506070802)0
1735 y(0xc00c4589)g(abbadabbad0add15)70 b(Berlioz)47 b(192.12.69.137)0
1791 y(0xc00c4518)22 b(141421356abcdefa)70 b(Britten)47 b(192.12.69.24)0
1847 y(0xc00c4554)22 b(2718281828459045)70 b(Cottonwood)22
b(192.12.69.84)0 1904 y(0xc00c4574)g(3141592653589793)70 b(Leibniz)47
b(192.12.69.116)0 1960 y(0xc00c4562)22 b(98cba765fed43210)70
b(Tchaikovsky)22 b(192.12.69.98)0 2017 y(0xc00c4536)g(010304050ad53812)0
2073 y(0xc00c4563)g(7766554433221100)0 2130 y(0xc00c4561)g(0103040706070a02)0
2186 y(--------------------------)o(-------)71 2269 y Fr(The)14
b(second)g(example)i(shows)d(keying)h(based)g(on)h(Ethernet)f(address,)h
(which)g(is)f(6)h(bytes)f(long.)26 b(This)14 b(keying)g(is)0
2326 y(appropriate)c(when)h(the)g(CR)m(YPT)h(module)f(is)g(placed)g(above)g
(ETH.)0 2403 y Fb(--------------------------)o(-------)0 2459
y(6)24 b(8)f(57)0 2516 y(0xc00c456e0ca2)f(0807060504030201)0
2572 y(0xc00c45432694)g(0103040506070802)0 2629 y(--------------------------)
o(-------)941 2753 y Fr(108)p eop
%%Page: 109 109
108 bop 71 124 a Fr(The)13 b(third)g(example)h(shows)f(keying)g(based)g(on)g
(the)h(combination)e(of)i(UDP)g(port)f(number)h(and)g(IP)g(address.)24
b(The)0 181 y(lookup)7 b(data)h(is)g(8)g(bytes)g(long:)13 b(4)c(bytes)e(of)i
(UDP)f(port)g(number)h(and)f(4)g(bytes)g(of)g(IP)h(address.)15
b(This)8 b(keying)f(is)h(appropriate)0 237 y(when)j(the)g(CR)m(YPT)h(module)f
(is)f(con\256gured)h(above)g(UDP)-5 b(.)0 319 y Fb
(--------------------------)o(-------)0 376 y(8)24 b(8)f(57)0
432 y(0x000007d1c00c456e)e(0807060504030201)0 489 y(0x00000100c00c4582)g
(0103040506070802)0 545 y(0x000007d1c00c4587)g(010304a50607080f)0
601 y(--------------------------)o(-------)71 684 y Fr(The)12
b(fourth)g(example)h(shows)f(some)g(additional)f(features)i(of)g(the)f(key)h
(\256le)g(parser)m(.)21 b(Addresses)12 b(and)h(keys)f(may)h(be)0
740 y(character)g(strings)d(instead)h(of)h(hex)f(byte)h(strings;)e(the)i
(strings)e(are)i(demarcated)h(with)e(double-quotes.)16 b(For)c(long)f(keys,)0
796 y(the)k(backslash)g(character)h(may)h(be)e(used)g(to)h(hide)f(line)g
(breaks,)i(to)e(include)g(octal-coded)g(characters,)i(and)f(to)f(quote)0
853 y(backslash)7 b(and)i(doublequote)d(characters.)16 b(A)9
b(comment)g(may)g(be)g(placed)f(after)h(backslash-space.)15
b(Following)6 b(a)j(hidden)0 909 y(newline,)i(initial)e(whitespace)h(is)h
(discarded,)g(but)f(another)h(backslash)f(turns)g(of)o(f)i(hiding.)71
966 y(V)-5 b(ariable)13 b(length)g(keys)g(are)h(permitted.)24
b(T)m(o)14 b(use)f(this)g(option,)g(the)h(\256rst)f(line)h(of)f(the)h(\256le)
g(should)e(have)i(a)g(range)g(of)0 1022 y(lengths)c(instead)g(of)h(a)h
(single)e(number)m(.)71 1079 y(The)f(0x)h(in)f(front)h(of)g(the)f(address)h
(is)f(optional)f(for)i(addresses,)g(prohibited)e(for)i(keys.)16
b(Individual)8 b(hex)i(bytes)f(may)h(be)0 1135 y(separated)g(with)f(one)h
(space)g(or)h(punctuation)c(character)m(.)18 b(A)10 b(hex)g(byte)g(string)f
(is)g(terminated)h(with)f(tab,)h(newline,)g(double)0 1192 y(space,)i(double)f
(punctuation,)f(or)i(the)g(double-quote)e(character)m(.)19
b(Single)11 b(space)h(is)g(allowed)f(as)g(a)i(terminator)e(when)g(the)0
1248 y(byte)i(string)f(is)h(maximum)h(permitted)f(length,)g(and)h(no)f
(internal)g(spaces)g(have)g(been)h(used)f(in)g(the)g(string.)22
b(Single)13 b(hex)0 1305 y(digits)e(are)j(ok,)f(but)f(odd)g(length)g(blocks)g
(of)h(hex)f(digits)f(are)j(not.)21 b(In)13 b(AA-B-CCC-DDDD,)h(the)e(B)h(is)g
(ok)f(but)g(the)h(CCC)0 1361 y(isn')o(t.)71 1417 y(Comment)f(lines)e(begin)h
(with)g(#.)18 b(Also,)11 b(any)g(text)g(following)f(a)i(key)g(is)f(treated)g
(as)h(a)g(comment)g(line,)f(even)h(without)0 1474 y(a)g(#.)0
1556 y Fb(--------------------------)o(-------)0 1612 y(6-10)47
b(0-2000)23 b(100)0 1669 y("Alabama")46 b(99)24 b(11)g(33)f(66)48
b(a)23 b(four)h(byte)f(key)0 1725 y("Arkansas")142 b("An)23
b(example)g(of)h(a)f(very)h(long)f(\\)406 1782 y(key,)g(that)g(shows)g(some)h
(of)f(the)h(\\)406 1838 y(uses)f(of)h(backslash,)e(such)h(as)h(\\)406
1895 y(for)f(breaking)g(long)g(lines,)g(for)h(\\)406 1951 y(including)e
(\\000)i(oddball)f(characters,)f(\\)406 2008 y(for)h(quoting)g(\\\\)h(and)f
(\\",)h(\\)71 b(freebie)23 b(comment!)406 2064 y(\\)47 b(and)24
b(for)f(resuming)g(scanning)g(\\)406 2120 y(after)g(a)h(hidden)f(line,)g(\\)
406 2290 y(and)g(even)g(hiding)g(multiple)g(blank)g(lines!")0
2346 y("Alaska")47 b("")g(null)23 b(key)h(is)f(not)h(a)g(good)f(idea,)g(but)h
(permitted)0 2403 y(001122334455)46 b("an)24 b(address)e(or)i(key)f(may)h(be)
g(expressed)e(either)h(\\)358 2459 y(as)h(a)f(character)g(string,)g(or)g(as)h
(hex)f(bytes")g(if)h(you)g(want)0 2516 y(0X)g(C0)f(C)h(45)f(74)h(fF)g(Ff)71
b(3141-59:2653;58,97)45 b(punctuation)23 b(run)g(riot)0 2572
y(#and)g(finally,)g(an)h(ordinary)e(comment)0 2629 y
(--------------------------)o(-------)941 2753 y Fr(109)p eop
%%Page: 110 110
109 bop 0 124 a Fl(AUTHORS)0 211 y Fr(David)10 b(C.)i(Schwartz,)g(Sean)g(W)l
(.)g(O'Malley)m(,)f(and)g(Rich)g(Schroeppel.)941 2753 y(110)p
eop
%%Page: 111 111
110 bop 0 124 a Fl(NAME)0 211 y Fr(MachNetIPC)12 b(\(a)g(network)e
(implementation)g(of)h(Mach)h(IPC\))0 336 y Fl(SPECIFICA)l(TION)0
423 y Fr(Mach3)g(Kernel)f(Principles,)f(with)g(appropriate)h(extensions.)0
547 y Fl(SYNOPSIS)0 634 y Fr(MachNetIPC)h(generalizes)f(Mach)h(IPC)g(to)f
(work)f(between)h(machines)g(connected)g(by)g(networking)e(services.)0
758 y Fl(REALM)0 845 y Fr(MachNetIPC)j(is)f(in)g(the)g(anchor)g(protocol)e
(realm;)j(it)f(is)f(speci\256c)h(to)g(the)g(Mach3)h(platform.)0
969 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1056 y Fr(The)e(SSR)g(protocol)f
(communicates)g(trivially)f(with)h(MachNetIPC)i(using)d(two)h(elements)h(in)f
(the)g(participant)g(stack:)14 b(the)0 1113 y(Mach)f(reply)f(port)g(for)g
(the)g(client)g(request,)g(and)g(the)g(IP)h(address)f(of)g(the)g(remote)h
(host.)19 b(T)m(o)12 b(accomplish)f(this,)h(SSR)h(and)0 1169
y(MachNetIPC)f(must)f(reside)g(in)g(the)g(same)g(Mach)h(task.)71
1226 y(SSR)h(is)e(only)g(used)h(to)f(bootstrap)f(initial)h(Mach)h(ports.)18
b(All)12 b(other)f(addressing)g(is)g(done)h(implicitly)e(through)h(Mach)0
1282 y(message)g(passing)f(that)h(involves)e(MachNetIPC)j(as)f(an)h
(intermediary)m(.)0 1407 y Fl(CONTROL)g(OPERA)l(TIONS)0 1494
y Fr(There)f(are)h(no)f(control)f(operations.)0 1618 y Fl(CONFIGURA)l(TION)0
1705 y Fr(MachNetIPC)16 b(uses)f(CHAN)h(as)f(its)g(transport)f(protocol,)h
(and)h(BIDCTL)f(for)h(detecting)e(host)g(reboots.)29 b(There)15
b(is)g(an)0 1761 y(unused)10 b(option)g(for)h(two)g(transport)f(protocols,)f
(and)i(that)g(is)g(why)f Fq(udp)22 b Fr(occurs)11 b(in)g(the)g
(con\256guration)f(line:)0 1818 y Fb(name=machripc)22 b
(protocols=chan,udp,bidctl;)71 1874 y Fr(In)13 b(addition,)g(the)h
Fq(srx)f Fr(and)h Fq(rrx)g Fr(protocols)e(must)h(be)h(included)e(in)i(the)f
(con\256guration.)23 b(There)14 b(is)g(a)g(tight)e(interface)0
1931 y(between)f(these)g(and)g(MachNetIPC)h(that)e(is)h(achieved)g(via)g
(subroutine)e(calls,)i(not)g Fq(x)p Fr(-kernel)g(operations.)71
1987 y(See)h(section)e(16)h(for)g(more)h(details)e(on)h(con\256guring)e(and)i
(installing)e(an)i Fq(x)p Fr(-kernel)h(with)e(MachNetIPC.)0
2111 y Fl(CA)-6 b(VEA)l(TS)12 b(and)g(DISCLAIMERS)0 2198 y
Fr(The)i(network)f(port)h(identi\256ers)f(are)i(fragile)f(for)g(the)g(time)g
(being.)25 b(They)14 b(are)g(based)g(on)g(the)g(lower)g(24)g(bits)f(of)h(the)
g(IP)0 2255 y(address)d(and)g(an)g(8)g(bit)f(sequence)h(number)m(.)17
b(This)11 b(is)f(inadequate)h(and)g(will)f(be)h(changed)g(in)g(the)f(near)i
(future.)71 2311 y(Behavior)f(under)h(heavy)f(load)g(or)h(with)f(machine)h
(reboots)f(during)f(complex)i(port)f(transfers)h(have)f(not)h(thoroughly)0
2368 y(been)f(tested.)0 2492 y Fl(AUTHOR)0 2579 y Fr(Hilarie)g(Orman)941
2753 y(111)p eop
%%Page: 112 112
111 bop 0 124 a Fl(NAME)0 211 y Fr(NNS)11 b(\(Network)g(Name)h(Service\))0
336 y Fl(SYNOPSIS)0 423 y Fr(NNS)h(provides)e(an)h(entry)g(point)f(to)h
(MachNetIPC)i(using)d(the)h(netname)h(interface.)20 b(A)12
b(registry)g(mapping)g(service)g(can)0 479 y(be)k(accessed)f(using)f(the)h
(MIG)h(generated)g(netname)f(interface)h(routines:)23 b(netname)p
1400 479 14 2 v 16 w(check)p 1522 479 V 17 w(in,)16 b(netname)p
1756 479 V 17 w(check)p 1879 479 V 16 w(out)0 535 y(and)e(netname)p
237 535 V 16 w(look)p 335 535 V 16 w(up.)25 b(Documentation)13
b(for)h(the)g(netname)h(interface)f(can)h(be)f(found)g(either)g(in)f
(/usr/mach/man)h(or)0 592 y(in)h(the)h(xkernel)f(distribution)d(in)k
Fg(mach3/api/netipc/netname)p 1087 592 V 17 w(*.3)g Fr(manpages.)30
b(NNS)16 b(will)e(not)h(interfere)h(with)f(a)0 648 y(previously)h(executing)g
(name)i(server)m(.)36 b(T)m(o)17 b(guarantee)h(that)f(NNS)g(is)g(being)g
(used)g(during)f(checkins,)j(lookups)c(and)0 705 y(checkouts,)i(do)e(a)i
(lookup)d(on)i(the)g(service)g(\252NetworkNameServer)r(\272)h(and)e(use)h
(the)g(associated)f(port)h(as)g(the)g(default)0 761 y(name)e(server)g(port.)
24 b(That)13 b(way)h(requests)f(will)g(not)g(mistakenly)f(be)i(directed)f(to)
g(another)h(name)g(server)g(instead.)23 b(See)0 818 y
(mach3/user/netipc/test/n)o(nst)o(est.c)9 b(for)i(more)h(details.)0
942 y Fl(REALM)0 1029 y Fr(NNS)f(is)g(in)g(the)g(anchor)g(protocol)e(realm;)j
(it)f(is)f(speci\256c)i(to)e(the)h(Mach3)h(platform.)0 1153
y Fl(CONFIGURA)l(TION)0 1240 y Fr(Broadcast)c(name)h(lookup)d(requests)h(are)
i(handled)e(using)g(the)h(UDP)g(protocol.)14 b(NNS)8 b(depends)g(on)f(the)h
(BIDCTL)h(protocol)0 1297 y(to)g(detect)g(reboots.)15 b(Additionally)7
b(the)i(SSR)h(protocol)e(must)h(be)h(con\256gured)f(below)f(NNS.)i(See)g
(notes)f(below)g(for)g(details)0 1353 y(of)i(their)g(interface.)0
1410 y Fb(name=nns)23 b(protocols=udp,)f(bidctl;)0 1534 y Fl(NOTES)0
1621 y Fr(NNS)e(utilizes)f(the)h(SSR)h(protocol)e(for)h(bootstrapping)d
(remote)k(host)e(ports)g(into)g(MachNetIPC.)j(NNS)e(and)g(SSR)0
1677 y(communicate)10 b(using)f(a)h(globally)e(de\256ned)i(Mach)h(port)e
(which)g(requires)h(that)f(they)h(be)g(con\256gured)f(into)g(the)h(same)g
(Mach)0 1734 y(task.)0 1858 y Fl(CA)-6 b(VEA)l(TS)12 b(and)g(DISCLAIMERS)0
1945 y Fr(T)m(o)i(specify)f(a)h(host)f(in)h(the)g(remote)g(lookup,)g(use)f
(the)h(IP)h(address)e(of)h(the)g(host)f(and)h(not)f(the)h(host)f(name.)25
b(Host)14 b(name)0 2002 y(resolutions)9 b(are)j(currently)e(not)h(supported.)
71 2058 y(Only)f(a)h(single)f(instance)h(of)g(NNS)g(may)h(run)f(at)g(any)g
(time.)0 2182 y Fl(AUTHOR)0 2269 y Fr(Hasnain)f(Karampurwala)941
2753 y(112)p eop
%%Page: 113 113
112 bop 0 124 a Fl(NAME)0 211 y Fr(RA)-5 b(T)11 b(\()h(Record)f(Accessed)g
(TCP)h(\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(RA)-5 b(T)11
b(uses)g(TCP)h(to)e(ship)g(very)i(lar)o(ge)f(packets)g(to)f(remote)i(hosts.)0
547 y Fl(SYNOPSIS)0 634 y Fr(RA)-5 b(T)11 b(is)f(a)h(protocol)e(uses)h(TCP)h
(to)f(send)h(very)f(lar)o(ge)h(packets)f(to)g(remote)h(hosts.)k(The)c
(current)f(implementation)f(of)i(RA)-5 b(T)0 690 y(manages)13
b(a)h(single)e(TCP)h(connection)f(between)h(each)g(host)f(pair)m(.)23
b(Messages)13 b(pushed)f(to)h(RA)-5 b(T)13 b(are)g(in)g(turn)g(pushed)f(to)0
747 y(TCP)-5 b(.)14 b(Unlike)e(TCP)i(RA)-5 b(T)13 b(preserves)h(packet)f
(boundaries.)21 b(One)13 b(the)g(receiving)g(end)g(RA)-5 b(T)13
b(reconstructs)g(the)g(original)0 803 y(packet)f(from)h(an)g(arbitrary)f
(list)f(of)i(buf)o(fers)g(handed)f(to)g(it)g(by)g(TCP)-5 b(.)13
b(RA)-5 b(T)13 b(should)e(be)h(able)h(to)f(accept)g(packets)g(as)h(lar)o(ge)0
860 y(as)e(the)g(message)g(tool)g(implementation)e(supports.)71
916 y(Note)j(that)g(RA)-5 b(T)13 b(is)f(totally)f(responsible)g(for)i(the)f
(management)h(of)g(the)f(TCP)i(connection.)20 b(In)12 b(the)h(current)f
(imple-)0 973 y(mentation)e(this)g(connection)g(is)h(not)f(opened)g(until)g
(a)i(message)f(is)g(pushed)f(to)g(RA)-5 b(T)m(.)12 b(In)f(the)g(future)f
(more)i(than)f(one)g(TCP)0 1029 y(connections)e(between)i(any)g(two)g(hosts)f
(could)g(be)h(supported)f(without)f(af)o(fecting)i(the)g(protocols)f(which)g
(use)h(RA)-5 b(T)m(.)71 1085 y(Currently)10 b(a)i(compiled)e(constant)g(in)h
(RA)-5 b(T)11 b(determines)g(the)g(TCP)h(send)e(and)h(receive)h(buf)o(fer)f
(sizes.)71 1142 y(RA)-5 b(T)14 b(will)f(almost)g(always)h(perform)g(worse)g
(than)g(BLAST)g(on)g(packets)f(that)h(are)g(small)g(enough)f(for)h(BLAST)h
(to)0 1198 y(deliver)m(.)71 1255 y(RA)-5 b(T)16 b(uses)f(any)h(message)g
(attribute)f(attached)g(to)h(the)f(outgoing)f(message)i(to)g(communicate)g
(the)g(fact)g(that)f(it)h(is)0 1311 y(reliable)11 b(to)f(some)i(higher)e
(level)h(protocol)f(\(in)h(this)f(case)h(CHAN\).)0 1436 y Fl(REALM)0
1523 y Fr(RA)-5 b(T)11 b(is)g(in)g(the)g(ASYNC)g(realm.)0 1647
y Fl(P)l(AR)n(TICIP)l(ANTS)0 1734 y Fr(The)f(interface)g(to)g(RA)-5
b(T)10 b(is)f(intended)g(to)h(look)f(as)h(much)g(like)f(IP)-5
b(,)11 b(VNET)m(,)f(and)f(BLAST)i(as)f(possible.)k(RA)-5 b(T)10
b(assumes)g(that)0 1790 y(the)j(\256rst)g(participant)g(passed)f(to)h(it)g
(at)h(open)f(time)g(contains)f(the)h(IP)h(address)f(of)h(the)f(remote)h
(host.)22 b(RA)-5 b(T)13 b(openEnable)0 1847 y(takes)e(participant)e(which)i
(is)f(ignored.)16 b(OpenEables)10 b(are)i(based)e(upon)g(the)h(protocol)f(ID)
h(of)g(the)g(higher)g(level)f(protocol.)0 1971 y Fl(CONTROL)i(OPERA)l(TIONS)0
2058 y Fr(RA)-5 b(T)11 b(passes)g(all)g(control)f(operations)f(to)i(IP)h(the)
f(second)f(protocol)g(con\256gured.)0 2182 y Fl(CONFIGURA)l(TION)0
2269 y Fr(RA)-5 b(T)11 b(is)g(not)f(freely)i(composable.)k(It)11
b(must)g(be)g(con\256gured)g(as)g(follows:)71 2326 y(name=rat)g
(protocols=tcp,)e(ip)71 2382 y(RA)-5 b(T)14 b(has)g(been)g(designed)e(to)i
(work)g(under)g(VSIZE)g(with)f(either)g(BLAST)m(,)i(VNET)m(,)e(or)h(IP)h(as)f
(the)g(short)f(message)0 2439 y(protocol.)27 b(bigskip)0 2495
y(RA)-5 b(T)11 b(recognizes)g(the)g(following)e(ROM)j(options:)71
2564 y Fb(rat/xxx)22 b(sourcePort)h(N)p Fr(:)10 b(Instantiation)d
Fq(xxx)k Fr(of)f(RA)-5 b(T)11 b(will)e(use)h(port)f(N)h(as)h(its)e(TCP)i
(source)e(port.)16 b(If)11 b(N)f(is)g(equal)0 2621 y(to)h(zero)g(TCP)h(will)e
(chose)h(a)h(port)e(at)h(random.)941 2753 y(113)p eop
%%Page: 114 114
113 bop 71 124 a Fb(rat/xxx)22 b(destPort)h(N)p Fr(:)16 b(Instantiation)e
Fq(xxx)k Fr(of)e(RA)-5 b(T)17 b(will)e(use)h(port)g(N)h(as)f(its)g(TCP)h
(destination)d(port.)32 b(Each)0 181 y(instance)10 b(of)i(RA)-5
b(T)11 b(must)g(have)g(its)f(own)h(destination)e(port.)0 330
y Fl(AUTHORS)0 417 y Fr(David)h(C.)i(Schwartz)g(and)f(Sean)h(W)l(.)f
(O'Malley)941 2753 y(114)p eop
%%Page: 115 115
114 bop 0 124 a Fl(NAME)0 211 y Fr(RRX)12 b(\(transfer)f(Mach)h(receive)g
(right\).)0 336 y Fl(SYNOPSIS)0 423 y Fr(RRX)18 b(is)f(a)h(receive-right)f
(transfer)g(protocol.)34 b(T)n(ransferring)17 b(a)h(receive)g(right)e
(involves)g(coordination)f(among)i(the)0 479 y(original)10
b(holder)h(of)h(the)g(receive)g(right,)f(the)g(new)h(holder)f(of)h(the)f
(receive)h(right,)g(and)f(all)h(of)f(the)h(holders)e(of)i(send)f(rights)0
535 y(to)g(the)g(port.)0 660 y Fl(EXTERNAL)i(INTERF)l(ACE)0
747 y Fr(RRX)g(uses)f(subroutine)e(calls)i(to)f(accept)i(transfer)f
(requests,)g(and)g(to)g(keep)g Fq(MachNetIPC)g Fr(apprised)g(of)g(the)g
(movement)0 803 y(of)f(receive)h(rights.)0 928 y Fl(CONFIGURA)l(TION)0
1015 y Fr(RRX)g(depends)e(on)h(a)g(synchronous)f(lower)g(protocol)g(and)h
(BIDCTL)h(to)f(detect)f(reboots.)0 1071 y Fb(name=rrx)23 b(protocols=chan,)f
(bidctl;)0 1195 y Fl(AUTHOR)0 1282 y Fr(Ed)11 b(Menze)941 2753
y(115)p eop
%%Page: 116 116
115 bop 0 124 a Fl(NAME)0 211 y Fr(SELECT)11 b(\(RPC)h(Select)g
(Micro-Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(S.)g(O'Malley)g(and)
f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fq(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479
y(10)p Fr(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 560 y(B.)i(W)l(elch.)21
b Fq(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fr(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 617 y(86/302,)d(June)h(1986.)0 741 y Fl(SYNOPSIS)0
828 y Fr(SELECT)16 b(is)g(a)h(micro-protocol)e(that)h(performs)h(the)f
(addressing)f(function)g(of)i(Sprite)f(RPC;)h(i.e.,)i(it)d(demultiplexes)0
885 y(request)11 b(messages)g(to)f(the)h(appropriate)g(procedure.)0
1009 y Fl(REALM)0 1096 y Fr(SELECT)g(is)g(in)f(the)h(RPC)i(realm.)0
1220 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1307 y Fr(SELECT)g(removes)h(a)g(pointer)e
(to)h(a)h(long)e(\(the)h(remote)h(procedure)g(number\))f(from)h(the)f(top)g
(of)h(the)f(stack)g(of)g(the)g(\256rst)0 1364 y(participant.)0
1488 y Fl(CONFIGURA)l(TION)0 1575 y Fr(SELECT)e(expects)g(one)g(RPC)h(realm)g
(protocol)e(below)g(it.)0 1699 y Fl(AUTHOR)0 1786 y Fr(Sean)i(O'Malley)941
2753 y(116)p eop
%%Page: 117 117
116 bop 0 124 a Fl(NAME)0 211 y Fr(SIMSIMETH)12 b(\()g(Simulated)f(Simulated)
f(Ethernet)h(Driver)g(Protocol\))0 336 y Fl(SPECIFICA)l(TION)0
423 y Fr(SIMSIMETH)j(simulates)e(an)h Fq(x)p Fr(-kernel)h(ethernet)f(driver)f
(by)h(sending)f(and)h(receiving)f(messages)h(using)f(any)h(x-kernel)0
479 y(protocol)g(that)g(accepts)h(UDP)h(addresses.)24 b(SIMSIMETH)16
b(is)d(platform)h(independent.)24 b(SIMSIMETH)15 b(interoperates)0
535 y(with)c(SIMETH)i(\()g(and)f(itself\).)20 b(SIMSIMETH')m(s)14
b(primary)e(purpose)g(is)f(to)h(support)f(the)h(testing)f(of)i(protocols)e
(between)0 592 y(x-kernel)k(simulators)g(such)g(as)h(the)f(SunOS)h(simulator)
f(and)g(native)g(mode)h(x-kernel)f(implementations)f(such)i(as)f(the)0
648 y(Mach)d(3.0)f(implementation.)0 773 y Fl(SYNOPSIS)0 860
y Fr(Each)f(instantiation)d(of)k(SIMSIMETH)g(associates)e(a)h
Fq(simulated)f Fr(Ethernet)g(address)h(with)f(a)h(speci\256c)g(UDP)h(address)
e(and)0 916 y(simulates)g(an)i(Ethernet)e(driver)h(for)h(a)f(single)f
(interface.)17 b(SIMSIMETH)11 b(reads)g(the)f(UDP)g(port)g(from)h(the)f(ROM)h
(\256le)f(and)0 973 y(gets)h(its)f(IP)i(address)e(by)h(performing)g(a)h
(GETMYHOST)e(control)g(operation)g(on)h(the)g(protocol)f(con\256gured)h
(below)f(it.)71 1029 y(The)k(mapping)f(between)h(Unix)g(UDP)g(ports)f(and)i
(SIMSIMETH)g(Ethernet)f(addresses)f(is)h(very)g(simple.)26
b(The)14 b(six)0 1085 y(bytes)g(of)g(SIMSIMETH)i(Ethernet)d(address)h(are)h
(formed)g(by)f(the)g(concatenation)f(of)i(the)f(four)g(byte)g(IP)h(host)e
(number)0 1142 y(for)g(the)g(Unix)f(host)h(on)f(which)h(the)g(simulator)f(is)
g(running)g(and)h(the)g(two)f(byte)h(UDP)g(port)g(used)f(by)h(the)g
(SIMSIMETH)0 1198 y(instantiation.)20 b(Note)13 b(that)g(this)f(IP)i(host)e
(must)h(be)g(valid)g(and)g(de\256ned)g(by)g(the)g(protocol)f(graph)h(below)g
(SIMSIMETH.)0 1255 y(Since)h(one)g(generally)f(runs)g(two)g(copies)h(of)f
(ARP)i(when)e(SIMSIMETH)i(is)f(con\256gured)f(keeping)g(your)g(IP)i
(addresses)0 1311 y(straight)10 b(is)g(sometimes)h(dif)o(\256cult.)16
b(See)c(the)f(CONFIGURA)-5 b(TION)11 b(section)f(below)m(.)71
1368 y(When)i(a)h(message)g(is)f(sent)h(using)e(SIMSIMETH)j(a)f(map)g(is)g
(checked)f(to)h(see)g(if)f(a)i(lower)e(level)g(session)g(exists)f(for)0
1424 y(that)d(destination)f(address.)15 b(If)10 b(no)e(lower)h(level)g
(session)e(exists)h(one)h(is)f(created)h(by)g(performing)g(an)g(open)f(on)h
(the)g(protocol)0 1481 y(con\256gured)h(below)f(SIMSIMETH)j(\(most)e
(probably\))f(UDP)-5 b(.)11 b(Once)f(SIMSIMETH)i(has)e(opened)f(a)i(lower)f
(level)g(session)0 1537 y(it)k(is)f(never)i(closed.)25 b(SIMSIMETH)15
b(then)f(pushes)f(an)i(Ethernet)e(header)i(on)e(the)h(message)h(and)f(pushes)
f(the)h(message)0 1594 y(using)e(the)h(lower)f(level)h(session.)21
b(When)13 b(a)g(packet)g(arrives)g(at)g(SIMSIMETH)i(the)e(Ethernet)f(header)h
(is)g(removed)g(and)0 1650 y(SIMSIMETH)f(presents)f(the)g(packet)g(received)g
(as)g(an)g(incoming)f(Ethernet)h(packet.)71 1706 y(Note)e(that)h(an)g
Fq(x)p Fr(-kernel)h(may)f(be)h(con\256gured)f(with)f(multiple)g
(instantiation)o(s)f(of)i(SIMSIMETH,)i(each)e(with)f(its)h(own)0
1763 y(UDP)j(port,)f(to)g(simulate)g(a)h(multihomed)e(host.)19
b(SIMSIMETH)14 b(can)f(awkwardly)e(simulate)h(Ethernet)g(broadcast)g(mes-)0
1819 y(sages.)19 b(When)12 b(an)g(outgoing)e(broadcast)i(message)g(is)g(sent)
f(to)h(SIMSIMETH,)i(SIMSIMETH)f(asks)f(its)f(corresponding)0
1876 y(ARP)k(protocol)e(for)i(a)g(dump)f(of)g(all)g(hosts)g(in)g(its)f
(table.)26 b(SIMSIMETH)16 b(then)e(sends)f(the)i(message)f(to)g(each)h(of)g
(these)0 1932 y(hosts)c(in)h(a)h(point-to-point)c(fashion.)20
b(Note)12 b(that)f(for)i(a)g(reasonable)f(simulation)e(of)j(Ethernet)f
(broadcast,)g(all)g Fq(x)p Fr(-kernels)0 1989 y(in)f(communication)f(should)f
(have)j(the)f(same)g(ARP)h(table)f(\(see)g(the)g(ARP)h(appendix.\))71
2045 y(The)7 b(primary)h(purpose)f(of)h(SIMSIMETH)g(is)g(to)f(allow)g
(simulated)g(x-kernels)g(and)g(native)g(x-kernels)g(to)h(interoperate.)0
2102 y(This)g(is)h(possible)e(because)i(SIMSIMETH)i(interoperates)d(with)g
(the)h(SIMETH)g(protocol.)15 b(Interoperability)7 b(is)h(achieved)0
2158 y(as)17 b(follows.)31 b(The)17 b(graph.comp)g(\256le)g(for)g(the)f
(simulated)g(x-kernel)g(is)g(unchanged)g(and)g(is)h(rooted)f(at)g(SIMETH)h
(the)0 2215 y(simulated)9 b(Ethernet)g(driver)m(.)16 b(The)10
b(graph.comp)g(for)g(the)g(machine)g(running)e(a)j(native)e(x-kernel)h(must)f
(contain)g(the)h(same)0 2271 y(graph)f(in)g(the)g(simulated)f(version)g
(except)h(that)g(SIMSIMETH)h(is)f(con\256gured)g(instead)f(of)h(SIMETH)h(and)
f(SIMSIMETH)0 2327 y(is)14 b(con\256gured)g(on)g(top)g(of)g(the)h(standard)e
(Internet)h(protocol)g(graph.)26 b(If)15 b(the)f(following)e(was)j(the)f
(graph.comp)g(on)g(the)0 2384 y(SunOS)d(simulator:)0 2490 y
Fb(#SunOS)23 b(Graph.comp)0 2547 y(@;)0 2603 y(name=simeth;)941
2753 y Fr(117)p eop
%%Page: 118 118
117 bop 0 124 a Fb(name=eth)23 b(protocols=simeth;)0 181 y(name=arp)g
(protocols=eth;)0 237 y(name=vnet)g(protocols=eth,arp;)0 294
y(name=ip)g(protocols=vnet;)0 350 y(name=udp)g(protocols=ip;)0
407 y(name=udptest)f(protocols=udp;)0 463 y(@;)0 519 y(prottbl)h(=)h
(../prottbl.simsimeth;)71 626 y Fr(The)11 b(corresponding)e(graph)i(for)g
(the)g(native)g(mode)g(x-kernel)g(would)f(be:)0 732 y Fb(#Mach)23
b(3.0)h(Graph.comp)0 788 y(@;)0 845 y(name=ethdrv/SE0;)0 901
y(name=eth/lower)e(protocols=ethdrv/SE0;)0 958 y(name=arp/lower)g
(protocols=eth/lower;)0 1014 y(name=vnet/lower)g(protocols=eth/lower,arp/l)o
(ower;)0 1071 y(name=ip/lower)g(protocols=vnet/lower;)0 1127
y(name=icmp/lower)g(protocols=ip/lower;)0 1184 y(name=udp/lower)g
(protocols=ip/lower;)0 1240 y(name=simsimeth)g(protocols=udp/lower;)0
1297 y(name=eth/upper)g(protocols=simsimeth;)0 1353 y(name=arp/upper)g
(protocols=eth/upper;)0 1409 y(name=vnet/upper)g(protocols=eth/upper,arp/u)o
(pper;)0 1466 y(name=ip/upper)g(protocols=vnet/upper;)0 1522
y(name=udp/upper)g(protocols=ip/upper;)0 1579 y(name=udptest)g
(protocols=udp/upper;)0 1635 y(@;)0 1692 y(prottbl)h(=)h
(../prottbl.simsimeth;)71 1798 y Fr(The)9 b Fb(/lower)g Fr(protocols)f(in)h
(the)g(above)h(graph.comp)f(correspond)g(to)g(the)g(Internet)h(protocol)e
(suite)h(implemented)g(in)0 1854 y(the)h(SunOS)h(kernel.)16
b(The)10 b Fb(/upper)g Fr(protocols)f(correspond)h(the)g(protocols)f(running)
g(on)h(the)g(simulated)g(x-kernel.)16 b(Note)0 1911 y(that)d(the)h(protocol)f
(table)h(used)f(by)h(a)g(kernel)g(running)f(SIMSIMETH)i(must)f(de\256ne)g
(the)g(correct)g(\(800\))g(relative)g(ETH)0 1967 y(protocol)c(id)h(for)g(IP)h
(for)f(this)f(technique)g(to)h(work.)71 2024 y(There)18 b(must)f(be)h(a)g
(similar)g(correspondence)f(between)g(the)h(ROM)h(\256les)e(on)h(the)f(SunOS)
h(side)g(and)f(the)h(native)0 2080 y(Mach)d(3.0)f(side.)25
b(This)14 b(can)g(be)g(a)h(bit)e(confusing,)h(and)g(automated)g(tools)f(are)i
(provided)e(to)h(help)f(produce)h(consistent)0 2137 y(SIMSIMETH)9
b(ROM)g(\256les)e(\(see)i(section)d(13.2.1\).)16 b(The)8 b(following)d(is)j
(an)g(example)g(ROM)g(\256le)g(for)g(the)g(SunOS)g(platform:)0
2243 y Fb(simeth)23 b(9875)0 2299 y(eth)g(mtu)h(1400)0 2356
y(arp)f(192.12.69.1)g(192.12.69.67)f(9875)0 2412 y(arp)h(192.12.69.2)g
(192.12.69.99)f(1234)71 2519 y Fr(While)10 b(the)h(following)e(is)i(an)g
(example)g(ROM)h(\256le)g(for)f(the)g(Mach)h(3)f(platform:)0
2625 y Fb(arp/lower)118 b(192.12.69.99)94 b(08:00:2b:23:6d:ec)21
b(#)j(mozart)941 2753 y Fr(118)p eop
%%Page: 119 119
118 bop 0 124 a Fb(simsimeth)23 b(1234)0 181 y(eth/upper)g(mtu)g(1400)0
237 y(arp/upper)g(192.12.69.1)f(c0:0c:45:43:26:93)g(#)h(translation:)46
b(192.12.69.67)23 b(9875)0 294 y(arp/upper)g(192.12.69.2)f(c0:0c:45:63:04:d2)
g(#)h(translation:)46 b(192.12.69.99)23 b(1234)71 400 y Fr(The)13
b(SunOS)h(ROM)h(\256le)f(is)f(identical)g(to)g(the)h(standard)f(ROM)i(\256le)
f(except)f(for)h(the)g(addition)e(of)i(a)g(line)f(to)h(set)f(the)0
456 y(Ethernet)7 b(MTU)h(to)g(1400)f(bytes.)15 b(If)8 b(the)g(default)f(MTU)i
(of)f(1500)f(bytes)g(were)h(to)g(be)g(used)g(SunOS)g(IP)g(would)f(fragment)h
(the)0 513 y(outgoing)h(simulated)g(Ethernet)h(packets)g(into)g(two)g(real)h
(Ethernet)f(packets)h(of)f(1500)g(bytes)g(and)h(64)f(bytes)g(respectively)m
(.)0 569 y(This)15 b(pattern)g(of)g(packets)g(can)h(result)f(in)g(a)h
(serious)f(increase)g(in)g(the)h(number)f(of)h(dropped)f(packets.)29
b(The)15 b(MTU)h(of)0 626 y(the)c(simulated)g(Ethernet)g(driver)g(on)g(the)h
(Mach)g(platform)f(\(eth/upper\))g(is)g(also)g(set)h(to)f(1400)f(bytes)h(to)g
(avoid)g(the)h(same)0 682 y(problem.)25 b(Note)14 b(you)g(should)e(always)i
(manually)g(set)g(the)g(MTU')m(s)g(of)h(the)f(simulated)f(Ethernet)g(drivers)
h(to)g(the)g(same)0 739 y(number!)71 795 y(The)e(ROM)i(for)f(Mach)h(3.0)f
(must)f(be)h(changed)g(to)f(set)h(the)f(appropriate)g(IP)i(to)e(Ethernet)g
(address)h(correspondence)0 852 y(for)h(the)f(real)h(ARP)g(\(ARP/lower\).)24
b(While)13 b(the)g(simulated)g(ARP)h(\(ARP/upper\))g(must)f(be)g
(con\256gured)h(with)e(the)i(same)0 908 y(information)i(as)h(given)f(in)g
(the)h(SunOS)f(ROM)i(\256le.)34 b(This)16 b(is)g(made)i(more)f(complex)g
(because)g(ARP)g(on)g(Mach)g(3.0)0 964 y(platforms)12 b(expects)g(real)h
(Ethernet)f(addresses)g(while)g(the)g(ARP)i(on)e(the)g(SunOS)h(platform)f
(expects)g(to)h(\256nd)f(simulated)0 1021 y(Ethernet)f(address.)18
b(Therefore)12 b(the)g(user)g(must)f(manually)g(convert)h(a)g(port)f(IP)i
(address)e(pair)h(into)f(an)h(Ethernet)f(address)0 1077 y(using)f(the)i
(algorithm)f(given)g(above.)18 b(For)12 b(example)g(the)f("Ethernet)g
(address":)16 b(c0:0c:45:43:26:)o(93)9 b(is)i(simply)g(the)g(hex)0
1134 y(translation)e(of)i(192.12.69.67)f(9875.)71 1190 y(Note)22
b(that)g(when)h(the)f(client)g(is)h(started)f(it)h(should)e(be)i(passed)f
(the)h(simulated)f(IP)h(address)f(of)h(the)g(server)0 1247
y(\(192.12.69.1or2\))10 b(not)h(the)f(real)i(IP)g(address)e(of)i(the)f
(server)m(.)71 1303 y(Example)19 b(graph.comp,)j(ROM,)f(and)e(protocol)f
(table)h(\256les)h(can)g(be)g(found)e(in)i(the)f Fg(xkernel/build/T)-5
b(emplate)0 1360 y Fr(directory)m(,)11 b(though)e(they)i(are)h(speci\256c)f
(to)g(the)g(cs.arizona.edu)g(site)g(and)g(will)f(have)h(to)g(be)g(customized)
f(for)i(other)f(sites.)0 1484 y Fl(REALM)0 1571 y Fr(SIMSIMETH)c(is)g(in)g
(the)g(ASYNC)g(realm,)h(supporting)f(the)g(Ethernet)g(d)o(river)g(int)o
(erface)g(described)g(in)g(th)o(e)g(ETH)g(append)o(ix.)0 1695
y Fl(P)l(AR)n(TICIP)l(ANTS)0 1782 y Fr(SIMSIMETH)15 b(supports)e(the)h
(Ethernet)f(driver)h(interface)g(rather)g(than)g(a)g(standard)g(xkernel)f
(UPI)i(interface)f(and)g(thus)0 1839 y(makes)d(no)g(use)g(of)g(participant)f
(stacks.)0 1963 y Fl(CONTROL)i(OPERA)l(TIONS)0 2050 y Fb(ETH)p
75 2050 15 2 v 17 w(REGISTER)p 284 2050 V 16 w(ARP:)22 b Fr(Used)13
b(by)f(an)h(ARP)g(instantiation)d(to)j(register)f(itself)g(with)g(its)g
(corresponding)f(SIMSIMETH)114 2106 y(driver)m(.)18 b(This)10
b(is)h(used)g(to)g(simulate)g(Ethernet)g(broadcasts)f(as)i(described)f
(above.)17 b(If)12 b(no)g(ARP)g(protocol)e(registers)114 2163
y(with)g(a)h(SIMSIMETH)i(instantiation)o(,)c(broadcasts)h(on)h(that)g
(instantiation)d(will)i(not)g(be)i(possible.)114 2257 y(Input:)21
b Fb(XObj)i(/*)h(ARP)f(protocol)g(object)g(*/)114 2330 y Fr(Output:)d(none)0
2454 y Fl(EXTERNAL)13 b(INTERF)l(ACE)0 2541 y Fr(SIMSIMETH)f(supports)e(the)h
(Ethernet)f(driver)h(interface)g(described)g(in)g(the)f(ETH)h(appendix.)941
2753 y(119)p eop
%%Page: 120 120
119 bop 0 124 a Fl(CONFIGURA)l(TION)0 211 y Fr(SIMSIMETH)11
b(should)e(be)h(con\256gured)f(on)h(top)f(of)h(any)g(protocol)e(that)i(takes)
f(UDP)h(addresses)g(and)f(below)h(any)g(protocol)0 268 y(which)h(supports)f
(the)h(ETH)g(lower)g(level)g(driver)h(interface.)17 b(It)12
b(can)g(be)f(con\256gured)g(in)h(either)f(the)g(driver)g(section)g(or)g(the)0
324 y(protocol)f(section)g(of)h(graph.comp.)0 406 y(SIMSIMETH)h(recognizes)f
(the)g(following)e(ROM)j(options:)71 474 y Fb(simsimeth)22
b(nnnn)p Fr(:)f(This)13 b(instantiation)d(of)k(simsimeth)f(should)f(use)i
(UDP)g(port)f(nnnn.)23 b(There)14 b(must)g(be)g(such)f(a)0
531 y(line)e(for)g(each)h(instantiation)c(of)j(SIMSIMETH)h(in)f(the)g
Fq(x)p Fr(-kernel.)0 655 y Fl(AUTHOR)0 742 y Fr(Sean)h(O'Malley)941
2753 y(120)p eop
%%Page: 121 121
120 bop 0 124 a Fl(NAME)0 211 y Fr(SRX)12 b(\(transfer)f(Mach)h(send)f
(right\).)0 336 y Fl(SYNOPSIS)0 423 y Fr(SRX)16 b(is)g(a)g(send-right)e
(transfer)i(protocol,)g(used)g(to)f(transfer)h(a)g(Mach)h(send)e(right)g
(when)h(there)f(are)i(more)f(than)g(two)0 479 y(parties)d(involved)e(\(i.e.,)
16 b(when)d(the)g(original)f(holder)g(of)i(the)f(send)g(right,)g(the)g(new)h
(holder)e(of)i(the)f(send)g(right,)g(and)g(the)0 535 y(holder)d(of)i(the)f
(receive)g(right)f(are)i(on)f(dif)o(ferent)g(hosts.\))0 660
y Fl(EXTERNAL)i(INTERF)l(ACE)0 747 y Fr(SRX)d(uses)f(subroutine)f(calls)h(to)
g(accept)h(transfer)g(requests,)f(and)h(to)f(notify)g Fq(MachNetIPC)g
Fr(of)h(the)f(arrival)h(of)g(new)f(rights.)0 871 y Fl(CONFIGURA)l(TION)0
958 y Fr(SRX)j(depends)e(on)h(a)g(synchronous)f(lower)g(protocol)g(and)h
(BIDCTL)h(to)f(detect)f(reboots.)0 1015 y Fb(name=srx)23 b(protocols=chan,)f
(bidctl;)0 1139 y Fl(AUTHOR)0 1226 y Fr(Ed)11 b(Menze)941 2753
y(121)p eop
%%Page: 122 122
121 bop 0 124 a Fl(NAME)0 211 y Fr(SSR)12 b(\(a)g(simple)e(name)i(server)g
(protocol)e(for)h(use)g(with)f(MachNetIPC\).)0 336 y Fl(SPECIFICA)l(TION)0
423 y Fr(See)i(the)g(\256le)f(\252ssr)m(.h\272.)18 b(This)11
b(contains)f(the)h(request)g(identi\256er)g(list)f(and)i(the)f(data)g
(structure)g(de\256ning)g(an)g(SSR)i(message.)0 479 y(This)d(is)h(not)f(MiG)i
(generated.)0 603 y Fl(SYNOPSIS)0 690 y Fr(SSR)h(is)f(used)g(for)h
(bootstrapping)c(ports)j(into)f(MachNetIPC.)j(It)f(can)f(register)g(a)h
(server)g(port)e(and)i(forward)f(requests)g(to)0 747 y(its)i(peers)h(on)g
(remote)h(hosts.)27 b(SSR)16 b(listens)d(for)j(messages)f(on)f(its)h(main)g
(port.)28 b(This)14 b(port)g(accepts)i(Mach)f(messages)0 803
y(containing)7 b(a)h(service)h(identi\256er)n(,)g(a)f(request)g(identi\256er)
n(,)h(an)g(IP)g(address,)f(and)h(a)g(Mach)g(reply)f(port.)15
b(The)8 b(requests)g(are)h(sent)0 860 y(to)i(the)g(remote)h(peer)n(,)g(and)f
(the)g(Mach)h(reply)f(port)g(is)g(translated)f(into)g(a)i(MachNetIPC)g(port.)
k(The)c(request)e(is)h(forwarded)0 916 y(to)g(the)g(server)g(registered)g(on)
f(the)h(remote)h(host)e(\(if)h(any\).)17 b(There)11 b(is)g(no)g(reply)g(to)f
(SSR.)0 1040 y Fl(REALM)0 1127 y Fr(SSR)i(is)f(in)f(the)h(anchor)g(protocol)e
(realm;)j(it)e(is)h(speci\256c)g(to)f(the)h(Mach3)g(platform.)17
b(SSR)12 b(communicates)e(with)g(the)h(NNS)0 1184 y(protocol)d(using)h(a)g
(globally)f(de\256ned)i(Mach)g(port;)f(this)g(requires)g(that)g(the)g(two)g
(protocols)f(exist)h(in)g(the)g(same)h(Mach)g(task.)0 1308
y Fl(CONFIGURA)l(TION)0 1395 y Fr(SSR)i(communicates)f(with)f(MachNetIPC)j
(as)e(its)f(only)g(lower)h(protocol.)0 1452 y Fb(name=ssr)23
b(protocols=machripc;)0 1576 y Fl(AUTHOR)0 1663 y Fr(Hilarie)11
b(Orman)941 2753 y(122)p eop
%%Page: 123 123
122 bop 0 124 a Fl(NAME)0 211 y Fr(SUNRPC)12 b(\(Sun)f(Remote)h(Procedure)g
(Call)f(Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fq(Remote)16
b(Pr)n(ocedur)n(e)g(Calls:)26 b(Pr)n(otocol)15 b(Speci\256cation)p
Fr(.)31 b(Sun)16 b(Microsystems,)i(Inc.,)g(Mountain)e(V)m(iew)m(,)i(Calif.,)h
(May)0 479 y(1988.)0 603 y Fl(SYNOPSIS)0 690 y Fr(Sun)10 b(RPC)h(is)f(a)h
(fairly)e(complete)h(implementation)f(of)h(Sun')m(s)h(remote)f(procedure)h
(call)f(protocol.)k(This)c(implementation)0 747 y(is)15 b(compatible)f(with)g
(Sun')m(s)h(native)g(implementation.)26 b(The)15 b(interface)h(to)e(our)h
(implementation)f(of)h(Sun)g(RPC)h(in)f(no)0 803 y(way)f(resembles)h(Sun')m
(s.)27 b(The)14 b(Sun)g(Portmapper)h(is)f(treated)h(as)f(a)h(separate)g
(protocol)e(that)h(sits)f(on)h(top)g(of)g(Sun)h(RPC.)0 860
y(This)10 b(implementation)f(only)h(supports)g(UDP)h(as)g(a)g(lower)g(level)f
(protocol.)15 b(The)c(protocol)f(supports)f(unreliable)h(remote)0
916 y(procedure)k(calls)f(to)g(possibly)f(heterogeneous)h(hosts.)23
b(Our)13 b(implementation)g(of)h(the)f(Sun)h(RPC)h(protocol)d(uses)i(most)0
973 y(but)d(not)f(all)h(of)h(the)f(original)f(Sun)h(RPC)i(include)d(\256les)i
(and)f(XDR)h(\256les.)17 b(Thus,)11 b(you)g(must)g(have)g(access)h(to)f(Sun)g
(include)0 1029 y(and)g(XDR)g(\256les)g(to)g(compile)g(this)f(protocol.)0
1153 y Fl(REALM)0 1240 y Fr(SUNRPC)i(is)f(in)g(the)f(RPC)j(realm.)0
1365 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1452 y Fr(SUNRPC)k(removes)e(three)h
(pointers)e(to)h(longs)f(from)i(the)g(remote)g(participant)e(stack,)i
(representing)f(the)g(procedure,)0 1508 y(version)10 b(and)h(program)h
(number)f(\(starting)f(from)h(the)g(top)g(of)g(the)g(stack.\))71
1565 y(The)g(local)h(participant)e(may)j(be)f(present,)g(in)f(which)g(case)i
(it)e(is)h(passed)f(on)h(untouched)e(to)i(the)f(next)h(protocol,)f(or)h(it)0
1621 y(may)g(be)f(absent.)0 1745 y Fl(CONTROL)h(OPERA)l(TIONS)0
1832 y Fb(SUNRPC)p 147 1832 15 2 v 16 w(CLNTGETERROR:)21 b
Fr(Returns)11 b(an)g(RPC)i(error)e(status)f(structure.)16 b(\(session)10
b(only\))114 1926 y(Input:)21 b(none)114 1999 y(Output:)f Fb(struct)j(rpc)p
517 1999 V 17 w(err)0 2093 y(SUNRPC)p 147 2093 V 16 w(CLNTSETTOUT:)e
Fr(Sets)f(the)g(client)f(timeout)g(value;)24 b(the)19 b(amount)h(of)g(time)g
(the)g(client)f(will)g(wait)g(before)114 2149 y(resending)10
b(the)h(message.)16 b(\(session)10 b(only\))114 2243 y(Input:)21
b Fb(struct)i(timeval)114 2316 y Fr(Output:)d(none)0 2410 y
Fb(SUNRPC)p 147 2410 V 16 w(CLNTGETTOUT:)h Fr(Returns)11 b(the)g(client)f
(timeout)h(value.)16 b(\(session)10 b(only\))114 2504 y(Input:)21
b(none)114 2577 y(Output:)f Fb(struct)j(timeval)941 2753 y
Fr(123)p eop
%%Page: 124 124
123 bop 0 124 a Fb(SUNRPC)p 147 124 15 2 v 16 w(CLNTSETWAIT:)21
b Fr(Sets)12 b(the)f(client)f(wait)h(value,)g(the)h(amount)e(of)i(time)f(the)
g(client)g(will)f(wait)h(before)g(returning)114 181 y(an)g(error)m(.)17
b(\(session)10 b(only\))114 275 y(Input:)21 b Fb(struct)i(timeval)114
348 y Fr(Output:)d(none)0 441 y Fb(SUNRPC)p 147 441 V 16 w(CLNTGETWAIT:)h
Fr(Returns)11 b(the)g(client)f(wait)h(value.)16 b(\(session)10
b(only\))114 535 y(Input:)21 b(none)114 608 y(Output:)f Fb(struct)j(timeval)0
702 y(SUNRPC)p 147 702 V 16 w(GETCREDTYPE:)e Fr(Returns)10
b(the)f(type)g(of)h(authentication)d(credentials)i(used.)15
b(V)-5 b(alid)9 b(types)f(are)j(NULL)e(authen-)114 759 y(tication,)i(Unix)g
(authentication)f(and)h(DES)h(authentication.)17 b(Note)12
b(that)f(the)h(protocol)f(or)h(user)f(above)h(Sun)g(RPC)114
815 y(is)f(completely)g(responsible)f(for)i(all)f(authentication;)e(the)j
(Sun)f(RPC)i(protocol)d(merely)i(copies)f(credentials)g(into)114
871 y(and)g(out)f(of)h(the)g(header)m(.)18 b(\(session)9 b(only\))114
965 y(Input:)21 b(none)114 1038 y(Output:)f Fb(int)0 1132 y(SUNRPC)p
147 1132 V 16 w(GETCRED:)i Fr(Returns)11 b(the)g(authentication)e
(credentials)h(used)h(in)f(an)i(opaque)e(byte)h(string.)k(\(session)10
b(only\))114 1226 y(Input:)21 b(none)114 1299 y(Output:)f Fb(char)k(*)0
1393 y(SUNRPC)p 147 1393 V 16 w(SETCREDTYPE:)d Fr(Sets)12 b(the)e(type)h(of)g
(authentication)e(credentials)i(used)f(\(session)g(only\))114
1487 y(Input:)21 b Fb(int)114 1560 y Fr(output:)f(none)0 1654
y Fb(SUNRPC)p 147 1654 V 16 w(SETCRED:)i Fr(Sets)e(the)f(authentication)f
(credentials)h(used)g(in)g(an)h(opaque)g(byte)f(string)f(\(already)i(xdr)r
('ed\).)114 1710 y(\(session)9 b(only\))114 1804 y(Input:)21
b Fb(char)i(*)114 1877 y Fr(Output:)d(none)0 1971 y Fb(SUNRPC)p
147 1971 V 16 w(GETVERFTYPE:)h Fr(Returns)15 b(the)g(type)g(of)g
(authentication)e(veri\256cation)h(used.)28 b(V)-5 b(alid)14
b(types)h(are)g(NULL)g(au-)114 2027 y(thentication,)9 b(Unix)h
(authentication,)g(and)h(DES)g(authentication.)j(\(session)c(only\))114
2121 y(Input:)21 b(none)114 2194 y(Output:)f Fb(int)0 2288
y(SUNRPC)p 147 2288 V 16 w(GETVERF:)i Fr(Returns)8 b(the)h(authentication)d
(veri\256cation)i(used)h(contained)e(in)i(an)g(opaque)f(byte)g(string.)15
b(\(session)114 2344 y(only\))114 2438 y(Input:)21 b(none)114
2511 y(Output:)f Fb(char)k(*)0 2605 y(SUNRPC)p 147 2605 V 16
w(SETVERFTYPE:)d Fr(Sets)12 b(the)e(type)h(of)g(authentication)e
(veri\256cation)i(used.)16 b(\(session)10 b(only\))941 2753
y(124)p eop
%%Page: 125 125
124 bop 114 124 a Fr(Input:)21 b Fb(int)114 197 y Fr(Output:)f(none)0
291 y Fb(SUNRPC)p 147 291 15 2 v 16 w(SETVERF:)i Fr(Sets)16
b(the)g(authentication)e(veri\256cation)h(used)h(contained)f(in)h(an)g
(opaque)g(byte)f(string)g(\(already)114 348 y(xdr)r('ed\))10
b(\(session)g(only\))114 441 y(Input:)21 b Fb(char)i(*)114
514 y Fr(Output:)d(none)0 608 y Fb(SUNRPC)p 147 608 V 16 w(SVCAUTHERR:)i
Fr(Causes)10 b(session)e(to)i(return)g(authentication)e(error)j(message)f
(and)g(terminate.)16 b(\(session)9 b(only\))114 702 y(Input:)21
b Fb(char)i(*)114 775 y Fr(Output:)d(none)0 869 y Fb(SUNRPC)p
147 869 V 16 w(SVCSYSTEMERR:)h Fr(Causes)11 b(session)f(to)h(return)g(a)g
(system)g(error)h(message)f(and)g(terminate.)16 b(\(session)10
b(only\))114 963 y(Input:)21 b Fb(char)i(*)114 1036 y Fr(Output:)d(none)0
1160 y Fl(CONFIGURA)l(TION)0 1247 y Fr(SUNRPC)e(is)e(a)h(realm)g(boundary)f
(protocol)f(which)h(assumes)h(its)e(lower)i(protocol)e(is)h(symmetric)h(\(in)
g(the)f(ASYNC)0 1304 y(realm.\))0 1360 y Fb(name=sunrpc)22
b(protocols=udp;)0 1484 y Fl(AUTHORS)0 1571 y Fr(Sean)12 b(O`Malley)f(and)g
(Richard)g(Schroeppel)941 2753 y(125)p eop
%%Page: 126 126
125 bop 0 124 a Fl(NAME)0 211 y Fr(Sun)11 b(Portmapper)0 336
y Fl(SPECIFICA)l(TION)0 423 y Fq(?)16 b Fr(Sun)11 b(Microsystems,)g(Inc.,)h
(Mountain)e(V)m(iew)m(,)i(Calif.,)g(May)f(1988.)0 547 y Fl(SYNOPSIS)0
634 y Fr(The)17 b(portmapper)g(supports)f(four)h(of)h(the)f(\256ve)h(of)f
(the)g(procedures)g(de\256ned)g(by)g(Sun.)36 b(Indirect)16
b(Call,)k(Function)c(5,)0 690 y(is)e(not)g(implemented.)28
b(This)13 b(implementation)h(is)g(compatible)g(with)g(Sun')m(s)h(native)f
(implementation.)26 b(The)15 b Fq(x)p Fr(-kernel)0 747 y(portmapper)10
b(is)f(treated)h(as)g(a)g(separate)g(protocol)e(that)i(sits)e(on)i(top)f(of)h
(the)f Fq(x)p Fr(-kernel)i(implementation)d(of)i(Sun)g(RPC.)h(This)0
803 y(implementation)e(only)g(supports)g(UDP)h(as)h(a)f(lower)g(level)g
(protocol.)15 b(Client)10 b(and)g(server)h(protocols)d(running)h(above)h(the)
0 860 y(sunrpc)j(protocol)g(make)h(remote)h(procedures)e(calls)h(to)f(the)h
(portmapper)n(,)h(using)d(its)i(well-known)e(UDP)i(port)f(number)0
916 y(111.)71 973 y(Our)f(implementation)e(of)i(the)g(Sun)g(Portmapper)h
(protocol)e(uses)g(some)h(of)h(the)e(original)g(SUN)p 1605
973 14 2 v 16 w(RPC)j(include)d(\256les.)0 1029 y(Y)-5 b(ou)11
b(must)g(have)g(access)g(to)g(Sun)g(include)f(\256les)i(to)e(compile)h(this)f
(protocol.)0 1153 y Fl(REALM)0 1240 y Fr(The)h(portmapper)g(is)g(in)f(the)h
(ASYNC)h(realm.)0 1365 y Fl(CONFIGURA)l(TION)0 1452 y Fr(The)f(portmapper)g
(is)g(a)g(realm)h(boundary)e(protocol)g(which)g(assumes)h(its)g(single)f
(lower)g(protocol)g(is)h(in)g(the)g(RPC)h(realm.)0 1508 y Fb(name=pmap)23
b(protocols=sunrpc;)0 1632 y Fl(AUTHORS)0 1719 y Fr(Sean)12
b(O`Malley)f(and)g(Richard)g(Schroeppel)941 2753 y(126)p eop
%%Page: 127 127
126 bop 0 124 a Fl(NAME)0 211 y Fr(TCP)12 b(\(T)n(ransmission)e(Control)g
(Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fq(T)m(ransmission)i(Contr)n
(ol)g(Pr)n(otocol)p Fr(.)24 b(Request)13 b(for)h(Comments)g(793,)h(USC)f
(Information)f(Sciences)i(Institute,)e(Marina)0 479 y(Del)e(Rey)m(,)h
(Calif.,)g(Sept.)17 b(1981)0 603 y Fl(SYNOPSIS)0 690 y Fr(TCP)11
b(is)g(a)g(reliable)f(stream)h(transport)f(protocol.)15 b(It)c(maintains)f(a)
h(connection)f(between)g(the)h(server)g(and)f(the)h(client,)f(and)0
747 y(provides)i(reliable)i(stream)g(delivery)e(to)i(the)f(process.)24
b(This)12 b(implementation)h(is)g(an)g(encapsulation)f(of)i(the)f(Unix)g(4.3)
0 803 y(BSD)f(implementation.)71 860 y(This)g(implementation)f(of)i(TCP)h
(supports)d(input)h(and)h(output)e(buf)o(fering.)22 b(Output)11
b(buf)o(fers)i(are)h(contained)e(within)0 916 y(TCP)-5 b(.)14
b(If)g(the)f(amount)g(of)g(data)h(sent)e(and)i(unacknowledged)d(by)i(the)g
(peer)h(reaches)g(the)f(output)f(buf)o(fer)h(size,)h(TCP)g(will)0
973 y(block)c(subsequent)g Fq(xPush)p Fr(')m(s)g(\(or)i(will)e(return)h(XMSG)
p 879 973 14 2 v 17 w(ERR)p 984 973 V 16 w(WOULDBLOCK)g(in)g(the)f(case)i(of)
f(non-blocking)e(I/O.\))71 1029 y(TCP)h(provides)e(support)g(for)i(users)f
(to)g(work)g(with)g(\256nite)g(input)f(buf)o(fers.)17 b(TCP)10
b(will)e(limit)h(the)g(amount)g(of)h(input)e(data)0 1085 y(sent)k(to)f(its)h
(upper)g(protocol)f(via)h Fq(xDemux)g Fr(to)g(the)g(size)g(of)g(the)g(input)f
(buf)o(fer)m(.)20 b(When)12 b(data)g(have)h(been)f(consumed)g(from)0
1142 y(the)f(user)r(')m(s)f(input)g(buf)o(fer)n(,)i(free)f(buf)o(fer)g(space)
g(must)g(be)g(signaled)e(to)h(TCP)i(via)e(a)i(TCP)p 1376 1142
V 16 w(SETRCVBUFSP)l(ACE)g(call)f(\(see)0 1198 y(below)m(.\))20
b(If)13 b(a)g(user)f(does)g(not)g(wish)f(to)h(use)g(input)f(buf)o(fering,)i
(a)g(control)e(message)i(signaling)d(an)j(empty)f(buf)o(fer)h(should)0
1255 y(be)e(sent)g(in)g(response)f(to)h(each)g Fq(xDemux.)0
1379 y Fl(REALM)0 1466 y Fr(TCP)h(is)e(in)h(the)g(ASYNC)g(realm.)0
1590 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1677 y Fr(TCP)h(removes)g(a)g(pointer)e(to)
h(a)h(long)f(\(the)g(TCP)i(port)e(number\))g(from)h(the)g(participant)e
(stack.)17 b(TCP)12 b(ports)f(must)g(be)h(less)0 1734 y(than)g(0x10000.)19
b(If)13 b(the)g(local)f(participant)f(is)h(missing,)g(or)h(if)g(the)f(local)g
(protocol)f(number)i(is)f(ANY)p 1633 1734 V 16 w(PROT)m(,)h(TCP)g(will)0
1790 y(select)e(an)g(unused)f(local)h(port.)0 1915 y Fl(CONTROL)h(OPERA)l
(TIONS)0 2002 y Fb(TCP)p 75 2002 15 2 v 17 w(PUSH:)22 b Fr(Force)12
b(a)f(TCP)h(message)f(to)g(be)g(sent.)16 b(\(session)10 b(only\))114
2095 y(Input:)21 b(none)114 2169 y(Output:)f(none)0 2262 y
Fb(TCP)p 75 2262 V 17 w(GETSTATEINFO:)h Fr(Returns)10 b(state)h(of)g(the)g
(connection.)16 b(\(session)9 b(only\))114 2356 y(Input:)21
b(none)114 2429 y(Output:)f Fb(int)0 2523 y(TCP)p 75 2523 V
17 w(DUMPSTATEINFO:)h Fr(Prints)10 b(out)g(statistics)f(gathered)i(by)g(TCP)
-5 b(.)12 b(\(protocol)e(only\))114 2617 y(Input:)21 b(none)941
2753 y(127)p eop
%%Page: 128 128
127 bop 114 124 a Fr(Output:)20 b(none)0 218 y Fb(TCP)p 75
218 15 2 v 17 w(GETFREEPROTNUM:)g Fr(Returns)14 b(an)f(unused)g(TCP)h(port)f
(number)m(.)25 b(This)13 b(port)g(number)h(will)e(not)h(be)h(given)f(out)g
(to)114 274 y(subsequent)h(TCP)p 418 274 14 2 v 16 w(GETFREEPROTNUM)i(calls)f
(until)g(it)g(is)g(released)h(with)f(TCP)p 1503 274 V 17 w(RELEASEPROTNUM.)
114 331 y(This)10 b(allows)h(an)h(opener)f(to)h(separate)f(reservation)g(of)h
(free)g(ports)f(from)i(the)e(actual)g(open)h(operation,)f(if)g(desired.)114
387 y(\(protocol)f(only\))114 480 y(Input:)21 b(none)114 553
y(Output:)f(long)0 646 y Fb(TCP)p 75 646 15 2 v 17 w(RELEASEPROTNUM:)g
Fr(Releases)97 b(a)f(TCP)g(portnumber)g(previously)e(acquired)h(with)114
703 y(TCP)p 200 703 14 2 v 16 w(GETFREEPROTNUM.)12 b(\(protocol)e(only\))114
796 y(Input:)21 b(long)114 869 y(Output:)f(none)0 962 y Fb(TCP)p
75 962 15 2 v 17 w(SETRCVBUFSPACE:)g Fr(T)m(ells)11 b(TCP)g(how)g(many)g
(bytes)g(in)f(the)h(receive)h(queue)f(are)h(free.)17 b(\(session)10
b(only\))114 1056 y(Input:)21 b(u)p 271 1056 14 2 v 16 w(short)114
1128 y(Output:)f(none)0 1222 y Fb(TCP)p 75 1222 15 2 v 17 w(SETRCVBUFSIZE:)h
Fr(T)m(ells)10 b(TCP)h(the)g(size)g(of)h(the)e(TCP)i(user)r(')m(s)f(receive)h
(queue.)k(\(session)10 b(only\))114 1315 y(Input:)21 b(u)p
271 1315 14 2 v 16 w(short)114 1388 y(Output:)f(none)0 1481
y Fb(TCP)p 75 1481 15 2 v 17 w(GETSNDBUFSPACE:)g Fr(Asks)11
b(TCP)g(for)h(the)f(number)g(of)g(free)h(bytes)e(its)h(send)f(queue.)17
b(\(session)10 b(only\))114 1574 y(Input:)21 b(none)114 1647
y(Output:)f(u)p 301 1647 14 2 v 16 w(short)0 1741 y Fb(TCP)p
75 1741 15 2 v 17 w(SETSNDBUFSIZE:)h Fr(T)m(ells)10 b(TCP)h(to)g(change)g
(its)g(send)f(queue)h(to)g(the)g(indicated)f(size)h(\(session)f(only\))114
1834 y(Input:)21 b(u)p 271 1834 14 2 v 16 w(short)114 1907
y(Output:)f(none)0 2000 y Fb(TCP)p 75 2000 15 2 v 17 w(SETOOBINLINE:)h
Fr(T)m(ells)10 b(TCP)j(whether)e(users)g(wants)g(ur)o(gent)g(data)h(to)f(be)h
(delivered)f(inline)f(\(non-zero)i(==)f(yes.\))114 2056 y(\(session)e(only\))
114 2162 y(Input:)21 b(int)114 2234 y(Output:)f(none)0 2340
y Fb(TCP)p 75 2340 V 17 w(GETOOBDATA:)h Fr(reads)11 b(the)g(ur)o(gent)g(data)
g(\(exactly)f(one)h(byte\),)g(returning)f(1)h(on)g(a)h(successful)e(read)h
(or)g(returning)f(0)114 2396 y(if)i(data)g(was)g(either)g(read)h(already)g
(or)f(was)g(not)g(received)g(yet)g(\(the)h(OOB)f(noti\256cation)f(may)i
(precede)f(the)g(actual)114 2453 y(reception)e(of)h(the)g(OOB)h(data\))114
2546 y(Input:)21 b(none)114 2619 y(Output:)f(char)941 2753
y(128)p eop
%%Page: 129 129
128 bop 0 124 a Fb(TCP)p 75 124 15 2 v 17 w(OOBPUSH:)21 b Fr(send)11
b(a)h(msg)f(in)f(ur)o(gent)h(mode)114 218 y(Input:)21 b(Msg)11
b(*)114 291 y(Output:)20 b(char)0 385 y Fb(TCP)p 75 385 V 17
w(OOBMODE:)h Fr(TCP)d(uses)e(this)g(to)g(tell)h(the)f(user)h(of)g(TCP)g(that)
g(it)f(has)h(ur)o(gent)f(data)h(present,)h(i.e.,)h(TCP)f(does)e(an)114
441 y(xControl\(\))8 b(call)i(on)f(its)g(parent)g(\320)h(THIS)g(IS)g(AN)g
(UPCALL!)f(The)h(\256rst)f(void)g(pointer)f(\(ar)o(gs[0]\))i(is)f(of)h(type)f
(XObj)114 498 y(and)h(is)f(a)i(pointer)e(to)h(the)g(TCP)g(session)f(that)h
(invoked)e(this)h(operation.)16 b(The)10 b(second)f(pointer)g(\(ar)o(gs[1]\))
i(is)f(of)g(type)114 554 y(u)p 140 554 14 2 v 16 w(int)i(and)g(is)h(the)f
(value)h(of)g(the)f(ur)o(gent)h(data)f(mark.)22 b(The)13 b(oobmark)g
(indicates)e(that)i(the)f("oobmark-th")f(byte)i(in)114 611
y(the)e(receive)g(queue)g(is)g(the)g(oobdata)f(\(or)h(will)f(be)i(the)f
(oobdata.\))114 686 y(Note:)j(all)c(protocols)e(using)g(TCP)j(without)c
(having)i(OOB)h(data)g(delivered)f(in-band)f(must)i(be)g(prepared)g(to)f
(accept)114 742 y(this)h(upcall.)114 849 y(Input:)21 b(void)10
b(*ar)o(gs[2])114 922 y(Output:)20 b(none)0 1046 y Fl(CONFIGURA)l(TION)0
1133 y Fb(name=tcp)j(protocols=ip;)0 1257 y Fl(AUTHORS)0 1344
y Fr(Norm)11 b(Hutchinson,)f(Herman)h(Rao,)h(and)f(David)g(Mosber)o(ger)o(-T)
m(ang)941 2753 y(129)p eop
%%Page: 130 130
129 bop 0 124 a Fl(NAME)0 211 y Fr(TCR)m(YPT)12 b(\()g(A)f(transparent)f(DES)
h(Encryption)f(Protocol\))71 268 y(See)i(the)e(description)g(of)h(CR)m(YPT)m
(,)h(page)g(97.)0 392 y Fl(DISTRIBUTION)i(NOTE)0 479 y Fq(This)c(pr)n(otocol)
g(will)g(not)h(be)g(distributed)d(via)i(anonymous)g(ftp.)15
b(If)c(inter)n(ested,)f(contact)g(xkernel-bugs@cs.arizona.edu)0
535 y(about)g(obtaining)f(this)h(pr)n(otocol.)941 2753 y Fr(130)p
eop
%%Page: 131 131
130 bop 0 124 a Fl(NAME)0 211 y Fr(TEST)11 b(\(instantiated)e(as)i
('chantest',)g('udptest',)g(etc.\))0 335 y Fl(SPECIFICA)l(TION)0
422 y Fr(The)g(test)g(protocol)g(runs)g(a)h(\252ping-pong\272)e(test)h(of)g
(the)h(protocol)e(below)h(it)g(for)h(various)e(message)i(lengths)e(and)h
(numbers)0 478 y(of)g(iterations.)0 602 y Fl(SYNOPSIS)0 689
y Fr(T)n(ransport)k(test)f(protocols)g(run)h(in)g(one)h(of)f(two)g(roles,)h
(either)f(as)h(\252client\272)f(or)g(as)g(\252server)m(.\272)31
b(The)15 b(client)g(will)f(send)h(a)0 746 y(message)g(to)f(the)g(server)h
(and)f(wait)g(for)h(a)g(reply)f(before)h(sending)e(the)i(next)f(message.)27
b(There)14 b(are)i(no)e(provisions)e(for)0 802 y(retransmission)d(\261)j(if)f
(the)g(protocol)e(below)i(the)g(test)f(protocol)g(drops)h(a)g(message,)h(the)
f(test)f(will)g(fail.)0 926 y Fl(CONFIGURA)l(TION)0 1013 y
Fr(When)f(the)h(test)f(protocol)f(instantiates,)g(it)i(can)g(determine)f
(which)g(role)h(it)f(should)f(assume)i(in)f(several)h(ways.)16
b(Command)0 1069 y(line)c(parameters)h(can)g(be)g(used)f(to)g(cause)h(the)f
(same)h(kernel)g(to)f(run)g(as)h(the)f(server)h(on)f(one)h(machine)g(and)f
(as)h(the)f(client)0 1126 y(on)f(another)m(.)16 b(The)11 b(server)h(should)d
(be)j(started)e(up)h(with)f(a)i(\252-s\272)f(\257ag:)114 1227
y Fb(xkernel)23 b(-s)71 1329 y Fr(The)14 b(client)g(side)g(must)g(be)h(told)e
(the)i(host)e(address)i(of)f(the)h(server)f(peer)h(\(note)g(that)f(on)g(the)g
(sunos)g(platform,)h(this)0 1386 y(should)10 b(be)h(the)g(address)f(of)i(the)
f(simulated)f(IP)h(host.\))16 b(This)10 b(can)i(be)f(done)g(with)f(the)h
(\252-c\272)h(command)g(line)e(option,)g(e.g.:)114 1487 y Fb(xkernel)23
b(-c192.12.69.54)71 1589 y Fr(If)12 b(you)g(will)f(be)i(running)e(several)h
(tests)f(between)h(the)g(same)h(hosts)e(you)h(may)h(\256nd)f(it)g(convenient)
f(to)h(copy)g(the)g(test)0 1646 y(protocol)g(to)h(your)g(build)f(directory)g
(and)h(edit)g(the)g(declaration)f(of)i(ServerAddr)f(and)g(ClientAddr)f(in)h
(your)g(local)g(copy)0 1702 y(to)h(name)h(these)f(hosts)f(directly)m(.)25
b(This)13 b(will)g(eliminate)h(the)g(need)h(for)f(client)g(and)g(server)g
(\257ags.)26 b(Note)14 b(that)g(most)g(test)0 1759 y(protocols)9
b(include)h(other)h(\256les)g(from)g(the)g Fg(protocols/test)f
Fr(directory)m(,)h(so)f(you)h(will)f(either)g(have)h(to)g(copy)f(those)g
(\256les)h(as)0 1815 y(well)g(or)g(add)g Fg($\(XR)o(T\)/protocols/test)g
Fr(to)g(the)f Fg(TMP)p 868 1815 14 2 v 17 w(INCLUDES)h Fr(variable)g(in)f
(your)h(Make\256le.)71 1872 y(If)17 b(a)g(test)g(protocol)f(is)g
(con\256gured)h(with)f(an)h(instance)f(name)i(of)f('client')f(or)h(')m
(server)r(',)j(it)d(will)e(come)j(up)f(in)f(the)0 1928 y(appropriate)11
b(role.)17 b(This)11 b(can)g(be)h(used)f(to)g(run)g(both)g(a)h(client)e(and)i
(server)g(in)f(the)g(same)h(kernel)f(for)h(loopback)e(testing)g(as)0
1984 y(in)h(this)f(graph.comp)h(excerpt:)0 2143 y Fb(...)0
2199 y(name=udp)23 b(protocols=ip;)0 2256 y(name=udptest/server)e
(protocols=udp;)0 2312 y(name=udptest/client)g(protocols=udp;)71
2470 y Fr(If)10 b(you)g(have)g(con\256gured)g(several)g(standard)g(test)g
(protocols)e(into)h(the)i(kernel,)f(you)g(can)g(run)h(any)f(subset)f(of)h
(them)h(by)0 2527 y(putting)e(the)i(test)g(names)g(onto)f(the)h(command)h
(line,)f(e.g.:)114 2629 y Fb(xkernel)23 b(-testip)f(-testudp)941
2753 y Fr(131)p eop
%%Page: 132 132
131 bop 0 124 a Fr(W)n(ith)10 b(no)h(command)h(line)e(test)h(selections,)f
(all)h(of)g(the)g(con\256gured)g(test)f(protocols)g(will)g(run.)71
181 y(The)h(number)g(of)g(round)f(trips)h(for)g(each)h(packet)f(size)g(can)g
(be)g(set)g(with)f(the)h(\252trips\272)g(\257ag:)114 287 y
Fb(xkernel)23 b(-trips=10000)71 393 y Fr(If)11 b(you)f(use)h(\252dns\272)f
(lines)g(\(see)i(9.6\))f(in)f(your)g(rom)i(\256le)f(to)f(map)i(host)d(names)j
(to)e(IP)h(addresses,)g(then)f(you)h(can)g(use)f(the)0 450
y(name)i(in)f(place)g(of)g(the)g(IP)h(address)e(when)h(starting)f(the)h
(client,)g(i.e.,)71 506 y(Rom)g(\256le)h(entry:)114 600 y Fb(dns)23
b(mars)g(192.12.69.54)71 694 y Fr(Sample)11 b(command)h(lines)e(for)i
(starting)d(client:)114 788 y Fb(xkernel)23 b(-c)g(mars)g(xkernel)g(-cmars)0
881 y Fr(Note)11 b(that)f(the)h(name)h(on)f(the)g(command)g(line)g(must)g(be)
g(an)g(exact)g(match)h(\(not)f(a)g(substring\))e(of)i(the)g(rom)h(\256le)f
(entry)m(.)71 938 y(The)g(test)h(protocols)e(all)i(use)f(the)h(common)g
(trace)h(variable)f Fb(prottest)f Fr(which)g(can)h(be)g(set)g(in)f(the)h
(third)f(section)g(of)0 994 y(graph.comp:)114 1101 y Fb(@;)114
1157 y(...)114 1214 y(name=udptest)22 b(protocols=udp;)114
1270 y(@;)114 1326 y(name=prottest)g(trace=TR_EVENTS;)0 1433
y Fr(If)15 b(you)e(set)h(a)g(trace)h(level)e(when)h(you)g(declare)g(the)g
(test)f(protocol)g(in)h(the)g(second)f(section)g(of)h(graph.comp,)i(it)d
(will)g(be)0 1489 y(ignored.)0 1613 y Fl(CA)-6 b(VEA)l(TS)0
1700 y Fr(Remember)15 b(that)d(if)h(you)f(are)i(using)e Fq(simeth)g
Fr(you)g(must)h(use)f(the)h(name)h(of)f(the)g Fq(simulated)e
Fr(host)h(when)g(you)h(invoke)e(the)0 1757 y(client,)g(not)f(the)h(real)h
(host.)941 2753 y(132)p eop
%%Page: 133 133
132 bop 0 124 a Fl(NAME)0 211 y Fr(UDP)11 b(\(User)h(Datagram)f(Protocol\))0
336 y Fl(SPECIFICA)l(TION)0 423 y Fr(J.)d(Postel.)15 b Fq(User)8
b(Datagram)e(Pr)n(otocol)p Fr(.)14 b(Request)8 b(for)g(Comments)g(768,)g(USC)
h(Information)e(Sciences)i(Institute,)e(Marina)0 479 y(del)k(Ray)m(,)h
(Calif.,)g(Aug.)k(1980.)0 603 y Fl(SYNOPSIS)0 690 y Fr(UDP)11
b(is)g(a)g(trivial)f(protocol)g(that)h(dispatches)f(messages)h(that)f(arrive)
i(at)f(the)g(host)f(to)g(a)i(process)f(running)e(on)i(the)g(host.)0
815 y Fl(REALM)0 902 y Fr(UDP)g(is)g(in)g(the)g(ASYNC)g(realm.)0
1026 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1113 y Fr(UDP)f(removes)h(a)g(pointer)e(to)
h(a)h(long)e(\(the)i(UDP)f(port)g(number\))g(from)h(the)f(participant)f
(stack.)16 b(UDP)11 b(ports)e(must)h(be)h(less)0 1169 y(than)h(0x10000.)18
b(If)13 b(the)f(local)g(participant)f(is)h(missing,)g(or)g(if)h(the)f(local)g
(protocol)f(number)h(is)g(ANY)p 1629 1169 14 2 v 16 w(POR)m(T)m(,)h(UDP)f
(will)0 1226 y(select)f(an)g(unused)f(local)h(port.)0 1350
y Fl(CONTROL)h(OPERA)l(TIONS)0 1437 y Fb(UDP)p 75 1437 15 2
v 17 w(ENABLE)p 236 1437 V 16 w(CHECKSUM:)22 b Fr(Cause)11
b(the)g(session)f(to)g(use)h(checksums)g(on)g(its)f(outgoing)f(packets.)16
b(\(session)10 b(only\))114 1531 y(Input:)21 b(none)114 1604
y(Output:)f(none)0 1698 y Fb(UDP)p 75 1698 V 17 w(DISABLE)p
260 1698 V 16 w(CHECKSUM:)h Fr(Cause)12 b(the)f(session)f(to)g(not)h(use)g
(checksums)f(on)h(its)g(outgoing)e(packets.)16 b(\(session)10
b(only\))114 1792 y(Input:)21 b(none)114 1865 y(Output:)f(none)0
1958 y Fb(UDP)p 75 1958 V 17 w(GETFREEPROTNUM:)g Fr(Returns)13
b(an)h(unused)e(UDP)h(port)g(number)m(.)23 b(This)12 b(port)h(number)g(will)f
(not)g(be)i(given)e(out)h(to)114 2015 y(subsequent)f(UDP)p
424 2015 14 2 v 16 w(GETFREEPROTNUM)i(calls)f(until)g(it)g(is)h(released)g
(with)f(UDP)p 1504 2015 V 16 w(RELEASEPROTNUM.)114 2071 y(This)d(allows)h(an)
h(opener)f(to)h(separate)f(reservation)g(of)h(free)g(ports)f(from)i(the)e
(actual)g(open)h(operation,)f(if)g(desired.)114 2128 y(\(protocol)f(only\))
114 2222 y(Input:)21 b(none)114 2295 y(Output:)f(long)0 2389
y Fb(UDP)p 75 2389 15 2 v 17 w(RELEASEPROTNUM:)g Fr(Releases)95
b(a)g(UDP)g(portnumber)f(previously)f(acquired)h(with)114 2445
y(UDP)p 208 2445 14 2 v 16 w(GETFREEPROTNUM.)11 b(\(protocol)f(only\))114
2539 y(Input:)21 b(long)114 2612 y(Output:)f(none)941 2753
y(133)p eop
%%Page: 134 134
133 bop 0 124 a Fl(CONFIGURA)l(TION)0 211 y Fb(name=udp)23
b(protocols=ip;)0 336 y Fl(AUTHORS)0 423 y Fr(Larry)11 b(Peterson)g(and)g
(Sean)h(O'Malley)941 2753 y(134)p eop
%%Page: 135 135
134 bop 0 124 a Fl(NAME)0 211 y Fr(VCACHE)11 b(\()h(V)m(irtual)e(Caching)h
(Protocol)f(\))0 332 y Fl(SPECIFICA)l(TION)0 419 y Fr(VCACHE)f(is)f(a)h
(simple)f(session)f(caching)h(protocol)f(which)h(provides)f(a)i(time)g(buf)o
(fer)g(between)f(when)h(an)f(upper)h(protocol)0 476 y(closes)h(a)i(lower)f
(session)f(and)h(when)f(that)h(close)g(is)f(propagated)h(to)f(the)h(lower)g
(session.)0 597 y Fl(SYNOPSIS)0 684 y Fr(When)17 b(a)g(VCACHE)g(session)f(is)
g(closed,)i(it)f(is)f(placed)h(in)g(a)g(time-expiration)f(cache.)34
b(When)17 b(VCACHE)g(receives)0 740 y(subsequent)11 b(opens)g(\(active)h(or)h
(passive\),)f(it)g(\256rst)g(looks)f(in)h(its)g(cache)h(for)f(sessions)f
(with)g(the)i(same)g(hlp)e(and)h(the)h(same)0 797 y(remote)d(host.)15
b(After)9 b(a)h(con\256gurable)f(amount)g(of)g(time,)h(closed)f(VCACHE)g
(sessions)f(will)g(be)i(destroyed)e(and)h(the)g(lower)0 853
y(session)h(actually)g(closed.)71 909 y(As)k(an)h(example,)i(VCACHE)d(can)i
(be)f(inserted)f(between)g(a)h(UDP)g(server)g(and)g(UDP)g(to)g(prevent)f(UDP)
h(sessions)0 966 y(from)d(being)e(closed)h(when)f(the)h(server)h(releases)f
(all)g(references.)71 1022 y(Server)f(sessions)e(\(those)h(created)i(as)f(a)g
(result)f(of)h(a)g(match)g(between)f(an)h(incoming)f(packet)h(and)f(an)h
(openenable\))g(are)0 1079 y(always)g(cached.)17 b(If)10 b(an)h
(instantiation)c(of)k(VCACHE)f(is)g(running)f(in)h Fq(symmetric)g
Fr(mode,)h(client)e(sessions)g(\(those)h(created)0 1135 y(by)15
b(an)g(xOpen\))g(will)f(be)h(cached)h(as)f(well.)28 b(It)15
b(is)g(reasonable)g(to)g(con\256gure)g(VCACHE)g(in)g(symmetric)g(mode)g
(above)0 1192 y(symmetric)f(\(ASYNC)g(realm\))g(protocols)e(and)i(in)f
(asymmetric)h(mode)g(above)f(asymmetric)h(\(RPC)h(realm\))f(protocols,)0
1248 y(though)c(this)g(usage)h(is)f(certainly)h(not)f(required.)0
1369 y Fl(REALM)0 1456 y Fr(VCACHE)16 b(can)f(be)h(used)f(with)f(either)h
(ASYNC)h(or)g(RPC)g(realm)g(lower)f(protocols)f(and)h(assumes)h(the)f(realm)h
(of)f(the)0 1513 y(protocol)10 b(below)g(it.)0 1634 y Fl(P)l(AR)n(TICIP)l
(ANTS)0 1721 y Fr(VCACHE)h(passes)g(participants)e(directly)i(to)f(the)h
(lower)g(protocol)f(and)h(does)g(not)f(make)i(direct)f(use)g(of)h(any)f
(participant)0 1777 y(information.)0 1898 y Fl(CONFIGURA)l(TION)0
1985 y Fr(VCACHE)g(uses)g(a)g(single)f(lower)h(protocol.)0
2041 y(VCACHE)g(recognizes)g(the)g(following)e(ROM)j(options:)0
2124 y Fb(vcache)23 b(symmetric)f Fr(:)16 b(Run)11 b(this)f(instantiation)e
(in)j(symmetric)g(mode.)0 2220 y Fb(vcache)23 b(asymmetric)e
Fr(:)16 b(Run)c(this)e(instantiation)e(in)i(asymmetric)i(mode)f(\(default\).)
0 2307 y Fb(vcache)23 b(interval)g(n)f Fr(:)f(Set)13 b(the)h(timeout)e
(interval)g(for)i Fb(n)f Fr(seconds.)23 b(A)13 b(cached)h(VCACHE)f(session)f
(is)h(eligible)f(to)114 2364 y(be)f(destroyed)f(if)h(it)f(is)h(idle)f(for)h
Fb(n)g Fr(seconds)f(and)h(is)g(guaranteed)f(to)h(be)g(destroyed)f(if)h(it)f
(is)h(idle)f(for)h(more)h(than)e Fb(2)24 b(*)114 2420 y(n)11
b Fr(seconds.)0 2541 y Fl(AUTHOR)0 2628 y Fr(Ed)g(Menze)941
2753 y(135)p eop
%%Page: 136 136
135 bop 0 124 a Fl(NAME)0 211 y Fr(VCHAN)11 b(\(Channel)g(V)m
(irtual-Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(S.)h(O'Malley)g
(and)f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fq(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479
y(10)p Fr(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 560 y(B.)i(W)l(elch.)21
b Fq(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fr(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 617 y(86/302,)d(June)h(1986.)0 741 y Fl(SYNOPSIS)0
828 y Fr(VCHAN)i(is)g(a)h(virtual)e(protocol)g(that)h(multiplexes)f(multiple)
g(client)g(procedure)i(invocations)d(over)i(some)h(number)f(of)0
885 y(open)e(channels.)k(The)c(call)g(blocks)f(if)h(there)g(are)h(no)e(idle)h
(channels)f(available.)16 b(VCHAN)10 b(was)h(originally)e(based)i(on)f(the)0
941 y(Sprite)h(RPC)h(protocol.)71 997 y(VCHAN)j(initially)f(opens)h(a)h
(default)g(number)g(of)g(channels)f(for)h(a)h(new)f(session,)g(though)e(this)
h(number)h(can)g(be)0 1054 y(increased)11 b(or)g(decreased)h(via)f(control)f
(operations.)0 1178 y Fl(REALM)0 1265 y Fr(VCHAN)h(is)g(in)f(the)h(RPC)i
(realm.)0 1390 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1477 y Fr(VCHAN)g(expects)g(an)g
(IPhost)g(pointer)f(on)h(the)h(stack)e(of)i(each)g(participant.)21
b(It)14 b(will)e(not)h(remove)g(this)g(pointer)f(before)0 1533
y(passing)e(the)h(address)f(down)h(to)f(the)h(lower)g(protocol.)0
1657 y Fl(CONTROL)h(OPERA)l(TIONS)0 1744 y Fb(VCHAN)p 123 1744
15 2 v 16 w(INCCONCURRENCY:)21 b Fr(Increase)12 b(the)f(number)h(of)f(active)
g(channels)g(by)g(the)g(number)g(given)g(\()p Fb(xControlSessn)114
1801 y Fr(only\).)114 1895 y(Input:)21 b Fb(int)114 1968 y
Fr(Output:)f(none;)0 2061 y Fb(VCHAN)p 123 2061 V 16 w(DECCONCURRENCY:)h
Fr(Decrease)11 b(the)e(number)h(of)g(active)g(channels)f(by)g(the)h(number)g
(given)f(\()p Fb(xControlSessn)114 2118 y Fr(only\).)114 2212
y(Input:)21 b Fb(int)114 2285 y Fr(Output:)f(none;)0 2409 y
Fl(CONFIGURA)l(TION)0 2496 y Fr(VCHAN)14 b(expects)g(to)g(be)g(con\256gured)g
(above)h(another)e(RPC)j(realm)f(protocol.)25 b(It)14 b(expects)g(that)g
(each)h(xOpen)e(on)h(the)0 2553 y(lower)d(protocol)f(with)g(the)h(same)h
(participants)d(will)h(return)h(a)h(new)f(lower)g(session.)941
2753 y(136)p eop
%%Page: 137 137
136 bop 0 124 a Fl(AUTHOR)0 211 y Fr(Ed)11 b(Menze)941 2753
y(137)p eop
%%Page: 138 138
137 bop 0 124 a Fl(NAME)0 211 y Fr(VDISORDER)11 b(\(V)m(irtual)g(Disorder)f
(Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(Shuf)o(\257es)i(the)e
(order)i(of)f(incoming)f(packets.)16 b(Used)11 b(to)g(exercise)g(the)g
(recovery)g(mechanisms)g(of)g(other)g(protocols.)0 547 y Fl(SYNOPSIS)0
634 y Fr(VDISORDER)i(sessions)e(deliver)i(packets)f(in)h(a)g(somewhat)f(dif)o
(ferent)h(order)g(than)g(they)f(receive)h(them.)22 b(The)13
b(charac-)0 690 y(teristics)e(of)i(the)g(reordering)f(are)i(controlled)d(by)h
(per)o(-session)g(parameters)h(which)g(can)g(be)g(set)f(by)g(control)g
(operations.)0 747 y(VDISORDER)f(will)g(eventually)e(deliver)i(all)g(packets)
f(it)h(receives.)71 803 y(VDISORDER)g(has)g(no)g(ef)o(fect)h(on)f(outgoing)e
(packets.)0 928 y Fl(REALM)0 1015 y Fr(VDISORDER)i(is)g(in)g(the)g(ASYNC)g
(realm.)0 1139 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1226 y Fr(VDISORDER)g(passes)g
(participants)e(to)i(the)g(lower)g(protocols)e(without)h(manipulating)f
(them.)0 1350 y Fl(CONTROL)j(OPERA)l(TIONS)0 1437 y Fb(VDISORDER)p
219 1437 15 2 v 16 w(SET)p 307 1437 V 17 w(ARRIVAL)p 492 1437
V 16 w(INTERVAL:)21 b Fr(Sets)d(the)f(arrival)h(interval)f(for)g(this)g
(session.)34 b(This)17 b(is)g(the)g(number)h(of)114 1494 y(packets)10
b(that)h(are)h(delivered)e(in-order)h(before)g(the)g(session)f(goes)h(into)f
(a)h(disordering)f(state.)16 b(\(session)10 b(only\))114 1587
y(Input:)21 b Fb(int)i(interval)114 1660 y Fr(Output:)d(none)0
1754 y Fb(VDISORDER)p 219 1754 V 16 w(GET)p 307 1754 V 17 w(ARRIVAL)p
492 1754 V 16 w(INTERVAL:)h Fr(Returns)11 b(the)g(arrival)g(interval)f(for)i
(this)e(session.)15 b(\(session)10 b(only\))114 1848 y(Input:)21
b(none)114 1921 y(Output:)f Fb(int)k(interval)0 2015 y(VDISORDER)p
219 2015 V 16 w(SET)p 307 2015 V 17 w(DISORDER)p 516 2015 V
16 w(INTERVAL:)d Fr(Sets)14 b(the)f(disorder)g(interval)f(for)i(this)e
(session.)22 b(This)12 b(is)h(the)h(number)f(of)114 2071 y(packets)f(that)h
(are)h(held)e(while)h(a)g(session)f(is)g(in)h(a)h(disordering)d(state)i
(before)g(the)g(set)g(is)f(delivered)h(in)g(a)g(random)114
2128 y(order)c(to)h(the)f(upper)g(protocol)g(\(and)g(the)h(session)e(leaves)h
(the)h(disordering)d(state.\))16 b(This)9 b(parameter)h(controls)f(how)114
2184 y(far)i(out-of-order)g(a)g(packet)g(might)g(arrive.)17
b(\(session)10 b(only\))114 2278 y(Input:)21 b Fb(int)i(interval)114
2351 y Fr(Output:)d(none)0 2445 y Fb(VDISORDER)p 219 2445 V
16 w(GET)p 307 2445 V 17 w(DISORDER)p 516 2445 V 16 w(INTERVAL:)h
Fr(Returns)11 b(the)g(disorder)f(interval)h(for)g(this)f(session.)15
b(\(session)10 b(only\))114 2539 y(Input:)21 b(none)114 2612
y(Output:)f Fb(int)k(interval)941 2753 y Fr(138)p eop
%%Page: 139 139
138 bop 0 124 a Fb(VDISORDER)p 219 124 15 2 v 16 w(SET)p 307
124 V 17 w(TIMEOUT)p 492 124 V 16 w(INTERVAL:)21 b Fr(Sets)13
b(the)f(timeout)g(interval)g(for)g(this)g(session.)19 b(When)12
b(a)h(session)f(enters)g(a)114 181 y(disordering)h(state,)i(it)f(starts)g(a)h
(timeout)f(event)g(for)h(this)e(many)i(milliseconds.)25 b(If)16
b(this)d(event)h(\256res)i(before)e(the)114 237 y(session)g(has)i(received)g
(suf)o(\256cient)g(packets)f(to)h(satisfy)e(the)i(disorder)f(interval,)i(it)e
(disorders)g(the)h(packets)f(and)114 294 y(delivers)10 b(them)h(to)g(the)g
(upper)g(protocol)f(anyway)m(.)16 b(\(session)10 b(only\))114
387 y(Input:)21 b Fb(int)i(interval)114 460 y Fr(Output:)d(none)0
554 y Fb(VDISORDER)p 219 554 V 16 w(GET)p 307 554 V 17 w(TIMEOUT)p
492 554 V 16 w(INTERVAL:)h Fr(Returns)11 b(the)g(timeout)f(interval)h(for)g
(this)f(session.)15 b(\(session)10 b(only\))114 648 y(Input:)21
b(none)114 721 y(Output:)f Fb(int)k(interval)0 845 y Fl(AUTHOR)0
932 y Fr(Erich)11 b(Nahum)941 2753 y(139)p eop
%%Page: 140 140
139 bop 0 124 a Fl(NAME)0 211 y Fr(VDROP)11 b(\(V)m(irtual)g(Drop)g
(Protocol\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(Throws)f(away)h
(occasional)g(incoming)f(packets.)16 b(Used)11 b(to)f(exercise)i(the)f
(recovery)g(mechanisms)g(of)g(other)g(protocols.)0 547 y Fl(SYNOPSIS)0
634 y Fr(VDROP)17 b(sessions)e(throw)g(away)i(incoming)e(packets)i(at)f
(regular)h(intervals.)31 b(This)16 b(interval)f(is)h(set)h(in)f(a)h(somewhat)
0 690 y(random)c(fashion)e(at)i(session)e(creation)h(time,)h(though)e(it)h
(can)h(be)g(set)f(explicitly)f(on)h(a)h(per)o(-session)e(basis)h(via)g(a)h
(control)0 747 y(operation.)71 803 y(VDROP)e(has)g(no)g(ef)o(fect)h(on)f
(outgoing)e(packets.)71 860 y(VDROP)k(should)f(allow)h(its)f(interval)h(to)g
(be)g(set)h(via)f(a)h(ROM)g(option)e(and)h(should)f(allow)g(sessions)g(to)h
(have)h(more)0 916 y(interesting)9 b(distributions)f(of)j(drop)g(intervals.)0
1040 y Fl(REALM)0 1127 y Fr(VDROP)g(is)g(in)g(the)g(ASYNC)g(realm.)0
1252 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1339 y Fr(VDROP)g(passes)g(participants)e
(to)i(the)g(lower)g(protocols)e(without)h(manipulating)f(them.)0
1463 y Fl(CONTROL)j(OPERA)l(TIONS)0 1550 y Fb(VDROP)p 123 1550
15 2 v 16 w(SETINTERVAL:)22 b Fr(Sets)17 b(the)f(drop)h(interval)f(for)h
(this)f(session.)33 b(An)17 b(interval)f(of)h(1)g(drops)f(every)h(packet,)i
(an)114 1606 y(interval)11 b(of)h(2)g(drops)g(every)g(other)g(packet,)g(etc.)
20 b(An)12 b(interval)g(of)g(zero)g(indicates)f(that)h(VDROP)g(is)g(disabled)
f(for)114 1663 y(that)f(session.)15 b(\(session)10 b(only\))114
1757 y(Input:)21 b Fb(int)i(interval)114 1830 y Fr(Output:)d(none)0
1924 y Fb(VDROP)p 123 1924 V 16 w(GETINTERVAL:)i Fr(Returns)10
b(the)h(current)g(drop)g(interval)f(for)i(this)e(session.)15
b(\(session)10 b(only\))114 2017 y(Input:)21 b(none)114 2090
y(Output:)f Fb(int)k(interval)0 2215 y Fl(AUTHOR)0 2302 y Fr(Ed)11
b(Menze)941 2753 y(140)p eop
%%Page: 141 141
140 bop 0 124 a Fl(NAME)0 211 y Fr(VMUX)11 b(\()h(V)m(irtual)e(Multiplexing)f
(Protocol)h(\))0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(VMUX)k(sits)e(above)h
(several)h(lower)f(protocols,)f(making)i(them)f(appear)h(as)f(a)h(single)f
(protocol.)22 b(VMUX)13 b(makes)h(very)0 479 y(simple)d(decisions)e(about)h
(which)h(protocol)f(to)h(use)f(for)i(each)f(connection.)0 603
y Fl(SYNOPSIS)0 690 y Fr(VMUX)i(is)e(only)h(active)g(during)g(connection)f
(establishment.)18 b(When)12 b(openenabled,)h(VMUX)f(openenables)f(all)i(of)f
(its)0 747 y(lower)g(protocols)e(on)i(behalf)g(of)g(the)g(upper)g(protocol.)
18 b(When)12 b(opened,)h(VMUX)f(attempts)f(opens)h(its)f(lower)h(protocols)0
803 y(in)d(the)g(order)h(in)f(which)g(they)g(were)h(speci\256ed)f(in)g(the)h
(down)f(vector)g(until)f(a)i(successful)e(open)i(occurs.)15
b(The)10 b(successfully)0 860 y(opened)h(lower)f(session)g(is)h(then)f
(returned.)0 984 y Fl(REALM)0 1071 y Fr(Since)i(VMUX)h(is)f(active)f(only)h
(during)f(open,)h(it)g(should)f(be)h(considered)f(in)h(the)g(same)h(realm)g
(as)f(the)g(protocols)f(below)0 1127 y(it)g(\(which)f(should)g(probably)g
(all)h(be)g(in)g(the)f(same)i(realm.\))0 1252 y Fl(P)l(AR)n(TICIP)l(ANTS)0
1339 y Fr(VMUX)f(passes)g(its)f(participants)f(to)i(the)g(lower)g(protocols)f
(unmodi\256ed.)0 1463 y Fl(CONTROL)i(OPERA)l(TIONS)0 1550 y
Fr(VMUX)f(forwards)g(control)f(operations)g(to)h(the)g(last)f(protocol)g(in)h
(the)g(down)f(vector)h(list.)0 1674 y Fl(CONFIGURA)l(TION)0
1761 y Fr(The)g(lower)g(protocols)e(will)i(be)g(opened)f(in)h(the)g(order)g
(in)g(which)g(they)f(are)i(listed)e(in)h(the)g(con\256guration)e(entry)m(.)0
1886 y Fl(AUTHOR)0 1973 y Fr(Ed)i(Menze)941 2753 y(141)p eop
%%Page: 142 142
141 bop 0 124 a Fl(NAME)0 211 y Fr(VNET)11 b(\(V)m(irtual)f(Network)g
(Protocol\))0 335 y Fl(SPECIFICA)l(TION)71 422 y Fr(VNET)h(is)g(a)h(virtual)e
(protocol)h(which)f(manages)i(multiple)f(physical)f(network)h(protocols.)16
b(When)11 b(opened)g(with)g(an)0 478 y(IP)g(address,)g(VNET)f(determines)h
(if)f(the)h(host)f(can)h(be)f(reached)i(directly)d(on)i(one)f(of)h(its)f
(physical)g(networks.)15 b(If)c(it)f(can,)i(a)0 535 y(session)e(on)g(that)h
(network)f(is)h(opened.)16 b(If)c(it)e(can)i(not)e(be)i(directly)e(reached,)i
(an)f(ERR)p 1376 535 14 2 v 17 w(XOBJ)g(is)g(returned.)0 658
y Fl(SYNOPSIS)71 745 y Fr(VNET)f(sits)g(above)h(pairs)g(of)g(network)g
(protocols)e(\(one)i(per)h(interface\))f(and)h(ARP)f(protocols.)16
b(When)10 b(opened)h(with)0 801 y(a)f(remote)h(IP)f(address,)g(VNET)f
(compares)h(the)g(net)g(number)g(with)f(that)g(of)h(its)f(lower)g(protocols)g
(to)g(determine)h(if)g(the)f(host)0 858 y(can)i(be)h(reached)f(directly)g(on)
f(a)i(local)f(network,)f(opening)g(the)h(appropriate)f(interface)i(protocol)e
(\(if)h(possible.\))71 914 y(If)18 b(opened)f(with)g(an)g(IP)i(broadcast)e
(address,)i(VNET)e(will)g(determine)g(which)g(networks)g(are)h(matched)g(by)f
(the)0 971 y(broadcast)12 b(address)g(and)h(will)e(open)i(a)g(lower)f
(session)f(on)h(each)i(of)e(those)g(networks.)20 b(A)13 b(push)e(on)i(a)g
(VNET)f(broadcast)0 1027 y(session)e(will)g(result)g(in)h(a)g(push)g(on)f
(all)h(of)g(these)g(lower)g(network)f(sessions.)71 1084 y(Use)h(of)g(the)g
(IP)h(broadcast)f(address)g(255.255.255.255)e(will)h(result)h(in)f(a)i(VNET)f
(session)f(which)g(broadcasts)h(on)g(all)0 1140 y(of)g(the)g(local)g
(networks.)0 1263 y Fl(REALM)0 1350 y Fr(VNET)g(is)f(in)h(the)g(ASYNC)g
(realm.)0 1474 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1561 y Fr(VNET)h(removes)g(a)h
(pointer)e(to)h(an)g(IPhost)g(from)h(the)f(top)f(of)i(the)f(stack)g(of)g(the)
g(remote)h(participant.)18 b(Only)12 b(the)g(remote)0 1617
y(participant)e(is)g(processed.)16 b(New)c(participants)d(are)j(created)g
(for)f(opening)f(the)h(lower)f(network)h(protocols.)0 1741
y Fl(CONTROL)h(OPERA)l(TIONS)0 1828 y Fb(VNET)p 99 1828 15
2 v 17 w(GETADDRCLASS:)21 b Fr(Determines)12 b(the)h(address)g(class)f(of)i
(the)e(given)h(IP)g(host.)22 b(The)13 b(address)f(class)h(is)f(one)h(of)g
(the)114 1884 y(following:)114 1986 y Fb(LOCAL)p 237 1986 V
16 w(ADDR)p 349 1986 V 17 w(C:)22 b Fr(An)11 b(address)g(for)g(the)g(local)g
(host.)114 2058 y Fb(REMOTE)p 261 2058 V 16 w(HOST)p 373 2058
V 17 w(ADDR)p 486 2058 V 16 w(C:)23 b Fr(Remote)11 b(host)g(directly)f
(reachable)h(on)g(a)h(local)e(net.)114 2129 y Fb(REMOTE)p 261
2129 V 16 w(NET)p 349 2129 V 17 w(ADDR)p 462 2129 V 16 w(C:)23
b Fr(Remote)12 b(host)e(on)h(a)g(remote)h(network.)114 2200
y Fb(BCAST)p 237 2200 V 16 w(LOCAL)p 373 2200 V 17 w(ADDR)p
486 2200 V 16 w(C:)23 b Fr(255.255.255.255)9 b(\261)i(broadcast)g(address)f
(for)i(all)e(local)h(nets.)114 2271 y Fb(BCAST)p 237 2271 V
16 w(NET)p 325 2271 V 17 w(ADDR)p 438 2271 V 17 w(C:)22 b Fr(Broadcast)12
b(address)f(for)i(a)f(single)f(network)g(or)h(a)g(single)f(subnet)g(\(if)h
(subnets)e(are)j(being)214 2327 y(used.\))114 2399 y Fb(BCAST)p
237 2399 V 16 w(SUBNET)p 397 2399 V 16 w(ADDR)p 509 2399 V
17 w(C:)23 b Fr(Broadcast)9 b(for)g(a)g(network)g(\(more)h(than)e(a)i(single)
e(subnet\))g(when)h(subnets)e(are)j(being)214 2455 y(used.)114
2557 y(Input:)21 b(VnetClassBuf)10 b(==)h Fi(f)24 b Fb(int)f(class;)g(IPhost)
g(host;)g Fi(g)114 2629 y Fr(Output:)d(VnetClassBuf)941 2753
y(142)p eop
%%Page: 143 143
142 bop 0 124 a Fb(VNET)p 99 124 15 2 v 17 w(GETNUMINTERFACES:)20
b Fr(Indicate)11 b(the)g(number)g(of)g(interfaces)g(used)g(by)g(the)g(VNET)f
(protocol)g(\(protocol)g(only)m(.\))114 215 y(Input:)21 b(none)114
281 y(Output:)f Fb(int)0 372 y(VNET)p 99 372 V 17 w(HOSTONLOCALNET:)g
Fr(Indicates)10 b(\(through)f(the)i(xControl)e(return)h(value\))g(whether)g
(the)h(given)e(host)h(is)g(on)g(one)g(of)114 429 y(VNET')m(s)k(interfaces.)25
b(When)14 b(performed)h(on)e(a)i(session,)f(only)f(those)g(interfaces)h
(active)g(on)g(that)g(session)e(will)114 485 y(be)f(considered)g(\(a)h
(typical)e(VNET)h(session)f(only)g(uses)h(one)g(interface,)h(though)e(a)i
(broadcast)e(session)g(may)i(have)114 542 y(more)f(than)g(one.\))17
b(When)10 b(performed)i(on)f(a)h(protocol,)e(all)h(interfaces)g(are)g
(considered.)114 613 y(Returns)f(sizeof\(IPhost\))h(if)g(it)g(is)f(on)h(a)h
(local)e(network,)h(0)g(if)g(it)g(is)g(not.)114 704 y(Input:)21
b Fb(IPhost)114 770 y Fr(Output:)f(none)0 861 y Fb(VNET)p 99
861 V 17 w(GETINTERFACEID:)g Fr(Returns)14 b(an)f(opaque)h(identi\256er)f
(indicating)e(the)j(interface)g(used)f(by)g(this)g(session.)22
b(This)114 917 y(identi\256er)10 b(may)i(be)g(used)f(in)g(subsequent)f
Fb(VNET)p 889 917 V 16 w(DISABLEINTERFACE)g Fr(and)h Fb(VNET)p
1472 917 V 17 w(ENABLEINTERFACE)e Fr(calls.)114 974 y(This)e(operation)h
(will)f(fail)h(\(and)h(return)f(0\))h(if)f(performed)h(on)g(a)g(broadcast)e
(session)h(with)f(more)i(than)f(one)h(interface.)114 1030 y(Broadcast)k
(sessions)f(never)h(process)g(incoming)f(packets,)i(however)n(,)g(so)f(this)g
(operation)f(will)g(always)h(succeed)114 1087 y(when)d(performed)i(on)f(a)g
(session)f(delivering)g(incoming)g(packets.)16 b(\(Session)10
b(only)m(.\))114 1178 y(Input:)21 b(none)114 1243 y(Output:)f
Fb(VOID)k(*)0 1334 y(VNET)p 99 1334 V 17 w(DISABLEINTERFACE:)c
Fr(The)9 b(session)f(will)h(no)g(longer)g(send)g(messages)g(out)g(over)g(the)
g(interface)h(corresponding)114 1391 y(to)g(the)h(given)g(interface)g
(identi\256er)m(.)16 b(\(Session)11 b(only)m(.\))114 1482 y(Input:)21
b Fb(VOID)i(*)114 1548 y Fr(Output:)d(none)0 1639 y Fb(VNET)p
99 1639 V 17 w(ENABLEINTERFACE:)g Fr(Undoes)10 b(the)h(ef)o(fect)h(of)g(a)f
(previous)f Fb(VNET)p 1196 1639 V 17 w(DISABLEINTERFACE)f Fr(\(Session)h
(only)m(.\))114 1730 y(Input:)21 b Fb(VOID)i(*)114 1796 y Fr(Output:)d(none)0
1887 y Fb(VNET)p 99 1887 V 17 w(ISMYADDR:)h Fr(Indicates)10
b(\(through)f(the)i(xControl)e(return)i(value\))f(whether)g(the)h(given)e
(host)h(is)g(an)h(address)f(which)114 1943 y(might)g(be)i(used)e(to)h(reach)h
(this)e(host)g(on)h(VNET')m(s)g(local)g(networks)f(\(i.e.,)j(if)e(the)g
(address)g(is)f(one)i(of)f(this)f(host')m(s)h(IP)114 2000 y(addresses)f(or)h
(is)g(a)h(broadcast)e(address.\))16 b(Returns)11 b(sizeof\(IPhost\))g(if)g
(it)f(is)h(local)g(\(or)g(broadcast\),)g(0)g(if)g(it)g(is)g(not.)114
2091 y(Input:)21 b Fb(IPhost)114 2156 y Fr(Output:)f(none)0
2277 y Fl(CONFIGURA)l(TION)0 2364 y Fr(VNET)11 b(expects)f(its)h(lower)f
(protocols)g(to)h(be)g(con\256gured)g(in)f(network/ARP)h(pairs:)0
2420 y Fb(name=vnet)23 b(protocols=eth/1,arp/1,e)o(th/2,arp)o(/2;)0
2541 y Fl(AUTHOR)0 2628 y Fr(Ed)11 b(Menze)941 2753 y(143)p
eop
%%Page: 144 144
143 bop 0 124 a Fl(NAME)0 211 y Fr(VSECSEL)11 b(\()h(V)m(irtual)e(Security)h
(Selection)g(Protocol)f(\))0 336 y Fl(DISTRIBUTION)k(NOTE)0
423 y Fq(This)c(pr)n(otocol)g(will)g(not)h(be)g(distributed)d(via)i
(anonymous)g(ftp.)15 b(If)c(inter)n(ested,)f(contact)g
(xkernel-bugs@cs.arizona.edu)0 479 y(about)g(obtaining)f(this)h(pr)n(otocol.)
0 603 y Fl(SPECIFICA)l(TION)0 690 y Fr(VSECSEL)16 b(sits)f(above)g(several)h
(lower)g(protocols,)g(selecting)e(them)i(with)f(security)g(enhancements)h
(appropriate)f(to)0 747 y(the)f(source)f(and)h(destination)d(addresses)j(of)f
(a)i(session.)23 b(In)14 b(a)g(protocol)e(graph,)j(VSECSEL)f(should)e(sit)h
(over)h(a)g(a)g(key)0 803 y(manager)e(instance)e(that)h(can)g(associate)g(an)
g(address)g(component)f(with)g(a)i(security)e(service.)0 928
y Fl(SYNOPSIS)0 1015 y Fr(VSECSEL)g(is)f(only)g(active)h(during)f(connection)
f(establishment.)15 b(When)9 b(openenabled,)h(VSECSEL)g(openenables)e(one)0
1071 y(of)14 b(its)f(lower)h(protocols)e(on)h(behalf)h(of)g(the)g(upper)f
(protocol.)24 b(When)14 b(opened,)g(VSECSEL)g(opens)f(a)i(lower)e(protocol,)0
1127 y(making)h(its)g(choice)g(based)h(on)f(interactions)f(with)h(the)g(key)g
(manager)m(.)29 b(The)14 b(successfully)f(opened)h(lower)h(session)e(is)0
1184 y(then)e(returned.)71 1240 y(The)g(default)f(service)h(type)g(is)g(the)g
(checksum)g(service.)0 1365 y Fl(REALM)0 1452 y Fr(Since)e(VSECSEL)g(is)g
(active)g(only)f(during)g(open,)h(it)f(should)g(be)h(considered)f(in)h(the)f
(same)i(realm)g(as)f(the)g(protocols)e(below)0 1508 y(it)k(\(which)f(should)g
(all)h(be)g(in)g(the)g(same)g(realm.\))0 1632 y Fl(P)l(AR)n(TICIP)l(ANTS)0
1719 y Fr(On)i(an)g(xOpen,)h(VSECSEL)f(passes)f(the)h(\256rst)g(address)g
(component)f(of)i(the)f(remote)g(participant)f(to)h(the)g(key)g(manager)0
1776 y(to)e(select)h(the)f(lower)h(security)f(service.)18 b(VSECSEL)12
b(passes)f(its)g(participants)f(to)i(that)f(lower)g(protocol)g(unmodi\256ed.)
18 b(If)0 1832 y(that)10 b(service)g(was)g(an)h(encryption)e(service,)i(then)
e(the)i(xOpen)e(of)i(that)f(service)g(completes,)g(VSECSEL)h(will)e(set)h
(the)g(key)0 1889 y(for)h(both)g(the)f(local)h(and)g(remote)h(participants)d
(to)i(be)g(the)g(same)h(key)m(.)71 1945 y(On)h(an)h(xOpenEnable,)g(VSECSEL)g
(passes)f(the)h(\256rst)f(address)h(component)f(of)h(the)f(local)h
(participant)e(to)i(the)f(key)0 2002 y(manager)19 b(to)g(select)f(the)h
(lower)f(security)g(service.)39 b(VSECSEL)19 b(passes)f(its)g(participants)f
(to)h(that)g(lower)h(protocol)0 2058 y(unmodi\256ed.)71 2115
y(On)8 b(an)i(xOpenDone,)f(VSECSEL)g(checks)g(that)g(the)f(\256rst)i(address)
e(component)h(of)g(the)g(local)g(participant)e(is)i(compat-)0
2171 y(ible)h(with)h(the)f(lower)h(protocol.)k(For)d(a)f(lower)g(protocol)f
(that)g(is)h(an)g(encryption)f(service,)h(VSECSEL)g(will)f(set)h(the)g(keys)0
2227 y(for)g(the)g(local)f(and)h(remote)g(participants)e(to)h(be)h(the)g
(same)g(key)m(.)17 b(VSECSEL)11 b(then)f(passes)g(the)h(unmodi\256ed)f
(participants)0 2284 y(list)g(to)h(the)g(upper)f(protocol)g(in)h(xOpenDone.)0
2408 y Fl(CONTROL)h(OPERA)l(TIONS)0 2495 y Fr(VSECSEL)e(determines)f(the)g
(type)g(of)h(control)f(op)g(and)g(forwards)g(it)h(to)f(the)g(appropriate)g
(lower)g(protocol.)15 b(For)10 b(example,)0 2552 y(CR)m(YPT)j(control)e(ops)g
(will)g(be)h(forwarded)g(to)f(the)h(encryption)e(service.)19
b(Other)11 b(control)g(ops)g(will)g(be)h(forwarded)g(to)g(all)0
2608 y(lower)f(services,)g(but)f(the)h(value)g(returned)g(will)f(be)h(from)h
(the)f(\256rst)g(lower)g(protocol.)941 2753 y(144)p eop
%%Page: 145 145
144 bop 0 124 a Fl(CONFIGURA)l(TION)0 211 y Fr(The)15 b(following)d(entry)i
(shows)g(how)g(to)g(con\256gure)h(vsecsel)f(over)g(UDP)-5 b(.)15
b(The)g(order)g(of)f(the)h(protocols)e(is)h(crucial)g(and)0
268 y(must)d(be)g(correlated)g(with)f(the)h(key)g(manager)h(\256le.)0
374 y Fb(name=vsecsel)22 b(dir=vsecsel_km)g(files=vsecsel_km)g
(protocols=udp,md5,crypt,k)o(m/vsec;)71 480 y Fr(A)10 b(key)f(manager)i
(\256le)f(example)h(is)e(shown)g(below)m(.)16 b(It)10 b(associates)f(UDP)h
(port)f(2001)g(\(decimal\))i(with)e(lower)h(protocol)0 537
y(1,)h(the)e(checksum)h(service;)g(UDP)g(port)g(2002)f(with)g(lower)h
(protocol)e(0,)j(the)f(no-security)f(service;)g(UDP)i(port)e(2003)g(with)0
593 y(lower)h(protocol)f(2,)i(the)f(encryption)e(service;)i(UDP)h(port)e
(2004)h(with)f(the)h(checksum)g(service.)16 b(The)10 b(encryption)f(service)0
650 y(must)15 b(be)g(the)g(third)g(lower)g(protocol,)g(because)g(the)g
(control)g(operations)f(to)g(set)h(the)g(keys)g(for)h(the)f(local)g(and)g
(remote)0 706 y(participants)9 b(depend)i(on)g(it.)16 b(Later)11
b(versions)f(of)h(the)g(key)g(manager)h(may)g(allow)e(this)g(restriction)g
(to)h(be)g(removed.)0 812 y Fb(4)24 b(4)f(32)0 869 y(000007d1)g(00000001)0
925 y(000007d2)g(00000000)0 982 y(000007d3)g(00000002)0 1038
y(000007d4)g(00000001)0 1162 y Fl(AUTHOR)0 1249 y Fr(Hilarie)11
b(Orman)941 2753 y(145)p eop
%%Page: 146 146
145 bop 0 124 a Fl(NAME)0 211 y Fr(VSIZE)11 b(\(Size)h(V)m(irtual-Protocol\))
0 336 y Fl(SPECIFICA)l(TION)0 423 y Fr(S.)g(O'Malley)g(and)f(L.)h(Peterson.)
18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17 b Fq(ACM)12
b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479 y(10)p Fr(,)g(2)g(\(May)h
(1992\),)f(110\261143.)0 603 y Fl(SYNOPSIS)0 690 y Fr(VSIZE)k(is)f(a)h
(virtual)f(protocol)f(that)h(multiplexes)f(messages)i(through)e(N)i(lower)o
(-level)f(protocols)f(based)h(on)h(the)f(size)0 747 y(of)f(the)g(message)h
(being)e(sent.)23 b(By)13 b(default,)h(VSIZE)f(determines)g(the)g(maximum)h
(packet)f(size)g(that)g(each)h(lower)f(level)0 803 y(protocol)f(can)h(handle)
f(by)g(performing)h(a)g(GET)o(OPTP)l(ACKET)f(control)g(operation)g(on)g(the)h
(\256rst)g(N-1)f(lower)h(protocols)0 860 y(\(the)g(last)f(lower)g(protocol)f
(is)i(assumed)f(to)g(have)h(an)g(in\256nite)e(maximum)j(packet)e(size\).)21
b(VSIZE)13 b(sends)f(each)h(message)0 916 y(using)d(the)h(lower)g(level)f
(protocol)g(with)g(the)h(smallest)f(index)h(whose)f(optimum)h(packet)g(size)g
(is)f(greater)i(than)e(the)h(length)0 973 y(of)g(the)g(message.)0
1097 y Fl(REALM)0 1184 y Fr(VSIZE)g(is)g(in)g(the)f(ASYNC)i(realm.)0
1308 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1395 y Fr(VSIZE)f(passes)g(participants)e
(to)i(the)g(lower)g(protocols)e(without)g(manipulating)h(them.)0
1519 y Fl(CONTROL)i(OPERA)l(TIONS)0 1606 y Fr(VSIZE)f(forwards)g(control)f
(operations)g(to)h(the)g(\252lar)o(gest)f(message\272)i(protocol.)0
1731 y Fl(CONFIGURA)l(TION)0 1818 y Fr(VSIZE')m(s)f(lower)g(protocols)f
(should)f(be)j(order)f(by)g(decreasing)g(ef)o(\256ciency)g(and)g(increasing)f
(packet)h(size.)0 1924 y(VSIZE)g(recognizes)g(the)g(following)e(ROM)j
(options:)71 1993 y Fb(vsize/xxx)22 b(cutoff)h(C1)h(C2)p Fr(:)18
b(Instantiation)10 b Fq(xxx)j Fr(of)f(VSIZE)g(should)f(use)h(a)h(cutof)o(f)f
(length)f(of)i(C1)f(bytes)g(for)g(its)0 2049 y(\256rst)j(down)g(protocol)f
(and)i(a)g(cutof)o(f)f(value)g(of)h(C2)f(bytes)g(for)h(its)e(second)h(down)g
(protocol.)28 b(This)15 b(control)f(operation)0 2106 y(allows)9
b(the)h(user)g(of)g(VSIZE)h(to)e(override)h(the)g(GET)o(OPTP)l(ACKET)m(.)g
(Note)f(this)g(operation)g(does)h(not)g(check)g(to)g(see)g(if)g(the)0
2162 y(speci\256ed)h(cutof)o(f)g(value)g(is)g(less)f(than)h(the)g(maximum)g
(packet)g(size)g(of)h(the)f(lower)f(level)h(protocol.)0 2287
y Fl(AUTHOR)0 2374 y Fr(Ed)g(Menze)941 2753 y(146)p eop
%%Page: 147 147
146 bop 0 124 a Fl(NAME)0 211 y Fr(VT)l(AP)11 b(\(V)m(irtual)g(W)n(iretap)g
(Protocol\))0 335 y Fl(SPECIFICA)l(TION)0 422 y Fr(VT)l(AP)g(simulates)f(a)i
(wiretap)f(by)g(intercepting)e(all)i(messages)g(as)g(they)g(are)h(sent)e(or)h
(received.)0 545 y Fl(SYNOPSIS)0 632 y Fr(VT)l(AP)h(is)f(a)h(virtual)e
(protocol)h(that)g(intercepts)f(messages.)18 b(It)11 b(will)g(print)f(the)i
(entire)f(message)h(unless)e(the)h(tap)h(has)f(been)0 689 y(disabled.)0
812 y Fl(REALM)0 899 y Fr(VT)l(AP)g(is)g(in)g(the)g(ASYNC)g(realm.)0
1022 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1109 y Fr(VT)l(AP)g(passes)g(participants)e
(to)i(the)g(lower)g(protocols)e(without)h(manipulating)f(them.)0
1233 y Fl(CONTROL)j(OPERA)l(TIONS)0 1320 y Fb(VTAP)p 99 1320
15 2 v 17 w(ENABLETAP:)21 b Fr(Cause)11 b(the)g(session)f(to)h(print)f(the)h
(intercepted)f(message.)17 b(\(session)10 b(only\))114 1412
y(Input:)21 b(none)114 1483 y(Output:)f(none)0 1575 y Fb(VTAP)p
99 1575 V 17 w(DISABLETAP:)h Fr(Cause)15 b(the)g(session)f(to)h(simply)f
(pass)h(along)f(the)h(intercepted)f(message)i(without)d(printing)g(it.)114
1631 y(\(session)c(only\))114 1723 y(Input:)21 b(none)114 1795
y(Output:)f(none)0 1887 y Fb(VTAP)p 99 1887 V 17 w(PRINTHEX:)h
Fr(If)11 b(the)f(tap)g(is)f(enabled,)i(causes)f(the)g(session)f(to)g(print)h
(the)g(hex)g(representation)f(of)h(each)g(byte)g(of)g(the)114
1943 y(message.)16 b(\(session)10 b(only\))114 2035 y(Input:)21
b(none)114 2106 y(Output:)f(none)0 2198 y Fb(VTAP)p 99 2198
V 17 w(PRINTCHARS:)h Fr(If)14 b(the)g(tap)g(is)g(enabled,)g(causes)g(the)g
(session)f(to)g(print)g(the)h(character)h(representation)e(of)h(each)114
2255 y(byte)c(of)h(the)g(message.)17 b(\(session)10 b(only\))114
2347 y(Input:)21 b(none)114 2418 y(Output:)f(none)0 2542 y
Fl(CONFIGURA)l(TION)0 2629 y Fr(VT)l(AP)11 b(expects)g(to)g(be)g
(con\256gured)g(between)g(two)f(ASYNC)i(protocols.)941 2753
y(147)p eop
%%Page: 148 148
147 bop 0 124 a Fl(AUTHOR)0 211 y Fr(David)10 b(C.)i(Schwartz)941
2753 y(148)p eop
%%Page: 149 149
148 bop 0 124 a Fl(NAME)0 211 y Fr(XKSOCKET)11 b(\(the)g Fq(x)p
Fr(-kernel)g(socket)g(interface\))0 336 y Fl(SPECIFICA)l(TION)0
423 y Fr(BSD)h(Socket)f(operations)f(as)h(implemented)g(by)f(the)h(Mach3)h
(Unix)e(Single-Server)m(.)0 547 y Fl(SYNOPSIS)0 634 y Fr(Sockets)h(are)h(an)f
(application)e(interface)j(to)e(UDP)i(and)f(TCP)g(networking)f(services.)0
758 y Fl(REALM)0 845 y Fr(Sockets)h(are)h(in)e(the)h(anchor)g(protocol)f
(realm.)17 b(This)11 b(version)f(is)g(speci\256c)i(to)e(the)h(Mach3)h
(platform.)0 969 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1056 y Fr(Sockets)f(use)g(IP)g
(addresses.)16 b(The)11 b(addresses)g(are)h(passed)e(in)h(messages)g
(generated)g(by)g(MiG)g(stubs.)0 1181 y Fl(CONFIGURA)l(TION)0
1268 y Fb(name=xksocket)22 b(protocols=udp,tcp;)0 1392 y Fl(AUTHOR)0
1479 y Fr(David)10 b(Mosber)o(ger)o(-T)m(ang)941 2753 y(149)p
eop
%%Page: 150 150
149 bop 0 124 a Fn(B)60 b(Device)13 b(Drivers)0 228 y Fr(This)f(appendix)h
(describes)f(device)h(drivers)g(currently)g(implemented)g(in)g(the)g
Fq(x)p Fr(-kernel.)23 b(The)13 b(descriptions)f(are)i(in)e(the)0
284 y(same)g(format)f(as)h(those)e(in)h(appendix)f(A.)71 340
y(The)h(device)g(drivers)f(are)i(or)o(ganized)f(by)g Fq(x)p
Fr(-kernel)g(platform.)0 465 y Fl(B.1)50 b(SunOS)0 553 y(NAME)0
640 y Fr(SIMETH)12 b(\(Simulated)e(Ethernet)h(Driver)g(Protocol)f(\(sunos)g
(platform\)\))0 765 y Fl(SPECIFICA)l(TION)0 852 y Fr(SIMETH)g(simulates)f(an)
i Fq(x)p Fr(-kernel)f(ethernet)g(driver)f(by)h(sending)f(and)h(receiving)f
(messages)h(using)f(Unix)g(UDP)h(sockets.)0 976 y Fl(SYNOPSIS)0
1063 y Fr(Each)h(instantiation)d(of)j(SIMETH)h(is)e(associated)g(with)g(a)i
(speci\256c)f(Unix)f(UDP)h(port)g(and)g(simulates)f(an)h(ethernet)f(driver)0
1119 y(for)k(a)g(single)e(interface.)24 b(SIMETH)14 b(transmits)f(outgoing)e
(messages)i(by)h(sending)e(to)h(other)g(UDP)h(ports)f(and)g(presents)0
1176 y(UDP)g(messages)g(received)g(on)g(its)f(port)g(as)h(incoming)f
(ethernet)h(packets.)21 b(Note)13 b(that)f(since)h(messages)f(sent)h(from)g
(one)0 1232 y(sunos)g Fq(x)p Fr(-kernel)i(to)g(another)f(are)h(encapsulated)f
(within)f(Unix)h(UDP)h(packets,)g(it)f(is)g(only)g(possible)f(to)h
(communicate)0 1289 y(with)g(another)g(peer)h(running)f(the)g
Fq(x)p Fr(-kernel)h(with)f(this)g(same)h(driver)m(.)28 b(Communication)14
b(with)f(arbitrary)i(peers)g(is)f(not)0 1345 y(possible)9 b(with)i(this)f
(driver)m(.)71 1402 y(The)i(mapping)h(between)f(Unix)h(UDP)g(ports)f(and)h
(SIMETH)g(ethernet)g(addresses)f(is)g(very)h(simple.)22 b(The)13
b(six)f(bytes)0 1458 y(of)g(SIMETH)g(ethernet)g(address)f(are)i(formed)f(by)g
(the)f(concatenation)g(of)h(the)g(four)g(byte)f(IP)h(host)f(number)h(for)g
(the)g(Unix)0 1515 y(host)e(on)h(which)f(the)h(simulator)f(is)h(running)f
(and)h(the)f(two)h(byte)g(UDP)g(port)f(used)h(by)g(the)g(SIMETH)g
(instantiation.)j(Note)0 1571 y(that)e(this)f(is)h(the)g Fq(r)n(eal)g
Fr(IP)h(host)e(number)n(,)j(not)d(the)h Fq(simulated)f Fr(IP)i(host)e(number)
m(.)21 b(See)13 b(the)f(CONFIGURA)-5 b(TION)12 b(section)0
1628 y(below)m(.)71 1684 y(Note)j(that)g(an)g Fq(x)p Fr(-kernel)h(may)g(be)g
(con\256gured)f(with)g(multiple)f(instantiations)e(of)k(SIMETH,)g(each)g
(with)f(its)g(own)0 1740 y(UDP)c(port,)g(to)g(simulate)f(a)i(multihomed)e
(host.)71 1797 y(SIMETH)i(can)h(awkwardly)f(simulate)f(ethernet)h(broadcast)g
(messages.)20 b(When)12 b(an)h(outgoing)d(broadcast)i(message)0
1853 y(is)k(sent)h(to)f(SIMETH,)i(SIMETH)f(asks)g(its)f(corresponding)f(ARP)j
(protocol)d(for)i(a)h(dump)e(of)h(all)g(hosts)f(in)g(its)g(table.)0
1910 y(SIMETH)9 b(then)g(sends)f(the)h(message)g(to)f(each)i(of)f(these)f
(hosts)g(in)g(a)i(point-to-point)5 b(fashion.)15 b(Note)9 b(that)f(for)h(a)h
(reasonable)0 1966 y(simulation)h(of)i(ethernet)f(broadcast,)h(all)g
Fq(x)p Fr(-kernels)g(in)f(communication)g(should)f(have)i(the)g(same)g(ARP)h
(table)e(\(see)h(the)0 2023 y(ARP)f(appendix.\))0 2147 y Fl(REALM)0
2234 y Fr(SIMETH)g(is)e(in)h(the)g(ASYNC)g(realm,)h(supporting)d(the)i
(ethernet)g(driver)g(interface)g(described)g(in)g(the)f(ETH)h(appendix.)0
2358 y Fl(P)l(AR)n(TICIP)l(ANTS)0 2445 y Fr(SIMETH)h(supports)d(the)i
(ethernet)g(driver)g(interface)h(rather)f(than)g(a)h(standard)e(xkernel)h
(UPI)h(interface)f(and)h(thus)e(makes)0 2502 y(no)h(use)g(of)g(participant)f
(stacks.)941 2753 y(150)p eop
%%Page: 151 151
150 bop 0 124 a Fl(CONTROL)12 b(OPERA)l(TIONS)0 211 y Fb(ETH)p
75 211 15 2 v 17 w(REGISTER)p 284 211 V 16 w(ARP:)22 b Fr(Used)8
b(by)h(an)g(ARP)g(instantiation)d(to)i(register)g(itself)g(with)g(its)g
(corresponding)e(SIMETH)k(driver)m(.)114 268 y(This)h(is)h(used)g(to)g
(simulate)g(ethernet)g(broadcasts)g(as)h(described)e(above.)21
b(If)13 b(no)f(ARP)h(protocol)f(registers)f(with)h(a)114 324
y(SIMETH)f(instantiation,)e(broadcasts)h(on)h(that)f(instantiation)e(will)i
(not)h(be)g(possible.)114 418 y(Input:)21 b Fb(XObj)i(/*)h(ARP)f(protocol)g
(object)g(*/)114 491 y Fr(Output:)d(none)0 615 y Fl(EXTERNAL)13
b(INTERF)l(ACE)0 702 y Fr(SIMETH)f(supports)d(the)i(ethernet)g(driver)g
(interface)g(described)f(in)h(the)g(ETH)g(appendix.)0 827 y
Fl(CONFIGURA)l(TION)0 914 y Fr(SIMETH)g(requires)f(no)g(lower)h(protocol.)k
(It)10 b(can)h(be)g(con\256gured)f(in)g(either)h(the)f(driver)g(section)g(or)
h(the)f(protocol)f(section)0 970 y(of)i(graph.comp.)0 1051
y(SIMETH)h(recognizes)e(the)h(following)e(ROM)j(options:)71
1120 y Fb(simeth)23 b(nnnn)p Fr(:)c(This)12 b(instantiation)e(of)k(simeth)e
(should)g(use)h(UDP)g(port)f(nnnn.)22 b(There)13 b(must)g(be)g(such)g(a)g
(line)g(for)0 1177 y(each)f(instantiation)c(of)j(SIMETH)h(in)e(the)h
Fq(x)p Fr(-kernel.)0 1301 y Fl(AUTHORS)0 1388 y Fr(Larry)g(Peterson)g(and)g
(Norm)h(Hutchinson)941 2753 y(151)p eop
%%Page: 152 152
151 bop 0 124 a Fl(B.2)50 b(Mach)13 b(3)0 213 y(NAME)0 300
y Fr(ETHDR)l(V)e(\(Out-of-kernel)f(Ethernet)h(Driver)g(Protocol)f(\(mach3)i
(platform\)\))0 424 y Fl(SPECIFICA)l(TION)71 511 y Fr(ETHDR)l(V)e(is)h(the)g
(Mach)g(out-of-kernel)f(ethernet)h(driver)n(,)g(interacting)f(with)g(an)h
(ethernet)g(device)g(through)e(a)i(Mach)0 568 y(device)g(control)f(port.)0
692 y Fl(SYNOPSIS)71 779 y Fr(Each)i(instantiation)d(of)j(ETHDR)l(V)g(is)g
(associated)g(with)f(a)h(single)f(ethernet)h(device.)20 b(ETHDR)l(V)12
b(has)g(the)g(ability)f(to)0 835 y(block)f(out)h(certain)g(packet)g(types)f
(and)h(to)g(prevent)g(other)f(Mach)i(servers)f(from)h(receiving)f(ethernet)f
(packets.)0 960 y Fl(REALM)0 1047 y Fr(ETHDR)l(V)h(is)g(in)f(the)h(ASYNC)h
(realm,)g(supporting)d(the)i(ethernet)f(driver)h(interface)h(described)e(in)h
(the)g(ETH)g(appendix.)0 1171 y Fl(P)l(AR)n(TICIP)l(ANTS)0
1258 y Fr(ETHDR)l(V)f(supports)f(the)i(ethernet)f(driver)g(interface)h
(rather)f(than)g(a)h(standard)f(xkernel)g(UPI)h(interface)g(and)f(thus)g
(makes)0 1314 y(no)h(use)g(of)g(participant)f(stacks.)0 1439
y Fl(CONTROL)i(OPERA)l(TIONS)0 1526 y Fb(ETH)p 75 1526 15 2
v 17 w(SET)p 164 1526 V 17 w(PRIORITY:)21 b Fr(Changes)12 b(the)f(priority)g
(of)h(the)g(packet)g(\256lter)g(to)f(the)h(given)f(value.)19
b(See)12 b(CONFIGURA)-5 b(TION)114 1582 y(below)10 b(for)h(an)h(explanation)d
(of)i(\256lter)h(values.)114 1676 y(Input:)21 b Fb(int)i(filterValue)114
1749 y Fr(Output:)d(none)0 1873 y Fl(EXTERNAL)13 b(INTERF)l(ACE)0
1960 y Fr(ETHDR)l(V)e(supports)e(the)i(ethernet)g(driver)g(interface)g
(described)g(in)g(the)g(ETH)f(appendix.)0 2085 y Fl(CONFIGURA)l(TION)0
2172 y Fr(ETHDR)l(V)f(requires)f(no)h(lower)f(protocol.)15
b(It')m(s)9 b(instance)f(name)h(must)g(be)f(the)h(name)g(of)g(the)g(unmapped)
f(device)h(as)g(passed)0 2228 y(to)i(the)g(Mach)h(system)e(call)i
Fb(device)p 591 2228 V 16 w(open)p Fr(.)k(For)c(example,)g(if)f(the)g
(unmapped)g(device)g(is)g(named)g Fb(SE0)p Fr(,)h(the)f(instance)f(of)0
2285 y(ETHDR)l(V)h(using)f(that)g(device)h(must)g(be)g(con\256gured)g(as:)114
2391 y Fb(name=ethdrv/SE0;)0 2497 y Fr(Check)g(to)g(make)h(sure)f(that)g
Fb(/etc/NETWORKS)e Fr(is)i(set)g(up)g(to)f(use)h(the)g(unmapped)g(device.)16
b(E.g.,)114 2603 y Fb(192.12.69.1)22 b(on)i(SE0)941 2753 y
Fr(152)p eop
%%Page: 153 153
152 bop 0 124 a Fr(The)12 b(device)h(name)g(is)f(case-sensitive;)g
Fb(se0)g Fr(represents)g(the)g(mapped)h(device,)g(while)f Fb(SE0)g
Fr(represents)g(the)h(unmapped)0 181 y(device.)0 262 y(ETHDR)l(V)e
(recognizes)g(the)g(following)e(ROM)j(options:)71 331 y Fb(ethdrv/xxx)22
b(priority)h(n)p Fr(:)15 b(Instantiation)7 b(xxx)h(of)h(ETHDR)l(V)h(should)d
(use)i(packet)g(\256lter)h(priority)e(n.)15 b(A)10 b(priority)0
387 y(>=)16 b(200)g(will)g(not)g(allow)g(other)g(servers)g(to)h(receive)g
(ethernet)f(packets.)33 b(Adjusting)14 b(the)i(priority)f(in)i(this)e(way)i
(is)f(a)0 444 y(privileged)10 b(Mach)i(operation.)71 525 y
Fb(ethdrv/xxx)22 b(block)h(n)p Fr(:)d(Instantiation)10 b(xxx)i(of)h(ETHDR)l
(V)g(should)e(drop)i(packets)f(with)g(ethernet)g(type)h(n.)21
b(The)0 582 y(type)11 b(may)g(be)h(speci\256ed)e(in)h(either)g(hexadecimal)g
(\(pre\256xed)h(with)e('x'\))h(or)h(decimal.)0 706 y Fl(AUTHORS)0
793 y Fr(Mats)f(Bjorkman,)h(Hilarie)e(Orman,)i(Michael)g(Pagels,)f(Ed)g
(Menze)941 2753 y(153)p eop
%%Page: 154 154
153 bop 0 124 a Fl(NAME)0 211 y Fr(NS8390)10 b(\(Mach3)i(in-kernel)f(ns8390)e
(ethernet)i(driver\))0 336 y Fl(SPECIFICA)l(TION)71 423 y Fr(NS8390)j(is)g(a)
i(Mach)f(in-kernel)g(ethernet)f(driver)n(,)i(presenting)e(both)g(a)h(mach)h
(kernel)f(interface)g(and)g(an)g Fq(x)p Fr(-kernel)0 479 y(interface.)0
603 y Fl(SYNOPSIS)71 690 y Fr(Each)d(instantiation)d(of)j(NS8390)f(is)g
(associated)g(with)g(a)h(single)f(ethernet)h(device.)19 b(NS8390)11
b(can)h(be)g(con\256gured)g(to)0 747 y(either)i(copy)f(incoming)g(packets)h
(to)f(both)g(the)h Fq(x)p Fr(-kernel)g(and)g(the)g(standard)f(Mach)i
(networking)d(interface)i(\(thus)f(both)0 803 y(the)g(in-kernel)f
Fq(x)p Fr(-kernel)h(and)g(the)g(Unix)f(server)i(will)d(see)j(packets\))e(or)i
(to)e(bypass)g(the)h(Mach)h(interface)f(and)g(not)f(allow)0
860 y(the)f(Unix)f(server)i(to)e(see)i(any)f(packets.)71 916
y(If)k(compiled)g(with)f(ALLOW)p 565 916 14 2 v 15 w(NON)p
679 916 V 16 w(XK)p 761 916 V 16 w(USERS)i(de\256ned,)h(NS8390)d(will)g
(allow)g(non-)p Fq(x)p Fr(-kernel)h(users)g(to)g(send)0 973
y(and)c(receive)h(network)e(packets)h(through)e(the)i(standard)g(Mach)g
(interfaces.)0 1097 y Fl(REALM)0 1184 y Fr(NS8390)f(is)h(in)g(the)g(ASYNC)g
(realm,)h(supporting)d(the)i(ethernet)g(driver)g(interface)g(described)g(in)f
(the)h(ETH)g(appendix.)0 1308 y Fl(P)l(AR)n(TICIP)l(ANTS)0
1395 y Fr(NS8390)h(supports)f(the)h(ethernet)g(driver)h(interface)g(rather)g
(than)f(a)h(standard)f(xkernel)g(UPI)h(interface)g(and)f(thus)g(makes)0
1452 y(no)f(use)g(of)g(participant)f(stacks.)0 1576 y Fl(EXTERNAL)j(INTERF)l
(ACE)0 1663 y Fr(NS8390)d(supports)g(the)h(ethernet)f(driver)h(interface)h
(described)e(in)h(the)g(ETH)g(appendix.)0 1787 y Fl(CONFIGURA)l(TION)0
1874 y Fr(NS8390)g(requires)h(no)f(lower)h(protocol.)18 b(The)12
b(last)f(digit)g(of)h(the)g(instance)f(name)h(must)g(correspond)f(to)h(the)f
(unit)g(device)0 1931 y(number)g(for)h(the)e(particular)h(instantiation.)j
(E.g.,)71 2012 y Fb(name=ns8390/el0;)0 2093 y Fr(for)d(device)g(0.)0
2218 y Fl(AUTHOR)0 2305 y Fr(Hasnain)f(Karampurwala)i(\(modi\256cations)e(to)
g(Mach)i(kernel)f(source)g(distribution\))941 2753 y(154)p
eop
%%Page: 155 155
154 bop 0 124 a Fl(NAME)0 211 y Fr(XKLANCE)10 b(\(Mach3)i(in-kernel)f(lance)g
(ethernet)g(driver\))0 336 y Fl(SPECIFICA)l(TION)71 423 y Fr(XKLANCE)e(is)h
(a)h(Mach)g(in-kernel)f(ethernet)g(driver)n(,)h(presenting)e(both)h(a)h(mach)
g(kernel)f(interface)h(and)f(an)h Fq(x)p Fr(-kernel)0 479 y(interface.)0
603 y Fl(SYNOPSIS)71 690 y Fr(Each)19 b(instantiation)e(of)j(XKLANCE)f(is)h
(associated)e(with)h(a)h(single)f(ethernet)g(device.)43 b(XKLANCE)19
b(can)h(be)0 747 y(con\256gured)10 b(to)f(either)h(copy)g(incoming)f(packets)
h(to)f(both)g(the)h Fq(x)p Fr(-kernel)h(and)f(the)g(standard)f(Mach)i
(networking)d(interface)0 803 y(\(thus)j(both)h(the)g(in-kernel)f
Fq(x)p Fr(-kernel)i(and)f(the)g(Unix)g(server)g(will)g(see)g(packets\))g(or)h
(to)e(bypass)h(the)g(Mach)h(interface)f(and)0 860 y(not)e(allow)h(the)g(Unix)
f(server)h(to)g(see)h(any)f(packets.)71 916 y(If)k(compiled)f(with)g(ALLOW)p
564 916 14 2 v 15 w(NON)p 678 916 V 16 w(XK)p 760 916 V 16
w(USERS)h(de\256ned,)h(XKLANCE)f(will)e(check)i(the)g(value)f(of)h(the)f
(global)0 973 y(variable)i(xklanceAllUsers)e(to)h(determine)h(whether)g(to)f
(allow)h(non-)p Fq(x)p Fr(-kernel)f(users)h(to)f(send)h(and)g(receive)g
(network)0 1029 y(packets)11 b(through)e(the)i(standard)g(Mach)h(interfaces.)
0 1153 y Fl(REALM)0 1240 y Fr(XKLANCE)d(is)g(in)g(the)h(ASYNC)f(realm,)i
(supporting)d(the)h(ethernet)g(driver)h(interface)f(described)g(in)g(the)h
(ETH)f(appendix.)0 1365 y Fl(P)l(AR)n(TICIP)l(ANTS)0 1452 y
Fr(XKLANCE)16 b(supports)g(the)g(ethernet)h(driver)g(interface)g(rather)g
(than)g(a)g(standard)f(xkernel)h(UPI)g(interface)g(and)g(thus)0
1508 y(makes)11 b(no)g(use)g(of)g(participant)f(stacks.)0 1632
y Fl(EXTERNAL)j(INTERF)l(ACE)0 1719 y Fr(XKLANCE)d(supports)g(the)h(ethernet)
g(driver)f(interface)i(described)e(in)h(the)g(ETH)g(appendix.)0
1844 y Fl(CONFIGURA)l(TION)0 1931 y Fr(XKLANCE)k(requires)g(no)g(lower)g
(protocol.)28 b(The)16 b(last)f(digit)f(of)h(the)g(instance)g(name)h(must)f
(correspond)g(to)g(the)g(unit)0 1987 y(device)c(number)g(for)h(the)e
(particular)h(instantiation.)j(E.g.,)71 2068 y Fb(name=xklance/SE0;)0
2150 y Fr(for)d(device)g(0.)0 2274 y Fl(AUTHORS)0 2361 y Fr(Richard)g
(Schroeppel,)g(Hilarie)g(Orman)h(\(modi\256cations)e(to)g(Mach)i(kernel)f
(source)g(distribution\))941 2753 y(155)p eop
%%Page: 156 156
155 bop 0 124 a Fn(C)60 b(Application)14 b(Pr)o(ogrammer)e(Interfaces)0
228 y Fr(This)e(appendix)g(describes)h(the)g(installation)e(and)i(use)g(of)g
Fq(x)p Fr(-kernel)h(application)d(programmer)j(interfaces.)17
b(APIs)12 b(in)e(the)0 284 y Fq(x)p Fr(-kernel)i(are)f(platform-speci\256c.)0
406 y Fl(C.1)63 b(Mach)12 b(3)0 493 y Fm(C.1.1)45 b(Sockets)0
580 y Fr(The)19 b(Mach)h(3)f(out-of-kernel)g(platform)g(provides)f(a)h(user)g
(socket)g(library)m(.)40 b(At)19 b(this)f(time,)k(the)d(library)g(can)g(only)
0 636 y(be)f(compiled)e(with)h(a)h(DECstation)d(5000.)35 b(The)17
b(library)g(can)h(be)f(used)g(to)g(communicate)h(with)e(the)i(XSI)g(protocol)
0 693 y(running)h(in)g(an)h(out-of-kernel)f Fq(x)p Fr(-kernel)i(in)e(a)h
(separate)g(task.)43 b(The)20 b(combination)e(of)i(the)g(library)f(and)h(the)
g(XSI)0 749 y(protocol)13 b(provides)h(Berkeley)h(socket)f(semantics.)26
b(The)15 b(mach)g(3)g(user)o(-level)f(build)f(will)h(create)h(a)h(socket)e
(library)g(in)0 806 y(the)g Fb(xkernel/mach3/user/sock)o(et)d
Fr(directory)i(which)g(can)h(be)g(linked)f(with)g(any)h(application)e(making)
h(Berkeley)0 862 y(socket)i(calls.)30 b(These)15 b(calls)g(will)g(then)g(be)h
(routed)f(through)f(the)h Fq(x)p Fr(-kernel)h(socket)f(implementation)f
(rather)i(than)f(the)0 919 y(sockets)10 b(in)h(the)g(BSD)h(server)m(.)71
975 y(The)e(user)o(-level)h(build)f(\(see)h(below\))f(will)g(also)h(create)g
(some)g(test)g(programs)g(that)f(exercise)h(the)g(socket)f(library)g(and)0
1032 y(the)i(XSI)i(protocol)d(in)h Fb(xkernel/mach3/user/socket/ts)o(t)p
Fr(.)19 b(T)m(wo)12 b(versions)f(of)i(each)g(test)f(program)h(are)g(created,)
0 1088 y(one)8 b(linked)g(against)g(the)g Fq(x)p Fr(-kernel)h(socket)f
(library)g(and)g(one)h(linked)e(against)h(the)g(standard)g(Mach)i(libraries.)
k(An)9 b Fq(x)p Fr(-kernel)0 1144 y(con\256gured)i(with)f(the)h(XSI)h
(protocol)e(must)h(be)g(running)f(for)i(the)f Fq(x)p Fr(-kernel)h(versions)e
(of)h(the)g(test)g(programs)g(to)g(run,)g(or)h(a)0 1201 y(message)f(of)h(the)
e(form:)114 1283 y Fb(xsi)p 189 1283 15 2 v 16 w(user)p 301
1283 V 17 w(init:)47 b(netname)p 653 1283 V 16 w(lookup\(\):)g(\(ipc/mig\))22
b(server)h(died)0 1364 y Fr(will)10 b(be)h(displayed.)k(The)c(test)f
(programs)h(have)g(a)h(number)f(of)g(\257ags)g(controlling)e(their)h
(behavior)m(.)17 b(Invoking)9 b(them)i(with)0 1421 y Fb(-h)g
Fr(will)f(give)h(a)g(list)f(of)i(these)e(parameters.)0 1541
y Fm(C.1.2)45 b(MachNetIPC)0 1628 y Fr(The)13 b(user)o(-level)g(build)f
(\(see)i(below\))e(will)h(create)h(a)f(test)g(program,)h(nnstest,)f(which)g
(exercises)g(the)g Fq(x)p Fr(-kernel')m(s)h(out-of-)0 1684
y(kernel)d(implementation)f(of)h(MachNetIPC)h(in)f Fb
(xkernel/mach3/user/netipc)o(/test)p Fr(.)71 1741 y(NNS)g(test)g
(communicates)g(with)g(the)g Fq(x)p Fr(-kernel)h(protocols)e(NNS)i(which)f
(is)g(the)g(top)g(layer)g(of)h(MachNetIPC.)h(There)0 1797 y(must)e(be)g(an)g
Fq(x)p Fr(-kernel)h(task)e(with)h(MachNetIPC)h(running)e(on)g(the)h(host.)71
1854 y(NNS)h(test)f(takes)g(command)i(line)e(ar)o(guments.)19
b(Before)13 b(performing)e(checkins,)h(checkouts,)f(and)h(lookups)e(the)i
(test)0 1910 y(program)h(\256rst)f(looks)f(up)i(the)f(service)g
(\252NetworkNameServer)r(\272)h(and)g(uses)f(the)g(associated)g(port)g(as)g
(the)h(default)f(name)0 1967 y(server)i(port.)23 b(This)13
b(is)g(to)g(avoid)g(con\257icts)g(with)f(a)i(previously)e(running)g(simple)h
(name)h(server)m(.)25 b(Following)12 b(are)i(some)0 2023 y(example)d(runs.)0
2120 y(T)m(o)g(checkin)f(a)i(service)f(on)g(the)g(local)f(host)h(do:)114
2209 y Fb(nnstest)23 b(-i)g(service)p 547 2209 V 16 w(name)h(&)f
Fr(;)0 2298 y(Note)13 b(that)g(to)g(perform)i(remote)f(host)e(lookups,)h(you)
g(have)h(to)f(specify)g(the)g(IP)i(address)e(of)g(the)h(host)e(and)i(not)f
(the)g(host)0 2354 y(name.)k(T)m(o)11 b(look)f(up)h(a)g(service)h(on)e(a)i
(remote)f(machine)h(with)e(IP)i(address)e(192.12.69.88)g(do:)114
2444 y Fb(nnstest)23 b(-h192.12.69.88)e(-l)j(service)p 905
2444 V 16 w(name)g Fr(;)0 2533 y(T)m(o)11 b(checkin,)g(lookup)e(and)i
(checkout)g(a)g(service)g(on)g(the)g(remote)h(machine)f(do:)114
2622 y Fb(nnstest)23 b(-h192.12.69.88)e(-ilo)j(service)p 953
2622 V 16 w(name)f Fr(;)941 2753 y(156)p eop
%%Page: 157 157
156 bop 0 124 a Fm(C.1.3)45 b(Building)0 211 y Fr(The)11 b(Mach)h(3)f(APIs)g
(can)h(be)f(built)f(from)h(a)h(normal)f(out-of-kernel)f Fq(x)p
Fr(-kernel)i(build)e(directory)m(.)16 b(Running)143 318 y Fb(make)23
b(userDepend)0 424 y Fr(will)10 b(build)g(the)h(dependency)f(\256les)h(for)h
(the)f(APIs)g(and)143 530 y Fb(make)23 b(user)0 636 y Fr(will)16
b(build)f(the)h(user)h(libraries)f(and)g(the)h(test)e(programs.)33
b(Building)15 b(the)i(APIs)g(should)e(only)g(be)i(attempted)f
Fq(after)g Fr(a)0 693 y(successful)10 b(build)g(of)h(the)g(rest)g(of)g(the)g
Fq(x)p Fr(-kernel)h(system.)941 2753 y(157)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
